"use strict";var xO=Object.defineProperty;var c=(t,e)=>xO(t,"name",{value:e,configurable:!0});var _=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Uc=_((Uj,o1)=>{"use strict";var s1=require("fs"),ra=require("path"),Qf=c(t=>{try{let e=s1.readFileSync(ra.join(__dirname,"..",t));return JSON.parse(e.toString().replace(/\/\*[\s\S]*?\*\//g,""))}catch{return{}}},"getConfig"),Yf=c(t=>{let e;return(...r)=>(e||(e=t(...r)),e)},"cacheResult"),TO=Yf(()=>Qf(ra.join("properties_pane","field_level","fieldLevelConfig.json"))),_O=Yf(()=>Qf(ra.join("properties_pane","entity_level","entityLevelConfig.json"))),bO=Yf(()=>{let t=c(n=>n.replace(/\.json/,""),"getName"),e=ra.join(__dirname,"..","types");return s1.readdirSync(e).reduce((n,i)=>(n[t(i)]=Qf(ra.join("types",i)),n),{})});o1.exports={getEntityLevelConfig:_O,getFieldLevelConfig:TO,getTypesConfig:bO}});var ar=_((Kj,f1)=>{"use strict";var{getEntityLevelConfig:Mj,getFieldLevelConfig:IO,getTypesConfig:AO}=Uc(),NO=2,BO=c((t="")=>t.startsWith("DSE")&&(t.split(" ")[1]||"").split(".")[0]||"","getDataStaxVersion"),RO=c((t,e=1)=>{let r=" ".repeat(e*NO);return t.split(`
`).map(n=>r+n).join(`
`)},"tab"),gi=c((t,e,r,n="")=>((t||[])[e]||{})[r]||n,"retrivePropertyFromConfig"),OO=c(t=>gi(t,0,"code",gi(t,0,"name","")),"retrieveContainerName"),DO=c(t=>gi(t,0,"code",gi(t,0,"collectionName","")),"retrieveEntityName"),LO=c(t=>gi(t,1,"UDFs",[]),"retrieveUDF"),PO=c(t=>gi(t,2,"UDAs",[]),"retrieveUDA"),kO=c((t,e)=>{let r=t[1],n={indexes:gi(t,1,"SecIndxs",[])};return r.searchIndex&&(n.searchIndex={indexType:"search",columns:r.searchIndexColumns,config:r.searchIndexConfig,profiles:c1(r.searchIndexProfiles,e),options:r.searchIndexOptions,ifNotExist:r.searchIndexIfNotExist}),n},"retrieveIndexes"),a1=c((t,e)=>t.filter(r=>!e.includes(r)),"filterSpaceSaving"),c1=c((t,e)=>{let r=BO(e),i=[(r.length?Number(r)>=6:!1)?"spaceSavingNoTextfield":""];return t=Array.isArray(t)?t:[t].filter(Boolean),t=a1(t,i),a1(["spaceSavingNoJoin","spaceSavingNoTextfield","spaceSavingSlowTriePrecision"],i).every(a=>t.includes(a))?["spaceSavingAll"]:t},"getIndexProfiles"),FO=c((t,e)=>u1(t,`"${e}"`),"getTableNameStatement"),u1=c((t,e)=>`${t?`"${t}".`:""}${e}`,"getNameWithKeyspace"),qO=c(t=>AO()[t],"getTypeConfig"),l1=c((t,e)=>{let r=IO().structure;return r[t]?r[t].find(i=>i.propertyKeyword===e):void 0},"getFieldConfig"),Zf=c((t,e)=>{let r=Object.assign({},t),n=c((s,o)=>Object.keys(s).reduce((a,u)=>{let l=s[u];return a[u]=o(Zf(l,o),u),a},{}),"eachProperty"),i=c((s,o)=>s.map((a,u)=>o(Zf(a,o),u)),"eachItem");if(r.hasOwnProperty("properties")&&(r.properties=n(r.properties,e)),r.hasOwnProperty("items")){let s=Array.isArray(r.items)?r.items:[r.items];r.items=i(s,e)}return r},"eachField"),UO=c((t,e)=>{let r=l1(t,"mode")||{};return Array.isArray(r.options)?r.options.includes(e):!1},"canTypeHaveSubtype"),VO=c((t,e=!0,r=!0,n=!0)=>{if(e||!r||!t)return t;let i=c((o,a="-- ")=>o.split(`
`).map(u=>`${a}${u}`).join(`
`),"insertBeforeEachLine");return n?c(o=>`/*
${i(o,"  ")}
*/`,"multiLineComment")(t):i(t)},"commentDeactivatedStatement"),MO=c(t=>{var r;let e=(r=t==null?void 0:t[0])==null?void 0:r.isActivated;return e===void 0?!0:e},"retrieveIsItemActivated"),KO=c(t=>t.map(e=>e.functionBody).filter(e=>e).join(`
`),"getUserDefinedFunctions"),HO=c(t=>t.map(e=>e.storedProcFunction).filter(e=>e).join(`
`),"getUserDefinedAggregations"),$O=c(t=>{let{applyDropStatements:e,additionalOptions:r=[]}=t.options||{},n=(r.find(i=>i.id==="applyDropStatements")||{}).value;return e||n},"getApplyDropStatement");f1.exports={tab:RO,retrieveContainerName:OO,retrieveEntityName:DO,retrieveUDF:LO,retrieveUDA:PO,retrieveIndexes:kO,retrivePropertyFromConfig:gi,getTableNameStatement:FO,getFieldConfig:l1,getTypeConfig:qO,getNameWithKeyspace:u1,eachField:Zf,canTypeHaveSubtype:UO,commentDeactivatedStatement:VO,retrieveIsItemActivated:MO,getUserDefinedAggregations:HO,getUserDefinedFunctions:KO,getIndexProfiles:c1,getApplyDropStatement:$O}});var na=_(($j,v1)=>{"use strict";var{getFieldConfig:d1,getTypeConfig:h1,canTypeHaveSubtype:GO}=ar(),p1=c(t=>{let e,r=c((n,i)=>{if(n===t)e=i;else if(n===void 0)return e;return r},"handler");return r},"ifType"),Xf=c((t,e,r)=>{if(t){let n=d1(t,"mode"),i=n!=null&&n.options?n.options[0]:t;return th(t,r)({type:t,mode:i,frozen:!0,keyType:"char",keySubtype:"text",items:{type:"char",mode:"varchar"},properties:{field:{type:"char",mode:"varchar"}}})}return e},"getModeType"),g1=c((t,e)=>{let r=c(s=>s.type,"simpleType"),n=c(s=>`'${s.subType||"PointType"}'`,"geoSpatialType"),i=c(s=>{if(s.physicalType)return th(s.physicalType)(Object.assign(s,{type:s.physicalType}))},"getJsonType");return p1(t)("char",s=>s.mode||"text")("numeric",s=>{let o=s.mode||"integer";return o==="integer"?"int":o})("binary",()=>"blob")("bool",()=>"boolean")("blob",r)("timestamp",r)("date",r)("time",r)("duration",r)("uuid",r)("timeuuid",r)("DseExecutorStateType",s=>`'${r(s)}'`)("DateRangeType",s=>`'${r(s)}'`)("geospatial",n)("udt",(s,o)=>Jf(o,e)())("jsonObject",i)("jsonArray",i)()},"getScalarType"),y1=c((t,e,r)=>{let n=c(g=>!!g.frozen,"isFrozen"),i=c(g=>d=>{let y=g(d);return n(d)?eh(y):y},"setFrozen"),s=c((g,d,y,v)=>{var m,w,x,A,O,P;if(g.items)if(Array.isArray(g.items)){let j=((m=g.items[0])==null?void 0:m.code)||((w=g.items[0])==null?void 0:w.name)||((x=g.items[0])==null?void 0:x.displayName);return a(g.items[0],n(g),j||0)}else{let j=((A=g.items)==null?void 0:A.code)||((O=g.items)==null?void 0:O.name)||((P=g.items)==null?void 0:P.displayName);return a(g.items,n(g),j||0)}else{let j=h1(g.type);if(j.subtypes&&g.subtype){let Q=j.subtypes[g.subtype];if(Q!=null&&Q.childValueType)return Xf(Q.childValueType,d,y)}}return d},"getValueTypeFromArray"),o=c((g,d,y)=>{if(g.properties){let v=Object.keys(g.properties)[0];if(v){let m=g.properties[v];return a(m,n(g),v)}}else{let v=h1(g.type);if(v.subtypes&&g.subtype){let m=v.subtypes[g.subtype];if(m!=null&&m.childValueType)return Xf(m.childValueType,d,y)}}return d},"getValueTypeFromObject"),a=((g,d)=>(y,v,m)=>{if(y){let w=jO(y,!v&&g,d,m);if(w!==void 0)return w}else return"text"})(e,r),u=c((g,d)=>`set<${s(g,"varchar",r,d)}>`,"typeSet"),l=c((g,d)=>`list<${s(g,"text",r,d)}>`,"list"),f=c((g,d)=>`tuple<${(Array.isArray(g.items)?g.items:[g.items]).map((v,m)=>a(v,!0,m)).join(", ")}>`,"tuple"),h=c((g,d)=>{let y=GO(g.keyType,g.keySubtype)?g.keySubtype:Xf(g.keyType,"text",r),v=o(g,"text",r);return`map<${y}, ${v}>`},"map"),p=c((g,d)=>{let y=s(g,"float",r,d),v=WO(g);return`vector<${y}, ${v}>`},"vector");return p1(t)("map",i(h))("list",i(l))("set",i(u))("vector",i(p))("tuple",f)()},"getStructuralTypeHandler"),Jf=c((t,e,r)=>()=>{let n=e[t]||{};return n.frozen&&!r?eh(n.name):n.name},"getUDTHandler"),eh=c(t=>t===void 0?void 0:`frozen<${t}>`,"getFrozen"),th=c((t,e)=>g1(t,e)||y1(t,!0,e)||Jf(t,e),"getHandlerByType"),jO=c((t,e,r,n)=>{let i=m1(t),s=g1(i,r);if(s)return s(t,n);let o=(y1(i,!1,r)||Jf(i,r,e))(t,n);return e?eh(o):o},"getNestedTypeByData"),m1=c(t=>t.$ref?t.$ref.split("/definitions/").pop():t.type?t.type:"char","getTypeByPropertyData"),zO=c((t,e,r)=>{let n=m1(t);return th(n,e)(t,r)},"getTypeByData"),WO=c(t=>{if(!isNaN(+t.dimension))return t.dimension;let e=d1(t.type,"dimension");return e==null?void 0:e.defaultValue},"getVectorDimension");v1.exports={getTypeByData:zO}});var S1=_((jj,E1)=>{"use strict";var QO=c(({index:t,numberOfStatements:e,lastIndexOfActivatedStatement:r,delimiter:n})=>{let i=t===e-1,s=t===r;return i?"":s?" --"+n:n},"getDelimiter"),YO=c(({statements:t=[],delimiter:e=",",indent:r=`
`})=>{let n=t.findLastIndex(s=>!s.startsWith("--")),i=t.length;return t.map((s,o)=>{let a=QO({index:o,numberOfStatements:i,lastIndexOfActivatedStatement:n,delimiter:e});return s+a}).join(r)},"joinActivatedAndDeactivatedStatements");E1.exports={joinActivatedAndDeactivatedStatements:YO}});var Vc=_((Wj,C1)=>{"use strict";var{getTypeByData:ZO}=na(),{commentDeactivatedStatement:XO}=ar(),{joinActivatedAndDeactivatedStatements:JO}=S1();C1.exports={getColumnDefinition(t,e={},r=!1){let n=Object.keys(t).map(i=>{let s=t[i],o=rD(s,e,i);if(o===void 0)return"";{let a=tD(s.code||i,o,eD(s));return XO(a,s.isActivated,r,!1)}}).filter(i=>i);return JO({statements:n,indent:`
`})}};var eD=c(t=>!!(t||{}).static,"isStatic"),tD=c((t,e,r)=>`"${t}" ${e}${r?" STATIC":""}`,"getColumn"),rD=c((t,e,r)=>ZO(t,e,r),"getTypeDefinition")});var sa=_((Yj,x1)=>{"use strict";var nD=["isActivated","type","compositePartitionKey"],w1=c((t={},e=!1)=>e?t:nD.reduce((r,n)=>!t.hasOwnProperty(n)||t[n]===void 0?r:{...r,[n]:t[n]},{}),"getAttributes"),ia=c((t,e,r)=>{if(t.GUID===e||t.id===e)return r;if(t.properties)return Object.keys(t.properties).reduce((n,i)=>{if(n)return n;{let s=t.properties[i];return ia(s,e,[...r,s.GUID||s.id])}},void 0);if(t.items)return Array.isArray(t.items)?t.items.reduce((n,i)=>n||ia(i,e,[...r,i.GUID||i.id]),void 0):ia(t.items,e,[...r,t.items.GUID])},"getPathById"),iD=c((t,e,r)=>{let n=Object.keys(e).find(s=>e[s].GUID===t||e[s].id===t),i=e[n];return i&&(i.code||i.name)?{name:i.code||i.name,...w1(e[n],r)}:{name:n,...w1(e[n],r)}},"getRootItemMetadataById"),sD=c((t,e,r)=>{let n=ia(e,t,[]);return n?iD(n[0],e.properties,r):{name:""}},"findFieldMetadataById"),oD=c((t,e,r)=>t.reduce((n,i)=>{for(let s=0;s<e.length;s++){let o=sD(i,e[s],r);if(o!=null&&o.name)return Object.assign({},n,{[i]:o})}return n},{}),"getAttributesDataByIds");x1.exports={getPathById:ia,getNamesByIds:oD}});var oa=_((Xj,A1)=>{"use strict";var T1="LINE",_1="INLINE",rh="MULTILINE",b1=c((t,e="-- ")=>t.split(`
`).map(r=>r&&`${e}${r}`).join(`
`),"insertBeforeEachLine"),aD=c(t=>`/*
${b1(t,"  ")}
*/`,"multiLineComment"),I1=c(t=>`/* ${t} */`,"inlineComment"),cD=c((t,e=!0,r=!0,n=rh)=>{if(e||!r||!t)return t;switch(n){case rh:return aD(t);case _1:return I1(t);case T1:return b1(t);default:return t}},"commentDeactivatedStatement");A1.exports={commentDeactivatedStatement:cD,inlineComment:I1,LINE:T1,INLINE:_1,MULTILINE:rh}});var B1=_((ez,N1)=>{"use strict";N1.exports={dropTable:"DROP TABLE IF EXISTS ${name};",createTable:"CREATE TABLE ${ifNotExistStatement}${name}${items}${options};",dropDatabase:"DROP DATABASE IF EXISTS ${name};",createCustomIndex:"CREATE CUSTOM INDEX ${ifNotExistStatement}${name}\n  ON ${tableName} (${column})\n  USING '${usingStatement}'${optionsStatement};",createIndex:"CREATE INDEX ${ifNotExistStatement}${nameStatement}\n  ON ${tableName} (${column});",createSearchIndex:"CREATE SEARCH INDEX ${ifNotExistStatement}ON ${tableName}\n  WITH COLUMNS\n${columnsStatement}${profiles}${config}${options};",dropType:"DROP TYPE IF EXISTS ${keyspaceName}.${typeName};",renameColumn:"${alterTablePrefixStatement} RENAME ${oldName} TO ${newName};",addEntity:"${alterTablePrefixStatement} ADD ${name} ${type};",deleteEntity:"${alterTablePrefixStatement} DROP ${name};",addPropertyToUdt:"${alterTypePrefixStatement}.${udtName} ADD ${name} ${type};",createUdt:"CREATE TYPE IF NOT EXISTS ${keySpaceName}.${udtName} (\n${columnScript} \n);",updateUdtType:"${alterTypePrefixStatement}.${udtName}\nALTER ${name} TYPE ${type};",renameType:"${alterTypePrefixStatement}.${udtName} \n	RENAME ${oldFieldName} TO ${newFieldName};",updateType:"${alterTablePrefixStatement} \n	ALTER ${name} TYPE ${type};",updateTableOptions:"${alterTablePrefixStatement}${optionsStatement};",dropSearchIndexConfig:"ALTER SEARCH INDEX CONFIG\n  ON ${tableNameStatement}\n    DROP ${indexName};",modifySearchIndex:"ALTER SEARCH INDEX CONFIG\n  ON ${tableNameStatement}\n    SET ${key} = ${value};",dropSearchIndex:"DROP SEARCH INDEX ON ${tableNameStatement};",dropIndex:"DROP INDEX IF EXISTS ${tableNameStatement};",dropKeySpace:"DROP KEYSPACE IF EXISTS ${keySpaceName};",createKeySpace:"CREATE KEYSPACE IF NOT EXISTS ${keySpaceName} \n${replication}\n${durableWrites}${udfScript}${udaScript};",alterKeySpaceReplication:"ALTER KEYSPACE ${keySpaceName} \n${replication}\n${durableWrites};",dropView:"DROP MATERIALIZED VIEW IF EXISTS ${viewName};",alterView:"ALTER MATERIALIZED VIEW ${keySpaceViewName}\n${optionScript};"}});var ca=_((tz,L1)=>{"use strict";var{commentDeactivatedStatement:uD,inlineComment:lD}=oa(),{tab:aa,getTableNameStatement:fD}=ar(),{getNamesByIds:R1}=sa(),{dependencies:nh}=cr(),hD=c((t,e,r,n,i,s,o)=>{let a=fD(n,r),u=i&&s,l=dD(a,e,t.indexes),f=o==="Astra DB"?[]:pD(a,e,u,t.searchIndex);return[...l,...f].map(p=>uD(p.statement,p.isActivated,u)).join(`

`)},"getIndexes"),dD=c((t,e,r=[])=>mD(r).map(n=>{let i,s=n.isActivated&&D1(n.SecIndxKey,e),o=O1(n.SecIndxKey,e);return n.indexType==="custom"?i=nh.provider.createCustomIndex({name:n.name,tableName:t,column:o,using:n.isSASI?"org.apache.cassandra.index.sasi.SASIIndex":"StorageAttachedIndex",options:ED(n.customOptions,n.isSASI),ifNotExist:n.indexIfNotExist}):i=nh.provider.createIndex({name:n.name,tableName:t,column:o,ifNotExist:n.indexIfNotExist}),{isActivated:s,statement:i}}),"getGeneralIndexes"),pD=c((t,e,r,n)=>{if(!n)return[];let i=[];n.columns&&(i=gD(n.columns.filter(u=>Array.isArray(u.key)&&u.key.length).map(u=>({...u,name:O1(u.key[0],e),isActivated:D1(u.key[0],e)}))));let o=i.filter(u=>u.isActivated).length>0,a=SD({tableName:t,isActivated:o&&r,index:n,columns:i,ifNotExist:n.ifNotExist});return[{isActivated:o,statement:a}]},"getSearchIndexStatement"),gD=c(t=>t.reduce((e,r)=>e.find(i=>i.name===r.name)?e:e.concat(r),[]),"uniqueByName"),O1=c((t,e)=>{let{name:r}=R1([t.keyId],e)[t.keyId]||{};return r?yD(`"${r}"`,t.type):""},"getIndexColumnStatement"),yD=c((t,e)=>e==="keys"?`KEYS(${t})`:e==="values"?`VALUES(${t})`:e==="entries"?`ENTRIES(${t})`:e==="full"?`FULL(${t})`:t,"wrapKey"),D1=c((t,e)=>{let{isActivated:r}=R1([t.keyId],e)[t.keyId]||{};return r!==!1},"isIndexColumnKeyActivated"),mD=c(t=>t.reduce((e,r)=>[...e,...(r.SecIndxKey||[]).map((n,i)=>Object.assign({},r,{name:i>0?r.name+"_"+i:r.name,SecIndxKey:n}))],[]),"unwindIndexes"),vD=c(t=>Object.keys(t).map(e=>`'${e}': '${t[e]}'`),"serializeOptions"),ED=c((t,e)=>{let r={};return!t||(t.case_sensitive&&(r.case_sensitive="true"),t.normalize&&(r.normalize="true"),t.ascii&&!e&&(r.ascii="true"),t.similarity_function&&!e&&(r.similarity_function=`${t.similarity_function}`),!e)||(t.analyzed&&(r.analyzed="true"),t.isLiteral&&(r.is_literal="true"),t.tokenizationEnableStemming&&(r.tokenization_enable_stemming="true"),t.tokenizationNormalizeLowercase&&(r.tokenization_normalize_lowercase="true"),t.tokenizationNormalizeUppercase&&(r.tokenization_normalize_uppercase="true"),t.normalizeLowercase&&(r.normalize_lowercase="true"),t.normalizeUppercase&&(r.normalize_uppercase="true"),t.tokenizationLocale&&(r.tokenization_locale=`${t.tokenizationLocale}`),t.tokenizationSkipStopWords&&(r.tokenization_skip_stop_words=`${t.tokenizationSkipStopWords}`),t.mode&&(r.mode=`${t.mode}`),t.analyzerClass&&(r.analyzer_class=`${t.analyzerClass}`),t.maxCompactionFlushMemoryInMb&&(r.max_compaction_flush_memory_in_mb=`${t.maxCompactionFlushMemoryInMb}`)),r},"getCustomOptions"),SD=c(({tableName:t,columns:e,index:r,isActivated:n,ifNotExist:i})=>{let s=wD(CD(e),n),o=r.profiles.length?`
${aa(`AND PROFILES ${r.profiles.join(", ")}`)}`:"",a=xD(r.config),u=a?`
${aa(`AND CONFIG ${a}`)}`:"",l=TD(r.options),f=l?`
${aa(`AND OPTIONS ${l}`)}`:"";return nh.provider.createSearchIndex({ifNotExist:i,tableName:t,columnsStatement:aa(s,2),profiles:o,config:u,options:f})},"getSearchIndex"),CD=c(t=>t.map(e=>{let r=[];return e.copyField&&r.push("copyField: true"),e.docValues&&r.push("docValues: true"),e.excluded&&r.push("excluded: true"),e.indexed||r.push("indexed: false"),e.lowerCase&&r.push("lowerCase: true"),{statement:`${e.name}${r.length?` {${r.join(", ")}}`:""}`,isActivated:e.isActivated}}),"getSearchIndexColumns"),wD=c((t,e)=>{let r=e?t.filter(o=>!o.isActivated):[],n=e?t.filter(o=>o.isActivated):t,i=r.length?r.map(({statement:o})=>o).join(`,
`).split(`
`).map(lD).join(`
`):"",s=n.map(({statement:o})=>o).join(`,
`);return i&&s?i+`,
`+s:i||s},"getSearchIndexColumnStatements"),xD=c((t={})=>{let e=[];return t.autoCommitTime&&t.autoCommitTime!==1e4&&e.push(`autoCommitTime: ${t.autoCommitTime}`),t.defaultQueryField&&e.push(`defaultQueryField: '${t.defaultQueryField}'`),t.directoryFactory&&e.push(`directoryFactory: '${t.directoryFactory}'`),t.filterCacheLowWaterMark&&t.filterCacheLowWaterMark!==1024&&e.push(`filterCacheLowWaterMark: ${t.filterCacheLowWaterMark}`),t.filterCacheHighWaterMark&&t.filterCacheHighWaterMark!==2048&&e.push(`filterCacheHighWaterMark: ${t.filterCacheHighWaterMark}`),t.directoryFactoryClass&&e.push(`directoryFactoryClass: '${t.directoryFactoryClass}'`),t.mergeMaxThreadCount&&t.mergeMaxMergeCount&&(e.push(`mergeMaxThreadCount: ${t.mergeMaxThreadCount}`),e.push(`mergeMaxMergeCount: ${t.mergeMaxMergeCount}`)),t.ramBufferSize&&t.ramBufferSize!==512&&e.push(`ramBufferSize: ${t.ramBufferSize}`),t.realtime&&e.push("realtime: true"),e.length?`{
${aa(e.join(`,
`))}
}`:""},"getSearchIndexConfig"),TD=c((t={})=>{let e=[];return t.recovery&&e.push("recovery: true"),t.reindex||e.push("reindex: false"),t.lenient&&e.push("lenient: true"),e.length?`{${e.join(", ")}}`:""},"getSearchIndexOptions");L1.exports={getIndexes:hD,serializeOptions:vD}});var k1=_((nz,P1)=>{"use strict";var _D=Object.freeze({ADD:"ADD",AGGREGATE:"AGGREGATE",ALLOW:"ALLOW",ALTER:"ALTER",AND:"AND",ANY:"ANY",APPLY:"APPLY",ASC:"ASC",AUTHORIZE:"AUTHORIZE",BATCH:"BATCH",BEGIN:"BEGIN",BY:"BY",COLUMNFAMILY:"COLUMNFAMILY",CREATE:"CREATE",DELETE:"DELETE",DESC:"DESC",DROP:"DROP",EACH_QUORUM:"EACH_QUORUM",ENTRIES:"ENTRIES",FROM:"FROM",FULL:"FULL",GRANT:"GRANT",IF:"IF",IN:"IN",INDEX:"INDEX",INET:"INET",INFINITY:"INFINITY",INSERT:"INSERT",INTO:"INTO",KEYSPACE:"KEYSPACE",KEYSPACES:"KEYSPACES",LIMIT:"LIMIT",LOCAL_ONE:"LOCAL_ONE",LOCAL_QUORUM:"LOCAL_QUORUM",MATERIALIZED:"MATERIALIZED",MODIFY:"MODIFY",NAN:"NAN",NORECURSIVE:"NORECURSIVE",NOT:"NOT",OF:"OF",ON:"ON",ONE:"ONE",ORDER:"ORDER",PARTITION:"PARTITION",PASSWORD:"PASSWORD",PER:"PER",PRIMARY:"PRIMARY",QUORUM:"QUORUM",RENAME:"RENAME",REVOKE:"REVOKE",SCHEMA:"SCHEMA",SELECT:"SELECT",SET:"SET",TABLE:"TABLE",TIME:"TIME",THREE:"THREE",TO:"TO",TOKEN:"TOKEN",TRUNCATE:"TRUNCATE",TWO:"TWO",UNLOGGED:"UNLOGGED",UPDATE:"UPDATE",USE:"USE",USING:"USING",VIEW:"VIEW",WHERE:"WHERE",WITH:"WITH"}),bD=Object.values(_D);P1.exports={ReservedWordsAsArray:bD}});var Mc=_((iz,q1)=>{"use strict";var{dependencies:F1}=cr(),{ReservedWordsAsArray:ID}=k1(),AD=c((t,e)=>[...t,...e],"mergeArrays"),ND={blob:["ascii","bigint","boolean","decimal","double","float","inet","int","timestamp","timeuuid","uuid","varchar","varint"],varint:["int"],varchar:["text"],uuid:["timeuuid"],text:["varchar"]},BD=c(t=>{let e=t.filter(n=>n.dbVersion)[0].dbVersion,r=e.search(/\d/);if(r!==-1)return e[r]<3},"checkIsOldModel"),RD=c((t,e)=>{let r=ND[e];return!(!r||!r.filter(i=>i===t).length)},"fieldTypeCompatible"),OD=c(t=>/\s|\W/.test(t)||F1.lodash.includes(ID,F1.lodash.toUpper(t))?`"${t}"`:t,"wrapInQuotes");q1.exports={mergeArrays:AD,checkIsOldModel:BD,fieldTypeCompatible:RD,wrapInQuotes:OD}});var Ji=_((oz,U1)=>{"use strict";var oh=class oh{script;isDropScript;isModifyScript;isAddScript};c(oh,"ModificationScript");var ih=oh,ah=class ah{isActivated;scripts;static getInstances(e,r,n,i){return(e||[]).filter(Boolean).map(s=>this.getInstance([s],r,n,i))}static getInstance(e,r,n,i){var o;if(!((o=e==null?void 0:e.filter(Boolean))!=null&&o.length))return;let s={deletion:!1,add:!1,modify:!1};if(s[n]===void 0)throw new Error(`Unsupported scriptPurpose provided: ${n}`);return s[n]=!0,{isActivated:r,scripts:e.filter(Boolean).map(a=>({isDropScript:s.deletion,script:a,isModifyScript:s.modify,isAddScript:s.add,modelLevel:i}))}}};c(ah,"AlterScriptDto");var sh=ah;U1.exports={ModificationScript:ih,AlterScriptDto:sh}});var fh=_((cz,j1)=>{"use strict";var{getTypeByData:V1}=na(),{getNamesByIds:ch}=sa(),{dependencies:br}=cr(),{eachField:DD,getTableNameStatement:$1}=ar(),{getTableStatement:LD}=Ws(),{AlterScriptDto:Kc}=Ji(),yi={modifiedColumn:[],addTable:[],deleteTable:[]},PD=c(t=>Hc(t)?[]:[Kc.getInstance([br.provider.addEntity(t)],!0,"add","field")],"getAdd"),kD=c(t=>Hc(t)?[]:[Kc.getInstance([br.provider.deleteEntity(t)],!0,"deletion","field")],"getDelete"),G1=c(t=>{let{tableName:e,keyspaceName:r,columnData:n}=t,i=$1(r,e);return n!=null&&n.name?`${i}.${n==null?void 0:n.name}`:i},"generateFullName"),lh=c((t={},e="modifiedColumn")=>{let r=G1(t);yi={...yi,[e]:[...(yi==null?void 0:yi[e])||[],r]}},"addScriptToExistScripts"),Hc=c((t={},e="modifiedColumn")=>{let r=G1(t);return((yi==null?void 0:yi[e])||[]).some(n=>n===r)},"isScriptExists"),FD=c((t,e)=>{let r=c(i=>!i.hasOwnProperty("properties")||!Array.isArray(i.properties)?i:{...i,properties:i.properties.reduce((s,o)=>({...s,[o.name]:r(o)}),{})},"propertiesFromArrayToObj"),n=r(t);return DD(n,i=>{if((i==null?void 0:i.type)!=="reference"||br.lodash.isEmpty(i.refIdPath))return i;let s=ch([br.lodash.last(i.refIdPath)],e)[br.lodash.last(i.refIdPath)]||{};return{...i,...s}})},"prepareField"),qD=c(({tableName:t,keyspaceName:e,isOldModel:r,property:n,udtMap:i,dataSources:s})=>{let{oldField:o={},newField:a={}}=(n==null?void 0:n.compMod)||{},u=FD(o,s),l=V1(n,i,a.name),f=V1(u,i,o.name);return{property:n,isOldModel:r,oldName:o.name,newName:a.name,newType:l,oldType:f,isNameChange:o.name!==a.name,isTypeChange:l!==f,dataForScript:{tableName:t,keyspaceName:e,columnData:{name:a.name,type:l}}}},"hydrateColumn"),uh=c((t,e)=>{var n,i,s;let r=(i=(n=t==null?void 0:t.role)==null?void 0:n.compMod)==null?void 0:i[e];return(r==null?void 0:r.new)||((s=t==null?void 0:t.role)==null?void 0:s[e])},"getTableParameter"),M1=c((t,e)=>Object.entries(t).reduce((r,[n,i])=>{let s=(e.find(o=>o.keyId===n)||{}).type;return{...r,[n]:{...br.lodash.omit(i,"type"),...s?{type:s}:{}}}},{}),"addToKeysHashType"),K1=c((t,e)=>br.lodash.omitBy(t,(r,n)=>r===!1&&!e[n]),"deleteFalseValuesIfNotPresentInOtherColumn"),UD=c((t,e)=>{let r=K1(t,e),n=K1(e,t);return br.lodash.isEqual(r,n)},"areTableKeyColumnsEqual"),H1=c(({newKeys:t=[],oldKeys:e=[],dataSources:r})=>{if(t.length!==e.length)return!1;let n=M1(ch(t.map(o=>o.keyId),r),t),i=M1(ch(e.map(o=>o.keyId),r),e),s=br.lodash.differenceWith(br.lodash.values(n),br.lodash.values(i),UD);return br.lodash.isEmpty(s)},"tableKeysIsEqual"),VD=c(({item:t,dataSources:e})=>{var u;let r=((u=t==null?void 0:t.role)==null?void 0:u.compMod)||{},n=["name","isActivated"],{compositeClusteringKey:i={},compositePartitionKey:s={}}=r||{},o=H1({newKeys:i.new,oldKeys:i.old,dataSources:e}),a=H1({newKeys:s.new,oldKeys:s.old,dataSources:e});return!o||!a||n.some(l=>{var f,h;return!br.lodash.isEqual((f=r[l])==null?void 0:f.new,(h=r[l])==null?void 0:h.old)})},"isTableChange"),MD=c(t=>{if(Hc(t,"deleteTable"))return[];let e=$1(t.keyspaceName,t.tableName);return lh(t,"deleteTable"),[Kc.getInstance([br.provider.dropTable(e)],!0,"deletion","table")]},"getDeleteTableDto"),KD=c(t=>{if(Hc(t,"addTable"))return[];let e=t.item,r=t.data,n=uh(e,"compositePartitionKey")||[],i=uh(e,"compositeClusteringKey")||[],s=[{compositePartitionKey:n,compositeClusteringKey:i,collectionName:t.tableName,tableOptions:e.role.tableOptions||"",comments:e.role.comments||"",isActivated:e.role.isActivated}],o=LD({tableData:e,tableMetaData:s,keyspaceMetaData:[{name:t.keyspaceName}],dataSources:t.dataSources,udtTypeMap:r.udtTypeMap||{},isKeyspaceActivated:t.isKeyspaceActivated});return lh(t,"addTable"),[Kc.getInstance([o],!0,"add","table")]},"getAddTable");j1.exports={getDelete:kD,getAdd:PD,hydrateColumn:qD,isTableChange:VD,getTableParameter:uh,addScriptToExistScripts:lh,getDeleteTableDto:MD,getAddTable:KD}});var ph=_((lz,W1)=>{"use strict";var{dependencies:pn}=cr(),{getColumnDefinition:HD}=Vc(),{eachField:$D}=ar(),{getTypeByData:hh}=na(),{checkIsOldModel:GD,fieldTypeCompatible:jD}=Mc(),{getDelete:zD}=fh(),{AlterScriptDto:ua}=Ji(),WD={Default_Keyspace:[]},QD={added:!1,deleted:!1,modified:!1,udt:"udt"},YD=c(t=>`ALTER TYPE "${t}"`,"getAlterTypePrefix"),ZD=c(t=>[ua.getInstance([pn.provider.dropType({keyspaceName:t.keyspaceName,typeName:t.typeName})],!0,"deletion","udt")],"getDropUDT"),XD=c(t=>{let{keySpaces:e,udtName:r,name:n,type:i}=t;return Object.keys(e).map(s=>ua.getInstance([pn.provider.addPropertyToUdt({keySpaceName:s,udtName:r,name:n,type:i})],!0,"add","udt"))},"getAddToUDT"),dh=c(t=>{var r;let e=(r=t.compMod)==null?void 0:r.bucketsWithCurrentDefinition;return pn.lodash.isEmpty(e)?WD:e},"getKeySpaces"),JD=c((t,e)=>{let{role:r={},compMod:n={},properties:i={}}=t,s=dh(r);if(n.created){let o=HD(i,e);return Object.keys(s).map(a=>{let u=r.code||r.name||"";return ua.getInstance([pn.provider.createUdt({keySpaceName:a,udtName:u,columnScript:o})],!0,"add","udt")})}return Object.entries(i).reduce((o,[a,u])=>[...o,...XD({type:hh(u,e),name:a,keySpaces:s,udtName:r.code||r.name||""})],[])},"getAddScript"),z1=c((t,e)=>t.type!=="reference"||t.$ref||!e.$ref?t:{...t,$ref:e.$ref},"prepareField"),eL=c((t,e,r)=>{let{role:n={},properties:i}=t;if(!i)return[];let s=dh(n),o=n.code||n.name;return Object.entries(i).reduce((a,[u,l])=>{let f=pn.lodash.get(l,"compMod.oldField.name"),h=pn.lodash.get(l,"compMod.newField.name"),{compMod:p={}}=l,g=hh(z1(p.oldField,l),r,"newField"),d=hh(z1(p.newField,l),r,"oldField"),y=GD(pn.lodash.get(e,"modelData")),v=Object.keys(s).reduce((m,w)=>{if(d&&g&&d!==g&&jD(g,d)&&y){let A=pn.provider.updateUdtType({keySpaceName:w,udtName:o,columnData:{name:u,type:d}});m=[...m,ua.getInstance([A],!0,"modify","udt")]}if(h&&f&&f!==h){let A=pn.provider.renameType({keySpaceName:w,oldFieldName:f,newFieldName:h,udtName:o});m=[...m,ua.getInstance([A],!0,"modify","udt")]}return m},[]);return[...a,...v]},[])},"getUpdateScript"),tL=c(t=>{let{properties:e,compMod:r={},role:n={}}=t;if(!(r!=null&&r.deleted)||!e)return[QD];let i=dh(n),s=n.code||n.name||"";return Object.entries(i).reduce((o,[a,u])=>{let l=u.reduce((f,h)=>{let p=zD({tableName:h.collectionName||h.code,keyspaceName:a,columnData:{name:s}}),g=ZD({keyspaceName:a,typeName:s});return[...f,...p,...g]},[]);return[...o,...l]},[])},"getDeleteScript"),rL=c(({child:t,mode:e,data:r,udtMap:n})=>e==="add"?JD(t,n):e==="update"?eL(t,r,n):tL(t),"getUdtScript"),nL=c(t=>{var a;let e=(a=t.properties.added)==null?void 0:a.items;if(!e||!Array.isArray(e))return t;let r=e.filter(u=>{var f;return(f=u.properties[Object.keys(u.properties)[0]].compMod)==null?void 0:f.created}),n=pn.lodash.xorWith(e,r,pn.lodash.isEqual);r=r.map(u=>[Object.keys(u.properties)[0],u]);let i=r.map(([u,l])=>u),s=[];r.forEach(([u,l])=>{let f=new Set,h=l.properties[u];$D(h||{},g=>{if(g.$ref){let d=g.$ref.split("/").pop();f.add(d)}});let p=Array.from(f).filter(g=>i.includes(g)&&!s.includes(g));if(s.push(...p),!p.length){let g=s.indexOf(u);g===-1?s.unshift(u):s.unshift(...s.splice(g,1))}});let o=i.filter(u=>!s.includes(u));return r=Object.fromEntries(r),r=[...s,...o].map(u=>r[u]).filter(Boolean),t.properties.added.items=[...r,...n],t},"sortAddedUdt");W1.exports={getUdtScript:rL,sortAddedUdt:nL,getAlterTypePrefix:YD}});var Z1=_((hz,Y1)=>{"use strict";var{dependencies:es}=cr(),iL="caching",sL="compaction",oL="compression",aL="id",cL=[aL],la={localReadRepairChance:0,caching:{keys:"ALL",rows_per_partition:"NONE"},compaction:"{'class': 'org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy', 'max_threshold': '32', 'min_threshold': '4'}",compression:"{'chunk_length_in_kb': '64', 'class': 'org.apache.cassandra.io.compress.LZ4Compressor'}",readRepairChance:0,gcGraceSeconds:864e3,bloomFilterFalsePositiveChance:.01,defaultTtl:0,speculativeRetry:"99PERCENTILE",minIndexInterval:128,maxIndexInterval:2048,crcCheckChance:1,memtableFlushPeriod:0},Q1=c((t,e,r)=>{switch(r){case oL:case sL:return uL(t,e);case iL:return lL(t,e);default:return t!==e}},"isDiff"),uL=c((t,e)=>{if(t===""||e==="")return t!==e;let r=JSON.parse(t.replace(/[\'']/g,'"')),n=JSON.parse(e.replace(/[\'']/g,'"'));return!es.lodash.isEqual(r,n)},"isDiffParsedJsonString"),lL=c((t,e)=>{let r=c(s=>{let o=es.lodash.get(s,"rowsPerPartition");return o?{...es.lodash.omit(s,"rowsPerPartition"),rows_per_partition:o}:s},"updateKeys"),n=Object.assign({},r(t),{id:null}),i=Object.assign({},r(e),{id:null});return!es.lodash.isEqual(n,i)},"isDiffCaching"),fL=c((t,e)=>(e=es.lodash.isEmpty(e)?la:e,Object.entries(t).reduce((r,[n,i])=>cL.includes(n)?r:!e.hasOwnProperty(n)||Q1(e[n],i,n)?Object.assign({},r,{[n]:i}):r,{})),"getModifiedAndNewOptions"),hL=c((t,e)=>(t=es.lodash.isEmpty(t)?la:t,Object.keys(e).filter(r=>!t.hasOwnProperty(r))),"getDeletedOptions"),dL=c((t,e)=>t.reduce((r,n)=>la.hasOwnProperty(n)&&Q1(es.lodash.get(e,n),la[n],n)?Object.assign({},r,{[n]:la[n]}):r,{}),"getDefaultOptionsByName");Y1.exports={getDiff(t,e){let r=fL(t,e),n=hL(t,e);return Object.assign({},r,dL(n,e))}}});var $c=_((pz,iS)=>{"use strict";var{dependencies:bt}=cr(),{commentDeactivatedStatement:mh}=oa(),{retrieveContainerName:pL,retrieveEntityName:gL,retrivePropertyFromConfig:fa,retrieveIsItemActivated:X1}=ar(),{getOptions:yL,getPrimaryKeyList:mL}=Ws(),J1=c(t=>t.name,"columnsToName"),vL=c((t=[],e)=>{let[r,n]=bt.lodash.partition(t,s=>bt.lodash.get(s,"isActivated",!0));n=n.map(J1).join(", "),r=r.map(J1).join(", ");let i=c(s=>mh(s,!1,e,"INLINE"),"getDeactivatedStatement");if(n.length){if(!r.length)return i(n)}else return r;return r+" "+i(", "+n)},"joinColumns"),EL=c((t,e,r={})=>{let n=t[e];return Object.values(r).find(i=>i.GUID===(n==null?void 0:n.definitionId))||{}},"getColumn"),SL=c((t,e)=>bt.lodash.uniqBy(Object.keys(e).map(r=>{let n=bt.lodash.get(e,[r,"GUID"]),i=Object.keys(t).find(u=>t[u].definitionId===n),s=t[i],o=`"${bt.lodash.get(s,"name",r)}"`,a=bt.lodash.get(e[r],"isActivated");return{name:o,isActivated:a}}),"name").filter(bt.lodash.identity),"getColumnNames"),CL=c((t,e)=>Object.keys(e).reduce((r,n)=>{let i=bt.lodash.get(e,[n,"GUID"]),s=Object.keys(t).find(a=>t[a].definitionId===i),o=t[s];return{...r,[bt.lodash.get(o,"name",n)]:e[n]}},{}),"getViewColumns"),eS=c((t=[],e)=>{let[r,n]=bt.lodash.partition(t,u=>bt.lodash.get(u,"isActivated",!0));if(bt.lodash.isEmpty(t)||n.length===t.length)return"";let i=c(u=>`AND ${u} IS NOT NULL`,"generateNewStatement"),s=n.map(u=>i(u.name)).join(" "),o=mh(s,!1,e,"INLINE");return`WHERE ${[...r].reduce((u,l)=>u?`${u} ${i(l.name)}`:`${l.name} IS NOT NULL`,"")}${s?" "+o:""}`},"getWhereStatement"),vh=c((t,e,r={})=>e.reduce((n,i)=>{let s=bt.lodash.get(t,[i,"name"]),a=EL(t,i,r).isActivated;return s?Object.assign({},n,{[i]:{name:s,isActivated:a}}):n},{}),"getNamesByIds"),tS=c((t,e,r)=>{let n=fa(e,0,"compositeClusteringKey",[]),i=vh(t,n.map(s=>s.keyId),r);return{clusteringKeys:n,clusteringKeysHash:i}},"getClusteringKeyData"),rS=c((t,e,r)=>[...gh({collectionRefsDefinitionsMap:t,viewData:e,key:"compositePartitionKey",columns:r}),...gh({collectionRefsDefinitionsMap:t,viewData:e,key:"compositeClusteringKey",columns:r})],"getPrimaryKeys"),gh=c(({collectionRefsDefinitionsMap:t,viewData:e,key:r,columns:n})=>{let i=fa(e,0,r,[]),s=vh(t,i.map(o=>o.keyId),n);return bt.lodash.values(s).filter(bt.lodash.identity).map(o=>({...o,name:`"${o.name}"`}))},"getCompositeKeys"),nS=c(({collectionRefsDefinitionsMap:t,viewData:e,isParentActivated:r,columns:n})=>{let i=fa(e,0,"compositePartitionKey",[]),s=vh(t,i.map(u=>u.keyId),n),o=tS(t,e,n),a=mL(s,o.clusteringKeysHash,r);return a?`PRIMARY KEY (${a})`:""},"getPrimaryKeyScript"),wL=c(t=>bt.lodash.trim(t||"").replace(/  /g,"    "),"addTab"),yh=c(({collectionRefsDefinitionsMap:t,viewData:e,columns:r,isParentActivated:n})=>{let i=tS(t,e,r),s=fa(e,0,"comments",""),o=fa(e,0,"tableOptions","");return wL(yL(i.clusteringKeys,i.clusteringKeysHash,"",o,s,n))},"getOptionsScript"),xL=c(({viewData:t,entitySchema:e,entityData:r,entityName:n,isParentActivated:i,collectionRefsDefinitionsMap:s,columns:o})=>{let a=[],u=(e==null?void 0:e.properties)||{},l=Object.keys(u).reduce((p,g)=>{let d=e.properties[g];return{...p,[d.GUID]:d}},{}),f=nS({entityFieldsMap:l,entityData:r,isParentActivated:i,columns:o}),h=yh({collectionRefsDefinitionsMap:{},viewData:t,columns:o,isParentActivated:i});return a.push(`AS SELECT * FROM ${n}`),a.push(eS(rS(s,r,o),i)),f&&a.push(f),h&&a.push(h),a},"getEmptyViewScript");iS.exports={getOptionsScript:yh,getViewScript({schema:t,entitySchema:e,viewData:r,entityData:n,containerData:i,collectionRefsDefinitionsMap:s,isKeyspaceActivated:o=!0,ifNotExist:a=!1}){let u=[],l=CL(s,t.properties||{}),f=bt.lodash.first(r)||{},h=gL(n),p=pL(i),g=p?`"${p}"."${h}"`:`"${h}"`,d=f.code||f.name,y=p?`"${p}"."${d}"`:`"${d}"`,v=X1(n)&&X1(r),m=o&&v,w=nS({collectionRefsDefinitionsMap:s,viewData:r,isParentActivated:m,columns:l}),x=yh({collectionRefsDefinitionsMap:s,viewData:r,columns:l,isParentActivated:m});if(u.push(`CREATE MATERIALIZED VIEW ${a?"IF NOT EXISTS ":""}${y}`),bt.lodash.isEmpty(l))u=u.concat(xL({viewData:r,entitySchema:e,entityData:n,entityName:g,isParentActivated:m,collectionRefsDefinitionsMap:s,columns:l}));else{let A=SL(s,l),O=vL(A,m);u.push(`AS SELECT ${O}`),u.push(`FROM ${g}`),u.push(eS(bt.lodash.uniq([...rS(s,r,l),...gh({collectionRefsDefinitionsMap:s,viewData:r,key:"whereClause",columns:l})]),m)),w&&u.push(w),x&&u.push(x)}return mh(u.join(`
  `)+";",v,o)}}});var Eh=_((yz,aS)=>{"use strict";var{getViewScript:TL}=$c(),{dependencies:da}=cr(),{AlterScriptDto:ha}=Ji(),_L=c((t,e)=>`${t?`"${t}".`:""}"${e}"`,"getViewName"),bL=["code","name"],IL=c(t=>{let e=bL.some(s=>{let{new:o,old:a}=t[s]||{};return!da.lodash.isEqual(o,a)}),{tableOptions:r={},comments:n={}}=t;if(n.old&&!n.new)return!1;let i=Object.entries(r.old||{}).some(([s])=>{var o;return!((o=r.new)!=null&&o[s])});return!e&&!i},"getIsOnlyOptionsModify"),sS=c((t,e)=>{if(!e||!da.lodash.isEqual(t,e))return t;if(!t)return e},"getProperty"),AL=c((t={},e={})=>{let r=sS(e.new,e.old),{new:n={},old:i={}}=t,s=Object.entries(n).map(([o,a])=>[o,sS(a,i[o])]).filter(([o,a])=>a);return{comments:r,tableOptions:Object.fromEntries(s)}},"getDifferentOptions"),oS=c(t=>{var s,o;let{compMod:e,properties:r={}}=t.role,n=Object.entries(r).map(([a,u])=>[u.code||u.name||u.displayName||a,u]),i={containerData:[{name:e.keyspaceName}],schema:{properties:Object.fromEntries(n)},viewData:[t.role],ifNotExist:!0,collectionRefsDefinitionsMap:((s=e.collectionData)==null?void 0:s.collectionRefsDefinitionsMap)||{},entityData:((o=e.collectionData)==null?void 0:o.entityData)||[{}]};return TL(i)},"getAddView"),NL=c(t=>{var o,a,u;let e=((o=t.role)==null?void 0:o.compMod)||{};if(!IL(e)){let l=((a=e.code)==null?void 0:a.old)||((u=e.name)==null?void 0:u.old),f=da.provider.dropView({...t,role:{...t.role,code:l}}),h=oS(t);return[ha.getInstance([f],!0,"deletion","view"),ha.getInstance([h],!0,"add","view")]}let{comments:n,tableOptions:i}=AL(e.tableOptions,e.comments),s={...t.role,comments:n,tableOptions:i};return[ha.getInstance([da.provider.alterView(s)],!0,"modify","view")]},"getModifyView"),BL=c(({child:t,mode:e})=>e==="add"?[ha.getInstance([oS(t)],!0,"add","view")]:e==="delete"?[ha.getInstance([da.provider.dropView(t)],!0,"deletion","view")]:NL(t),"getViewScript");aS.exports={getViewScript:BL,getViewName:_L}});var fS=_((vz,lS)=>{"use strict";var rt=B1(),{tab:Nn,getTableNameStatement:Gc,getUserDefinedFunctions:RL,getUserDefinedAggregations:OL}=ar(),{serializeOptions:DL}=ca(),{getAlterTypePrefix:Sh}=ph(),{getDiff:LL}=Z1(),{mergeValuesWithConfigOptions:PL}=Ws(),{parseToString:cS}=Ch(),{getViewName:uS}=Eh(),{getOptionsScript:kL}=$c(),{wrapInQuotes:yt}=Mc(),pa=c((t,e)=>e?`ALTER TABLE ${yt(e)}.${yt(t)}`:`ALTER TABLE ${yt(t)}`,"alterTablePrefix");lS.exports=t=>{let{assignTemplates:e}=t.require("@hackolade/ddl-fe-utils");return{dropTable(r){return e(rt.dropTable,{name:r})},createTable(r){if(!r.databaseName)return"";let{ifNotExist:n,databaseName:i,items:s,options:o}=r,a=n?"IF NOT EXISTS ":"";return e(rt.createTable,{ifNotExistStatement:a,name:i,items:` (
`+s.map(u=>Nn(u)).join(`,
`)+`
)`,options:`${o}`})},dropDatabase(r){return r?e(rt.dropDatabase,{name:r}):""},createCustomIndex(r){if(!r.tableName)return"";let{name:n,tableName:i,column:s,using:o,options:a,ifNotExist:u}=r,l=u?"IF NOT EXISTS ":"",f=o||"StorageAttachedIndex",h=Object.keys(a).length?`
`+Nn(`WITH OPTIONS = {
${Nn(DL(a).join(`,
`))}
}`):"";return e(rt.createCustomIndex,{ifNotExistStatement:l,name:`"${n}"`,tableName:i,column:s,usingStatement:f,optionsStatement:h})},createIndex(r){let{name:n,tableName:i,column:s,ifNotExist:o}=r,a=n?`"${n}"`:"",u=o?"IF NOT EXISTS ":"";return e(rt.createIndex,{ifNotExistStatement:u,nameStatement:a,tableName:i,column:s})},createSearchIndex(r){let{ifNotExist:n,tableName:i,columnsStatement:s,profiles:o,config:a,options:u}=r,l=n?"IF NOT EXISTS ":"";return e(rt.createSearchIndex,{ifNotExistStatement:l,tableName:i,columnsStatement:s,profiles:o,config:a,options:u})},dropType(r){let{keyspaceName:n,typeName:i}=r;return e(rt.dropType,{keyspaceName:yt(n),typeName:yt(i)})},renameColumn(r){let{tableName:n,keyspaceName:i,columnData:s}=r,o=pa(n,i);return e(rt.renameColumn,{alterTablePrefixStatement:o,oldName:yt(s.oldName),newName:yt(s.newName)})},addEntity(r){let{tableName:n,keyspaceName:i,columnData:s}=r,o=pa(n,i);return e(rt.addEntity,{alterTablePrefixStatement:o,name:yt(s.name),type:s.type})},deleteEntity(r){let{tableName:n,keyspaceName:i,columnData:s}=r,o=pa(n,i);return e(rt.deleteEntity,{alterTablePrefixStatement:o,name:yt(s.name)})},addPropertyToUdt(r){let{keySpaceName:n,udtName:i,type:s}=r,o=Sh(n);return e(rt.addPropertyToUdt,{alterTypePrefixStatement:o,udtName:yt(i),name:yt(i),type:s})},createUdt(r){let{keySpaceName:n,udtName:i,columnScript:s}=r;return e(rt.createUdt,{keySpaceName:yt(n),udtName:yt(i),columnScript:Nn(s)})},updateUdtType(r){let{keySpaceName:n,udtName:i,columnData:s}=r,o=Sh(n);return e(rt.updateUdtType,{alterTypePrefixStatement:o,udtName:yt(i),name:yt(s.name),type:s.type})},renameType(r){let{keySpaceName:n,udtName:i,oldFieldName:s,newFieldName:o}=r,a=Sh(n);return e(rt.renameType,{alterTypePrefixStatement:a,udtName:yt(i),oldFieldName:yt(s),newFieldName:yt(o)})},updateType(r){let{tableName:n,keyspaceName:i,columnData:s}=r,o=pa(n,i);return e(rt.updateType,{alterTablePrefixStatement:o,name:yt(s.name),type:s.type})},updateTableOptions(r,n,i){if(!i||!r)return"";let{keyspaceName:s,tableOptions:o={},comments:a}=r,u=c(g=>(g==null?void 0:g.new)&&g.new!==g.old,"isCommentNew"),l=pa(n,s),f=LL(o.new||{},o.old||{}),h=PL(f),p=u(a)?cS(h,a.new):cS(h);return p?e(rt.updateTableOptions,{alterTablePrefixStatement:l,optionsStatement:Nn(p)}):""},dropSearchIndexConfig(r,n,i){let s=Gc(r,n);return e(rt.dropSearchIndexConfig,{tableNameStatement:s,indexName:i})},modifySearchIndex(r,n,i,s){let o=Gc(r,n);return e(rt.modifySearchIndex,{tableNameStatement:o,key:i,value:s})},dropSearchIndex(r,n){let i=Gc(r,n);return e(rt.dropSearchIndex,{tableNameStatement:i})},dropIndex(r,n){let i=Gc(r,n);return e(rt.dropIndex,{tableNameStatement:i})},dropKeySpace(r){return e(rt.dropKeySpace,{keySpaceName:yt(r)})},createKeySpace(r,n,i,s,o){let a=RL(s),u=OL(o);return e(rt.createKeySpace,{keySpaceName:yt(r),replication:Nn(n),durableWrites:Nn(i),udfScript:a,udaScript:u})},alterKeySpaceReplication(r,n,i){return e(rt.alterKeySpaceReplication,{keySpaceName:yt(r),replication:Nn(n),durableWrites:Nn(i,2)})},dropView(r){let{compMod:n,name:i,code:s}=r.role,o=uS(n.keyspaceName,s||i);return e(rt.dropView,{viewName:o})},alterView(r){var a;let n=[r],i=kL({collectionRefsDefinitionsMap:((a=r.compMod.collectionData)==null?void 0:a.collectionRefsDefinitionsMap)||{},viewData:n}),s=r.name||r.code,o=r.compMod.keyspaceName;if(i){let u=uS(o,s);return e(rt.alterView,{keySpaceViewName:u,optionScript:Nn(i)})}return""}}}});var cr=_((Sz,hS)=>{"use strict";var wh={},FL=c(t=>{wh.lodash=t.require("lodash"),wh.provider=fS()(t)},"setDependencies");hS.exports={setDependencies:FL,dependencies:wh}});var Ch=_((wz,ES)=>{"use strict";var{inlineComment:dS}=oa(),{dependencies:pS}=cr(),qL="numeric",UL="text",VL="details",ML="checkbox",yS="otherProperties",mS="caching",KL=[mS,yS],jc=c(t=>t===""?`
WITH`:"  AND","getStringStart"),vS=c(t=>String(t||"").replace(/[\"\`]/g,"'"),"changeQuotes"),gS={localReadRepairChance:"dclocal_read_repair_chance",readRepairChance:"read_repair_chance",gcGraceSeconds:"gc_grace_seconds",bloomFilterFalsePositiveChance:"bloom_filter_fp_chance",defaultTtl:"default_time_to_live",speculativeRetry:"speculative_retry",minIndexInterval:"min_index_interval",maxIndexInterval:"max_index_interval",crcCheckChance:"crc_check_chance",memtableFlushPeriod:"memtable_flush_period_in_ms"},xh=c(t=>gS.hasOwnProperty(t)?gS[t]:t,"convertKeywordToTableOptionName"),HL=c(t=>KL.includes(t.propertyKeyword)?$L(t):GL(t),"transformOption"),$L=c(t=>{switch(t.propertyKeyword){case mS:return ZL(t);case yS:return QL(t);default:return null}},"transformSpecialOption"),GL=c(t=>{switch(t.propertyType){case UL:return jL(t);case ML:return YL(t);case qL:return zL(t);case VL:return WL(t);default:return null}},"transformOptionByPropertyType"),jL=c(t=>`${xh(t.propertyKeyword)} = '${t.value}'`,"transformTextOption"),zL=c(t=>`${xh(t.propertyKeyword)} = ${t.value}`,"transformNumericOption"),WL=c(t=>{let n=c(i=>typeof i=="object"?JSON.stringify(t.value):i,"getStringValue")(t.value).replace(/\n/g,"");return`${xh(t.propertyKeyword)} = ${vS(n)}`},"transformDetailsOptions"),QL=c(t=>t.value.reduce((r,n)=>{let{name:i,value:s}=n;if(!i||!s)return r;let o=r===""?"":"  AND";return r.concat(`${o} ${i} = '${s}'
`)},"").replace(/\n$/,""),"transformOtherOptions"),YL=c(t=>{let e=t.propertyKeyword;return t.value?e==="cdc"?"cdc = TRUE":e==="compactStorage"?"COMPACT STORAGE":null:null},"transformBooleanOption"),ZL=c(t=>{let e=c(u=>i.includes(u)?u:null,"validateKeys"),r=c(u=>i.includes(u)?u:isNaN(u)?null:Number(u),"validateRows"),n=c((u,l)=>Object.assign({},u&&{keys:u},l&&{rows_per_partition:l}),"createValueObject"),i=["ALL","NONE"],s=e(t.value.keys),o=r(t.value.rowsPerPartition);if(!s&&!o)return null;let a=JSON.stringify(n(s,o));return`caching = ${vS(a)}`},"transformCachingOption"),XL=c((t,e)=>{if(!e.value&&typeof e.value!="number")return t;let r=HL(e);if(!r)return t;let n=jc(t);return t.concat(`${n} ${r}
`)},"generateOptionsStringReducer"),JL=c((t,e)=>{if(e){let r=jc(t);return t.concat(`${r} comment = '${e}'
`)}return t},"addCommentToOptionString"),eP=c((t,e)=>{if(!t)return e;let r=jc(e);return e.concat(`${r} ID = '${t}'
`)},"addId"),tP=c((t,e,r,n)=>{let i=t.filter(f=>e[f&&f.keyId]);if(!i.length)return r;let s=c(f=>f.map(h=>{let{keyId:p,type:g}=h,{name:d}=e[p];return`"${d}" ${g==="descending"?"DESC":"ASC"}`}),"mapKeys"),[o,a]=pS.lodash.partition(i,({keyId:f})=>pS.lodash.get(e,`${f}.isActivated`)!==!1);o=s(o),a=s(a);let u;n?a.length===0?u=o.join(", "):o.length===0?u=dS(a.join(", ")):u=`${o.join(", ")} ${dS(`, ${a.join(", ")}`)}`:u=s(i).join(", ");let l=jc(r);return r.concat(`${l} CLUSTERING ORDER BY (${u})
`)},"addClustering");ES.exports={parseToString(t,e){let r=t.reduce(XL,"");return JL(r,e)},addId:eP,addClustering:tP}});var Ws=_((Tz,IS)=>{"use strict";var{retrieveContainerName:rP,retrieveEntityName:nP,retrivePropertyFromConfig:ts,getTableNameStatement:iP,commentDeactivatedStatement:sP}=ar(),{getColumnDefinition:oP}=Vc(),{getNamesByIds:SS}=sa(),{getEntityLevelConfig:aP}=Uc(),{parseToString:cP,addId:uP,addClustering:lP}=Ch(),{inlineComment:CS}=oa(),{dependencies:TS}=cr(),fP=c((t,e,r,n,i,s)=>{let o=[];return r&&o.push(r),n&&o.push(`PRIMARY KEY (${n})`),TS.provider.createTable({ifNotExist:s,databaseName:iP(t,e),items:o,options:i})},"getCreateTableStatement"),wS=c((t,e,r)=>{let n=hP(t,r),i=dP(e,r),s=[];return n&&s.push(n),i&&s.push(i),s.join(i.startsWith("/*")||n.endsWith("*/")?" ":", ")},"getPrimaryKeyList"),hP=c((t,e)=>{let r=Object.keys(t);if(r.length){let n=bS(r,t,e);return r.length>1?`(${n})`:n}else return""},"getPartitionKeys"),dP=c((t,e)=>{let r=Object.keys(t);return r.length?bS(r,t,e):""},"getClusteringKeys"),pP=c((t,e)=>t.map(r=>{let n=e[r.propertyKeyword];return n===void 0?r:Object.assign({},r,{value:n})}),"seedOptionsWithValues"),gP=c(t=>t.structure.find(r=>r.propertyName==="Options").structure,"getOptionsFromTab"),_S=c(t=>{let[e]=aP(),r=gP(e);return pP(r,t)},"mergeValuesWithConfigOptions"),xS=c((t,e,r,n,i,s)=>{let o=_S(n),a=uP(r,lP(t,e,cP(o,i),s));return a?a.replace(/\n$/,""):""},"getOptions"),bS=c((t,e,r)=>{let n=c(o=>o.map(a=>e[a].name).join('", "'),"joinKeys");if(!r)return`"${n(t)}"`;let[i,s]=TS.lodash.partition(t,o=>e[o].isActivated!==!1);return s.length===0?`"${n(i)}"`:i.length===0?`${CS(`"${n(s)}"`)}`:`"${n(i)}" ${CS(`, "${n(s)}"`)}`},"commentDeactivatedKeys");IS.exports={getOptions:xS,getPrimaryKeyList:wS,getTableStatement({tableData:t,tableMetaData:e,dataSources:r,keyspaceMetaData:n,udtTypeMap:i,isKeyspaceActivated:s}){let o=rP(n),a=nP(e),u=ts(e,0,"compositePartitionKey",[]),l=ts(e,0,"compositeClusteringKey",[]),f=ts(e,0,"schemaId",""),h=ts(e,0,"comments",""),p=ts(e,0,"tableOptions",""),g=ts(e,0,"isActivated",!1),d=s&&g,y=SS(u.map(w=>w.keyId),r),v=SS(l.map(w=>w.keyId),r),m=fP(o,a,oP(t.properties||{},i,d),wS(y,v,d),xS(l,v,f,p,h,d),ts(e,0,"tableIfNotExist",void 0));return sP(m,g,s)},mergeValuesWithConfigOptions:_S}});var zc=_((bz,RS)=>{"use strict";var{tab:yP,getNameWithKeyspace:mP,eachField:Th}=ar(),{getColumnDefinition:vP}=Vc(),EP=c((t,e,r,n)=>{let i=SP(r);return e.reduce((s,o)=>{let a=wP(o,i,n).map(({name:u,definition:l})=>CP(t,u,l));return s.concat(a)},[])},"getUdtScripts"),SP=c(t=>Object.keys(t).reduce((e,r)=>Object.assign(e,{[r]:Object.assign({},t[r],{frozen:!0})}),{}),"setFrozenForAllUdt"),AS=c((t,e)=>typeof t=="number"&&e.displayName?e.displayName:e.code||t,"getName"),CP=c((t,e,r)=>`CREATE TYPE IF NOT EXISTS ${mP(t,e)} (
${yP(r)}
);`,"getCreateTypeStatement"),NS=c(t=>t.reduce((e,r)=>(Th(r,(n,i)=>{if(n.type==="udt"){let s=AS(i,n);e[s]={name:s,frozen:n.frozen}}return n}),e),{}),"getUdtMap"),wP=c((t,e,r)=>{let n=[];return Th(t,(i,s)=>(i.type==="udt"&&i.properties&&n.push({name:AS(s,i),definition:vP(i.properties,e,r)}),i)),n},"getAllUdt"),BS=c(t=>{if(!t.properties)return t;let e=Object.keys(t.properties),r=[];e.forEach(i=>{let s=[];if(Th(t.properties[i],o=>{if(o.$ref){let a=o.$ref.split("/").pop();s.indexOf(a)===-1&&s.push(a)}}),s.length)r.push(...s.filter(o=>r.indexOf(o)===-1));else{let o=r.indexOf(i);o===-1?r.unshift(i):r.unshift(...r.splice(o,1))}}),e.forEach(i=>{r.indexOf(i)===-1&&r.push(i)});let n={};return r.forEach(i=>{t.properties[i]&&(n[i]=Object.assign({},t.properties[i]))}),t.properties=n,t},"sortUdt"),xP=c(t=>{let e=BS(JSON.parse(t.modelDefinitions)),r=JSON.parse(t.externalDefinitions);return{udtTypeMap:NS([e,r]),modelDefinitions:e,externalDefinitions:r}},"prepareDefinitions");RS.exports={getUdtScripts:EP,getUdtMap:NS,sortUdt:BS,prepareDefinitions:xP}});var _h=_((Az,kS)=>{"use strict";var{tab:OS,retrieveContainerName:TP,retrivePropertyFromConfig:ga}=ar(),_P=c(({name:t,replication:e,durableWrites:r,ifNotExist:n})=>`CREATE KEYSPACE ${n?"IF NOT EXISTS ":""}"${t}" 
${OS(e)}
${r}; 

USE "${t}";`,"getCreateStatement"),bP=c(t=>`'class' : 'SimpleStrategy',
'replication_factor' : ${t}`,"getSimpleStrategy"),IP=c(t=>["'class' : 'NetworkTopologyStrategy'"].concat(t.reduce((e,r)=>[...e,`'${r.dataCenterName}' : ${PS(r.replFactorValue)}`],[])).join(`,
`),"getNetworkTopologyStrategy"),AP=c((t,e,r)=>t==="NetworkTopologyStrategy"?IP(r):bP(PS(e)),"getTopology"),DS=c((t,e,r)=>`WITH REPLICATION = {
${OS(AP(t,e,r))}
}`,"getReplication"),LS=c(t=>`AND DURABLE_WRITES = ${!!t+""}`,"getDurableWrites"),PS=c(t=>+t||1,"getFactor"),NP=c(t=>{let e=TP(t),r=ga(t,0,"replStrategy",""),n=ga(t,0,"replFactor",void 0),i=ga(t,0,"dataCenters",[]),s=ga(t,0,"durableWrites",!1);return t[0]&&!t[0].addToCqlScript||e===""?"":_P({name:e,replication:DS(r,n,i),durableWrites:LS(s),ifNotExist:ga(t,0,"keyspaceIfNotExist",void 0)})},"getKeyspaceStatement");kS.exports={getKeyspaceStatement:NP,getReplication:DS,getDurableWrites:LS}});var qS=_((Bz,FS)=>{"use strict";var{retrieveContainerName:BP,retrieveEntityName:RP,retrieveUDA:OP,retrieveUDF:DP,retrieveIndexes:LP,commentDeactivatedStatement:PP,retrieveIsItemActivated:kP}=ar(),{getTableStatement:FP}=Ws(),{getUdtMap:qP,getUdtScripts:UP}=zc(),{getIndexes:VP}=ca(),MP=c((t,e)=>{var y,v;let r=BP(t.containerData),n=RP(t.entityData),i=kP(t.entityData),s=e&&i,o=[t.externalDefinitions,t.modelDefinitions,t.internalDefinitions,t.jsonSchema],a=qP(o),u=UP(r,o,a,s),l=FP({tableData:t.jsonSchema,tableMetaData:t.entityData,keyspaceMetaData:t.containerData,dataSources:o,udtTypeMap:a,isKeyspaceActivated:s}),f=(v=(y=t.modelData)==null?void 0:y[0])==null?void 0:v.dbVersion,h=VP(LP(t.entityData,f),o,n,r,i,e,f),p=HP(DP(t.containerData)),g=$P(OP(t.containerData)),d=KP([p,g,...u,l,h]);return PP(d,i&&e)},"getCreateTableScript"),KP=c(t=>t.filter(e=>e).join(`

`),"getScript"),HP=c(t=>t.map(e=>e.functionBody).filter(e=>e).join(`
`),"getUserDefinedFunctions"),$P=c(t=>t.map(e=>e.storedProcFunction).filter(e=>e).join(`
`),"getUserDefinedAggregations");FS.exports={getCreateTableScript:MP}});var ze=_(Bn=>{"use strict";var gn=require("util");function Vt(t){Error.call(this,t),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.info="Cassandra Driver Error",this.message=t}c(Vt,"DriverError");gn.inherits(Vt,Error);function US(t,e){if(Vt.call(this,e),this.innerErrors=t,this.info="Represents an error when a query cannot be performed because no host is available or could be reached by the driver.",!e&&(this.message="All host(s) tried for query failed.",t)){let r=Object.keys(t);if(r.length>0){let n=r[0];this.message+=gn.format(" First host tried, %s: %s. See innerErrors.",n,t[n])}}}c(US,"NoHostAvailableError");gn.inherits(US,Vt);function VS(t,e){Vt.call(this,e),this.code=t,this.info="Represents an error message from the server"}c(VS,"ResponseError");gn.inherits(VS,Vt);function MS(t){Vt.call(this,t),this.info="Represents a bug inside the driver or in a Cassandra host."}c(MS,"DriverInternalError");gn.inherits(MS,Vt);function KS(t){Vt.call(this,t),this.info="Represents an authentication error from the driver or from a Cassandra node."}c(KS,"AuthenticationError");gn.inherits(KS,Vt);function HS(t){Vt.call(this,t),this.info="Represents an error that is raised when one of the arguments provided to a method is not valid."}c(HS,"ArgumentError");gn.inherits(HS,Vt);function $S(t,e){Vt.call(this,t,this.constructor),this.info="Represents a client-side error that is raised when the client did not hear back from the server within socketOptions.readTimeout",this.host=e}c($S,"OperationTimedOutError");gn.inherits($S,Vt);function GS(t){Vt.call(this,t,this.constructor),this.info="Represents a feature that is not supported in the driver or in the Cassandra version."}c(GS,"NotSupportedError");gn.inherits(GS,Vt);function jS(t,e,r){let n=gn.format("All connections to host %s are busy, %d requests are in-flight on %s",t,e,r===1?"a single connection":"each connection");Vt.call(this,n,this.constructor),this.info="Represents a client-side error indicating that all connections to a certain host have reached the maximum amount of in-flight requests supported (pooling.maxRequestsPerConnection)"}c(jS,"BusyConnectionError");gn.inherits(jS,Vt);Bn.ArgumentError=HS;Bn.AuthenticationError=KS;Bn.BusyConnectionError=jS;Bn.DriverError=Vt;Bn.OperationTimedOutError=$S;Bn.DriverInternalError=MS;Bn.NoHostAvailableError=US;Bn.NotSupportedError=GS;Bn.ResponseError=VS});var fr=_((Lz,WS)=>{"use strict";function GP(t){return new Promise(e=>setTimeout(e,t||0))}c(GP,"delay");function jP(t,e){return new Promise((r,n)=>t.once(e,(i,s)=>{i?n(i):r(s)}))}c(jP,"fromEvent");function zP(t){return new Promise((e,r)=>t((n,i)=>{n?r(n):e(i)}))}c(zP,"fromCallback");function WP(t,e){return function(r,n){r?e(r):t(n)}}c(WP,"getCallback");async function QP(t,e,r){let n;for(;(n=t.counter++)<e;)await r(n)}c(QP,"invokeSequentially");function YP(t,e,r){return new Promise((n,i)=>{t.newQueryPlan(e,r,(s,o)=>{s?i(s):n(o)})})}c(YP,"newQueryPlan");function ZP(t,e){if(!e)return t;zS(t,e)}c(ZP,"optionalCallback");function XP(t,e,r){e>t&&(e=t);let n=new Array(e),i={counter:0};for(let s=0;s<e;s++)n[s]=QP(i,t,r);return Promise.all(n)}c(XP,"times");function JP(t){t.catch(()=>{})}c(JP,"toBackground");function zS(t,e){t.then(r=>process.nextTick(()=>e(null,r)),r=>process.nextTick(()=>e(r)))}c(zS,"toCallback");WS.exports={delay:GP,fromCallback:zP,fromEvent:jP,getCallback:WP,newQueryPlan:YP,optionalCallback:ZP,times:XP,toBackground:JP,toCallback:zS}});var oe=_(de=>{"use strict";var Qs=require("util"),ek=require("net"),{EventEmitter:tk}=require("events"),QS=ze(),rk=fr(),nk=9007199254740992,ik=2147483647,YS=Object.freeze({}),sk=Object.freeze([]);function hr(){}c(hr,"noop");var ok=Buffer.alloc||uk,ZS=Buffer.allocUnsafe||XS,ak=Int8Array.from!==Buffer.from&&Buffer.from||lk,ck=Int8Array.from!==Buffer.from&&Buffer.from||fk;function XS(t){return new Buffer(t)}c(XS,"allocBufferDeprecated");function uk(t){let e=XS(t);return e.fill(0),e}c(uk,"allocBufferFillDeprecated");function lk(t,e){if(typeof t!="string")throw new TypeError("Expected string, obtained "+Qs.inspect(t));return new Buffer(t,e)}c(lk,"allocBufferFromStringDeprecated");function fk(t){if(!Array.isArray(t))throw new TypeError("Expected Array, obtained "+Qs.inspect(t));return new Buffer(t)}c(fk,"allocBufferFromArrayDeprecated");function hk(t){let e=t;return c(function(n,i){e(n,i),e=hr},"wrapperCallback")}c(hk,"callbackOnce");function dk(t){let e=ZS(t.length);return t.copy(e),e}c(dk,"copyBuffer");function pk(t,e){return t&&(e.stack+=`
  (event loop)
`+t.substr(t.indexOf(`
`)+1)),e}c(pk,"fixStack");function gk(t,e,r,n){if(!this.logEmitter){let i=n||this.options;if(!i||!i.logEmitter)throw new Error("Log emitter not defined");this.logEmitter=i.logEmitter}this.logEmitter("log",t,this.constructor.name,e,r||"")}c(gk,"log");function yk(t){if(t.length===1)return t[0].length;let e=0;return t.forEach(function(r){let n=r.length;n=n||0,e+=n}),e}c(yk,"totalLength");function mk(t){return Array.prototype.slice.call(arguments,1).forEach(function(r){if(!r)return;let n=Object.keys(r);for(let i=0;i<n.length;i++){let s=n[i],o=r[s];o!==void 0&&(t[s]=o)}}),t}c(mk,"extend");function vk(t){let e=Object.keys(t),r={};for(let n=0;n<e.length;n++){let i=e[n];r[i.toLowerCase()]=t[i]}return r}c(vk,"toLowerCaseProperties");function JS(t){return Array.prototype.slice.call(arguments,1).forEach(function(r){for(let n in r){if(!r.hasOwnProperty(n))continue;let i=t[n],s=typeof i;!i||s==="number"||s==="string"||Array.isArray(i)||Qs.isDate(i)||i.constructor.name!=="Object"?t[n]=r[n]:t[n]=JS({},i,r[n])}}),t}c(JS,"deepExtend");function Ek(t){return function(e,r){return e[t]>r[t]?1:e[t]<r[t]?-1:0}}c(Ek,"propCompare");function Sk(t,e){return function(r,n){if(typeof r[t]>"u")return 0;let i=r[t].apply(r,e),s=n[t].apply(n,e);return i>s?1:i<s?-1:0}}c(Sk,"funcCompare");function Ck(t){return t[Symbol.iterator]()}c(Ck,"arrayIterator");function wk(t){let e=[],r=t.next();for(;!r.done;)e.push(r.value),r=t.next();return e}c(wk,"iteratorToArray");function eC(t,e,r){let n=0,i=t.length-1;for(;n<=i;){let s=n+i>>>1,o=t[s],a=r(o,e);if(a<0)n=s+1;else if(a>0)i=s-1;else return s}return~n}c(eC,"binarySearch");function xk(t,e,r){if(t.length===0)return t.push(e);let n=eC(t,e,r);n<0&&(n=~n),t.splice(n,0,e)}c(xk,"insertSorted");function Tk(t,e){if(typeof t!="function")throw new QS.ArgumentError(Qs.format("%s is not a function",e||"callback"));return t}c(Tk,"validateFn");function _k(t,e){if(!t||Array.isArray(t)||!e||e.length===0)return t;let r=new Array(e.length);t=vk(t);let n={};for(let i=0;i<e.length;i++){let s=e[i].name;if(!t.hasOwnProperty(s))throw new QS.ArgumentError(Qs.format('Parameter "%s" not defined',s));r[i]=t[s],n[s]=i}return r}c(_k,"adaptNamedParamsPrepared");function bk(t,e){if(!t||Array.isArray(t))return{params:t,namedParameters:!1,keyIndexes:null};let r=Object.keys(t),n=new Array(r.length),i=new Array(r.length),s=e.getHints()||YS,o={};for(let a=0;a<r.length;a++){let u=r[a];n[a]={name:u.toLowerCase(),value:t[u]},i[a]=s[u],o[u]=a}return e.setHints(i),{params:n,namedParameters:!0,keyIndexes:o}}c(bk,"adaptNamedParamsWithHints");function Ik(t,e){return!e||e<0?null:e===1?t:new Array(e+1).join(t)}c(Ik,"stringRepeat");function Ak(t){if(!t)return sk;let e=Object.keys(t),r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=t[e[n]];return r}c(Ak,"objectValues");function Nk(t,e,r){if(typeof e=="function"){r.call(this,e);return}let n=t.promiseFactory||Bk,i=this;return n(c(function(o){r.call(i,o)},"handlerWrapper"))}c(Nk,"promiseWrapper");function Bk(t){return new Promise(c(function(r,n){t(c(function(s,o){if(s)return n(s);r(o)},"handlerCallback"))},"executor"))}c(Bk,"defaultPromiseFactory");function Rk(t,e){return t!==void 0?t:e}c(Rk,"ifUndefined");function Ok(t,e,r){return t!==void 0?t:e!==void 0?e:r}c(Ok,"ifUndefined3");function Dk(t){for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[r],t[r]=n}return t}c(Dk,"shuffleArray");function ya(){this.length=0,this.items={}}c(ya,"HashSet");ya.prototype.add=function(t){return this.contains(t)?!1:(this.items[t]=!0,this.length++,!0)};ya.prototype.contains=function(t){return this.length>0&&this.items[t]===!0};ya.prototype.remove=function(t){if(!this.contains(t))return!1;delete this.items[t],this.length--};ya.prototype.toArray=function(){return Object.keys(this.items)};var Ih=class Ih{constructor(e){if(!e||!e.nameOrIp||!e.dns)throw new Error("nameOrIp and dns lib must be provided as part of the options");this._resolve4=Qs.promisify(e.dns.resolve4),this._nameOrIp=e.nameOrIp,this._isIp=ek.isIP(e.nameOrIp),this._index=0,this._addresses=null,this._refreshing=null}async init(){this._isIp||await this._resolve()}async refresh(){if(!this._isIp){if(this._refreshing)return await rk.fromEvent(this._refreshing,"finished");this._refreshing=new tk().setMaxListeners(0);try{await this._resolve()}catch{}this._refreshing.emit("finished"),this._refreshing=null}}async _resolve(){let e=await this._resolve4(this._nameOrIp);if(!e||e.length===0)throw new Error(`${this._nameOrIp} could not be resolved`);this._addresses=e}getIp(){if(this._isIp)return this._nameOrIp;let e=this._addresses[this._index%this._addresses.length];return this._index=this._index!==ik?this._index+1:0,e}};c(Ih,"AddressResolver");var bh=Ih;function Lk(t,e,r){if(!Array.isArray(t))throw new TypeError("First parameter is not an Array");r=r||hr;let n=t.length;if(n===0)return r();let i=0;for(let o=0;o<n;o++)e(t[o],s);function s(o){if(o){let a=r;r=hr,a(o);return}++i===n&&r()}c(s,"next")}c(Lk,"each");function Pk(t,e,r){if(!Array.isArray(t))throw new TypeError("First parameter is not an Array");r=r||hr;let n=t.length;if(n===0)return r();let i,s=1;e(t[0],o),i===void 0&&(i=!1);function o(a){if(a)return r(a);if(s>=n)return r();if(i===void 0&&(i=!0),i)return process.nextTick(function(){e(t[s++],o)});e(t[s++],o)}c(o,"next")}c(Pk,"eachSeries");function kk(t,e,r){return tC(t,e,!0,r)}c(kk,"forEachOf");function Fk(t,e,r){return tC(t,e,!1,r)}c(Fk,"map");function tC(t,e,r,n){if(!Array.isArray(t))throw new TypeError("First parameter must be an Array");n=n||hr;let i=t.length;if(i===0)return n(null,[]);let s=new Array(i),o=0,a=r?l:u;for(let h=0;h<i;h++)a(h);function u(h){e(t[h],c(function(g,d){s[h]=d,f(g)},"mapItemCallback"))}c(u,"invokeWithoutIndex");function l(h){e(t[h],h,c(function(g,d){s[h]=d,f(g)},"mapItemCallback"))}c(l,"invokeWithIndex");function f(h){if(h){let p=n;n=hr,p(h);return}++o===i&&n(null,s)}c(f,"next")}c(tC,"mapEach");function qk(t,e,r){if(!Array.isArray(t))throw new TypeError("First parameter must be an Array");r=r||hr;let n=t.length;if(n===0)return r(null,[]);let i=new Array(n),s=0,o;a(0),o===void 0&&(o=!1);function a(l){e(t[l],c(function(h,p){i[l]=p,u(h)},"mapItemCallback"))}c(a,"invoke");function u(l){if(l)return r(l);if(++s===n)return r(null,i);o===void 0&&(o=!0);let f=s;if(o)return process.nextTick(function(){a(f)});a(s)}c(u,"next")}c(qk,"mapSeries");function Uk(t,e){if(!Array.isArray(t))throw new TypeError("First parameter must be an Array");e=e||hr;let r=t.length,n=0;for(let s=0;s<r;s++)t[s](i);function i(s){if(s){let o=e;return e=hr,o(s)}++n===r&&e()}c(i,"next")}c(Uk,"parallel");function Vk(t,e){if(!Array.isArray(t))throw new TypeError("First parameter must be an Array");e=e||hr;let r=0,n;i();function i(s,o){if(s)return e(s);if(r===t.length)return e(null,o);if(n)return process.nextTick(function(){n=!0,t[r++](i),n=!1});n=!0,t[r++](i),n=!1}c(i,"next")}c(Vk,"series");function Mk(t,e,r){if(r=r||hr,t=+t,isNaN(t)||t===0)return r();let n=0;for(let s=0;s<t;s++)e(s,i);function i(s){if(s){let o=r;return r=hr,o(s)}++n===t&&r()}c(i,"next")}c(Mk,"times");function Kk(t,e,r,n){let i;n=n||hr,e=Math.min(e,t);let s=e-1,o,a=0;for(o=0;o<e;o++)r(o,u);o=-1;function u(l){if(l){let f=n;n=hr,f(l);return}if(++a===t)return n();if(s++,!(s>=t)){if(i===void 0&&(i=o>=0),i){let f=s;return process.nextTick(function(){r(f,u)})}r(s,u)}}c(u,"next")}c(Kk,"timesLimit");function Hk(t,e,r){if(t=+t,isNaN(t)||t<1)return r();let n=1,i;e(0,s),i===void 0&&(i=!1);function s(o){if(o)return r(o);if(n===t)return r();i===void 0&&(i=!0);let a=n++;if(i)return process.nextTick(function(){e(a,s)});e(a,s)}c(s,"next")}c(Hk,"timesSeries");function $k(t,e,r){let n=0;i();function i(s){if(s)return r(s);if(!t())return r();if(n===0){n=1,e(function(o){n===1&&(n=4),i(o)}),n===1&&(n=2);return}if(n===4)return process.nextTick(function(){e(i)});e(i)}c(i,"next")}c($k,"whilst");de.adaptNamedParamsPrepared=_k;de.adaptNamedParamsWithHints=bk;de.AddressResolver=bh;de.allocBuffer=ok;de.allocBufferUnsafe=ZS;de.allocBufferFromArray=ck;de.allocBufferFromString=ak;de.arrayIterator=Ck;de.binarySearch=eC;de.callbackOnce=hk;de.copyBuffer=dk;de.deepExtend=JS;de.each=Lk;de.eachSeries=Pk;de.emptyArray=Object.freeze([]);de.emptyObject=YS;de.extend=mk;de.fixStack=pk;de.forEachOf=kk;de.funcCompare=Sk;de.ifUndefined=Rk;de.ifUndefined3=Ok;de.insertSorted=xk;de.iteratorToArray=wk;de.log=gk;de.map=Fk;de.mapSeries=qk;de.maxInt=nk;de.noop=hr;de.objectValues=Ak;de.parallel=Uk;de.promiseWrapper=Nk;de.propCompare=Ek;de.series=Vk;de.shuffleArray=Dk;de.stringRepeat=Ik;de.times=Mk;de.timesLimit=Kk;de.timesSeries=Hk;de.totalLength=yk;de.validateFn=Tk;de.whilst=$k;de.HashSet=ya});var nC=_(Nh=>{"use strict";var rC=require("dns"),Gk=require("util"),jk=oe();function Ah(){}c(Ah,"AddressTranslator");Ah.prototype.translate=function(t,e,r){r(t+":"+e)};function Wc(){}c(Wc,"EC2MultiRegionTranslator");Gk.inherits(Wc,Ah);Wc.prototype.translate=function(t,e,r){let n=t,i=this,s;jk.series([c(function(a){rC.reverse(t,function(u,l){if(u)return a(u);if(!l)return a();s=l[0],a()})},"resolve"),c(function(a){if(!s)return a();rC.lookup(s,function(u,l){if(u)return a(u);n=l,a()})},"lookup")],function(o){o&&i.logError(t,o),r(n+":"+e)})};Wc.prototype.logError=function(t,e){};Nh.AddressTranslator=Ah;Nh.EC2MultiRegionTranslator=Wc});var rs=_((sC,Bh)=>{var iC=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function r(q,T,G){this.low=q|0,this.high=T|0,this.unsigned=!!G}c(r,"Long"),r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0});function n(q){return(q&&q.__isLong__)===!0}c(n,"isLong");function i(q){var T=Math.clz32(q&-q);return q?31-T:T}c(i,"ctz32"),r.isLong=n;var s={},o={};function a(q,T){var G,ae,X;return T?(q>>>=0,(X=0<=q&&q<256)&&(ae=o[q],ae)?ae:(G=l(q,0,!0),X&&(o[q]=G),G)):(q|=0,(X=-128<=q&&q<128)&&(ae=s[q],ae)?ae:(G=l(q,q<0?-1:0,!1),X&&(s[q]=G),G))}c(a,"fromInt"),r.fromInt=a;function u(q,T){if(isNaN(q))return T?A:x;if(T){if(q<0)return A;if(q>=v)return se}else{if(q<=-m)return re;if(q+1>=m)return Q}return q<0?u(-q,T).neg():l(q%y|0,q/y|0,T)}c(u,"fromNumber"),r.fromNumber=u;function l(q,T,G){return new r(q,T,G)}c(l,"fromBits"),r.fromBits=l;var f=Math.pow;function h(q,T,G){if(q.length===0)throw Error("empty string");if(typeof T=="number"?(G=T,T=!1):T=!!T,q==="NaN"||q==="Infinity"||q==="+Infinity"||q==="-Infinity")return T?A:x;if(G=G||10,G<2||36<G)throw RangeError("radix");var ae;if((ae=q.indexOf("-"))>0)throw Error("interior hyphen");if(ae===0)return h(q.substring(1),T,G).neg();for(var X=u(f(G,8)),Re=x,je=0;je<q.length;je+=8){var Se=Math.min(8,q.length-je),Oe=parseInt(q.substring(je,je+Se),G);if(Se<8){var Ce=u(f(G,Se));Re=Re.mul(Ce).add(u(Oe))}else Re=Re.mul(X),Re=Re.add(u(Oe))}return Re.unsigned=T,Re}c(h,"fromString"),r.fromString=h;function p(q,T){return typeof q=="number"?u(q,T):typeof q=="string"?h(q,T):l(q.low,q.high,typeof T=="boolean"?T:q.unsigned)}c(p,"fromValue"),r.fromValue=p;var g=65536,d=1<<24,y=g*g,v=y*y,m=v/2,w=a(d),x=a(0);r.ZERO=x;var A=a(0,!0);r.UZERO=A;var O=a(1);r.ONE=O;var P=a(1,!0);r.UONE=P;var j=a(-1);r.NEG_ONE=j;var Q=l(-1,2147483647,!1);r.MAX_VALUE=Q;var se=l(-1,-1,!0);r.MAX_UNSIGNED_VALUE=se;var re=l(0,-2147483648,!1);r.MIN_VALUE=re;var k=r.prototype;k.toInt=c(function(){return this.unsigned?this.low>>>0:this.low},"toInt"),k.toNumber=c(function(){return this.unsigned?(this.high>>>0)*y+(this.low>>>0):this.high*y+(this.low>>>0)},"toNumber"),k.toString=c(function(T){if(T=T||10,T<2||36<T)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(re)){var G=u(T),ae=this.div(G),X=ae.mul(G).sub(this);return ae.toString(T)+X.toInt().toString(T)}else return"-"+this.neg().toString(T);for(var Re=u(f(T,6),this.unsigned),je=this,Se="";;){var Oe=je.div(Re),Ce=je.sub(Oe.mul(Re)).toInt()>>>0,Ee=Ce.toString(T);if(je=Oe,je.isZero())return Ee+Se;for(;Ee.length<6;)Ee="0"+Ee;Se=""+Ee+Se}},"toString"),k.getHighBits=c(function(){return this.high},"getHighBits"),k.getHighBitsUnsigned=c(function(){return this.high>>>0},"getHighBitsUnsigned"),k.getLowBits=c(function(){return this.low},"getLowBits"),k.getLowBitsUnsigned=c(function(){return this.low>>>0},"getLowBitsUnsigned"),k.getNumBitsAbs=c(function(){if(this.isNegative())return this.eq(re)?64:this.neg().getNumBitsAbs();for(var T=this.high!=0?this.high:this.low,G=31;G>0&&!(T&1<<G);G--);return this.high!=0?G+33:G+1},"getNumBitsAbs"),k.isZero=c(function(){return this.high===0&&this.low===0},"isZero"),k.eqz=k.isZero,k.isNegative=c(function(){return!this.unsigned&&this.high<0},"isNegative"),k.isPositive=c(function(){return this.unsigned||this.high>=0},"isPositive"),k.isOdd=c(function(){return(this.low&1)===1},"isOdd"),k.isEven=c(function(){return(this.low&1)===0},"isEven"),k.equals=c(function(T){return n(T)||(T=p(T)),this.unsigned!==T.unsigned&&this.high>>>31===1&&T.high>>>31===1?!1:this.high===T.high&&this.low===T.low},"equals"),k.eq=k.equals,k.notEquals=c(function(T){return!this.eq(T)},"notEquals"),k.neq=k.notEquals,k.ne=k.notEquals,k.lessThan=c(function(T){return this.comp(T)<0},"lessThan"),k.lt=k.lessThan,k.lessThanOrEqual=c(function(T){return this.comp(T)<=0},"lessThanOrEqual"),k.lte=k.lessThanOrEqual,k.le=k.lessThanOrEqual,k.greaterThan=c(function(T){return this.comp(T)>0},"greaterThan"),k.gt=k.greaterThan,k.greaterThanOrEqual=c(function(T){return this.comp(T)>=0},"greaterThanOrEqual"),k.gte=k.greaterThanOrEqual,k.ge=k.greaterThanOrEqual,k.compare=c(function(T){if(n(T)||(T=p(T)),this.eq(T))return 0;var G=this.isNegative(),ae=T.isNegative();return G&&!ae?-1:!G&&ae?1:this.unsigned?T.high>>>0>this.high>>>0||T.high===this.high&&T.low>>>0>this.low>>>0?-1:1:this.sub(T).isNegative()?-1:1},"compare"),k.comp=k.compare,k.negate=c(function(){return!this.unsigned&&this.eq(re)?re:this.not().add(O)},"negate"),k.neg=k.negate,k.add=c(function(T){n(T)||(T=p(T));var G=this.high>>>16,ae=this.high&65535,X=this.low>>>16,Re=this.low&65535,je=T.high>>>16,Se=T.high&65535,Oe=T.low>>>16,Ce=T.low&65535,Ee=0,ke=0,we=0,Ve=0;return Ve+=Re+Ce,we+=Ve>>>16,Ve&=65535,we+=X+Oe,ke+=we>>>16,we&=65535,ke+=ae+Se,Ee+=ke>>>16,ke&=65535,Ee+=G+je,Ee&=65535,l(we<<16|Ve,Ee<<16|ke,this.unsigned)},"add"),k.subtract=c(function(T){return n(T)||(T=p(T)),this.add(T.neg())},"subtract"),k.sub=k.subtract,k.multiply=c(function(T){if(this.isZero())return this;if(n(T)||(T=p(T)),e){var G=e.mul(this.low,this.high,T.low,T.high);return l(G,e.get_high(),this.unsigned)}if(T.isZero())return this.unsigned?A:x;if(this.eq(re))return T.isOdd()?re:x;if(T.eq(re))return this.isOdd()?re:x;if(this.isNegative())return T.isNegative()?this.neg().mul(T.neg()):this.neg().mul(T).neg();if(T.isNegative())return this.mul(T.neg()).neg();if(this.lt(w)&&T.lt(w))return u(this.toNumber()*T.toNumber(),this.unsigned);var ae=this.high>>>16,X=this.high&65535,Re=this.low>>>16,je=this.low&65535,Se=T.high>>>16,Oe=T.high&65535,Ce=T.low>>>16,Ee=T.low&65535,ke=0,we=0,Ve=0,lt=0;return lt+=je*Ee,Ve+=lt>>>16,lt&=65535,Ve+=Re*Ee,we+=Ve>>>16,Ve&=65535,Ve+=je*Ce,we+=Ve>>>16,Ve&=65535,we+=X*Ee,ke+=we>>>16,we&=65535,we+=Re*Ce,ke+=we>>>16,we&=65535,we+=je*Oe,ke+=we>>>16,we&=65535,ke+=ae*Ee+X*Ce+Re*Oe+je*Se,ke&=65535,l(Ve<<16|lt,ke<<16|we,this.unsigned)},"multiply"),k.mul=k.multiply,k.divide=c(function(T){if(n(T)||(T=p(T)),T.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&T.low===-1&&T.high===-1)return this;var G=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,T.low,T.high);return l(G,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?A:x;var ae,X,Re;if(this.unsigned){if(T.unsigned||(T=T.toUnsigned()),T.gt(this))return A;if(T.gt(this.shru(1)))return P;Re=A}else{if(this.eq(re)){if(T.eq(O)||T.eq(j))return re;if(T.eq(re))return O;var je=this.shr(1);return ae=je.div(T).shl(1),ae.eq(x)?T.isNegative()?O:j:(X=this.sub(T.mul(ae)),Re=ae.add(X.div(T)),Re)}else if(T.eq(re))return this.unsigned?A:x;if(this.isNegative())return T.isNegative()?this.neg().div(T.neg()):this.neg().div(T).neg();if(T.isNegative())return this.div(T.neg()).neg();Re=x}for(X=this;X.gte(T);){ae=Math.max(1,Math.floor(X.toNumber()/T.toNumber()));for(var Se=Math.ceil(Math.log(ae)/Math.LN2),Oe=Se<=48?1:f(2,Se-48),Ce=u(ae),Ee=Ce.mul(T);Ee.isNegative()||Ee.gt(X);)ae-=Oe,Ce=u(ae,this.unsigned),Ee=Ce.mul(T);Ce.isZero()&&(Ce=O),Re=Re.add(Ce),X=X.sub(Ee)}return Re},"divide"),k.div=k.divide,k.modulo=c(function(T){if(n(T)||(T=p(T)),e){var G=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,T.low,T.high);return l(G,e.get_high(),this.unsigned)}return this.sub(this.div(T).mul(T))},"modulo"),k.mod=k.modulo,k.rem=k.modulo,k.not=c(function(){return l(~this.low,~this.high,this.unsigned)},"not"),k.countLeadingZeros=c(function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},"countLeadingZeros"),k.clz=k.countLeadingZeros,k.countTrailingZeros=c(function(){return this.low?i(this.low):i(this.high)+32},"countTrailingZeros"),k.ctz=k.countTrailingZeros,k.and=c(function(T){return n(T)||(T=p(T)),l(this.low&T.low,this.high&T.high,this.unsigned)},"and"),k.or=c(function(T){return n(T)||(T=p(T)),l(this.low|T.low,this.high|T.high,this.unsigned)},"or"),k.xor=c(function(T){return n(T)||(T=p(T)),l(this.low^T.low,this.high^T.high,this.unsigned)},"xor"),k.shiftLeft=c(function(T){return n(T)&&(T=T.toInt()),(T&=63)===0?this:T<32?l(this.low<<T,this.high<<T|this.low>>>32-T,this.unsigned):l(0,this.low<<T-32,this.unsigned)},"shiftLeft"),k.shl=k.shiftLeft,k.shiftRight=c(function(T){return n(T)&&(T=T.toInt()),(T&=63)===0?this:T<32?l(this.low>>>T|this.high<<32-T,this.high>>T,this.unsigned):l(this.high>>T-32,this.high>=0?0:-1,this.unsigned)},"shiftRight"),k.shr=k.shiftRight,k.shiftRightUnsigned=c(function(T){return n(T)&&(T=T.toInt()),(T&=63)===0?this:T<32?l(this.low>>>T|this.high<<32-T,this.high>>>T,this.unsigned):T===32?l(this.high,0,this.unsigned):l(this.high>>>T-32,0,this.unsigned)},"shiftRightUnsigned"),k.shru=k.shiftRightUnsigned,k.shr_u=k.shiftRightUnsigned,k.rotateLeft=c(function(T){var G;return n(T)&&(T=T.toInt()),(T&=63)===0?this:T===32?l(this.high,this.low,this.unsigned):T<32?(G=32-T,l(this.low<<T|this.high>>>G,this.high<<T|this.low>>>G,this.unsigned)):(T-=32,G=32-T,l(this.high<<T|this.low>>>G,this.low<<T|this.high>>>G,this.unsigned))},"rotateLeft"),k.rotl=k.rotateLeft,k.rotateRight=c(function(T){var G;return n(T)&&(T=T.toInt()),(T&=63)===0?this:T===32?l(this.high,this.low,this.unsigned):T<32?(G=32-T,l(this.high<<G|this.low>>>T,this.low<<G|this.high>>>T,this.unsigned)):(T-=32,G=32-T,l(this.low<<G|this.high>>>T,this.high<<G|this.low>>>T,this.unsigned))},"rotateRight"),k.rotr=k.rotateRight,k.toSigned=c(function(){return this.unsigned?l(this.low,this.high,!1):this},"toSigned"),k.toUnsigned=c(function(){return this.unsigned?this:l(this.low,this.high,!0)},"toUnsigned"),k.toBytes=c(function(T){return T?this.toBytesLE():this.toBytesBE()},"toBytes"),k.toBytesLE=c(function(){var T=this.high,G=this.low;return[G&255,G>>>8&255,G>>>16&255,G>>>24,T&255,T>>>8&255,T>>>16&255,T>>>24]},"toBytesLE"),k.toBytesBE=c(function(){var T=this.high,G=this.low;return[T>>>24,T>>>16&255,T>>>8&255,T&255,G>>>24,G>>>16&255,G>>>8&255,G&255]},"toBytesBE"),r.fromBytes=c(function(T,G,ae){return ae?r.fromBytesLE(T,G):r.fromBytesBE(T,G)},"fromBytes"),r.fromBytesLE=c(function(T,G){return new r(T[0]|T[1]<<8|T[2]<<16|T[3]<<24,T[4]|T[5]<<8|T[6]<<16|T[7]<<24,G)},"fromBytesLE"),r.fromBytesBE=c(function(T,G){return new r(T[4]<<24|T[5]<<16|T[6]<<8|T[7],T[0]<<24|T[1]<<16|T[2]<<8|T[3],G)},"fromBytesBE");var Ae=r;return t.default=Ae,"default"in t?t.default:t}({});typeof define=="function"&&define.amd?define([],function(){return iC}):typeof Bh=="object"&&typeof sC=="object"&&(Bh.exports=iC)});var Rh=_((Mz,cC)=>{"use strict";var zk=require("crypto"),Wk=oe();function yn(t){if(!t||t.length!==16)throw new Error("You must provide a buffer containing 16 bytes");this.buffer=t}c(yn,"Uuid");yn.fromString=function(t){if(typeof t!="string"||t.length!==36)throw new Error("Invalid string representation of Uuid, it should be in the 00000000-0000-0000-0000-000000000000");return new yn(Wk.allocBufferFromString(t.replace(/-/g,""),"hex"))};yn.random=function(t){if(t)aC(function(e,r){return e?t(e):t(null,oC(r))});else{let e=aC();return oC(e)}};yn.prototype.getBuffer=function(){return this.buffer};yn.prototype.equals=function(t){return t instanceof yn&&this.buffer.equals(t.buffer)};yn.prototype.toString=function(){let t=Qk(this);return t.substr(0,8)+"-"+t.substr(8,4)+"-"+t.substr(12,4)+"-"+t.substr(16,4)+"-"+t.substr(20,12)};yn.prototype.inspect=function(){return this.constructor.name+": "+this.toString()};yn.prototype.toJSON=function(){return this.toString()};function oC(t){return t[6]&=15,t[6]|=64,t[8]&=63,t[8]|=128,new yn(t)}c(oC,"createUuidFromBuffer");function Qk(t){return t.buffer.toString("hex")}c(Qk,"getHex");function aC(t){return zk.randomBytes(16,t)}c(aC,"getRandomBytes");cC.exports=yn});var gC=_((Hz,pC)=>{"use strict";var Yk=require("util"),fC=require("crypto"),Ys=rs(),Oh=Rh(),mi=oe(),hC=122192928e5,Zc=1e4,Zk=mi.allocBufferFromString("808080808080","hex"),Xk=mi.allocBufferFromString("8080","hex"),Jk=mi.allocBufferFromString("7f7f7f7f7f7f","hex"),eF=mi.allocBufferFromString("7f7f","hex"),Qc=0,Yc=0,uC=0;function Mt(t,e,r,n){let i;if(t instanceof Buffer){if(t.length!==16)throw new Error("Buffer for v1 uuid not valid");i=t}else i=oF(t,e,r,n);Oh.call(this,i)}c(Mt,"TimeUuid");Yk.inherits(Mt,Oh);Mt.fromDate=function(t,e,r,n,i){if(typeof e=="function"?(i=e,e=r=n=null):typeof r=="function"?(i=r,r=n=null):typeof n=="function"&&(i=n,n=null),!i)return new Mt(t,e,r,n);mi.parallel([s=>lC(r,6,(o,a)=>s(o,r=a)),s=>lC(n,2,(o,a)=>s(o,n=a))],s=>{if(s)return i(s);let o;try{o=new Mt(t,e,r,n)}catch(a){return i(a)}i(null,o)})};Mt.fromString=function(t){return new Mt(Oh.fromString(t).getBuffer())};Mt.min=function(t,e){return new Mt(t,e,Zk,Xk)};Mt.max=function(t,e){return new Mt(t,e,Jk,eF)};Mt.now=function(t,e,r){return Mt.fromDate(null,null,t,e,r)};Mt.prototype.getDatePrecision=function(){let t=this.buffer.readUInt32BE(0),e=0;e|=(this.buffer[4]&255)<<8,e|=this.buffer[5]&255,e|=(this.buffer[6]&15)<<24,e|=(this.buffer[7]&255)<<16;let r=Ys.fromBits(t,e),n=Ys.fromNumber(Zc),i=r.modulo(n),s=r.div(n).subtract(Ys.fromNumber(hC));return{date:new Date(s.toNumber()),ticks:i.toNumber()}};Mt.prototype.getDate=function(){return this.getDatePrecision().date};Mt.prototype.getNodeId=function(){return this.buffer.slice(10)};Mt.prototype.getClockId=function(){return this.buffer.slice(8,10)};Mt.prototype.getNodeIdString=function(){return this.buffer.slice(10).toString("ascii")};function tF(t,e,r){let n=Ys.fromNumber(e+hC).multiply(Ys.fromNumber(1e4)).add(Ys.fromNumber(r)),i=n.getHighBitsUnsigned();t.writeUInt32BE(n.getLowBitsUnsigned(),0),t.writeUInt16BE(i&65535,4),t.writeUInt16BE(i>>>16&65535,6)}c(tF,"writeTime");function rF(t){let e=t;if(typeof t=="string"&&(e=mi.allocBufferFromString(t,"ascii")),!(e instanceof Buffer))e=dC(2);else if(e.length!==2)throw new Error("Clock identifier must have 2 bytes");return e}c(rF,"getClockId");function nF(t){let e=t;if(typeof t=="string"&&(e=mi.allocBufferFromString(t,"ascii")),!(e instanceof Buffer))e=dC(6);else if(e.length!==6)throw new Error("Node identifier must have 6 bytes");return e}c(nF,"getNodeId");function iF(t){return(typeof t!="number"||t>=Zc)&&(Qc++,Qc>=Zc&&(Qc=0),t=Qc),t}c(iF,"getTicks");function sF(t,e){if(!(t instanceof Date)||isNaN(t.getTime())){t=new Date;let r=t.getTime();Yc++,(Yc>Zc||r>uC)&&(Yc=0,uC=r),e=Yc}return{time:t.getTime(),ticks:iF(e)}}c(sF,"getTimeWithTicks");function dC(t){return fC.randomBytes(t)}c(dC,"getRandomBytes");function lC(t,e,r){if(t)return r(null,t);fC.randomBytes(e,r)}c(lC,"getOrGenerateRandom");function oF(t,e,r,n){let i=sF(t,e);r=nF(r),n=rF(n);let s=mi.allocBufferUnsafe(16);return tF(s,i.time,i.ticks),n.copy(s,8,0),r.copy(s,10,0),s[6]=s[6]&15,s[6]=s[6]|16,s[8]=s[8]&63,s[8]=s[8]|128,s}c(oF,"generateBuffer");pC.exports=Mt});var Lh=_((Gz,yC)=>{"use strict";var aF=/(\d+)\.(\d+)(?:\.(\d+))?(?:\.(\d+)?)?(?:[-~]([\w+]*(?:-\w[.\w]*)*))?(?:\+([.\w]+))?/,Xc=class Xc{constructor(e,r,n,i,s,o){this.major=e,this.minor=r,this.patch=n,this.dsePatch=i,this.preReleases=s,this.build=o}toString(){let e=this.major+"."+this.minor;return this.patch!==void 0&&(e+="."+this.patch),this.dsePatch!==void 0&&(e+="."+this.dsePatch),this.preReleases!==void 0&&this.preReleases.forEach(r=>{e+="-"+r}),this.build&&(e+="+"+this.build),e}compare(e){if(this.major<e.major)return-1;if(this.major>e.major)return 1;if(this.minor<e.minor)return-1;if(this.minor>e.minor)return 1;let r=this.patch||0,n=e.patch||0;if(r<n)return-1;if(r>n)return 1;if(this.dsePatch===void 0){if(e.dsePatch!==void 0)return-1}else{if(e.dsePatch===void 0)return 1;if(this.dsePatch<e.dsePatch)return-1;if(this.dsePatch>e.dsePatch)return 1}if(this.preReleases===void 0){if(e.preReleases!==void 0)return 1}else if(e.preReleases===void 0)return-1;return 0}static parse(e){if(!e)return null;let r=e.match(aF);if(r){let n=parseInt(r[1],10),i=parseInt(r[2],10),s=r[3]?parseInt(r[3],10):void 0,o=r[4]?parseInt(r[4],10):void 0,a=r[5]?r[5].split("-"):void 0,u=r[6];return new Xc(n,i,s,o,a,u)}throw new TypeError("Could not extract version from '"+e+"'")}};c(Xc,"VersionNumber");var Dh=Xc;yC.exports=Dh});var vC=_((zz,mC)=>{"use strict";var cF=oe(),vi=Lh(),uF=vi.parse("2.0.0"),lF=vi.parse("2.1.0"),fF=vi.parse("2.2.0"),hF=vi.parse("3.0.0"),dF=vi.parse("5.1.0"),pF=vi.parse("6.0.0"),gF={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,dseV1:65,dseV2:66,maxSupported:66,minSupported:1,isDse:function(t){return t>=this.dseV1&&t<=this.dseV2},isSupportedCassandra:function(t){return t<=4&&t>=1},isSupported:function(t){return this.isDse(t)||this.isSupportedCassandra(t)},supportsPrepareFlags:function(t){return t===this.dseV2},supportsKeyspaceInRequest:function(t){return t===this.dseV2},supportsResultMetadataId:function(t){return t===this.dseV2},supportsPreparedPartitionKey:function(t){return t>=this.v4},supportsSchemaChangeFullMetadata:function(t){return t>=this.v3},supportsContinuousPaging:function(t){return this.isDse(t)},supportsPaging:function(t){return t>=this.v2},supportsTimestamp:function(t){return t>=this.v3},supportsNamedParameters:function(t){return t>=this.v3},supportsUnset:function(t){return t>=this.v4},supportsFailureReasonMap:function(t){return t>=this.v5},uses2BytesStreamIds:function(t){return t>=this.v3},uses4BytesCollectionLength:function(t){return t>=this.v3},uses4BytesQueryFlags:function(t){return this.isDse(t)},canStartupResponseErrorBeWrapped:function(t){return t>=this.v4},getLowerSupported:function(t){return t>=this.v5?this.v4:t<=this.v1?0:t-1},getHighestCommon:function(t,e){let r=t.log?t.log.bind(t):cF.noop,n=t.protocolVersion,i=!1,s=n;if(e.forEach(o=>{let a=null;if(o.dseVersion&&(a=vi.parse(o.dseVersion),r("verbose",`Encountered host ${o.address} with dse version ${a}`),a.compare(dF)>=0)){i=!0,a.compare(pF)>=0?n=Math.min(this.dseV2,n):n=Math.min(this.dseV1,n),s=n;return}if(!o.cassandraVersion||o.cassandraVersion.length===0){r("warning","Encountered host "+o.address+" with no cassandra version, skipping as part of protocol version evaluation");return}try{let u=vi.parse(o.cassandraVersion);a||r("verbose","Encountered host "+o.address+" with cassandra version "+u),u.compare(hF)>=0?(i=!0,n=Math.min(this.v4,n),s=n):u.compare(fF)>=0?(n=Math.min(this.v4,n),s=n):u.compare(lF)>=0?(n=Math.min(this.v3,n),s=n):u.compare(uF)>=0?n=Math.min(this.v2,n):n=this.v1}catch{r("warning","Encountered host "+o.address+" with unparseable cassandra version "+o.cassandraVersion+" skipping as part of protocol version evaluation")}}),i&&n<this.v3){let o=". This should not be possible as nodes within a cluster can't be separated by more than one major version";s<this.v3?r("error","Detected hosts that require at least protocol version 0x3, but currently connected to "+t.address+":"+t.port+" using protocol version 0x"+s+". Will not be able to connect to these hosts"+o):r("error","Detected hosts with maximum protocol version of 0x"+n.toString(16)+" but there are some hosts that require at least version 0x3. Will not be able to connect to these older hosts"+o),n=s}return r("verbose","Resolved protocol version 0x"+n.toString(16)+" as the highest common protocol version among hosts"),n},isBeta:function(t){return t===this.v5}};mC.exports=gF});var Ph=_((Wz,SC)=>{var EC=oe();function W(t,e){this.bits_=[],this.sign_=e;for(var r=!0,n=t.length-1;n>=0;n--){var i=t[n]|0;(!r||i!=e)&&(this.bits_[n]=i,r=!1)}}c(W,"Integer");W.IntCache_={};W.fromInt=function(t){if(-128<=t&&t<128){var e=W.IntCache_[t];if(e)return e}var r=new W([t|0],t<0?-1:0);return-128<=t&&t<128&&(W.IntCache_[t]=r),r};W.fromNumber=function(t){if(isNaN(t)||!isFinite(t))return W.ZERO;if(t<0)return W.fromNumber(-t).negate();for(var e=[],r=1,n=0;t>=r;n++)e[n]=t/r|0,r*=W.TWO_PWR_32_DBL_;return new W(e,0)};W.fromBits=function(t){var e=t[t.length-1];return new W(t,e&1<<31?-1:0)};W.fromString=function(t,e){if(t.length==0)throw TypeError("number format error: empty string");var r=e||10;if(r<2||36<r)throw Error("radix out of range: "+r);if(t.charAt(0)=="-")return W.fromString(t.substring(1),r).negate();if(t.indexOf("-")>=0)throw TypeError('number format error: interior "-" character');for(var n=W.fromNumber(Math.pow(r,8)),i=W.ZERO,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),r);if(o<8){var u=W.fromNumber(Math.pow(r,o));i=i.multiply(u).add(W.fromNumber(a))}else i=i.multiply(n),i=i.add(W.fromNumber(a))}return i};W.fromBuffer=function(t){for(var e=new Array(Math.ceil(t.length/4)),r=t[0]&128?-1:0,n=0;n<e.length;n++){var i=t.length-(n+1)*4,s;if(i<0){i=i+4,s=0;for(var o=0;o<i;o++){var a=t[o];r===-1&&(a=~a&255),s=s|a<<(i-o-1)*8}r===-1&&(s=~s)}else s=t.readInt32BE(i);e[n]=s}return new W(e,r)};W.toBuffer=function(t){var e=t.sign_,r=t.bits_;if(r.length===0)return EC.allocBufferFromArray([t.sign_]);var n=r[r.length-1];e===-1&&(n=~n);var i=[];n>>>24>0&&i.push(n>>24&255),n>>>16>0&&i.push(n>>16&255),n>>>8>0&&i.push(n>>8&255),i.push(n&255),i[0]>>7&&i.unshift(0);for(var s=EC.allocBufferUnsafe(i.length+(r.length-1)*4),o=0;o<i.length;o++){var a=i[o];e===-1?s[o]=~a:s[o]=a}for(var u=0;u<r.length-1;u++){var l=r[r.length-2-u],f=i.length+u*4;s.writeInt32BE(l,f)}return s};W.TWO_PWR_32_DBL_=65536*65536;W.ZERO=W.fromInt(0);W.ONE=W.fromInt(1);W.TWO_PWR_24_=W.fromInt(1<<24);W.prototype.toInt=function(){return this.bits_.length>0?this.bits_[0]:this.sign_};W.prototype.toNumber=function(){if(this.isNegative())return-this.negate().toNumber();for(var t=0,e=1,r=0;r<this.bits_.length;r++)t+=this.getBitsUnsigned(r)*e,e*=W.TWO_PWR_32_DBL_;return t};W.prototype.toString=function(t){var e=t||10;if(e<2||36<e)throw Error("radix out of range: "+e);if(this.isZero())return"0";if(this.isNegative())return"-"+this.negate().toString(e);for(var r=W.fromNumber(Math.pow(e,6)),n=this,i="";;){var s=n.divide(r),o=n.subtract(s.multiply(r)).toInt(),a=o.toString(e);if(n=s,n.isZero())return a+i;for(;a.length<6;)a="0"+a;i=""+a+i}};W.prototype.getBits=function(t){return t<0?0:t<this.bits_.length?this.bits_[t]:this.sign_};W.prototype.getBitsUnsigned=function(t){var e=this.getBits(t);return e>=0?e:W.TWO_PWR_32_DBL_+e};W.prototype.getSign=function(){return this.sign_};W.prototype.isZero=function(){if(this.sign_!=0)return!1;for(var t=0;t<this.bits_.length;t++)if(this.bits_[t]!=0)return!1;return!0};W.prototype.isNegative=function(){return this.sign_==-1};W.prototype.isOdd=function(){return this.bits_.length==0&&this.sign_==-1||this.bits_.length>0&&(this.bits_[0]&1)!=0};W.prototype.equals=function(t){if(this.sign_!=t.sign_)return!1;for(var e=Math.max(this.bits_.length,t.bits_.length),r=0;r<e;r++)if(this.getBits(r)!=t.getBits(r))return!1;return!0};W.prototype.notEquals=function(t){return!this.equals(t)};W.prototype.greaterThan=function(t){return this.compare(t)>0};W.prototype.greaterThanOrEqual=function(t){return this.compare(t)>=0};W.prototype.lessThan=function(t){return this.compare(t)<0};W.prototype.lessThanOrEqual=function(t){return this.compare(t)<=0};W.prototype.compare=function(t){var e=this.subtract(t);return e.isNegative()?-1:e.isZero()?0:1};W.prototype.shorten=function(t){for(var e=t-1>>5,r=(t-1)%32,n=[],i=0;i<e;i++)n[i]=this.getBits(i);var s=r==31?4294967295:(1<<r+1)-1,o=this.getBits(e)&s;return o&1<<r?(o|=4294967295-s,n[e]=o,new W(n,-1)):(n[e]=o,new W(n,0))};W.prototype.negate=function(){return this.not().add(W.ONE)};W.prototype.add=function(t){for(var e=Math.max(this.bits_.length,t.bits_.length),r=[],n=0,i=0;i<=e;i++){var s=this.getBits(i)>>>16,o=this.getBits(i)&65535,a=t.getBits(i)>>>16,u=t.getBits(i)&65535,l=n+o+u,f=(l>>>16)+s+a;n=f>>>16,l&=65535,f&=65535,r[i]=f<<16|l}return W.fromBits(r)};W.prototype.subtract=function(t){return this.add(t.negate())};W.prototype.multiply=function(t){if(this.isZero())return W.ZERO;if(t.isZero())return W.ZERO;if(this.isNegative())return t.isNegative()?this.negate().multiply(t.negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.negate()).negate();if(this.lessThan(W.TWO_PWR_24_)&&t.lessThan(W.TWO_PWR_24_))return W.fromNumber(this.toNumber()*t.toNumber());for(var e=this.bits_.length+t.bits_.length,r=[],n=0;n<2*e;n++)r[n]=0;for(var n=0;n<this.bits_.length;n++)for(var i=0;i<t.bits_.length;i++){var s=this.getBits(n)>>>16,o=this.getBits(n)&65535,a=t.getBits(i)>>>16,u=t.getBits(i)&65535;r[2*n+2*i]+=o*u,W.carry16_(r,2*n+2*i),r[2*n+2*i+1]+=s*u,W.carry16_(r,2*n+2*i+1),r[2*n+2*i+1]+=o*a,W.carry16_(r,2*n+2*i+1),r[2*n+2*i+2]+=s*a,W.carry16_(r,2*n+2*i+2)}for(var n=0;n<e;n++)r[n]=r[2*n+1]<<16|r[2*n];for(var n=e;n<2*e;n++)r[n]=0;return new W(r,0)};W.carry16_=function(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535};W.prototype.divide=function(t){if(t.isZero())throw Error("division by zero");if(this.isZero())return W.ZERO;if(this.isNegative())return t.isNegative()?this.negate().divide(t.negate()):this.negate().divide(t).negate();if(t.isNegative())return this.divide(t.negate()).negate();for(var e=W.ZERO,r=this;r.greaterThanOrEqual(t);){for(var n=Math.max(1,Math.floor(r.toNumber()/t.toNumber())),i=Math.ceil(Math.log(n)/Math.LN2),s=i<=48?1:Math.pow(2,i-48),o=W.fromNumber(n),a=o.multiply(t);a.isNegative()||a.greaterThan(r);)n-=s,o=W.fromNumber(n),a=o.multiply(t);o.isZero()&&(o=W.ONE),e=e.add(o),r=r.subtract(a)}return e};W.prototype.modulo=function(t){return this.subtract(this.divide(t).multiply(t))};W.prototype.not=function(){for(var t=this.bits_.length,e=[],r=0;r<t;r++)e[r]=~this.bits_[r];return new W(e,~this.sign_)};W.prototype.and=function(t){for(var e=Math.max(this.bits_.length,t.bits_.length),r=[],n=0;n<e;n++)r[n]=this.getBits(n)&t.getBits(n);return new W(r,this.sign_&t.sign_)};W.prototype.or=function(t){for(var e=Math.max(this.bits_.length,t.bits_.length),r=[],n=0;n<e;n++)r[n]=this.getBits(n)|t.getBits(n);return new W(r,this.sign_|t.sign_)};W.prototype.xor=function(t){for(var e=Math.max(this.bits_.length,t.bits_.length),r=[],n=0;n<e;n++)r[n]=this.getBits(n)^t.getBits(n);return new W(r,this.sign_^t.sign_)};W.prototype.shiftLeft=function(t){for(var e=t>>5,r=t%32,n=this.bits_.length+e+(r>0?1:0),i=[],s=0;s<n;s++)r>0?i[s]=this.getBits(s-e)<<r|this.getBits(s-e-1)>>>32-r:i[s]=this.getBits(s-e);return new W(i,this.sign_)};W.prototype.shiftRight=function(t){for(var e=t>>5,r=t%32,n=this.bits_.length-e,i=[],s=0;s<n;s++)r>0?i[s]=this.getBits(s+e)>>>r|this.getBits(s+e+1)<<32-r:i[s]=this.getBits(s+e);return new W(i,this.sign_)};W.prototype.inspect=function(){return this.constructor.name+": "+this.toString()};W.prototype.abs=function(){return this.sign_===0?this:this.negate()};W.prototype.toJSON=function(){return this.toString()};SC.exports=W});var xC=_((Yz,wC)=>{"use strict";var Jn=Ph(),CC=oe();function We(t,e){typeof t=="number"&&(t=Jn.fromNumber(t)),this._intVal=t,this._scale=e}c(We,"BigDecimal");We.fromBuffer=function(t){let e=t.readInt32BE(0),r=Jn.fromBuffer(t.slice(4));return new We(r,e)};We.toBuffer=function(t){let e=Jn.toBuffer(t._intVal),r=CC.allocBufferUnsafe(4);return r.writeInt32BE(t._scale,0),Buffer.concat([r,e],r.length+e.length)};We.fromString=function(t){if(!t)throw new TypeError("Invalid null or undefined value");t=t.trim();let e=t.indexOf("."),r=0;return e>=0&&(r=t.length-1-e,t=t.substr(0,e)+t.substr(e+1)),new We(Jn.fromString(t),r)};We.fromNumber=function(t){if(isNaN(t))return new We(Jn.ZERO,0);let e=t.toString();return e.indexOf("e")>=0&&(e=t.toFixed(20)),We.fromString(e)};We.prototype.equals=function(t){return t instanceof We&&this.compare(t)===0};We.prototype.inspect=function(){return this.constructor.name+": "+this.toString()};We.prototype.notEquals=function(t){return!this.equals(t)};We.prototype.compare=function(t){let e=this.subtract(t);return e.isNegative()?-1:e.isZero()?0:1};We.prototype.subtract=function(t){let e=this;if(e._scale===t._scale)return new We(e._intVal.subtract(t._intVal),e._scale);let r,n;return e._scale<t._scale?(r=t._scale-e._scale,n=e._intVal.multiply(Jn.fromNumber(Math.pow(10,r))).subtract(t._intVal),new We(n,t._scale)):(r=e._scale-t._scale,n=e._intVal.subtract(t._intVal.multiply(Jn.fromNumber(Math.pow(10,r)))),new We(n,e._scale))};We.prototype.add=function(t){let e=this;if(e._scale===t._scale)return new We(e._intVal.add(t._intVal),e._scale);let r,n;return e._scale<t._scale?(r=t._scale-e._scale,n=e._intVal.multiply(Jn.fromNumber(Math.pow(10,r))).add(t._intVal),new We(n,t._scale)):(r=e._scale-t._scale,n=e._intVal.add(t._intVal.multiply(Jn.fromNumber(Math.pow(10,r)))),new We(n,e._scale))};We.prototype.greaterThan=function(t){return this.compare(t)===1};We.prototype.isNegative=function(){return this._intVal.isNegative()};We.prototype.isZero=function(){return this._intVal.isZero()};We.prototype.toString=function(){let t=this._intVal.toString();if(this._scale===0)return t;let e="";t.charAt(0)==="-"&&(e="-",t=t.substr(1));let r=t.length-this._scale;return r<=0&&(t=CC.stringRepeat("0",-r+1)+t,r=t.length-this._scale),e+t.substr(0,r)+"."+t.substr(r)};We.prototype.toNumber=function(){return parseFloat(this.toString())};We.prototype.toJSON=function(){return this.toString()};wC.exports=We});var IC=_((Xz,bC)=>{"use strict";var nt=rs(),Ei=require("util"),Jc=oe(),Zs={months:Jc.allocBuffer(9),days:Jc.allocBuffer(9),nanoseconds:Jc.allocBuffer(9)},qh=2147483647,Uh=nt.fromInt(1e3),eu=Uh,tu=Uh.multiply(eu),ru=Uh.multiply(tu),nu=nt.fromInt(60).multiply(ru),kh=nt.fromInt(60).multiply(nu),TC=7,Fh=12,_C=/(\d+)(y|mo|w|d|h|s|ms|us|s|ns|m)/gi,yF=/P((\d+)Y)?((\d+)M)?((\d+)D)?(T((\d+)H)?((\d+)M)?((\d+)S)?)?/,mF=/P(\d+)W/,vF=/P(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/;function Rn(t,e,r){this.months=t,this.days=e,this.nanoseconds=typeof r=="number"?nt.fromNumber(r):r}c(Rn,"Duration");Rn.prototype.equals=function(t){return t instanceof Rn?this.months===t.months&&this.days===t.days&&this.nanoseconds.equals(t.nanoseconds):!1};Rn.prototype.toBuffer=function(){let t=Xs.writeVInt(nt.fromNumber(this.months),Zs.months),e=Xs.writeVInt(nt.fromNumber(this.days),Zs.days),r=Xs.writeVInt(this.nanoseconds,Zs.nanoseconds),n=Jc.allocBufferUnsafe(t+e+r);Zs.months.copy(n,0,0,t);let i=t;return Zs.days.copy(n,i,0,e),i+=e,Zs.nanoseconds.copy(n,i,0,r),n};Rn.prototype.toString=function(){let t="";function e(i,s,o){return i===0||i<s?i:(t+=(i/s).toFixed(0)+o,i%s)}c(e,"append");function r(i,s,o){return i.equals(nt.ZERO)||i.lessThan(s)?i:(t+=i.divide(s).toString()+o,i.modulo(s))}c(r,"append64"),(this.months<0||this.days<0||this.nanoseconds.isNegative())&&(t="-");let n=e(Math.abs(this.months),Fh,"y");if(e(n,1,"mo"),e(Math.abs(this.days),1,"d"),!this.nanoseconds.equals(nt.ZERO)){let i=this.nanoseconds.isNegative()?this.nanoseconds.negate():this.nanoseconds;n=r(i,kh,"h"),n=r(n,nu,"m"),n=r(n,ru,"s"),n=r(n,tu,"ms"),n=r(n,eu,"us"),r(n,nt.ONE,"ns")}return t};Rn.fromBuffer=function(t){let e={value:0},r=Xs.readVInt(t,e).toNumber(),n=Xs.readVInt(t,e).toNumber(),i=Xs.readVInt(t,e);return new Rn(r,n,i)};Rn.fromString=function(t){let e=t.charAt(0)==="-",r=e?t.substr(1):t;return r.charAt(0)==="P"?r.charAt(r.length-1)==="W"?CF(e,r):r.indexOf("-")>0?wF(e,r):SF(e,r):EF(e,r)};function EF(t,e){let r=new ft(t);_C.lastIndex=0;let n;for(;(n=_C.exec(e))&&n.length<=3;)r.add(n[1],n[2]);return r.build()}c(EF,"parseStandardFormat");function SF(t,e){let r=yF.exec(e);if(!r||r[0]!==e)throw new TypeError(Ei.format("Unable to convert '%s' to a duration",e));let n=new ft(t);return r[1]&&n.addYears(r[2]),r[3]&&n.addMonths(r[4]),r[5]&&n.addDays(r[6]),r[7]&&(r[8]&&n.addHours(r[9]),r[10]&&n.addMinutes(r[11]),r[12]&&n.addSeconds(r[13])),n.build()}c(SF,"parseIso8601Format");function CF(t,e){let r=mF.exec(e);if(!r||r[0]!==e)throw new TypeError(Ei.format("Unable to convert '%s' to a duration",e));return new ft(t).addWeeks(r[1]).build()}c(CF,"parseIso8601WeekFormat");function wF(t,e){let r=vF.exec(e);if(!r||r[0]!==e)throw new TypeError(Ei.format("Unable to convert '%s' to a duration",e));return new ft(t).addYears(r[1]).addMonths(r[2]).addDays(r[3]).addHours(r[4]).addMinutes(r[5]).addSeconds(r[6]).build()}c(wF,"parseIso8601AlternativeFormat");function ft(t){this._isNegative=t,this._unitIndex=0,this._months=0,this._days=0,this._nanoseconds=nt.ZERO,this._addMethods={y:this.addYears,mo:this.addMonths,w:this.addWeeks,d:this.addDays,h:this.addHours,m:this.addMinutes,s:this.addSeconds,ms:this.addMillis,\u00B5s:this.addMicros,us:this.addMicros,ns:this.addNanos},this._unitByIndex=[null,"years","months","weeks","days","hours","minutes","seconds","milliseconds","microseconds","nanoseconds"]}c(ft,"Builder");ft.prototype._validateOrder=function(t){if(t===this._unitIndex)throw new TypeError(Ei.format("Invalid duration. The %s are specified multiple times",this._getUnitName(t)));if(t<=this._unitIndex)throw new TypeError(Ei.format("Invalid duration. The %s should be after %s",this._getUnitName(this._unitIndex),this._getUnitName(t)));this._unitIndex=t};ft.prototype._validateMonths=function(t,e){this._validate32(t,(qh-this._months)/e,"months")};ft.prototype._validateDays=function(t,e){this._validate32(t,(qh-this._days)/e,"days")};ft.prototype._validateNanos=function(t,e){this._validate64(t,nt.MAX_VALUE.subtract(this._nanoseconds).divide(e),"nanoseconds")};ft.prototype._validate32=function(t,e,r){if(t>e)throw new TypeError(Ei.format("Invalid duration. The total number of %s must be less or equal to %s",r,qh))};ft.prototype._validate64=function(t,e,r){if(t.greaterThan(e))throw new TypeError(Ei.format("Invalid duration. The total number of %s must be less or equal to %s",r,nt.MAX_VALUE.toString()))};ft.prototype._getUnitName=function(t){let e=this._unitByIndex[+t];if(!e)throw new Error("unknown unit index: "+t);return e};ft.prototype.add=function(t,e){let r=this._addMethods[e.toLowerCase()];if(!r)throw new TypeError(Ei.format("Unknown duration symbol '%s'",e));return r.call(this,t)};ft.prototype.addYears=function(t){let e=+t;return this._validateOrder(1),this._validateMonths(e,Fh),this._months+=e*Fh,this};ft.prototype.addMonths=function(t){let e=+t;return this._validateOrder(2),this._validateMonths(e,1),this._months+=e,this};ft.prototype.addWeeks=function(t){let e=+t;return this._validateOrder(3),this._validateDays(e,TC),this._days+=e*TC,this};ft.prototype.addDays=function(t){let e=+t;return this._validateOrder(4),this._validateDays(e,1),this._days+=e,this};ft.prototype.addHours=function(t){let e=typeof t=="string"?nt.fromString(t):t;return this._validateOrder(5),this._validateNanos(e,kh),this._nanoseconds=this._nanoseconds.add(e.multiply(kh)),this};ft.prototype.addMinutes=function(t){let e=typeof t=="string"?nt.fromString(t):t;return this._validateOrder(6),this._validateNanos(e,nu),this._nanoseconds=this._nanoseconds.add(e.multiply(nu)),this};ft.prototype.addSeconds=function(t){let e=typeof t=="string"?nt.fromString(t):t;return this._validateOrder(7),this._validateNanos(e,ru),this._nanoseconds=this._nanoseconds.add(e.multiply(ru)),this};ft.prototype.addMillis=function(t){let e=typeof t=="string"?nt.fromString(t):t;return this._validateOrder(8),this._validateNanos(e,tu),this._nanoseconds=this._nanoseconds.add(e.multiply(tu)),this};ft.prototype.addMicros=function(t){let e=typeof t=="string"?nt.fromString(t):t;return this._validateOrder(9),this._validateNanos(e,eu),this._nanoseconds=this._nanoseconds.add(e.multiply(eu)),this};ft.prototype.addNanos=function(t){let e=typeof t=="string"?nt.fromString(t):t;return this._validateOrder(10),this._validateNanos(e,nt.ONE),this._nanoseconds=this._nanoseconds.add(e),this};ft.prototype.build=function(){return this._isNegative?new Rn(-this._months,-this._days,this._nanoseconds.negate()):new Rn(this._months,this._days,this._nanoseconds)};var Xs=function(){function t(d){return d.toUnsigned().shiftLeft(1).xor(d.shiftRight(63))}c(t,"encodeZigZag64");function e(d){return d.shiftRightUnsigned(1).xor(d.and(nt.ONE).negate())}c(e,"decodeZigZag64");function r(d,y){return n(t(d),y)}c(r,"writeVInt");function n(d,y){let v=i(d);return v===1?(y[0]=d.getLowBits(),1):(s(d,v,y),v)}c(n,"writeUnsignedVInt");function i(d){return 639-o(d.or(nt.ONE))*9>>6}c(i,"computeUnsignedVIntSize");function s(d,y,v){let m=y-1,w=d.getLowBits(),x,A=4;for(x=m;x>=0&&A-- >0;x--)v[x]=255&w,w>>=8;for(w=d.getHighBits();x>=0;x--)v[x]=255&w,w>>=8;v[0]|=a(m)}c(s,"encodeVInt");function o(d){if(d.equals(nt.ZERO))return 64;let y=1,v=d.getHighBits();return v===0&&(y+=32,v=d.getLowBits()),v>>>16||(y+=16,v<<=16),v>>>24||(y+=8,v<<=8),v>>>28||(y+=4,v<<=4),v>>>30||(y+=2,v<<=2),y-=v>>>31,y}c(o,"numberOfLeadingZeros");function a(d){return~(255>>d)}c(a,"encodeExtraBytesToRead");function u(d,y){return e(l(d,y))}c(u,"readVInt");function l(d,y){let v=d[y.value++];if(!(v&128))return nt.fromInt(v);let m=f(v),w=p(m),x=nt.fromInt(m&g(w));for(let A=0;A<w;A++){let O=nt.fromInt(d[y.value++]);x=x.shiftLeft(8).or(O)}return x}c(l,"readUnsignedVInt");function f(d){return d>127?d-256:d}c(f,"fromSignedByteToInt");function h(d){if(d===0)return 32;let y=1;return d>>>16||(y+=16,d<<=16),d>>>24||(y+=8,d<<=8),d>>>28||(y+=4,d<<=4),d>>>30||(y+=2,d<<=2),y-=d>>>31,y}c(h,"numberOfLeadingZerosInt32");function p(d){return h(~d)-24}c(p,"numberOfExtraBytesToRead");function g(d){return 255>>d}return c(g,"firstByteValueMask"),{readVInt:u,writeVInt:r}}();bC.exports=Rn});var NC=_((eW,AC)=>{"use strict";var Vh=oe();function mn(t){if(!(t instanceof Buffer)||t.length!==4&&t.length!==16)throw new TypeError("The ip address must contain 4 or 16 bytes");this.buffer=t,this.length=t.length,this.version=t.length===4?4:6}c(mn,"InetAddress");mn.fromString=function(t){if(!t)return new mn(Vh.allocBufferFromArray([0,0,0,0]));let e=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,r=/^[\da-f:.]+$/i,n;if(e.test(t))return n=t.split("."),new mn(Vh.allocBufferFromArray(n));if(!r.test(t))throw new TypeError("Value could not be parsed as InetAddress: "+t);if(n=t.split(":"),n.length<3)throw new TypeError("Value could not be parsed as InetAddress: "+t);let i=Vh.allocBufferUnsafe(16),s=8-n.length+1,o=!1,a=0,u=e.test(n[n.length-1]);u&&(s-=1);function l(f){i.writeUInt8(+f,a++)}c(l,"writeItem");for(let f=0;f<n.length;f++){let h=n[f];if(h){if(u&&f===n.length-1){h.split(".").forEach(l);break}i.writeUInt16BE(parseInt(h,16),a),a=a+2;continue}o&&(s=1),o=!0;for(let p=0;p<s;p++)i[a++]=0,i[a++]=0}if(u&&!xF(i))throw new TypeError("Only IPv4-Mapped IPv6 addresses are allowed as IPv6 address with embedded IPv4 address");return new mn(i)};mn.prototype.equals=function(t){return t instanceof mn?this.buffer.length===t.buffer.length&&this.buffer.toString("hex")===t.buffer.toString("hex"):!1};mn.prototype.getBuffer=function(){return this.buffer};mn.prototype.inspect=function(){return this.constructor.name+": "+this.toString()};mn.prototype.toString=function(t){if(t==="hex")return this.buffer.toString("hex");if(this.buffer.length===4)return this.buffer[0]+"."+this.buffer[1]+"."+this.buffer[2]+"."+this.buffer[3];let e=-1,r={length:0,start:-1};function n(s){if(e>=0){let o=s-e;o>r.length&&(r.length=o,r.start=e,e=-1)}}c(n,"checkLongest");for(let s=0;s<this.buffer.length;s=s+2){if(this.buffer[s]===0&&this.buffer[s+1]===0){e<0&&(e=s),s===this.buffer.length-2&&n(s+2);continue}n(s)}let i="";for(let s=0;s<this.buffer.length;s=s+2){if(s===r.start){i+=":";continue}s<r.start+r.length&&s>r.start||(i.length>0&&(i+=":"),i+=(this.buffer[s]<<8|this.buffer[s+1]).toString(16))}return i.charAt(i.length-1)===":"&&(i+=":"),i};mn.prototype.toJSON=function(){return this.toString()};function xF(t){for(let e=0;e<t.length-6;e++)if(t[e]!==0)return!1;return!(t[10]!==255||t[11]!==255)}c(xF,"isValidIPv4Mapped");AC.exports=mn});var DC=_((rW,OC)=>{"use strict";var TF=require("util"),BC=oe(),su=864e5,RC=Math.pow(2,31);function It(t,e,r){if(typeof t=="number"&&typeof e=="number"&&typeof r=="number"){if(this.date=new Date,this.date.setUTCHours(0,0,0,0),this.date.setUTCFullYear(t,e-1,r),isNaN(this.date.getTime()))throw new Error(TF.format("%d-%d-%d does not form a valid ES5 date!",t,e,r))}else if(typeof e>"u"&&typeof r>"u"&&typeof t=="number"){if(t<-2147483648||t>2147483647)throw new Error("You must provide a valid value for days since epoch (-2147483648 <= value <= 2147483647).");this.date=new Date(t*su)}if(typeof this.date>"u")throw new Error("You must provide a valid year, month and day");this._value=isNaN(this.date.getTime())?t:null,this.year=this.date.getUTCFullYear(),this.month=this.date.getUTCMonth()+1,this.day=this.date.getUTCDate()}c(It,"LocalDate");It.now=function(){return It.fromDate(new Date)};It.utcNow=function(){return new It(Date.now())};It.fromDate=function(t){if(isNaN(t.getTime()))throw new TypeError("Invalid date: "+t);return new It(t.getFullYear(),t.getMonth()+1,t.getDate())};It.fromString=function(t){if((t.match(/-/g)||[]).length>=2){let r=1;t[0]==="-"&&(t=t.substring(1),r=-1);let n=t.split("-");return new It(r*parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10))}if(t.match(/^-?\d+$/))return new It(parseInt(t,10));throw new Error("Invalid input '"+t+"'.")};It.fromBuffer=function(t){return new It(t.readUInt32BE(0)-RC)};It.prototype.compare=function(t){let e=isNaN(this.date.getTime())?this._value*su:this.date.getTime(),r=isNaN(t.date.getTime())?t._value*su:t.date.getTime(),n=e-r;return n<0?-1:n>0?1:0};It.prototype.equals=function(t){return t instanceof It&&this.compare(t)===0};It.prototype.inspect=function(){return this.constructor.name+": "+this.toString()};It.prototype.toBuffer=function(){let e=(isNaN(this.date.getTime())?this._value:Math.floor(this.date.getTime()/su))+RC,r=BC.allocBufferUnsafe(4);return r.writeUInt32BE(e,0),r};It.prototype.toString=function(){let t;return isNaN(this.date.getTime())?this._value.toString():(this.year<0?t="-"+iu((this.year*-1).toString(),4):t=iu(this.year.toString(),4),t+="-"+iu(this.month.toString(),2)+"-"+iu(this.day.toString(),2),t)};It.prototype.toJSON=function(){return this.toString()};function iu(t,e){return t.length>=e?t:BC.stringRepeat("0",e-t.length)+t}c(iu,"fillZeros");OC.exports=It});var kC=_((iW,PC)=>{"use strict";var Si=rs(),Mh=require("util"),Kh=oe(),_F=Si.fromString("86399999999999"),LC=Si.fromNumber(1e9),bF=Si.fromNumber(1e6),IF=864e5;function xt(t){if(!(t instanceof Si))throw new Error("You must specify a Long value as totalNanoseconds");if(t.lessThan(Si.ZERO)||t.greaterThan(_F))throw new Error("Total nanoseconds out of range");this.value=t,this.hour=this._getParts()[0],this.minute=this._getParts()[1],this.second=this._getParts()[2],this.nanosecond=this._getParts()[3]}c(xt,"LocalTime");xt.fromString=function(t){if(typeof t!="string")throw new Error("Argument type invalid: "+Mh.inspect(t));let e=t.split(":"),r=parseInt(e[0],10)*36e5+parseInt(e[1],10)*6e4,n;if(e.length===3){let i=e[2].split(".");r+=parseInt(i[0],10)*1e3,i.length===2&&(n=i[1],n=n+Kh.stringRepeat("0",9-n.length))}return xt.fromMilliseconds(r,parseInt(n,10)||0)};xt.now=function(t){return xt.fromDate(new Date,t)};xt.fromDate=function(t,e){if(!Mh.isDate(t))throw new Error("Not a valid date");let r=(t.getTime()+t.getTimezoneOffset()*-6e4)%IF;return xt.fromMilliseconds(r,e)};xt.fromMilliseconds=function(t,e){return typeof e!="number"&&(e=0),new xt(Si.fromNumber(t).multiply(bF).add(Si.fromNumber(e)))};xt.fromBuffer=function(t){if(!(t instanceof Buffer))throw new TypeError("Expected Buffer, obtained "+Mh.inspect(t));return new xt(new Si(t.readInt32BE(4),t.readInt32BE(0)))};xt.prototype.compare=function(t){return this.value.compare(t.value)};xt.prototype.equals=function(t){return t instanceof xt&&this.compare(t)===0};xt.prototype.getTotalNanoseconds=function(){return this.value};xt.prototype.inspect=function(){return this.constructor.name+": "+this.toString()};xt.prototype.toBuffer=function(){let t=Kh.allocBufferUnsafe(8);return t.writeUInt32BE(this.value.getHighBitsUnsigned(),0),t.writeUInt32BE(this.value.getLowBitsUnsigned(),4),t};xt.prototype.toString=function(){return AF(this._getParts())};xt.prototype.toJSON=function(){return this.toString()};xt.prototype._getParts=function(){if(!this._partsCache){let t=[0,0,0,0],e=this.value.div(LC);t[3]=this.value.subtract(e.multiply(LC)).toNumber(),t[2]=e.toNumber(),t[2]>=60&&(t[1]=Math.floor(t[2]/60),t[2]=t[2]%60),t[1]>=60&&(t[0]=Math.floor(t[1]/60),t[1]=t[1]%60),this._partsCache=t}return this._partsCache};function AF(t){let e;if(t[0]<10?e="0"+t[0]+":":e=t[0]+":",t[1]<10?e+="0"+t[1]+":":e+=t[1]+":",t[2]<10?e+="0"+t[2]:e+=t[2],t[3]>0){let r=t[3].toString();r.length<9&&(r=Kh.stringRepeat("0",9-r.length)+r);let n;for(let i=r.length-1;i>0&&r[i]==="0";i--)n=i;n&&(r=r.substring(0,n)),e+="."+r}return e}c(AF,"formatTime");PC.exports=xt});var qC=_((oW,FC)=>{"use strict";var NF=oe(),BF=ze(),RF=Symbol.asyncIterator||"@@asyncIterator";function Ci(t,e,r,n,i,s){n===-1&&(n=0),this.info={queriedHost:e,triedHosts:r,speculativeExecutions:n,achievedConsistency:i,traceId:null,warnings:null,customPayload:null,isSchemaInAgreement:s},t.flags&&(this.info.traceId=t.flags.traceId,this.info.warnings=t.flags.warnings,this.info.customPayload=t.flags.customPayload),this.rows=t.rows,this.rowLength=this.rows?this.rows.length:t.rowLength,this.columns=null,this.pageState=null,this.nextPage=void 0,this.nextPageAsync=void 0;let o=t.meta;o&&(this.columns=o.columns,o.pageState&&(this.pageState=o.pageState.toString("hex"),Object.defineProperty(this,"rawPageState",{value:o.pageState,enumerable:!1})))}c(Ci,"ResultSet");Ci.prototype.first=function(){return this.rows&&this.rows.length?this.rows[0]:null};Ci.prototype.getPageState=function(){return this.pageState};Ci.prototype.getColumns=function(){return this.columns};Ci.prototype.wasApplied=function(){if(!this.rows||this.rows.length===0)return!0;let e=this.rows[0]["[applied]"];return typeof e=="boolean"?e:!0};Ci.prototype[Symbol.iterator]=c(function(){return this.rows?this.rows[Symbol.iterator]():NF.emptyArray[Symbol.iterator]()},"getIterator");Ci.prototype[RF]=c(function(){let e=0,r=this.rawPageState,n=this.rows;if(!n||n.length===0)return{next:()=>Promise.resolve({done:!0})};let i=this;return{async next(){if(e>=n.length&&r){if(!i.nextPageAsync)throw new BF.DriverInternalError("Property nextPageAsync should be set when pageState is defined");let s=await i.nextPageAsync(r);n=s.rows,e=0,r=s.rawPageState}return e<n.length?{done:!1,value:n[e++]}:{done:!0}}}},"getAsyncGenerator");Ci.prototype.isPaged=function(){return!!this.rawPageState};FC.exports=Ci});var VC=_((cW,UC)=>{"use strict";var{Readable:OF}=require("stream"),DF=oe(),LF=ze(),PF=ma(),$h=class $h extends OF{constructor(e){super(e),this.buffer=[],this.paused=!0,this._cancelAllowed=!1,this._handlersObject=null,this._highWaterMarkRows=0}_read(){for(this.paused=!1,this.buffer.length===0&&(this._readableState.reading=!1);!this.paused&&this.buffer.length>0;)this.paused=!this.push(this.buffer.shift());this._checkBelowHighWaterMark(),!this.paused&&!this.buffer.length&&this._readNext&&(this._readNext(),this._readNext=null)}_valve(e){this._readNext=null,e&&(this.paused||this.buffer.length?this._readNext=e:e())}add(e){let r=this.buffer.push(e);return this.read(0),this._checkAboveHighWaterMark(),r}_checkAboveHighWaterMark(){!this._handlersObject||!this._handlersObject.resumeReadingHandler||this._highWaterMarkRows===0||this.buffer.length!==this._highWaterMarkRows||this._handlersObject.resumeReadingHandler(!1)}_checkBelowHighWaterMark(){!this._handlersObject||!this._handlersObject.resumeReadingHandler||this._highWaterMarkRows===0||this.buffer.length>=this._highWaterMarkRows||this._handlersObject.resumeReadingHandler(!0)}cancel(e){if(!this._cancelAllowed){let r=new Error("You can only cancel streaming executions when continuous paging is enabled");if(!e)throw r;return e(r)}if(!this._handlersObject)throw new LF.DriverInternalError("ResultStream cancel is allowed but the cancel options were not set");if(e=e||DF.noop,!this._handlersObject.cancelHandler){this._handlersObject.cancelHandler=e;return}this._handlersObject.cancelHandler(e)}setHandlers(e){e.continuousPaging&&(this._cancelAllowed=!0,this._handlersObject=e,this._highWaterMarkRows=e.continuousPaging.highWaterMarkRows||PF.continuousPageDefaultHighWaterMark)}};c($h,"ResultStream");var Hh=$h;UC.exports=Hh});var KC=_((lW,MC)=>{"use strict";function va(t){if(!t)throw new Error("Columns not defined");Object.defineProperty(this,"__columns",{value:t,enumerable:!1,writable:!1})}c(va,"Row");va.prototype.get=function(t){return typeof t=="number"?this[this.__columns[t].name]:this[t]};va.prototype.values=function(){let t=[];return this.forEach(function(e){t.push(e)}),t};va.prototype.keys=function(){let t=[];return this.forEach(function(e,r){t.push(r)}),t};va.prototype.forEach=function(t){for(let e in this)this.hasOwnProperty(e)&&t(this[e],e)};MC.exports=va});var $C=_((hW,HC)=>{"use strict";function ns(...t){if(this.elements=t,this.elements.length===0)throw new TypeError("Tuple must contain at least one value");this.length=this.elements.length}c(ns,"Tuple");ns.fromArray=function(t){return new ns(...t)};ns.prototype.get=function(t){return this.elements[t||0]};ns.prototype.toString=function(){return"("+this.elements.reduce(function(t,e,r){return t+(r>0?",":"")+e.toString()},"")+")"};ns.prototype.toJSON=function(){return this.elements};ns.prototype.values=function(){return this.elements.slice(0)};HC.exports=ns});var Ke=_(Me=>{"use strict";var Ca=require("util"),Ea=ze(),GC=gC(),Gh=Rh(),cu=vC(),Sa=oe(),Gr=rs(),jr={any:0,one:1,two:2,three:3,quorum:4,all:5,localQuorum:6,eachQuorum:7,serial:8,localSerial:9,localOne:10},zr={};zr[jr.any]="ANY";zr[jr.one]="ONE";zr[jr.two]="TWO";zr[jr.three]="THREE";zr[jr.quorum]="QUORUM";zr[jr.all]="ALL";zr[jr.localQuorum]="LOCAL_QUORUM";zr[jr.eachQuorum]="EACH_QUORUM";zr[jr.serial]="SERIAL";zr[jr.localSerial]="LOCAL_SERIAL";zr[jr.localOne]="LOCAL_ONE";var au={custom:0,ascii:1,bigint:2,blob:3,boolean:4,counter:5,decimal:6,double:7,float:8,int:9,text:10,timestamp:11,uuid:12,varchar:13,varint:14,timeuuid:15,inet:16,date:17,time:18,smallint:19,tinyint:20,duration:21,list:32,map:33,set:34,udt:48,tuple:49,getByName:function(t){if(t=t.toLowerCase(),t.indexOf("<")>0){let r=/^(list|set)<(.+)>$/.exec(t);if(r)return{code:this[r[1]],info:this.getByName(r[2])};let n=/^(map)< *(.+) *, *(.+)>$/.exec(t);if(n)return{code:this[n[1]],info:[this.getByName(n[2]),this.getByName(n[3])]};let i=/^(udt)<(.+)>$/.exec(t);if(i)return{code:this[i[1]],info:i[2]};let s=/^(tuple)<(.+)>$/.exec(t);if(s)return{code:this[s[1]],info:s[2].split(",").map(function(o){return this.getByName(o.trim())},this)}}let e={code:this[t],info:null};if(typeof e.code!="number")throw new TypeError("Data type with name "+t+" not valid");return e}},kF=function(){let t={};for(let e in au){if(!au.hasOwnProperty(e))continue;let r=au[e];typeof r=="number"&&(t[r]=e)}return t}(),FF={local:0,remote:1,ignored:2},qF={error:0,startup:1,ready:2,authenticate:3,credentials:4,options:5,supported:6,query:7,result:8,prepare:9,execute:10,register:11,event:12,batch:13,authChallenge:14,authResponse:15,authSuccess:16,cancel:255,isInRange:function(t){return t>this.error&&t>this.event}},UF={topologyChange:"TOPOLOGY_CHANGE",statusChange:"STATUS_CHANGE",schemaChange:"SCHEMA_CHANGE"},VF={serverError:0,protocolError:10,badCredentials:256,unavailableException:4096,overloaded:4097,isBootstrapping:4098,truncateError:4099,writeTimeout:4352,readTimeout:4608,readFailure:4864,functionFailure:5120,writeFailure:5376,syntaxError:8192,unauthorized:8448,invalid:8704,configError:8960,alreadyExists:9216,unprepared:9472,clientWriteFailure:32768},MF={voidResult:1,rows:2,setKeyspace:3,prepared:4,schemaChange:5},KF={compression:1,tracing:2,customPayload:4,warning:8},HF=Object.freeze({unset:!0}),$F=Gr.fromInt(1e3),ou=0;function GF(t,e,r){let n,i,s,o;t&&(typeof t.msecs=="number"&&(n=new Date(t.msecs)),t.msecs instanceof Date&&(n=t.msecs),Array.isArray(t.node)&&(s=Sa.allocBufferFromArray(t.node)),typeof t.clockseq=="number"&&(o=Sa.allocBufferUnsafe(2),o.writeUInt16BE(t.clockseq,0)),typeof t.nsecs=="number"&&(i=t.nsecs));let a=new GC(n,i,s,o);return e instanceof Buffer?(a.getBuffer().copy(e,r||0),e):a.toString()}c(GF,"timeuuid");function jF(t,e,r){let n;return t&&Array.isArray(t.random)&&(n=new Gh(Sa.allocBufferFromArray(t.random))),n||(n=Gh.random()),e instanceof Buffer?(n.getBuffer().copy(e,r||0),e):n.toString()}c(jF,"uuid");function jh(t){if(!t||typeof t.code!="number")throw new Ea.ArgumentError("Invalid signature type definition");let e=kF[t.code];if(!e)throw new Ea.ArgumentError(Ca.format("Type with code %d not found",t.code));return t.info?Array.isArray(t.info)?e+"<"+t.info.map(function(r){return jh(r)}).join(", ")+">":typeof t.info.code=="number"?e+"<"+jh(t.info)+">":e:e}c(jh,"getDataTypeNameByCode");function is(t,e,r,n,i){this.version=t,this.flags=e,this.streamId=r,this.opcode=n,this.bodyLength=i}c(is,"FrameHeader");is.size=function(t){return cu.uses2BytesStreamIds(t)?9:8};is.getProtocolVersion=function(t){return t[0]&127};is.fromBuffer=function(t,e){let r=0;e||(e=0);let n=t[e++]&127,i=t.readUInt8(e++);return cu.uses2BytesStreamIds(n)?(r=t.readInt16BE(e),e+=2):r=t.readInt8(e++),new is(n,i,r,t.readUInt8(e++),t.readUInt32BE(e))};is.prototype.toBuffer=function(){let t=Sa.allocBufferUnsafe(is.size(this.version));t.writeUInt8(this.version,0),t.writeUInt8(this.flags,1);let e=3;return cu.uses2BytesStreamIds(this.version)?(t.writeInt16BE(this.streamId,2),e=4):t.writeInt8(this.streamId,2),t.writeUInt8(this.opcode,e++),t.writeUInt32BE(this.bodyLength,e),t};Gr.fromBuffer=function(t){if(!(t instanceof Buffer))throw new TypeError("Expected Buffer, obtained "+Ca.inspect(t));return new Gr(t.readInt32BE(4),t.readInt32BE(0))};Gr.toBuffer=function(t){if(!(t instanceof Gr))throw new TypeError("Expected Long, obtained "+Ca.inspect(t));let e=Sa.allocBufferUnsafe(8);return e.writeUInt32BE(t.getHighBitsUnsigned(),0),e.writeUInt32BE(t.getLowBitsUnsigned(),4),e};Gr.prototype.inspect=function(){return"Long: "+this.toString()};Gr.prototype.toJSON=function(){return this.toString()};function zF(t,e){t||(t=new Date);let r=Gr.ZERO;return typeof e=="number"&&e>=0&&e<1e3?r=Gr.fromInt(e):(ou>999&&(ou=0),r=Gr.fromInt(ou),ou++),Gr.fromNumber(t.getTime()).multiply($F).add(r)}c(zF,"generateTimestamp");function jC(t){jC.super_.call(this,t.message,this.constructor),this.internalError=t}c(jC,"QueryParserError");Ca.inherits(jC,Ea.DriverError);function zh(t){zh.super_.call(this,t,this.constructor),this.info="Represents an error that happens when the maximum amount of time for an operation passed."}c(zh,"TimeoutError");Ca.inherits(zh,Ea.DriverError);Me.opcodes=qF;Me.consistencies=jr;Me.consistencyToString=zr;Me.dataTypes=au;Me.getDataTypeNameByCode=jh;Me.distance=FF;Me.frameFlags=KF;Me.protocolEvents=UF;Me.protocolVersion=cu;Me.responseErrorCodes=VF;Me.resultKind=MF;Me.timeuuid=GF;Me.uuid=jF;Me.BigDecimal=xC();Me.Duration=IC();Me.FrameHeader=is;Me.InetAddress=NC();Me.Integer=Ph();Me.LocalDate=DC();Me.LocalTime=kC();Me.Long=Gr;Me.ResultSet=qC();Me.ResultStream=VC();Me.Row=KC();Me.DriverError=Ea.DriverError;Me.TimeoutError=zh;Me.TimeUuid=GC;Me.Tuple=$C();Me.Uuid=Gh;Me.unset=HF;Me.generateTimestamp=zF});var YC=_((yW,QC)=>{"use strict";var wa=require("util"),ei=Ke(),uu=oe(),Wh=ze(),Yh=Object.freeze({done:!0}),WF=6e4;function vn(){}c(vn,"LoadBalancingPolicy");vn.prototype.init=function(t,e,r){this.client=t,this.hosts=e,r()};vn.prototype.getDistance=function(t){return ei.distance.local};vn.prototype.newQueryPlan=function(t,e,r){r(new Error("You must implement a query plan for the LoadBalancingPolicy class"))};vn.prototype.getOptions=function(){return new Map};function Zh(){this.index=0}c(Zh,"RoundRobinPolicy");wa.inherits(Zh,vn);Zh.prototype.newQueryPlan=function(t,e,r){if(!this.hosts)return r(new Error("Load balancing policy not initialized"));let n=this.hosts.values(),i=this,s=0,o=i.index%n.length;i.index+=1,i.index>=uu.maxInt&&(i.index=0),r(null,{next:function(){return++s>n.length?Yh:{value:n[o++%n.length],done:!1}}})};function ti(t){this.localDc=t,this.index=0,this.localHostsArray=null}c(ti,"DCAwareRoundRobinPolicy");wa.inherits(ti,vn);ti.prototype.init=function(t,e,r){this.client=t,this.hosts=e,e.on("add",this._cleanHostCache.bind(this)),e.on("remove",this._cleanHostCache.bind(this));try{WC(this,t,this.hosts)}catch(n){return r(n)}r()};ti.prototype.getDistance=function(t){return t.datacenter===this.localDc?ei.distance.local:ei.distance.ignored};ti.prototype._cleanHostCache=function(){this.localHostsArray=null};ti.prototype._resolveLocalHosts=function(){let t=this.hosts.values();this.localHostsArray||(this.localHostsArray=[],t.forEach(function(e){e.datacenter&&e.datacenter===this.localDc&&this.localHostsArray.push(e)},this))};ti.prototype.newQueryPlan=function(t,e,r){if(!this.hosts)return r(new Error("Load balancing policy not initialized"));this.index+=1,this.index>=uu.maxInt&&(this.index=0),this._resolveLocalHosts();let n=this.localHostsArray,i=this.index,s=0;r(null,{next:function(){let o;return s++<n.length?(o=n[i++%n.length],{value:o,done:!1}):Yh}})};ti.prototype.getOptions=function(){return new Map([["localDataCenter",this.localDc]])};function Js(t){if(!t)throw new Error("You must specify a child load balancing policy");this.childPolicy=t}c(Js,"TokenAwarePolicy");wa.inherits(Js,vn);Js.prototype.init=function(t,e,r){this.client=t,this.hosts=e,this.childPolicy.init(t,e,r)};Js.prototype.getDistance=function(t){return this.childPolicy.getDistance(t)};Js.prototype.newQueryPlan=function(t,e,r){let n;e&&(n=e.getRoutingKey(),e.getKeyspace()&&(t=e.getKeyspace()));let i;if(n&&(i=this.client.getReplicas(t,n)),!n||!i)return this.childPolicy.newQueryPlan(t,e,r);new Xh(t,e,i,this.childPolicy).iterate(r)};function Xh(t,e,r,n){this.keyspace=t,this.childPolicy=n,this.options=e,this.localReplicas=[],this.replicaIndex=0,this.replicaMap={},this.childIterator=null;for(let i=0;i<r.length;i++){let s=r[i];this.childPolicy.getDistance(s)===ei.distance.local&&(this.replicaMap[s.address]=!0,this.localReplicas.push(s))}this.startIndex=Math.floor(Math.random()*this.localReplicas.length)}c(Xh,"TokenAwareIterator");Xh.prototype.iterate=function(t){let e=this;this.childPolicy.newQueryPlan(this.keyspace,this.options,function(r,n){if(r)return t(r);e.childIterator=n,t(null,{next:function(){return e.computeNext()}})})};Xh.prototype.computeNext=function(){let t;if(this.replicaIndex<this.localReplicas.length)return t=this.localReplicas[(this.startIndex+this.replicaIndex++)%this.localReplicas.length],{value:t,done:!1};let e;for(;(e=this.childIterator.next())&&!e.done;)if(!this.replicaMap[e.value.address])return e;return Yh};Js.prototype.getOptions=function(){let t=new Map([["childPolicy",this.childPolicy.constructor!==void 0?this.childPolicy.constructor.name:null]]);return this.childPolicy instanceof ti&&t.set("localDataCenter",this.childPolicy.localDc),t};function On(t,e){if(!t)throw new Error("You must specify a child load balancing policy");if(!Array.isArray(e))throw new Error("You must provide the list of allowed host addresses");this.childPolicy=t,this.allowList=new Map(e.map(r=>[r,!0]))}c(On,"AllowListPolicy");wa.inherits(On,vn);On.prototype.init=function(t,e,r){this.childPolicy.init(t,e,r)};On.prototype.getDistance=function(t){return this._contains(t)?this.childPolicy.getDistance(t):ei.distance.ignored};On.prototype._contains=function(t){return!!this.allowList.get(t.address)};On.prototype.newQueryPlan=function(t,e,r){let n=this;this.childPolicy.newQueryPlan(t,e,function(i,s){if(i)return r(i);r(null,n._filter(s))})};On.prototype._filter=function(t){let e=this;return{next:function(){let r=t.next();return!r.done&&!e._contains(r.value)?this.next():r}}};On.prototype.getOptions=function(){return new Map([["childPolicy",this.childPolicy.constructor!==void 0?this.childPolicy.constructor.name:null],["allowList",Array.from(this.allowList.keys())]])};function zC(t,e){On.call(this,t,e)}c(zC,"WhiteListPolicy");wa.inherits(zC,On);var lu=class lu extends vn{constructor(e){super(),typeof e=="string"?e={localDc:e}:e||(e=uu.emptyObject),this._client=null,this._hosts=null,this._filteredHosts=null,this._preferredHost=null,this._index=0,this.localDc=e.localDc,this._filter=e.filter||this._defaultFilter,e.isHostNewlyUp&&(this._isHostNewlyUp=e.isHostNewlyUp),e.healthCheck&&(this._healthCheck=e.healthCheck),e.compare&&(this._compare=e.compare),e.getReplicas&&(this._getReplicas=e.getReplicas)}init(e,r,n){this._client=e,this._hosts=r,this._hosts.on("add",()=>this._filteredHosts=null),this._hosts.on("remove",()=>this._filteredHosts=null);try{WC(this,e,this._hosts)}catch(i){return n(i)}n()}getDistance(e){return this._preferredHost!==null&&e===this._preferredHost||this._filter(e)&&e.datacenter===this.localDc?ei.distance.local:ei.distance.ignored}newQueryPlan(e,r,n){let i,s;r&&(i=r.getRoutingKey(),r.getKeyspace()&&(e=r.getKeyspace()),s=r.getPreferredHost());let o;return!e||!i?o=this._getLocalHosts():o=this._getReplicasAndLocalHosts(e,i),s&&(this._preferredHost=s,o=lu._getPreferredHostFirst(s,o)),n(null,o)}static*_getPreferredHostFirst(e,r){yield e;for(let n of r)n!==e&&(yield n)}*_getLocalHosts(e){let r=this._getFilteredLocalHosts(),n=this._getIndex(),i=e?s=>e.indexOf(s)===-1:s=>!0;for(let s=0;s<r.length;s++){let o=r[(s+n)%r.length];i(o)&&o.isUp()&&(yield o)}}_getReplicasAndLocalHosts(e,r){let n=this._getReplicas(e,r);if(n===null)return this._getLocalHosts();let i=[],s=null,o=Number.MIN_SAFE_INTEGER,a=0;for(let l=0;l<n.length;l++){let f=n[l];if(!this._filter(f)||f.datacenter!==this.localDc||!f.isUp())continue;let h=this._isHostNewlyUp(f);h!==null&&h>o&&(s=f,o=h),s===null&&!this._healthCheck(f)&&a++,i.push(f)}if(n=i,uu.shuffleArray(n),n.length<3)return this.yieldReplicasFirst(n);let u;if(s===null)a>0&&a<Math.floor(n.length/2+1)&&this._sendUnhealthyToTheBack(n,a);else if((s===n[0]||s===n[1])&&Math.random()*4>=1){let l=s===n[0]?0:1;u=n[n.length-1],n[n.length-1]=n[l],n[l]=u}return this._compare(n[1],n[0])>0&&(u=n[0],n[0]=n[1],n[1]=u),this.yieldReplicasFirst(n)}*yieldReplicasFirst(e){for(let r=0;r<e.length;r++)yield e[r];yield*this._getLocalHosts(e)}_isHostNewlyUp(e){return e.isUpSince!==null&&Date.now()-e.isUpSince<WF?e.isUpSince:null}_healthCheck(e){return!(e.getInFlight()>=10&&e.getResponseCount()<=1)}_compare(e,r){return e.getInFlight()<r.getInFlight()?1:-1}_getReplicas(e,r){return this._client.getReplicas(e,r)}_getFilteredLocalHosts(){return this._filteredHosts===null&&(this._filteredHosts=this._hosts.values().filter(e=>this._filter(e)&&e.datacenter===this.localDc)),this._filteredHosts}_getIndex(){let e=this._index++;return this._index===2147483647&&(this._index=0),e}_sendUnhealthyToTheBack(e,r){let n=0;for(let i=e.length-1;i>=0&&n<r;i--){let s=e[i];if(this._healthCheck(s))continue;let o=e.length-1-n;if(o!==i){let a=e[o];e[o]=s,e[i]=a}n++}}_defaultFilter(){return!0}getOptions(){return new Map([["localDataCenter",this.localDc],["filterFunction",this._filter!==this._defaultFilter]])}};c(lu,"DefaultLoadBalancingPolicy");var Qh=lu;function WC(t,e,r){if(!(t instanceof vn))throw new Wh.DriverInternalError("LoadBalancingPolicy instance was not provided");e&&e.options&&(t.localDc&&!e.options.localDataCenter&&e.log("info",`Local data center '${t.localDc}' was provided as an argument to the load-balancing policy. It is preferable to specify the local data center using 'localDataCenter' in Client options instead when your application is targeting a single data center.`),t.localDc=t.localDc||e.options.localDataCenter);let n=QF(r);if(!t.localDc)throw new Wh.ArgumentError(`'localDataCenter' is not defined in Client options and also was not specified in constructor. At least one is required. Available DCs are: [${Array.from(n)}]`);if(!n.has(t.localDc))throw new Wh.ArgumentError(`Datacenter ${t.localDc} was not found. Available DCs are: [${Array.from(n)}]`)}c(WC,"setLocalDc");function QF(t){return new Set(t.values().map(e=>e.datacenter))}c(QF,"getDataCenters");QC.exports={AllowListPolicy:On,DCAwareRoundRobinPolicy:ti,DefaultLoadBalancingPolicy:Qh,LoadBalancingPolicy:vn,RoundRobinPolicy:Zh,TokenAwarePolicy:Js,WhiteListPolicy:zC}});var XC=_(hu=>{"use strict";var ZC=require("util");function xa(){}c(xa,"ReconnectionPolicy");xa.prototype.newSchedule=function(){throw new Error("You must implement a new schedule for the Reconnection class")};xa.prototype.getOptions=function(){return new Map};function fu(t){this.delay=t}c(fu,"ConstantReconnectionPolicy");ZC.inherits(fu,xa);fu.prototype.newSchedule=function(){let t=this;return{next:function(){return{value:t.delay,done:!1}}}};fu.prototype.getOptions=function(){return new Map([["delay",this.delay]])};function Ta(t,e,r){this.baseDelay=t,this.maxDelay=e,this.startWithNoDelay=r}c(Ta,"ExponentialReconnectionPolicy");ZC.inherits(Ta,xa);Ta.prototype.newSchedule=function*(){let t=this.startWithNoDelay?-1:0;for(;;){let e=0;t>=64?e=this.maxDelay:t!==-1&&(e=Math.min(Math.pow(2,t)*this.baseDelay,this.maxDelay)),t++,yield this._addJitter(e)}};Ta.prototype._addJitter=function(t){if(t===0)return t;let e=.85,r=.3;return!this.startWithNoDelay&&t===this.baseDelay?(e=1,r=.15):t===this.maxDelay&&(r=.15),Math.floor(t*(Math.random()*r+e))};Ta.prototype.getOptions=function(){return new Map([["baseDelay",this.baseDelay],["maxDelay",this.maxDelay],["startWithNoDelay",this.startWithNoDelay]])};hu.ReconnectionPolicy=xa;hu.ConstantReconnectionPolicy=fu;hu.ExponentialReconnectionPolicy=Ta});var Jh=_(du=>{"use strict";var JC=require("util");function kr(){}c(kr,"RetryPolicy");kr.prototype.onUnavailable=function(t,e,r,n){return t.nbRetry>0?this.rethrowResult():this.retryResult(void 0,!1)};kr.prototype.onReadTimeout=function(t,e,r,n,i){return t.nbRetry>0?this.rethrowResult():r>=n&&!i?this.retryResult():this.rethrowResult()};kr.prototype.onWriteTimeout=function(t,e,r,n,i){return t.nbRetry>0?this.rethrowResult():i==="BATCH_LOG"?this.retryResult():this.rethrowResult()};kr.prototype.onRequestError=function(t,e,r){return this.retryResult(void 0,!1)};kr.prototype.retryResult=function(t,e){return{decision:kr.retryDecision.retry,consistency:t,useCurrentHost:e!==!1}};kr.prototype.rethrowResult=function(){return{decision:kr.retryDecision.rethrow}};kr.retryDecision={rethrow:0,retry:1,ignore:2};function eo(t){this._childPolicy=t||new kr}c(eo,"IdempotenceAwareRetryPolicy");JC.inherits(eo,kr);eo.prototype.onReadTimeout=function(t,e,r,n,i){return this._childPolicy.onReadTimeout(t,e,r,n,i)};eo.prototype.onRequestError=function(t,e,r){return t.executionOptions.isIdempotent()?this._childPolicy.onRequestError(t,e,r):this.rethrowResult()};eo.prototype.onUnavailable=function(t,e,r,n){return this._childPolicy.onUnavailable(t,e,r,n)};eo.prototype.onWriteTimeout=function(t,e,r,n,i){return t.executionOptions.isIdempotent()?this._childPolicy.onWriteTimeout(t,e,r,n,i):this.rethrowResult()};function to(){}c(to,"FallthroughRetryPolicy");JC.inherits(to,kr);to.prototype.onReadTimeout=function(){return this.rethrowResult()};to.prototype.onRequestError=function(){return this.rethrowResult()};to.prototype.onUnavailable=function(){return this.rethrowResult()};to.prototype.onWriteTimeout=function(){return this.rethrowResult()};du.IdempotenceAwareRetryPolicy=eo;du.FallthroughRetryPolicy=to;du.RetryPolicy=kr});var rw=_(gu=>{"use strict";var tw=require("util"),ew=ze();function ss(){}c(ss,"SpeculativeExecutionPolicy");ss.prototype.init=function(t){};ss.prototype.shutdown=function(){};ss.prototype.newPlan=function(t,e){throw new Error("You must implement newPlan() method in the SpeculativeExecutionPolicy")};ss.prototype.getOptions=function(){return new Map};function ed(){this._plan={nextExecution:function(){return-1}}}c(ed,"NoSpeculativeExecutionPolicy");tw.inherits(ed,ss);ed.prototype.newPlan=function(){return this._plan};function pu(t,e){if(!(t>=0))throw new ew.ArgumentError("delay must be a positive number or zero");if(!(e>0))throw new ew.ArgumentError("maxSpeculativeExecutions must be a positive number");this._delay=t,this._maxSpeculativeExecutions=e}c(pu,"ConstantSpeculativeExecutionPolicy");tw.inherits(pu,ss);pu.prototype.newPlan=function(){let t=0,e=this;return{nextExecution:function(){return t++<e._maxSpeculativeExecutions?e._delay:-1}}};pu.prototype.getOptions=function(){return new Map([["delay",this._delay],["maxSpeculativeExecutions",this._maxSpeculativeExecutions]])};gu.NoSpeculativeExecutionPolicy=ed;gu.SpeculativeExecutionPolicy=ss;gu.ConstantSpeculativeExecutionPolicy=pu});var iw=_(nd=>{"use strict";var nw=require("util"),{Long:td}=Ke(),YF=ze(),ZF=9007199254740,XF=td.fromInt(1e3);function rd(){}c(rd,"TimestampGenerator");rd.prototype.next=function(t){throw new Error("next() must be implemented")};function _a(t,e){if(t<0)throw new YF.ArgumentError("warningThreshold can not be lower than 0");this._warningThreshold=t||1e3,this._minLogInterval=1e3,typeof e=="number"&&(this._minLogInterval=e),this._micros=-1,this._lastDate=0,this._lastLogDate=0}c(_a,"MonotonicTimestampGenerator");nw.inherits(_a,rd);_a.prototype.getDate=function(){return Date.now()};_a.prototype.next=function(t){let e=this.getDate(),r=0;if(e>this._lastDate)return this._micros=0,this._lastDate=e,this._generateMicroseconds();e<this._lastDate&&(r=this._lastDate-e,e=this._lastDate),++this._micros===1e3&&(this._micros=0,e===this._lastDate&&(e++,r++));let n=this._lastDate;this._lastDate=e;let i=this._generateMicroseconds();if(r>=this._warningThreshold){let s=Date.now();if(this._minLogInterval>0&&this._lastLogDate+this._minLogInterval<=s){let o=nw.format("Timestamp generated using current date was %d milliseconds behind the last generated timestamp (which millisecond portion was %d), the returned value (%s) is being artificially incremented to guarantee monotonicity.",r,n,i);this._lastLogDate=s,t.log("warning",o)}}return i};_a.prototype._generateMicroseconds=function(){return this._lastDate<ZF?this._lastDate*1e3+this._micros:td.fromNumber(this._lastDate).multiply(XF).add(td.fromInt(this._micros))};nd.TimestampGenerator=rd;nd.MonotonicTimestampGenerator=_a});var yu=_(Fr=>{"use strict";var JF=Fr.addressResolution=nC(),e3=Fr.loadBalancing=YC(),t3=Fr.reconnection=XC(),r3=Fr.retry=Jh(),n3=Fr.speculativeExecution=rw(),i3=Fr.timestampGeneration=iw();Fr.defaultAddressTranslator=function(){return new JF.AddressTranslator};Fr.defaultLoadBalancingPolicy=function(t){return new e3.DefaultLoadBalancingPolicy(t)};Fr.defaultRetryPolicy=function(){return new r3.RetryPolicy};Fr.defaultReconnectionPolicy=function(){return new t3.ExponentialReconnectionPolicy(1e3,10*60*1e3,!1)};Fr.defaultSpeculativeExecutionPolicy=function(){return new n3.NoSpeculativeExecutionPolicy};Fr.defaultTimestampGenerator=function(){return new i3.MonotonicTimestampGenerator}});var od=_((IW,sw)=>{"use strict";var sd=class sd{onSuccess(e,r,n,i,s,o,a){}onError(e,r,n,i,s,o,a){}shutdown(){}};c(sd,"RequestTracker");var id=sd;sw.exports=id});var fw=_((NW,lw)=>{"use strict";var s3=require("events"),o3=od(),a3=ze(),{format:ba}=require("util"),c3=1e6,u3=500,l3=50,ow=200,cd=class cd extends o3{constructor(e){if(super(),!e)throw new a3.ArgumentError("RequestLogger options parameter is required");this._options=e,this.logNormalRequests=this._options.logNormalRequests,this.logErroredRequests=this._options.logErroredRequests,this.emitter=new s3.EventEmitter}onSuccess(e,r,n,i,s,o,a){this._options.slowThreshold>0&&ro(a)>this._options.slowThreshold?this._logSlow(e,r,n,i,s,o,a):this._options.requestSizeThreshold>0&&s>this._options.requestSizeThreshold?this._logLargeRequest(e,r,n,i,s,o,a):this.logNormalRequests&&this._logNormalRequest(e,r,n,i,s,o,a)}onError(e,r,n,i,s,o,a){this._options.requestSizeThreshold>0&&s>this._options.requestSizeThreshold?this._logLargeErrorRequest(e,r,n,i,s,o,a):this.logErroredRequests&&this._logErrorRequest(e,r,n,i,s,o,a)}_logSlow(e,r,n,i,s,o,a){let u=ba("[%s] Slow request, took %d ms (%s): %s",e.address,Math.floor(ro(a)),Aa(s,o),Ia(r,n,i,this._options));this.emitter.emit("slow",u)}_logLargeRequest(e,r,n,i,s,o,a){let u=ba("[%s] Request exceeded length, %s (took %d ms): %s",e.address,Aa(s,o),~~ro(a),Ia(r,n,i,this._options));this.emitter.emit("large",u)}_logNormalRequest(e,r,n,i,s,o,a){let u=ba("[%s] Request completed normally, took %d ms (%s): %s",e.address,~~ro(a),Aa(s,o),Ia(r,n,i,this._options));this.emitter.emit("normal",u)}_logLargeErrorRequest(e,r,n,i,s,o,a){let u=this._options.messageMaxErrorStackTraceLength||ow,l=ba("[%s] Request exceeded length and execution failed, %s (took %d ms): %s; error: %s",e.address,Aa(s),~~ro(a),Ia(r,n,i,this._options),o.stack.substr(0,u));this.emitter.emit("large",l)}_logErrorRequest(e,r,n,i,s,o,a){let u=this._options.messageMaxErrorStackTraceLength||ow,l=ba("[%s] Request execution failed, took %d ms (%s): %s; error: %s",e.address,~~ro(a),Aa(s),Ia(r,n,i,this._options),o.stack.substr(0,u));this.emitter.emit("failure",l)}};c(cd,"RequestLogger");var ad=cd;function ro(t){return t[0]*1e3+t[1]/c3}c(ro,"toMillis");function Ia(t,e,r,n){let i=n.messageMaxQueryLength||u3,s=n.messageMaxParameterValueLength||l3;if(Array.isArray(t))return f3(t,r,i,s);let o=t.substr(0,i),a=i-o.length-1;return o+=uw(e,a,s),r.isPrepared()||(o+=" (not prepared)"),o}c(Ia,"getStatementInfo");function f3(t,e,r,n){let i=(e.isBatchLogged()?"LOGGED ":"")+"BATCH w/ "+t.length+(e.isPrepared()?"":" not prepared")+" queries (",s=r,o;for(o=0;o<t.length&&s>0;o++){let a=t[o],u=a.params;typeof a!="string"&&(a=a.query),o>0&&(i+=",",s--);let l=Math.min(s,a.length);if(i+=a.substr(0,l),s-=l,s<=0)break;let f=uw(u,s,n);s-=f.length,i+=f}return i+=o<t.length?",...)":")",i}c(f3,"getBatchStatementInfo");function uw(t,e,r){if(e<=3)return" [...]";if(!t)return" []";let n=c((o,a)=>aw(t[o],a),"paramStringifier");if(!Array.isArray(t)){let o=t;t=Object.keys(t),n=c((a,u)=>{let l=t[a],f=l.substr(0,u),h=u-f.length-1;return h<=0||(f+=":"+aw(o[l],h)),f},"paramStringifier")}let i=" [",s;for(s=0;e>0&&s<t.length;s++){s>0&&(i+=",",e--);let o=n(s,Math.min(r,e));e-=o.length,i+=o}return s<t.length&&(i+="..."),i+="]",i}c(uw,"getParametersInfo");function aw(t,e){return t===void 0?"undefined":t===null?"null":t.toString().substr(0,e)}c(aw,"formatParam");function Aa(t,e){let r="request size "+cw(t);return e!==void 0&&(r+=" / response size "+cw(e)),r}c(Aa,"getPayloadSizes");function cw(t){return t>1e3?Math.round(t/1024)+" KB":t+" bytes"}c(cw,"formatSize");lw.exports=ad});var ld=_(ud=>{"use strict";ud.RequestLogger=fw();ud.RequestTracker=od()});var dd=_((OW,hw)=>{"use strict";var hd=class hd{onAuthenticationError(e){}onClientTimeoutError(e){}onConnectionError(e){}onOtherError(e){}onReadTimeoutError(e){}onWriteTimeoutError(e){}onUnavailableError(e){}onClientTimeoutRetry(e){}onOtherErrorRetry(e){}onReadTimeoutRetry(e){}onUnavailableRetry(e){}onWriteTimeoutRetry(e){}onIgnoreError(e){}onSpeculativeExecution(){}onSuccessfulResponse(e){}onResponse(e){}};c(hd,"ClientMetrics");var fd=hd;hw.exports=fd});var pw=_((LW,dw)=>{"use strict";var h3=dd(),Kt=require("events"),gd=class gd extends h3{constructor(){super(),this.errors=new Kt,this.errors.authentication=new Kt,this.errors.clientTimeout=new Kt,this.errors.connection=new Kt,this.errors.other=new Kt,this.errors.readTimeout=new Kt,this.errors.unavailable=new Kt,this.errors.writeTimeout=new Kt,this.retries=new Kt,this.retries.clientTimeout=new Kt,this.retries.other=new Kt,this.retries.readTimeout=new Kt,this.retries.unavailable=new Kt,this.retries.writeTimeout=new Kt,this.speculativeExecutions=new Kt,this.ignoredErrors=new Kt,this.responses=new Kt,this.responses.success=new Kt}onAuthenticationError(e){this.errors.authentication.emit("increment",e),this.errors.emit("increment",e)}onConnectionError(e){this.errors.connection.emit("increment",e),this.errors.emit("increment",e)}onReadTimeoutError(e){this.errors.readTimeout.emit("increment",e),this.errors.emit("increment",e)}onWriteTimeoutError(e){this.errors.writeTimeout.emit("increment",e),this.errors.emit("increment",e)}onUnavailableError(e){this.errors.unavailable.emit("increment",e),this.errors.emit("increment",e)}onClientTimeoutError(e){this.errors.clientTimeout.emit("increment",e),this.errors.emit("increment",e)}onOtherError(e){this.errors.other.emit("increment",e),this.errors.emit("increment",e)}onClientTimeoutRetry(e){this.retries.clientTimeout.emit("increment",e),this.retries.emit("increment",e)}onOtherErrorRetry(e){this.retries.other.emit("increment",e),this.retries.emit("increment",e)}onReadTimeoutRetry(e){this.retries.readTimeout.emit("increment",e),this.retries.emit("increment",e)}onUnavailableRetry(e){this.retries.unavailable.emit("increment",e),this.retries.emit("increment",e)}onWriteTimeoutRetry(e){this.retries.writeTimeout.emit("increment",e),this.retries.emit("increment",e)}onIgnoreError(e){this.ignoredErrors.emit("increment",e)}onSpeculativeExecution(){this.speculativeExecutions.emit("increment")}onSuccessfulResponse(e){this.responses.success.emit("increment",e)}onResponse(e){this.responses.emit("increment",e)}};c(gd,"DefaultMetrics");var pd=gd;dw.exports=pd});var yd=_((kW,gw)=>{"use strict";var d3=dd(),p3=pw();gw.exports={ClientMetrics:d3,DefaultMetrics:p3}});var os=_(md=>{"use strict";function yw(){}c(yw,"AuthProvider");yw.prototype.newAuthenticator=function(t,e){throw new Error("This is an abstract class, you must implement newAuthenticator method or use another auth provider that inherits from this class")};function mu(){}c(mu,"Authenticator");mu.prototype.initialResponse=function(t){t(new Error("Not implemented"))};mu.prototype.evaluateChallenge=function(t,e){e(new Error("Not implemented"))};mu.prototype.onAuthenticationSuccess=function(t){};md.AuthProvider=yw;md.Authenticator=mu});var Ed=_((UW,Ew)=>{"use strict";var mw=require("util"),vw=os(),vu=oe(),g3=vw.AuthProvider,y3=vw.Authenticator;function vd(t,e){this.username=t,this.password=e}c(vd,"PlainTextAuthProvider");mw.inherits(vd,g3);vd.prototype.newAuthenticator=function(){return new Na(this.username,this.password)};function Na(t,e){this.username=t,this.password=e}c(Na,"PlainTextAuthenticator");mw.inherits(Na,y3);Na.prototype.initialResponse=function(t){let e=Buffer.concat([vu.allocBufferFromArray([0]),vu.allocBufferFromString(this.username,"utf8"),vu.allocBufferFromArray([0]),vu.allocBufferFromString(this.password,"utf8")]);t(null,e)};Na.prototype.evaluateChallenge=function(t,e){e()};Ew.exports={PlainTextAuthenticator:Na,PlainTextAuthProvider:vd}});var Sd=_((MW,Sw)=>{"use strict";var m3=require("util"),{Authenticator:v3}=os(),E3="com.datastax.bdp.cassandra.auth.DseAuthenticator";function no(t){this.authenticatorName=t}c(no,"BaseDseAuthenticator");m3.inherits(no,v3);no.prototype.getMechanism=function(){throw new Error("Not implemented")};no.prototype.getInitialServerChallenge=function(){throw new Error("Not implemented")};no.prototype.initialResponse=function(t){if(!this._isDseAuthenticator())return this.evaluateChallenge(this.getInitialServerChallenge(),t);t(null,this.getMechanism())};no.prototype._isDseAuthenticator=function(){return this.authenticatorName===E3};Sw.exports=no});var xw=_((HW,ww)=>{"use strict";var S3=require("util"),Cw=oe(),wd=class wd{constructor(e,r){this.authorizationId=e,this.service=r!==void 0?r:"dse"}init(e,r){throw new Error("Not implemented")}evaluateChallenge(e,r){throw new Error("Not implemented")}shutdown(e){throw new Error("Not implemented")}static createNew(e,r,n){return new Cd(e,r,n)}};c(wd,"GssapiClient");var Eu=wd,xd=class xd extends Eu{constructor(e,r,n){if(typeof e.initializeClient!="function")throw new Error("The driver expects version 1.x of the kerberos library");super(r,n),this.kerberos=e,this.transitionIndex=0}init(e,r){this.host=e;let n=this.service;this.host&&(n=S3.format("%s@%s",this.service,this.host));let i={gssFlags:this.kerberos.GSS_C_MUTUAL_FLAG};this.kerberos.initializeClient(n,i,(s,o)=>{if(s)return r(s);this.kerberosClient=o,r()})}evaluateChallenge(e,r){this["transition"+this.transitionIndex](e,(n,i)=>{if(n)return r(n);this.transitionIndex++,r(null,i?Cw.allocBufferFromString(i,"base64"):Cw.allocBuffer(0))})}transition0(e,r){this.kerberosClient.step("",r)}transition1(e,r){let n=e.toString("base64");this.kerberosClient.step(n,r)}transition2(e,r){this.kerberosClient.unwrap(e.toString("base64"),(n,i)=>{if(n)return r(n,!1);let s=c(function(o,a){if(o)return r(o);r(null,a)},"cb");this.authorizationId!==void 0?this.kerberosClient.wrap(i,{user:this.authorizationId},s):this.kerberosClient.wrap(i,null,s)})}shutdown(e){this.kerberosClient=null,e()}};c(xd,"StandardGssClient");var Cd=xd;ww.exports=Eu});var Aw=_((GW,Iw)=>{"use strict";var Tw=require("util"),{AuthProvider:C3}=os(),_w=Sd(),w3=xw(),Td=require("dns"),Ba=oe(),x3=Ba.allocBufferFromString("GSSAPI"),bw="GSSAPI-START",T3=Ba.allocBuffer(0);function wi(t){try{this._kerberos=require("kerberos")}catch(e){if(e.code==="MODULE_NOT_FOUND"){let r=new Error('You must install module "kerberos" to use GSSAPI auth provider: https://www.npmjs.com/package/kerberos');throw r.code=e.code,r}throw e}t=t||Ba.emptyObject,this.authorizationId=t.authorizationId||t.user,this.service=t.service,this.hostNameResolver=t.hostNameResolver||wi.lookupServiceResolver}c(wi,"DseGssapiAuthProvider");Tw.inherits(wi,C3);wi.prototype.newAuthenticator=function(t,e){let r=t;return t.indexOf(":")>0&&(r=t.split(":")[0]),new as(this._kerberos,r,e,this.authorizationId,this.service,this.hostNameResolver)};wi.lookupServiceResolver=function(t,e){if(!Td.lookupService)return wi.reverseDnsResolver(t,e);Td.lookupService(t,0,function(r,n){if(r)return e(r);if(!n)return e(null,t);e(null,n)})};wi.reverseDnsResolver=function(t,e){Td.reverse(t,function(r,n){if(r)return e(r);if(!n||!n.length)return e(null,t);e(null,n[0])})};wi.useIpResolver=function(t,e){e(null,t)};function as(t,e,r,n,i,s){_w.call(this,r),this.authorizationId=n,this.address=e,this.client=w3.createNew(t,n,i),this.hostNameResolver=s}c(as,"GssapiAuthenticator");Tw.inherits(as,_w);as.prototype.getMechanism=function(){return x3};as.prototype.getInitialServerChallenge=function(){return Ba.allocBufferFromString(bw)};as.prototype.initialResponse=function(t){let e=this,r=this.address;Ba.series([c(function(i){e.hostNameResolver(e.address,function(s,o){!s&&o&&(r=o),i()})},"getHostName"),c(function(i){e.client.init(r,function(s){if(s)return i(s);if(!e._isDseAuthenticator())return e.evaluateChallenge(e.getInitialServerChallenge(),i);i(null,e.getMechanism())})},"initClient")],t)};as.prototype.evaluateChallenge=function(t,e){(!t||t.toString()===bw)&&(t=T3),this.client.evaluateChallenge(t,e)};as.prototype.onAuthenticationSuccess=function(t){this.client.shutdown(c(function(){},"noop"))};Iw.exports=wi});var Lw=_((zW,Dw)=>{"use strict";var Bw=require("util"),{AuthProvider:_3}=os(),Rw=Sd(),io=oe(),b3=io.allocBufferFromString("PLAIN"),Nw=io.allocBufferFromArray([0]),Ow="PLAIN-START";function _d(t,e,r){if(typeof t!="string"||typeof e!="string")throw new TypeError("Username and password must be a string");this.username=t,this.password=e,this.authorizationId=r}c(_d,"DsePlainTextAuthProvider");Bw.inherits(_d,_3);_d.prototype.newAuthenticator=function(t,e){return new Ra(e,this.username,this.password,this.authorizationId)};function Ra(t,e,r,n){Rw.call(this,t),this.authenticatorId=io.allocBufferFromString(e),this.password=io.allocBufferFromString(r),this.authorizationId=io.allocBufferFromString(n||"")}c(Ra,"PlainTextAuthenticator");Bw.inherits(Ra,Rw);Ra.prototype.getMechanism=function(){return b3};Ra.prototype.getInitialServerChallenge=function(){return io.allocBufferFromString(Ow)};Ra.prototype.evaluateChallenge=function(t,e){if(!t||t.toString()!==Ow)return e(new Error("Incorrect SASL challenge from server"));e(null,Buffer.concat([this.authorizationId,Nw,this.authenticatorId,Nw,this.password]))};Dw.exports=_d});var kw=_((QW,Pw)=>{"use strict";var{AuthProvider:I3,Authenticator:A3}=os(),{PlainTextAuthenticator:N3}=Ed(),B3=ze(),R3="com.datastax.bdp.cassandra.auth.DseAuthenticator",Nd=class Nd extends I3{newAuthenticator(e,r){return r===R3?new Ad:new Id(e)}};c(Nd,"NoAuthProvider");var bd=Nd,Bd=class Bd extends A3{constructor(e){super(),this.endpoint=e}initialResponse(e){e(new B3.AuthenticationError(`Host ${this.endpoint} requires authentication, but no authenticator found in the options`))}};c(Bd,"NoAuthAuthenticator");var Id=Bd,Rd=class Rd extends N3{constructor(){super("","")}};c(Rd,"TransitionalModePlainTextAuthenticator");var Ad=Rd;Pw.exports=bd});var Oa=_((ZW,Fw)=>{"use strict";var{Authenticator:O3,AuthProvider:D3}=os(),{PlainTextAuthProvider:L3}=Ed(),P3=Aw(),k3=Lw(),F3=kw();Fw.exports={Authenticator:O3,AuthProvider:D3,DseGssapiAuthProvider:P3,DsePlainTextAuthProvider:k3,NoAuthProvider:F3,PlainTextAuthProvider:L3}});var ma=_(Cn=>{"use strict";var qw=require("util"),En=yu(),Sn=Ke(),Uw=oe(),q3=ld(),Vw=yd(),Od=Oa(),Mw={[Sn.distance.local]:2,[Sn.distance.remote]:1,[Sn.distance.ignored]:0},Kw={[Sn.distance.local]:1,[Sn.distance.remote]:1,[Sn.distance.ignored]:0},Hw=128,$w=2048,U3="bytes",V3=5e3,M3=1e4;function Gw(){return{policies:{addressResolution:En.defaultAddressTranslator(),loadBalancing:En.defaultLoadBalancingPolicy(),reconnection:En.defaultReconnectionPolicy(),retry:En.defaultRetryPolicy(),speculativeExecution:En.defaultSpeculativeExecutionPolicy(),timestampGeneration:En.defaultTimestampGenerator()},queryOptions:{fetchSize:5e3,prepare:!1,captureStackTrace:!1},protocolOptions:{port:9042,maxSchemaAgreementWaitSeconds:10,maxVersion:0,noCompact:!1},pooling:{heartBeatInterval:3e4,warmup:!0},socketOptions:{connectTimeout:5e3,defunctReadTimeoutThreshold:64,keepAlive:!0,keepAliveDelay:0,readTimeout:12e3,tcpNoDelay:!0,coalescingThreshold:65536},authProvider:null,requestTracker:null,metrics:new Vw.DefaultMetrics,maxPrepared:500,refreshSchemaDelay:1e3,isMetadataSyncEnabled:!0,prepareOnAllHosts:!0,rePrepareOnUp:!0,encoding:{copyBuffer:!0,useUndefinedAsUnset:!0},monitorReporting:{enabled:!0}}}c(Gw,"defaultOptions");function K3(t,e){arguments.length===1&&(e=arguments[0],t={});let r=Uw.deepExtend(t,Gw(),e);if(r.cloud)H3(r);else{if(!Array.isArray(r.contactPoints)||r.contactPoints.length===0)throw new TypeError("Contacts points are not defined.");for(let n=0;n<r.contactPoints.length;n++){let i=r.contactPoints[n];if(!i)throw new TypeError(qw.format("Contact point %s (%s) is not a valid host name, the following values are valid contact points: ipAddress, hostName or ipAddress:port",n,i))}r.sni=void 0}if(r.logEmitter||(r.logEmitter=function(){}),!r.queryOptions)throw new TypeError("queryOptions not defined in options");if(r.requestTracker!==null&&!(r.requestTracker instanceof q3.RequestTracker))throw new TypeError("requestTracker must be an instance of RequestTracker");if(!(r.metrics instanceof Vw.ClientMetrics))throw new TypeError("metrics must be an instance of ClientMetrics");if($3(r.policies),G3(r.protocolOptions),j3(r.socketOptions),z3(r),r.encoding=r.encoding||{},W3(r.encoding),r.profiles&&!Array.isArray(r.profiles))throw new TypeError("profiles must be an Array of ExecutionProfile instances");return Q3(r),Y3(r),r}c(K3,"extend");function H3(t){let e=t.cloud.secureConnectBundle;if(!(typeof e=="string"||typeof URL<"u"&&e instanceof URL))throw new TypeError("secureConnectBundle in cloud options must be of type string");if(t.contactPoints)throw new TypeError("Contact points can not be defined when cloud settings are provided");if(t.sslOptions)throw new TypeError("SSL options can not be defined when cloud settings are provided")}c(H3,"validateCloudOptions");function $3(t){if(!t)throw new TypeError("policies not defined in options");if(!(t.loadBalancing instanceof En.loadBalancing.LoadBalancingPolicy))throw new TypeError("Load balancing policy must be an instance of LoadBalancingPolicy");if(!(t.reconnection instanceof En.reconnection.ReconnectionPolicy))throw new TypeError("Reconnection policy must be an instance of ReconnectionPolicy");if(!(t.retry instanceof En.retry.RetryPolicy))throw new TypeError("Retry policy must be an instance of RetryPolicy");if(!(t.addressResolution instanceof En.addressResolution.AddressTranslator))throw new TypeError("Address resolution policy must be an instance of AddressTranslator");if(t.timestampGeneration!==null&&!(t.timestampGeneration instanceof En.timestampGeneration.TimestampGenerator))throw new TypeError("Timestamp generation policy must be an instance of TimestampGenerator")}c($3,"validatePoliciesOptions");function G3(t){if(!t)throw new TypeError("protocolOptions not defined in options");let e=t.maxVersion;if(e&&(typeof e!="number"||!Sn.protocolVersion.isSupported(e)))throw new TypeError(qw.format("protocolOptions.maxVersion provided (%s) is invalid",e))}c(G3,"validateProtocolOptions");function j3(t){if(!t)throw new TypeError("socketOptions not defined in options");if(typeof t.readTimeout!="number")throw new TypeError("socketOptions.readTimeout must be a Number");if(typeof t.coalescingThreshold!="number"||t.coalescingThreshold<=0)throw new TypeError("socketOptions.coalescingThreshold must be a positive Number")}c(j3,"validateSocketOptions");function z3(t){if(t.authProvider){if(!(t.authProvider instanceof Od.AuthProvider))throw new TypeError("options.authProvider must be an instance of AuthProvider")}else{let e=t.credentials;if(e){if(typeof e.username!="string"||typeof e.password!="string")throw new TypeError("credentials username and password must be a string");t.authProvider=new Od.PlainTextAuthProvider(e.username,e.password)}else t.authProvider=new Od.NoAuthProvider}}c(z3,"validateAuthenticationOptions");function W3(t){if(t.map){let e=t.map;if(typeof e!="function"||typeof e.prototype.forEach!="function"||typeof e.prototype.set!="function")throw new TypeError("Map constructor not valid")}if(t.set){let e=t.set;if(typeof e!="function"||typeof e.prototype.forEach!="function"||typeof e.prototype.add!="function")throw new TypeError("Set constructor not valid")}if((t.useBigIntAsLong||t.useBigIntAsVarint)&&typeof BigInt>"u")throw new TypeError("BigInt is not supported by the JavaScript engine")}c(W3,"validateEncodingOptions");function Q3(t){function e(r){let n=t[r];if(n!=null&&typeof n!="string")throw new TypeError(`${r} should be a String`)}if(c(e,"validateString"),e("applicationName"),e("applicationVersion"),t.id!==null&&t.id!==void 0&&!(t.id instanceof Sn.Uuid))throw new TypeError("Client id must be a Uuid")}c(Q3,"validateApplicationInfo");function Y3(t){let e=t.monitorReporting;if(e===null||typeof e!="object")throw new TypeError(`Monitor reporting must be an object, obtained: ${e}`)}c(Y3,"validateMonitorReporting");function Z3(t){let e=t.controlConnection.protocolVersion,r=Kw,n=$w;Sn.protocolVersion.uses2BytesStreamIds(e)||(r=Mw,n=Hw),t.options.queryOptions.consistency===void 0&&(t.options.queryOptions.consistency=t.metadata.isDbaas()?Sn.consistencies.localQuorum:Sn.consistencies.localOne),t.options.pooling=Uw.deepExtend({},{coreConnectionsPerHost:r,maxRequestsPerConnection:n},t.options.pooling)}c(Z3,"setMetadataDependent");Cn.extend=K3;Cn.defaultOptions=Gw;Cn.coreConnectionsPerHostV2=Mw;Cn.coreConnectionsPerHostV3=Kw;Cn.maxRequestsPerConnectionV2=Hw;Cn.maxRequestsPerConnectionV3=$w;Cn.setMetadataDependent=Z3;Cn.continuousPageUnitBytes=U3;Cn.continuousPageDefaultSize=V3;Cn.continuousPageDefaultHighWaterMark=M3});var kd=_((eQ,Ww)=>{"use strict";var jw=oe(),zw=Ke(),X3=fr();function Dd(t,e){if(typeof t!="string")throw new TypeError("Execution profile name must be a string");e=e||jw.emptyObject;let r=e.graphOptions||jw.emptyObject;this.name=t,this.consistency=e.consistency,this.loadBalancing=e.loadBalancing,this.readTimeout=e.readTimeout,this.retry=e.retry,this.serialConsistency=e.serialConsistency,this.graphOptions={language:r.language,results:r.results,name:r.name,readConsistency:r.readConsistency,source:r.source,writeConsistency:r.writeConsistency}}c(Dd,"ExecutionProfile");var Pd=class Pd{constructor(e){this._profiles=e.profiles||[],this._defaultConfiguredRetryPolicy=void 0,this._setDefault(e),this._loadBalancingPolicies=[],this._profilesMap={},this._customPayloadCache={},this._graphOptionsCache={},this._profiles.forEach(function(r){return this._profilesMap[r.name]=r,r.loadBalancing=r.loadBalancing||this._defaultProfile.loadBalancing,this._loadBalancingPolicies.indexOf(r.loadBalancing)===-1&&this._loadBalancingPolicies.push(r.loadBalancing),r},this)}async init(e,r){for(let n of this._loadBalancingPolicies)await X3.fromCallback(i=>n.init(e,r,i))}getDistance(e){let r=zw.distance.ignored;for(let n=0;n<this._loadBalancingPolicies.length;n++){let i=this._loadBalancingPolicies[n].getDistance(e);if(i<r&&(r=i,r===zw.distance.local))break}return e.setDistance(r),r}getProfile(e){return e instanceof Dd?e:this._profilesMap[e||"default"]}getDefault(){return this._defaultProfile}getDefaultLoadBalancing(){return this._defaultProfile.loadBalancing}getOrCreateGraphOptions(e,r){let n=this._graphOptionsCache[e.name];return n||(n=this._graphOptionsCache[e.name]=r()),n}_setDefault(e){this._defaultProfile=this._profiles.filter(function(r){return r.name==="default"})[0],this._defaultProfile||this._profiles.push(this._defaultProfile=new Dd("default")),this._defaultConfiguredRetryPolicy=this._defaultProfile.retry,this._defaultProfile.loadBalancing=this._defaultProfile.loadBalancing||e.policies.loadBalancing,this._defaultProfile.retry=this._defaultProfile.retry||e.policies.retry}getAll(){return this._profiles}getDefaultConfiguredRetryPolicy(){return this._defaultConfiguredRetryPolicy}};c(Pd,"ProfileManager");var Ld=Pd;Ww.exports={ProfileManager:Ld,ExecutionProfile:Dd}});var Md=_((rQ,Qw)=>{"use strict";var J3=require("events"),Su=Ke(),so=oe(),e4=Su.FrameHeader,Ud=class Ud{constructor(e){if(!e)throw new Error("Opcode not provided");this.buffers=[],this.opcode=e,this.bodyLength=0}add(e){this.buffers.push(e),this.bodyLength+=e.length}writeShort(e){let r=so.allocBufferUnsafe(2);r.writeUInt16BE(e,0),this.add(r)}writeInt(e){let r=so.allocBufferUnsafe(4);r.writeInt32BE(e,0),this.add(r)}writeLong(e){this.add(Su.Long.toBuffer(e))}writeBytes(e){if(e===null){this.writeInt(-1);return}if(e===Su.unset){this.writeInt(-2);return}this.writeInt(e.length),this.add(e)}writeShortBytes(e){if(e===null){this.writeShort(-1);return}this.writeShort(e.length),this.add(e)}writeByte(e){this.add(so.allocBufferFromArray([e]))}writeString(e){if(typeof e>"u")throw new Error("can not write undefined");let r=Buffer.byteLength(e,"utf8"),n=so.allocBufferUnsafe(2+r);n.writeUInt16BE(r,0),n.write(e,2,n.length-2,"utf8"),this.add(n)}writeLString(e){let r=Buffer.byteLength(e,"utf8"),n=so.allocBufferUnsafe(4+r);n.writeInt32BE(r,0),n.write(e,4,n.length-4,"utf8"),this.add(n)}writeStringList(e){this.writeShort(e.length),e.forEach(this.writeString,this)}writeCustomPayload(e){let r=Object.keys(e);this.writeShort(r.length),r.forEach(n=>{this.writeString(n),this.writeBytes(e[n])})}writeStringMap(e){let r=[];for(let n in e)e.hasOwnProperty(n)&&r.push(n);this.writeShort(r.length);for(let n=0;n<r.length;n++){let i=r[n];this.writeString(i),this.writeString(e[i])}}write(e,r,n){let s=new e4(e,n||0,r,this.opcode,this.bodyLength).toBuffer();return this.buffers.unshift(s),Buffer.concat(this.buffers,s.length+this.bodyLength)}};c(Ud,"FrameWriter");var Fd=Ud,Vd=class Vd extends J3.EventEmitter{constructor(e,r,n){super(),this.netClient=e,this.encoder=r,this.isRunning=!1,this.queue=[],this.coalescingThreshold=n.socketOptions.coalescingThreshold,this.error=null,this.canWrite=!0,e.on("drain",()=>{this.canWrite=!0,this.run()})}push(e,r){let n=this;if(this.error)return process.nextTick(c(function(){r(n.error)},"writePushError"));this.queue.push({operation:e,callback:r}),this.run()}run(){!this.isRunning&&this.canWrite&&(this.isRunning=!0,process.nextTick(()=>this.process()))}process(){if(this.error)return;let e=[],r=[],n=0;for(;this.queue.length>0&&n<this.coalescingThreshold;){let i=this.queue.shift();if(!i.operation.canBeWritten()){i.callback(new Error("The operation was already cancelled or timeout elapsed"));continue}let s;try{s=i.operation.request.write(this.encoder,i.operation.streamId)}catch(o){i.callback(o);continue}n+=s.length,e.push(s),r.push(i.callback)}if(n===0){this.isRunning=!1;return}for(let i=0;i<r.length;i++)r[i]();this.canWrite=this.netClient.write(Buffer.concat(e,n),i=>{if(i){this.setWriteError(i);return}if(this.queue.length===0||!this.canWrite){this.isRunning=!1;return}setImmediate(()=>this.process())})}setWriteError(e){e.isSocketError=!0,this.error=new Su.DriverError("Socket was closed"),this.error.isSocketError=!0,this.error.requestNotWritten=!0,this.error.innerError=e;let r=this.queue;this.queue=so.emptyArray;for(let n=0;n<r.length;n++)r[n].callback(this.error)}};c(Vd,"WriteQueue");var qd=Vd;Qw.exports={FrameWriter:Fd,WriteQueue:qd}});var xi=_((iQ,Zw)=>{"use strict";var Da=oe(),Yw=Ke(),t4=ze(),Cu="ProxyExecute",xu=class xu{constructor(){}static empty(){return new xu}getCaptureStackTrace(){}getConsistency(){}getCustomPayload(){}getFetchSize(){}getFixedHost(){}getHints(){}isAutoPage(){}isBatchCounter(){}isBatchLogged(){}isIdempotent(){}isPrepared(){}isQueryTracing(){}getKeyspace(){}getLoadBalancingPolicy(){}getPageState(){}getPreferredHost(){}getRawQueryOptions(){}getReadTimeout(){}getRetryPolicy(){}getRowCallback(){}getOrGenerateTimestamp(){}getRoutingIndexes(){}getRoutingKey(){}getRoutingNames(){}getSerialConsistency(){}getTimestamp(){}setHints(e){}setKeyspace(e){}setPageState(){}setPreferredHost(){}setRoutingIndexes(e){}setRoutingKey(e){}};c(xu,"ExecutionOptions");var wu=xu,Pa=class Pa extends wu{constructor(e,r,n){if(super(),this._queryOptions=e,this._rowCallback=n,this._routingKey=this._queryOptions.routingKey,this._hints=this._queryOptions.hints,this._keyspace=this._queryOptions.keyspace,this._routingIndexes=this._queryOptions.routingIndexes,this._pageState=typeof this._queryOptions.pageState=="string"?Da.allocBufferFromString(this._queryOptions.pageState,"hex"):this._queryOptions.pageState,this._preferredHost=null,this._client=r,this._defaultQueryOptions=r.options.queryOptions,this._profile=r.profileManager.getProfile(this._queryOptions.executionProfile),this._customPayload=Pa.createCustomPayload(this._queryOptions,this._defaultQueryOptions),!this._profile)throw new t4.ArgumentError(`Execution profile "${this._queryOptions.executionProfile}" not found`)}static createCustomPayload(e,r){let n=e.customPayload||r.customPayload,i=e.executeAs||r.executeAs;return i&&(n?n[Cu]||(n=Da.extend({},n),n[Cu]=Da.allocBufferFromString(i)):(n={},n[Cu]=Da.allocBufferFromString(i))),n}static create(e,r,n){return(!e||typeof e=="function")&&(e=Da.emptyObject),new Pa(e,r,n)}getCaptureStackTrace(){return cs(this._queryOptions.captureStackTrace,this._defaultQueryOptions.captureStackTrace)}getConsistency(){return La(this._queryOptions.consistency,this._profile.consistency,this._defaultQueryOptions.consistency)}getCustomPayload(){return this._customPayload}getFetchSize(){return cs(this._queryOptions.fetchSize,this._defaultQueryOptions.fetchSize)}getFixedHost(){return this._queryOptions.host}getHints(){return this._hints}isAutoPage(){return cs(this._queryOptions.autoPage,this._defaultQueryOptions.autoPage)}isBatchCounter(){return cs(this._queryOptions.counter,!1)}isBatchLogged(){return La(this._queryOptions.logged,this._defaultQueryOptions.logged,!0)}isIdempotent(){return cs(this._queryOptions.isIdempotent,this._defaultQueryOptions.isIdempotent)}isPrepared(){return cs(this._queryOptions.prepare,this._defaultQueryOptions.prepare)}isQueryTracing(){return cs(this._queryOptions.traceQuery,this._defaultQueryOptions.traceQuery)}getKeyspace(){return this._keyspace}getLoadBalancingPolicy(){return this._profile.loadBalancing}getOrGenerateTimestamp(){let e=this.getTimestamp();if(e===void 0){let r=this._client.options.policies.timestampGeneration;Yw.protocolVersion.supportsTimestamp(this._client.controlConnection.protocolVersion)&&r?e=r.next(this._client):e=null}return typeof e=="number"?Yw.Long.fromNumber(e):e}getPageState(){return this._pageState}getProfile(){return this._profile}getRawQueryOptions(){return this._queryOptions}getReadTimeout(){return La(this._queryOptions.readTimeout,this._profile.readTimeout,this._client.options.socketOptions.readTimeout)}getRetryPolicy(){return La(this._queryOptions.retry,this._profile.retry,this._client.options.policies.retry)}getRoutingIndexes(){return this._routingIndexes}getRoutingKey(){return this._routingKey}getRoutingNames(){return this._queryOptions.routingNames}getRowCallback(){return this._rowCallback}getSerialConsistency(){return La(this._queryOptions.serialConsistency,this._profile.serialConsistency,this._defaultQueryOptions.serialConsistency)}getTimestamp(){return this._queryOptions.timestamp}setCustomPayload(e){this._customPayload=e}setHints(e){this._hints=e}setKeyspace(e){this._keyspace=e}setPageState(e){this._pageState=e}setRoutingIndexes(e){this._routingIndexes=e}setRoutingKey(e){this._routingKey=e}};c(Pa,"DefaultExecutionOptions");var Kd=Pa;function cs(t,e){return t!==void 0?t:e}c(cs,"ifUndefined");function La(t,e,r){return t!==void 0?t:e!==void 0?e:r}c(La,"ifUndefined3");Zw.exports={ExecutionOptions:wu,DefaultExecutionOptions:Kd,proxyExecuteKey:Cu}});var oo=_((oQ,r4)=>{r4.exports={name:"cassandra-driver",version:"4.7.2",description:"DataStax Node.js Driver for Apache Cassandra",author:"DataStax",keywords:["cassandra","cql","cql3","connection","gremlin","datastax","nosql","driver","database","dse","graph","graphdb"],license:"Apache-2.0",types:"./index.d.ts",dependencies:{"@types/long":"~5.0.0","@types/node":">=8","adm-zip":"~0.5.10",long:"~5.2.3"},devDependencies:{chai:"~4.3.8",kerberos:"~2.0.3",mocha:"~10.2.0","mocha-jenkins-reporter":"~0.4.8",proxyquire:"~2.1.3",sinon:"~15.2.0",temp:">= 0.8.3"},repository:{type:"git",url:"https://github.com/datastax/nodejs-driver.git"},bugs:{url:"https://groups.google.com/a/lists.datastax.com/forum/#!forum/nodejs-driver-user"},scripts:{test:"./node_modules/.bin/mocha test/unit -R spec -t 5000 --recursive",unit:"./node_modules/.bin/mocha test/unit -R spec -t 5000 --recursive",integration_short:"./node_modules/.bin/mocha test/integration/short -R spec -t 5000 --recursive",integration_long:"./node_modules/.bin/mocha test/integration/long -R spec -t 5000 --recursive",ci_jenkins:"./node_modules/.bin/mocha test/unit test/integration/short --recursive -R mocha-jenkins-reporter --exit",ci_appveyor:"./node_modules/.bin/mocha test/unit test/integration/short --recursive -R mocha-appveyor-reporter --exit",ci_unit_appveyor:"./node_modules/.bin/mocha test/unit --recursive -R mocha-appveyor-reporter --exit",server_api:"./node_modules/.bin/mocha test/integration/short -g '@SERVER_API' --recursive --exit",eslint:"eslint lib test"},engines:{node:">=16"}}});var Ti=_(Qr=>{"use strict";var ex=require("util"),{FrameWriter:Dn}=Md(),Qe=Ke(),$d=oe(),{ExecutionOptions:n4}=xi(),Xw=oo(),qr={values:1,skipMetadata:2,pageSize:4,withPagingState:8,withSerialConsistency:16,withDefaultTimestamp:32,withNameForValues:64,withKeyspace:128,withPageSizeBytes:1073741824,withContinuousPaging:2147483648},ao={withSerialConsistency:16,withDefaultTimestamp:32,withNameForValues:64,withKeyspace:128},Jw={withKeyspace:1},Hd={logged:0,unlogged:1,counter:2},ep=class ep{constructor(){this.length=0}write(e,r){throw new Error("Method must be implemented")}clone(){let e=new this.constructor,r=Object.keys(this);for(let n=0;n<r.length;n++){let i=r[n];e[i]=this[i]}return e}};c(ep,"Request");var Wr=ep,tp=class tp extends Wr{constructor(e,r,n,i,s){super(),this.query=e,this.queryId=r,this.params=n,this.meta=s,this.options=i||n4.empty(),this.consistency=this.options.getConsistency()||Qe.consistencies.one,this.namedParameters=!1}getParamType(e){let r=this.meta.columns[e];return r?r.type:null}write(e,r){let n=new Dn(Qe.opcodes.execute),i=this.options.isQueryTracing()?Qe.frameFlags.tracing:0;return this.options.getCustomPayload()&&(i|=Qe.frameFlags.customPayload,n.writeCustomPayload(this.options.getCustomPayload())),n.writeShortBytes(this.queryId),Qe.protocolVersion.supportsResultMetadataId(e.protocolVersion)&&n.writeShortBytes(this.meta.resultId),this.writeQueryParameters(n,e),this.length=n.bodyLength,n.write(e.protocolVersion,r,i)}writeQueryParameters(e,r,n){let i=0,s=this.options.getOrGenerateTimestamp();if(Qe.protocolVersion.supportsPaging(r.protocolVersion)){i|=this.params&&this.params.length?qr.values:0,i|=this.options.getFetchSize()>0?qr.pageSize:0,i|=this.options.getPageState()?qr.withPagingState:0,i|=this.options.getSerialConsistency()?qr.withSerialConsistency:0,i|=s!=null?qr.withDefaultTimestamp:0,i|=this.namedParameters?qr.withNameForValues:0;let o=n&&Qe.protocolVersion.supportsKeyspaceInRequest(r.protocolVersion);i|=o&&this.options.getKeyspace()?qr.withKeyspace:0,e.writeShort(this.consistency),Qe.protocolVersion.uses4BytesQueryFlags(r.protocolVersion)?e.writeInt(i):e.writeByte(i)}if(this.params&&this.params.length){e.writeShort(this.params.length);for(let o=0;o<this.params.length;o++){let a=this.params[o];i&qr.withNameForValues&&(e.writeString(a.name),a=a.value),e.writeBytes(r.encode(a,this.getParamType(o)))}}if(!Qe.protocolVersion.supportsPaging(r.protocolVersion)){(!this.params||!this.params.length)&&e.writeShort(0),e.writeShort(this.consistency);return}i&qr.pageSize&&e.writeInt(this.options.getFetchSize()),i&qr.withPagingState&&e.writeBytes(this.options.getPageState()),i&qr.withSerialConsistency&&e.writeShort(this.options.getSerialConsistency()),i&qr.withDefaultTimestamp&&e.writeLong(s),i&qr.withKeyspace&&e.writeString(this.options.getKeyspace())}};c(tp,"ExecuteRequest");var Tu=tp,rp=class rp extends Tu{constructor(e,r,n,i){super(e,null,r,n,null),this.hints=this.options.getHints()||$d.emptyArray,this.namedParameters=i}getParamType(e){return this.hints[e]}write(e,r){let n=new Dn(Qe.opcodes.query),i=this.options.isQueryTracing()?Qe.frameFlags.tracing:0;return this.options.getCustomPayload()&&(i|=Qe.frameFlags.customPayload,n.writeCustomPayload(this.options.getCustomPayload())),n.writeLString(this.query),Qe.protocolVersion.supportsPaging(e.protocolVersion)?this.writeQueryParameters(n,e,!0):n.writeShort(this.consistency),this.length=n.bodyLength,n.write(e.protocolVersion,r,i)}};c(rp,"QueryRequest");var Gd=rp,np=class np extends Wr{constructor(e,r){super(),this.query=e,this.keyspace=r}write(e,r){let n=new Dn(Qe.opcodes.prepare);if(n.writeLString(this.query),Qe.protocolVersion.supportsPrepareFlags(e.protocolVersion)){let i=this.keyspace&&Qe.protocolVersion.supportsKeyspaceInRequest(e.protocolVersion)?Jw.withKeyspace:0;n.writeInt(i),i&Jw.withKeyspace&&n.writeString(this.keyspace)}return n.write(e.protocolVersion,r)}};c(np,"PrepareRequest");var jd=np,ip=class ip extends Wr{constructor(e){super(),this.options=e||{}}write(e,r){let n=new Dn(Qe.opcodes.startup),i={CQL_VERSION:this.options.cqlVersion||"3.0.0",DRIVER_NAME:Xw.description,DRIVER_VERSION:Xw.version};return this.options.noCompact&&(i.NO_COMPACT="true"),this.options.clientId&&(i.CLIENT_ID=this.options.clientId.toString()),this.options.applicationName&&(i.APPLICATION_NAME=this.options.applicationName),this.options.applicationVersion&&(i.APPLICATION_VERSION=this.options.applicationVersion),n.writeStringMap(i),n.write(e.protocolVersion,r)}};c(ip,"StartupRequest");var zd=ip,sp=class sp extends Wr{constructor(e){super(),this.events=e}write(e,r){let n=new Dn(Qe.opcodes.register);return n.writeStringList(this.events),n.write(e.protocolVersion,r)}};c(sp,"RegisterRequest");var Wd=sp,op=class op extends Wr{constructor(e){super(),this.token=e}write(e,r){let n=new Dn(Qe.opcodes.authResponse);return n.writeBytes(this.token),n.write(e.protocolVersion,r)}};c(op,"AuthResponseRequest");var Qd=op,ap=class ap extends Wr{constructor(e,r){super(),this.username=e,this.password=r}write(e,r){let n=new Dn(Qe.opcodes.credentials);return n.writeStringMap({username:this.username,password:this.password}),n.write(e.protocolVersion,r)}};c(ap,"CredentialsRequest");var Yd=ap,_u=class _u extends Wr{constructor(e,r){super(),this.queries=e,this.options=r,this.hints=r.getHints()||$d.emptyArray,this.type=Hd.logged,r.isBatchCounter()?this.type=Hd.counter:r.isBatchLogged()||(this.type=Hd.unlogged)}write(e,r){if(!this.queries||!(this.queries.length>0))throw new TypeError(ex.format("Invalid queries provided %s",this.queries));let n=new Dn(Qe.opcodes.batch),i=this.options.isQueryTracing()?Qe.frameFlags.tracing:0;this.options.getCustomPayload()&&(i|=Qe.frameFlags.customPayload,n.writeCustomPayload(this.options.getCustomPayload())),n.writeByte(this.type),n.writeShort(this.queries.length);let s=this;if(this.queries.forEach(c(function(a,u){let l=s.hints[u],f=a.params||$d.emptyArray,h;a.queryId?(n.writeByte(1),n.writeShortBytes(a.queryId),h=c(p=>a.meta.columns[p].type,"getParamType")):(n.writeByte(0),n.writeLString(a.query),h=l?p=>l[p]:()=>null),n.writeShort(f.length),f.forEach((p,g)=>n.writeBytes(e.encode(p,h(g))))},"eachQuery"),this),n.writeShort(this.options.getConsistency()),Qe.protocolVersion.supportsTimestamp(e.protocolVersion)){let o=this.options.getSerialConsistency()?ao.withSerialConsistency:0,a=this.options.getOrGenerateTimestamp();o|=a!=null?ao.withDefaultTimestamp:0,o|=this.options.getKeyspace()&&Qe.protocolVersion.supportsKeyspaceInRequest(e.protocolVersion)?ao.withKeyspace:0,Qe.protocolVersion.uses4BytesQueryFlags(e.protocolVersion)?n.writeInt(o):n.writeByte(o),o&ao.withSerialConsistency&&n.writeShort(this.options.getSerialConsistency()),o&ao.withDefaultTimestamp&&n.writeLong(a),o&ao.withKeyspace&&n.writeString(this.options.getKeyspace())}return this.length=n.bodyLength,n.write(e.protocolVersion,r,i)}clone(){return new _u(this.queries,this.options)}};c(_u,"BatchRequest");var Zd=_u;function Jd(t){this.streamId=null,this.operationId=t}c(Jd,"CancelRequest");ex.inherits(Jd,Wr);Jd.prototype.write=function(t,e){let r=new Dn(Qe.opcodes.cancel);return r.writeInt(1),r.writeInt(this.operationId),r.write(t.protocolVersion,e)};var cp=class cp extends Wr{write(e,r){return new Dn(Qe.opcodes.options).write(e.protocolVersion,r,0)}clone(){return this}};c(cp,"OptionsRequest");var Xd=cp,i4=new Xd;Qr.AuthResponseRequest=Qd;Qr.BatchRequest=Zd;Qr.CancelRequest=Jd;Qr.CredentialsRequest=Yd;Qr.ExecuteRequest=Tu;Qr.PrepareRequest=jd;Qr.QueryRequest=Gd;Qr.Request=Wr;Qr.RegisterRequest=Wd;Qr.StartupRequest=zd;Qr.options=i4});var nx=_((uQ,rx)=>{"use strict";var s4=require("util"),tx=ze(),bu=class bu{constructor(e,r,n){this._hosts=e,this._openConnections=r,this._inFlightQueries=n}getConnectedHosts(){return this._hosts}getOpenConnections(e){if(!e)throw new tx.ArgumentError("Host is not defined");return this._openConnections[e.address]||0}getInFlightQueries(e){if(!e)throw new tx.ArgumentError("Host is not defined");return this._inFlightQueries[e.address]||0}toString(){return s4.format('{"hosts": %j, "openConnections": %j, "inFlightQueries": %j}',this._hosts.map(function(e){return e.address}),this._openConnections,this._inFlightQueries)}static from(e){let r={},n={},i=[];return e.hosts.forEach(s=>{s.pool.connections.length!==0&&(i.push(s),r[s.address]=s.pool.connections.length,n[s.address]=s.getInFlight())}),new bu(i,r,n)}};c(bu,"ClientState");var up=bu;rx.exports=up});var fp=_((fQ,sx)=>{"use strict";var o4=rs(),ix=65536,lp=ix*ix,Yt=class Yt{constructor(e,r,n,i){this._arr=[e&65535,r&65535,n&65535,i&65535]}toString(){return this.toImmutable().toString()}compare(e){let r=this.isNegative(),n=e.isNegative();return r&&!n?-1:!r&&n?1:this._compareBits(e)}_compareBits(e){for(let r=3;r>=0;r--){if(this._arr[r]>e._arr[r])return 1;if(this._arr[r]<e._arr[r])return-1}return 0}getUint16(e){return this._arr[e]}getLowBitsUnsigned(){return(this._arr[0]|(this._arr[1]&65535)<<16)>>>0}getHighBitsUnsigned(){return(this._arr[2]|this._arr[3]<<16)>>>0}toNumber(){return(this._arr[3]<<16|this._arr[2])*lp+((this._arr[1]<<16|this._arr[0])>>>0)}not(){return this._arr[0]=~this._arr[0]&65535,this._arr[1]=~this._arr[1]&65535,this._arr[2]=~this._arr[2]&65535,this._arr[3]=~this._arr[3]&65535,this}add(e){let r=0,n=0,i=0,s=0;return s+=this._arr[0]+e._arr[0],this._arr[0]=s&65535,i+=s>>>16,i+=this._arr[1]+e._arr[1],this._arr[1]=i&65535,n+=i>>>16,n+=this._arr[2]+e._arr[2],this._arr[2]=n&65535,r+=n>>>16,r+=this._arr[3]+e._arr[3],this._arr[3]=r&65535,this}shiftLeft(e){if(e===0)return this;if(e>=64)return this.toZero();let r=e%16,n=Math.floor(e/16);return n>0&&(this._arr[3]=this._arr[3-n],this._arr[2]=n>2?0:this._arr[2-n],this._arr[1]=n>1?0:this._arr[0],this._arr[0]=0),r>0&&(this._arr[3]=(this._arr[3]<<r|this._arr[2]>>>16-r)&65535,this._arr[2]=(this._arr[2]<<r|this._arr[1]>>>16-r)&65535,this._arr[1]=(this._arr[1]<<r|this._arr[0]>>>16-r)&65535,this._arr[0]=this._arr[0]<<r&65535),this}shiftRightUnsigned(e){if(e===0)return this;if(e>=64)return this.toZero();let r=e%16,n=Math.floor(e/16);return n>0&&(this._arr[0]=this._arr[n],this._arr[1]=n>2?0:this._arr[1+n],this._arr[2]=n>1?0:this._arr[3],this._arr[3]=0),r>0&&(this._arr[0]=this._arr[0]>>>r|this._arr[1]<<16-r&65535,this._arr[1]=this._arr[1]>>>r|this._arr[2]<<16-r&65535,this._arr[2]=this._arr[2]>>>r|this._arr[3]<<16-r&65535,this._arr[3]=this._arr[3]>>>r),this}or(e){return this._arr[0]|=e._arr[0],this._arr[1]|=e._arr[1],this._arr[2]|=e._arr[2],this._arr[3]|=e._arr[3],this}xor(e){return this._arr[0]^=e._arr[0],this._arr[1]^=e._arr[1],this._arr[2]^=e._arr[2],this._arr[3]^=e._arr[3],this}clone(){return new Yt(this._arr[0],this._arr[1],this._arr[2],this._arr[3])}multiply(e){let r=!1;if(this.isZero()||e.isZero())return this.toZero();this.isNegative()&&(this.negate(),r=!r),e.isNegative()&&(e=e.clone().negate(),r=!r);let n=0,i=0,s=0,o=0;return o+=this._arr[0]*e._arr[0],s+=o>>>16,s+=this._arr[1]*e._arr[0],i+=s>>>16,s&=65535,s+=this._arr[0]*e._arr[1],i+=s>>>16,i+=this._arr[2]*e._arr[0],n+=i>>>16,i&=65535,i+=this._arr[1]*e._arr[1],n+=i>>>16,i&=65535,i+=this._arr[0]*e._arr[2],n+=i>>>16,n+=this._arr[3]*e._arr[0]+this._arr[2]*e._arr[1]+this._arr[1]*e._arr[2]+this._arr[0]*e._arr[3],this._arr[0]=o&65535,this._arr[1]=s&65535,this._arr[2]=i&65535,this._arr[3]=n&65535,r&&this.negate(),this}toZero(){return this._arr[3]=this._arr[2]=this._arr[1]=this._arr[0]=0,this}isZero(){return this._arr[3]===0&&this._arr[2]===0&&this._arr[1]===0&&this._arr[0]===0}isNegative(){return(this._arr[3]&32768)>0}negate(){return this.not().add(Yt.one)}equals(e){return e instanceof Yt?this._arr[0]===e._arr[0]&&this._arr[1]===e._arr[1]&&this._arr[2]===e._arr[2]&&this._arr[3]===e._arr[3]:!1}toImmutable(){return o4.fromBits(this.getLowBitsUnsigned(),this.getHighBitsUnsigned(),!1)}static fromNumber(e){if(isNaN(e)||!isFinite(e))return new Yt;if(e<0)return Yt.fromNumber(-e).negate();let r=e%lp,n=e/lp;return Yt.fromBits(r,n)}static fromBits(e,r){return new Yt(e,e>>>16,r,r>>>16)}static fromString(e,r){if(typeof e!="string")throw new Error("String format is not valid: "+e);if(e.length===0)throw Error("number format error: empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return new Yt;if(r=r||10,r<2||r>36)throw Error("radix out of range: "+r);let n;if((n=e.indexOf("-"))>0)throw Error('number format error: interior "-" character: '+e);if(n===0)return Yt.fromString(e.substring(1),r).negate();let i=Yt.fromNumber(Math.pow(r,8)),s=new Yt;for(let o=0;o<e.length;o+=8){let a=Math.min(8,e.length-o),u=parseInt(e.substring(o,o+a),r);if(a<8){let l=Yt.fromNumber(Math.pow(r,a));s.multiply(l).add(Yt.fromNumber(u));break}s.multiply(i),s.add(Yt.fromNumber(u))}return s}};c(Yt,"MutableLong");var ka=Yt;ka.one=new ka(1,0,0,0);sx.exports=ka});var Fa=_(uo=>{"use strict";var yp=Ke(),ox=require("util"),a4=yp.dataTypes.getByName("bigint"),c4=yp.dataTypes.getByName("varint"),u4=yp.dataTypes.getByName("blob"),mp=class mp{constructor(e){this._value=e}getType(){throw new Error("You must implement a getType function for this Token instance")}getValue(){return this._value}toString(){return this._value.toString()}compare(e){return this._value.compare(e._value)}equals(e){return this.compare(e)===0}inspect(){return this.constructor.name+" { "+this.toString()+" }"}};c(mp,"Token");var co=mp,vp=class vp extends co{constructor(e){super(e)}getType(){return a4}};c(vp,"Murmur3Token");var hp=vp,Ep=class Ep extends co{constructor(e){super(e)}getType(){return c4}};c(Ep,"RandomToken");var dp=Ep,Sp=class Sp extends co{constructor(e){super(e)}getType(){return u4}toString(){return this._value.toString("hex").toUpperCase()}};c(Sp,"ByteOrderedToken");var pp=Sp,_i=class _i{constructor(e,r,n){this.start=e,this.end=r,Object.defineProperty(this,"_tokenizer",{value:n,enumerable:!1})}splitEvenly(e){if(e<1)throw new Error(ox.format("numberOfSplits (%d) must be greater than 0.",e));if(this.isEmpty())throw new Error("Can't split empty range "+this.toString());let r=[],n=this._tokenizer.split(this.start,this.end,e),i=this.start,s;for(let o=0;o<n.length;o++)s=n[o],r.push(new _i(i,s,this._tokenizer)),i=s;return r.push(new _i(i,this.end,this._tokenizer)),r}isEmpty(){return this.start.equals(this.end)&&!this.start.equals(this._tokenizer.minToken())}isWrappedAround(){return this.start.compare(this.end)>0&&!this.end.equals(this._tokenizer.minToken())}unwrap(){return this.isWrappedAround()?[new _i(this.start,this._tokenizer.minToken(),this._tokenizer),new _i(this._tokenizer.minToken(),this.end,this._tokenizer)]:[this]}contains(e){if(this.isEmpty())return!1;let r=this._tokenizer.minToken();if(this.end.equals(r))return this.start.equals(r)||e.equals(r)?!0:e.compare(this.start)>0;let n=e.compare(this.start)>0,i=e.compare(this.end)<=0;return this.isWrappedAround()?n||i:n&&i}equals(e){return e===this?!0:e instanceof _i?this.compare(e)===0:!1}compare(e){let r=this.start.compare(e.start);return r!==0?r:this.end.compare(e.end)}toString(){return ox.format("]%s, %s]",this.start.toString(),this.end.toString())}};c(_i,"TokenRange");var gp=_i;uo.Token=co;uo.TokenRange=gp;uo.ByteOrderedToken=pp;uo.Murmur3Token=hp;uo.RandomToken=dp});var cx=_(qa=>{"use strict";var Cp=oe(),ax=rs(),l4=/^[-+]?(\d{1,6})(?:-(\d{1,2}))?(?:-(\d{1,2}))?(?:T(\d{1,2}?)?(?::(\d{1,2}))?(?::(\d{1,2})(?:\.(\d{1,3}))?)?)?Z?$/,f4=/^\[(.+?) TO (.+)]$/,Ir=Object.freeze(new mt(null,-1)),dr={singleValue:0,closedRange:1,openRangeHigh:2,openRangeLow:3,openBoth:4,openSingle:5},ct={year:0,month:1,day:2,hour:3,minute:4,second:5,millisecond:6};function Ur(t,e){if(!t)throw new TypeError("The lower boundaries must be defined");this.lowerBound=t,this.upperBound=e||null,this.upperBound===null?this.lowerBound!==Ir?this._type=dr.singleValue:this._type=dr.openSingle:this.lowerBound!==Ir?this._type=this.upperBound!==Ir?dr.closedRange:dr.openRangeHigh:this._type=this.upperBound!==Ir?dr.openRangeLow:dr.openBoth}c(Ur,"DateRange");Ur.prototype.equals=function(t){return t instanceof Ur?t.lowerBound.equals(this.lowerBound)&&(t.upperBound?t.upperBound.equals(this.upperBound):!this.upperBound):!1};Ur.prototype.toString=function(){return this.upperBound===null?this.lowerBound.toString():"["+this.lowerBound.toString()+" TO "+this.upperBound.toString()+"]"};Ur.prototype.toBuffer=function(){if(this._type===dr.openBoth||this._type===dr.openSingle)return Cp.allocBufferFromArray([this._type]);let t,e=0;if(this._type!==dr.closedRange){let r=this._type!==dr.openRangeLow?this.lowerBound:this.upperBound;return t=Cp.allocBufferUnsafe(10),t.writeUInt8(this._type,e++),e=wp(r.date,t,e),t.writeUInt8(r.precision,e),t}return t=Cp.allocBufferUnsafe(19),t.writeUInt8(this._type,e++),e=wp(this.lowerBound.date,t,e),t.writeUInt8(this.lowerBound.precision,e++),e=wp(this.upperBound.date,t,e),t.writeUInt8(this.upperBound.precision,e),t};Ur.fromString=function(t){let e=f4.exec(t);return e?new Ur(mt.toLowerBound(mt.fromString(e[1])),mt.toUpperBound(mt.fromString(e[2]))):new Ur(mt.toLowerBound(mt.fromString(t)))};Ur.fromBuffer=function(t){if(t.length===0)throw new TypeError("DateRange serialized value must have at least 1 byte");let e=t.readUInt8(0);if(e===dr.openBoth)return new Ur(Ir,Ir);if(e===dr.openSingle)return new Ur(Ir);let r=1,n,i,s=null;if(e!==dr.closedRange)return n=xp(t,r),r+=8,i=new mt(n,t.readUInt8(r)),e===dr.openRangeLow?(s=i,i=Ir):s=e===dr.openRangeHigh?Ir:null,new Ur(i,s);n=xp(t,r),r+=8,i=new mt(n,t.readUInt8(r++));let o=xp(t,r);return r+=8,s=new mt(o,t.readUInt8(r)),new Ur(i,s)};function wp(t,e,r){let n=ax.fromNumber(t.getTime());return e.writeUInt32BE(n.getHighBitsUnsigned(),r),e.writeUInt32BE(n.getLowBitsUnsigned(),r+4),r+8}c(wp,"writeDate");function xp(t,e){let r=new ax(t.readInt32BE(e+4),t.readInt32BE(e));return new Date(r.toNumber())}c(xp,"readDate");function mt(t,e){this.date=t,this.precision=e}c(mt,"DateRangeBound");mt.prototype.toString=function(){if(this.precision===-1)return"*";let t=0,e=this.date.toISOString(),r,n;for(r=4;r<e.length&&t<=this.precision;r++){if(n=e.charAt(r),t===ct.day&&n==="T"){t=ct.hour;continue}if(t>=ct.hour&&n===":"||n==="."){t++;continue}t<ct.day&&n==="-"&&t++}let i=0,s=e.charAt(0),o="",a=4;if(s==="+"||s==="-")for(o=s,s==="-"&&(a=3),i=1;i<a&&e.charAt(i)==="0";i++);return this.precision!==ct.millisecond&&r--,o+e.substring(i,r)};mt.prototype.equals=function(t){return!(t instanceof mt)||t.precision!==this.precision?!1:h4(t.date,this.date)};function h4(t,e){let r=t?t.getTime():null,n=e?e.getTime():null;return r===n}c(h4,"datesEqual");mt.prototype.isUnbounded=function(){return this.precision===-1};mt.fromString=function(t){if(!t)return null;if(t==="*")return Ir;let e=l4.exec(t);if(!e)throw TypeError("String provided is not a valid date "+t);if(e[7]!==void 0&&e[5]===void 0)throw new TypeError("String representation of the date contains the milliseconds portion but not the seconds: "+t);let r=new Tp(t.charAt(0)==="-");for(let n=1;n<e.length;n++)r.set(n-1,e[n],t);return r.build()};mt.unbounded=Ir;mt.toLowerBound=function(t){if(t===Ir)return t;let e=new Date(t.date.getTime());switch(t.precision){case ct.year:e.setUTCMonth(0);case ct.month:e.setUTCDate(1);case ct.day:e.setUTCHours(0);case ct.hour:e.setUTCMinutes(0);case ct.minute:e.setUTCSeconds(0);case ct.second:e.setUTCMilliseconds(0)}return new mt(e,t.precision)};mt.toUpperBound=function(t){if(t===Ir)return t;let e=new Date(t.date.getTime());switch(t.precision){case ct.year:e.setUTCMonth(11);case ct.month:e.setUTCMonth(e.getUTCMonth()+1,0);case ct.day:e.setUTCHours(23);case ct.hour:e.setUTCMinutes(59);case ct.minute:e.setUTCSeconds(59);case ct.second:e.setUTCMilliseconds(999)}return new mt(e,t.precision)};function Tp(t){this._sign=t?-1:1,this._index=0,this._values=new Int32Array(7)}c(Tp,"BoundaryBuilder");Tp.prototype.set=function(t,e,r){if(e===void 0)return;if(t>6)throw new TypeError("Index out of bounds: "+t);t>this._index&&(this._index=t);let n=+e;switch(t){case ct.month:if(n<1||n>12)throw new TypeError("Month portion is not valid for date: "+r);break;case ct.day:if(n<1||n>31)throw new TypeError("Day portion is not valid for date: "+r);break;case ct.hour:if(n>23)throw new TypeError("Hour portion is not valid for date: "+r);break;case ct.minute:case ct.second:if(n>59)throw new TypeError("Minute/second portion is not valid for date: "+r);break;case ct.millisecond:if(n>999)throw new TypeError("Millisecond portion is not valid for date: "+r);break}this._values[t]=n};Tp.prototype.build=function(){let t=new Date(0),e=this._values[1];return e&&e--,t.setUTCFullYear(this._sign*this._values[0],e,this._values[2]||1),t.setUTCHours(this._values[3],this._values[4],this._values[5],this._values[6]),new mt(t,this._index)};qa.unbounded=Ir;qa.dateRangePrecision=ct;qa.DateRange=Ur;qa.DateRangeBound=mt});var bp=_(Iu=>{"use strict";var _p=cx();Iu.DateRange=_p.DateRange;Iu.DateRangeBound=_p.DateRangeBound;Iu.dateRangePrecision=_p.dateRangePrecision});var Ua=_((vQ,ux)=>{"use strict";var d4={0:"BE",1:"LE"};function ri(){}c(ri,"Geometry");ri.types={Point2D:1,LineString:2,Polygon:3};ri.getEndianness=function(t){let e=d4[t.toString()];if(typeof e>"u")throw new TypeError("Invalid endianness with code "+t);return e};ri.readInt32=function(t,e,r){return e==="BE"?t.readInt32BE(r,!0):t.readInt32LE(r,!0)};ri.readDouble=function(t,e,r){return e==="BE"?t.readDoubleBE(r,!0):t.readDoubleLE(r,!0)};ri.prototype.writeInt32=function(t,e,r){return this.useBESerialization()?e.writeInt32BE(t,r,!0):e.writeInt32LE(t,r,!0)};ri.prototype.writeDouble=function(t,e,r){return this.useBESerialization()?e.writeDoubleBE(t,r,!0):e.writeDoubleLE(t,r,!0)};ri.prototype.writeEndianness=function(t,e){return this.useBESerialization()?t.writeInt8(0,e,!0):t.writeInt8(1,e,!0)};ri.prototype.useBESerialization=function(){throw new Error("Not Implemented")};ux.exports=ri});var Au=_((SQ,fx)=>{"use strict";var lx=require("util"),p4=oe(),us=Ua();function Yr(t,e){if(typeof t!="number"||typeof e!="number")throw new TypeError("X and Y must be numbers");if(isNaN(t)||isNaN(e))throw new TypeError("X and Y must be numbers");this.x=t,this.y=e}c(Yr,"Point");lx.inherits(Yr,us);Yr.fromBuffer=function(t){if(!t||t.length!==21)throw new TypeError("2D Point buffer should contain 21 bytes");let e=us.getEndianness(t.readInt8(0,!0));if(us.readInt32(t,e,1)!==us.types.Point2D)throw new TypeError("Binary representation was not a point");return new Yr(us.readDouble(t,e,5),us.readDouble(t,e,13))};Yr.fromString=function(t){let r=/^POINT\s?\(([-0-9.]+) ([-0-9.]+)\)$/g.exec(t);if(!r||r.length!==3)throw new TypeError("2D Point WTK should contain 2 coordinates");return new Yr(parseFloat(r[1]),parseFloat(r[2]))};Yr.prototype.toBuffer=function(){let t=p4.allocBufferUnsafe(21);return this.writeEndianness(t,0),this.writeInt32(us.types.Point2D,t,1),this.writeDouble(this.x,t,5),this.writeDouble(this.y,t,13),t};Yr.prototype.equals=function(t){return t instanceof Yr?this.x===t.x&&this.y===t.y:!1};Yr.prototype.toString=function(){return lx.format("POINT (%d %d)",this.x,this.y)};Yr.prototype.useBESerialization=function(){return!1};Yr.prototype.toJSON=function(){return{type:"Point",coordinates:[this.x,this.y]}};fx.exports=Yr});var Ip=_((wQ,px)=>{"use strict";var hx=require("util"),g4=oe(),bi=Ua(),dx=Au();function Ar(t){let e=Array.prototype.slice.call(arguments);if(e.length===1&&Array.isArray(e)&&Array.isArray(e[0])&&(e=e[0]),e.length===1)throw new TypeError("LineString can be either empty or contain 2 or more points");this.points=Object.freeze(e)}c(Ar,"LineString");hx.inherits(Ar,bi);Ar.fromBuffer=function(t){if(!t||t.length<9)throw new TypeError("A linestring buffer should contain at least 9 bytes");let e=bi.getEndianness(t.readInt8(0,!0)),r=1;if(bi.readInt32(t,e,r)!==bi.types.LineString)throw new TypeError("Binary representation was not a LineString");r+=4;let n=bi.readInt32(t,e,r);if(r+=4,t.length!==r+n*16)throw new TypeError(hx.format("Length of the buffer does not match %d !== %d",t.length,r+n*8));let i=new Array(n);for(let s=0;s<n;s++)i[s]=new dx(bi.readDouble(t,e,r),bi.readDouble(t,e,r+8)),r+=16;return new Ar(i)};Ar.fromString=function(t){let r=/^LINESTRING ?\(([-0-9. ,]+)\)+$/g.exec(t);if(!r||r.length!==2)throw new TypeError("Invalid WKT: "+t);let n=Ar.parseSegments(r[1]);return new Ar(n)};Ar.parseSegments=function(t){let e=[],r=t.split(",");for(let n=0;n<r.length;n++){let i=r[n].trim();if(i.length===0)throw new TypeError("Invalid WKT segment: "+t);let s=i.split(" ").filter(function(o){return o.trim().length>0});if(s.length!==2)throw new TypeError("Invalid WKT segment: "+t);e.push(new dx(parseFloat(s[0]),parseFloat(s[1])))}return e};Ar.prototype.toBuffer=function(){let t=g4.allocBufferUnsafe(9+this.points.length*16);this.writeEndianness(t,0);let e=1;return this.writeInt32(bi.types.LineString,t,e),e+=4,this.writeInt32(this.points.length,t,e),e+=4,this.points.forEach(function(r){this.writeDouble(r.x,t,e),this.writeDouble(r.y,t,e+8),e+=16},this),t};Ar.prototype.equals=function(t){if(!(t instanceof Ar)||this.points.length!==t.points.length)return!1;for(let e=0;e<this.points.length;e++)if(!this.points[e].equals(t.points[e]))return!1;return!0};Ar.prototype.toString=function(){return this.points.length===0?"LINESTRING EMPTY":"LINESTRING ("+this.points.map(function(t){return t.x+" "+t.y}).join(", ")+")"};Ar.prototype.useBESerialization=function(){return!1};Ar.prototype.toJSON=function(){return{type:"LineString",coordinates:this.points.map(function(t){return[t.x,t.y]})}};px.exports=Ar});var vx=_((TQ,mx)=>{"use strict";var gx=require("util"),y4=oe(),ni=Ua(),m4=Au(),v4=Ip();function Zr(t){let e=Array.prototype.slice.call(arguments);this.rings=Object.freeze(e)}c(Zr,"Polygon");gx.inherits(Zr,ni);Zr.fromBuffer=function(t){if(!t||t.length<9)throw new TypeError("A Polygon buffer should contain at least 9 bytes");let e=ni.getEndianness(t.readInt8(0,!0)),r=1;if(ni.readInt32(t,e,r)!==ni.types.Polygon)throw new TypeError("Binary representation was not a Polygon");r+=4;let n=ni.readInt32(t,e,r);r+=4;let i=new Array(n);for(let s=0;s<n;s++){let o=ni.readInt32(t,e,r);if(r+=4,t.length<r+o*16)throw new TypeError(gx.format("Length of the buffer does not match"));let a=new Array(o);for(let u=0;u<o;u++)a[u]=new m4(ni.readDouble(t,e,r),ni.readDouble(t,e,r+8)),r+=16;i[s]=a}return yx(i)};Zr.fromString=function(t){let r=/^POLYGON ?\((\(.*\))\)$/g.exec(t);function n(a){if(a)throw new TypeError("Invalid WKT: "+t)}c(n,"validateWkt"),n(!r||r.length!==2);let i=r[1],s=[],o=null;for(let a=0;a<i.length;a++){let u=i[a];if(u==="("){n(o!==null),o=a+1;continue}if(u===")"){n(o===null),s.push(i.substring(o,a)),o=null;continue}n(o===null&&u!==" "&&u!==",")}return yx(s.map(v4.parseSegments))};function yx(t){function e(){return Zr.apply(this,t)}return c(e,"F"),e.prototype=Zr.prototype,new e}c(yx,"construct");Zr.prototype.toBuffer=function(){let t=0;this.rings.forEach(function(n){t+=4+n.length*16},this);let e=y4.allocBufferUnsafe(9+t);this.writeEndianness(e,0);let r=1;return this.writeInt32(ni.types.Polygon,e,r),r+=4,this.writeInt32(this.rings.length,e,r),r+=4,this.rings.forEach(function(n){this.writeInt32(n.length,e,r),r+=4,n.forEach(function(i){this.writeDouble(i.x,e,r),this.writeDouble(i.y,e,r+8),r+=16},this)},this),e};Zr.prototype.equals=function(t){if(!(t instanceof Zr)||this.rings.length!==t.rings.length)return!1;for(let e=0;e<this.rings.length;e++){let r=this.rings[e],n=t.rings[e];if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(!r[e].equals(n[e]))return!1}return!0};Zr.prototype.useBESerialization=function(){return!1};Zr.prototype.toString=function(){if(this.rings.length===0)return"POLYGON EMPTY";let t="";return this.rings.forEach(function(e,r){r>0&&(t+=", "),t+="("+e.map(function(n){return n.x+" "+n.y}).join(", ")+")"}),"POLYGON ("+t+")"};Zr.prototype.toJSON=function(){return{type:"Polygon",coordinates:this.rings.map(function(t){return t.map(function(e){return[e.x,e.y]})})}};mx.exports=Zr});var Nu=_(Va=>{"use strict";Va.Geometry=Ua();Va.LineString=Ip();Va.Point=Au();Va.Polygon=vx()});var Ou=_((IQ,Rx)=>{"use strict";var ht=require("util"),xe=Ke(),U=xe.dataTypes,ls=xe.Long,lo=xe.Integer,fo=xe.BigDecimal,E4=fp(),it=oe(),Ex=Fa(),{DateRange:_x}=bp(),Ru=Nu(),S4=Ru.Geometry,bx=Ru.LineString,Ix=Ru.Point,Ax=Ru.Polygon,C4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,ho={int16Zero:it.allocBufferFromArray([0,0]),int32Zero:it.allocBufferFromArray([0,0,0,0]),int8Zero:it.allocBufferFromArray([0]),int8One:it.allocBufferFromArray([1]),int8MaxValue:it.allocBufferFromArray([255])},po=typeof BigInt<"u",Sx=po?BigInt(32):null,Cx=po?BigInt(8):null,Bu=po?BigInt(0):null,wx=po?BigInt(-1):null,w4=po?BigInt(4294967295):null,Ap=po?BigInt(255):null,Ze=Object.freeze({list:"org.apache.cassandra.db.marshal.ListType",set:"org.apache.cassandra.db.marshal.SetType",map:"org.apache.cassandra.db.marshal.MapType",udt:"org.apache.cassandra.db.marshal.UserType",tuple:"org.apache.cassandra.db.marshal.TupleType",frozen:"org.apache.cassandra.db.marshal.FrozenType",reversed:"org.apache.cassandra.db.marshal.ReversedType",composite:"org.apache.cassandra.db.marshal.CompositeType",empty:"org.apache.cassandra.db.marshal.EmptyType",collection:"org.apache.cassandra.db.marshal.ColumnToCollectionType"}),At=Object.freeze({frozen:"frozen",list:"list",set:"set",map:"map",tuple:"tuple",empty:"empty",duration:"duration",vector:"vector"}),Bp=Object.freeze({"org.apache.cassandra.db.marshal.UTF8Type":U.varchar,"org.apache.cassandra.db.marshal.AsciiType":U.ascii,"org.apache.cassandra.db.marshal.UUIDType":U.uuid,"org.apache.cassandra.db.marshal.TimeUUIDType":U.timeuuid,"org.apache.cassandra.db.marshal.Int32Type":U.int,"org.apache.cassandra.db.marshal.BytesType":U.blob,"org.apache.cassandra.db.marshal.FloatType":U.float,"org.apache.cassandra.db.marshal.DoubleType":U.double,"org.apache.cassandra.db.marshal.BooleanType":U.boolean,"org.apache.cassandra.db.marshal.InetAddressType":U.inet,"org.apache.cassandra.db.marshal.SimpleDateType":U.date,"org.apache.cassandra.db.marshal.TimeType":U.time,"org.apache.cassandra.db.marshal.ShortType":U.smallint,"org.apache.cassandra.db.marshal.ByteType":U.tinyint,"org.apache.cassandra.db.marshal.DateType":U.timestamp,"org.apache.cassandra.db.marshal.TimestampType":U.timestamp,"org.apache.cassandra.db.marshal.LongType":U.bigint,"org.apache.cassandra.db.marshal.DecimalType":U.decimal,"org.apache.cassandra.db.marshal.IntegerType":U.varint,"org.apache.cassandra.db.marshal.CounterColumnType":U.counter}),x4=H4(Bp),T4=Object.keys(Bp).reduce(function(t,e){return e.length>t?e.length:t},0),dt=Object.freeze({duration:"org.apache.cassandra.db.marshal.DurationType",lineString:"org.apache.cassandra.db.marshal.LineStringType",point:"org.apache.cassandra.db.marshal.PointType",polygon:"org.apache.cassandra.db.marshal.PolygonType",dateRange:"org.apache.cassandra.db.marshal.DateRangeType",vector:"org.apache.cassandra.db.marshal.VectorType"}),xx=it.allocBufferFromArray([255,255,255,255]),Tx=it.allocBufferFromArray([255,255,255,254]),_4=new Set([U.text,U.ascii,U.varchar,U.custom,U.blob]);function Ii(t,e){this.encodingOptions=e.encoding||it.emptyObject,b4.call(this),this.setProtocolVersion(t),I4.call(this),this.encodingOptions.copyBuffer?this.handleBuffer=B4:this.handleBuffer=R4}c(Ii,"Encoder");function b4(){this.setProtocolVersion=function(r){this.protocolVersion=r,this.decodeCollectionLength=O4,this.getLengthBuffer=N4,this.collectionLengthSize=4,xe.protocolVersion.uses4BytesCollectionLength(this.protocolVersion)||(this.decodeCollectionLength=D4,this.getLengthBuffer=A4,this.collectionLengthSize=2)};let t={[dt.duration]:Nx,[dt.lineString]:L4,[dt.point]:k4,[dt.polygon]:q4,[dt.dateRange]:V4},e={[dt.duration]:Bx,[dt.lineString]:P4,[dt.point]:F4,[dt.polygon]:U4,[dt.dateRange]:M4};this.decodeBlob=function(r){return this.handleBuffer(r)},this.decodeCustom=function(r,n){if(!n||n.length===0)return this.handleBuffer(r);if(n.startsWith(dt.vector))return this.decodeVector(r,this.parseVectorTypeArgs(n,dt.vector,this.parseFqTypeName));let i=t[n];return i?i.call(this,r):this.handleBuffer(r)},this.decodeUtf8String=function(r){return r.toString("utf8")},this.decodeAsciiString=function(r){return r.toString("ascii")},this.decodeBoolean=function(r){return!!r.readUInt8(0)},this.decodeDouble=function(r){return r.readDoubleBE(0)},this.decodeFloat=function(r){return r.readFloatBE(0)},this.decodeInt=function(r){return r.readInt32BE(0)},this.decodeSmallint=function(r){return r.readInt16BE(0)},this.decodeTinyint=function(r){return r.readInt8(0)},this._decodeCqlLongAsLong=function(r){return ls.fromBuffer(r)},this._decodeCqlLongAsBigInt=function(r){return BigInt.asIntN(64,BigInt(r.readUInt32BE(0))<<Sx|BigInt(r.readUInt32BE(4)))},this.decodeLong=this.encodingOptions.useBigIntAsLong?this._decodeCqlLongAsBigInt:this._decodeCqlLongAsLong,this._decodeVarintAsInteger=function(r){return lo.fromBuffer(r)},this._decodeVarintAsBigInt=c(function(n){let i=Bu;if(n[0]<=127)for(let s=0;s<n.length;s++){let o=BigInt(n[n.length-1-s]);i=i|o<<BigInt(s*8)}else{for(let s=0;s<n.length;s++){let o=BigInt(n[n.length-1-s]);i=i|(~o&Ap)<<BigInt(s*8)}i=~i}return i},"decodeVarintAsBigInt"),this.decodeVarint=this.encodingOptions.useBigIntAsVarint?this._decodeVarintAsBigInt:this._decodeVarintAsInteger,this.decodeDecimal=function(r){return fo.fromBuffer(r)},this.decodeTimestamp=function(r){return new Date(this._decodeCqlLongAsLong(r).toNumber())},this.decodeDate=function(r){return xe.LocalDate.fromBuffer(r)},this.decodeTime=function(r){return xe.LocalTime.fromBuffer(r)},this.decodeList=function(r,n){let i=this.decodeCollectionLength(r,0),s=this.collectionLengthSize,o=new Array(i);for(let a=0;a<i;a++){let u=this.decodeCollectionLength(r,s);s+=this.collectionLengthSize,o[a]=this.decode(r.slice(s,s+u),n),s+=u}return o},this.decodeSet=function(r,n){let i=this.decodeList(r,n);if(this.encodingOptions.set){let s=this.encodingOptions.set;return new s(i)}return i},this.decodeMap=function(r,n){let i,s=this.decodeCollectionLength(r,0),o=this.collectionLengthSize,a=this;function u(l,f){for(let h=0;h<s;h++){let p=a.decodeCollectionLength(r,o);o+=a.collectionLengthSize;let g=a.decode(r.slice(o,o+p),n[0]);o+=p;let d=a.decodeCollectionLength(r,o);if(o+=a.collectionLengthSize,d<0){l.call(f,g,null);continue}let y=a.decode(r.slice(o,o+d),n[1]);o+=d,l.call(f,g,y)}}if(c(u,"readValues"),this.encodingOptions.map){let l=this.encodingOptions.map;i=new l,u(i.set,i)}else i={},u(function(l,f){i[l]=f});return i},this.decodeUuid=function(r){return new xe.Uuid(this.handleBuffer(r))},this.decodeTimeUuid=function(r){return new xe.TimeUuid(this.handleBuffer(r))},this.decodeInet=function(r){return new xe.InetAddress(this.handleBuffer(r))},this.decodeUdt=function(r,n){let i={},s=0;for(let o=0;o<n.fields.length&&s<r.length;o++){let a=r.readInt32BE(s);s+=4;let u=n.fields[o];if(a<0){i[u.name]=null;continue}i[u.name]=this.decode(r.slice(s,s+a),u.type),s+=a}return i},this.decodeTuple=function(r,n){let i=new Array(n.length),s=0;for(let o=0;o<n.length&&s<r.length;o++){let a=r.readInt32BE(s);if(s+=4,a<0){i[o]=null;continue}i[o]=this.decode(r.slice(s,s+a),n[o]),s+=a}return xe.Tuple.fromArray(i)},this.encodeFloat=function(r){if(typeof r=="string"&&(r=parseFloat(r),Number.isNaN(r)))throw new TypeError(`Expected string representation of a number, obtained ${ht.inspect(r)}`);if(typeof r!="number")throw new TypeError("Expected Number, obtained "+ht.inspect(r));let n=it.allocBufferUnsafe(4);return n.writeFloatBE(r,0),n},this.encodeDouble=function(r){if(typeof r=="string"&&(r=parseFloat(r),Number.isNaN(r)))throw new TypeError(`Expected string representation of a number, obtained ${ht.inspect(r)}`);if(typeof r!="number")throw new TypeError("Expected Number, obtained "+ht.inspect(r));let n=it.allocBufferUnsafe(8);return n.writeDoubleBE(r,0),n},this.encodeTimestamp=function(r){let n=r;if(typeof r=="string"&&(r=new Date(r)),r instanceof Date&&(r=r.getTime(),isNaN(r)))throw new TypeError("Invalid date: "+n);return this.encodingOptions.useBigIntAsLong&&(r=BigInt(r)),this.encodeLong(r)},this.encodeDate=function(r){let n=r;try{typeof r=="string"&&(r=xe.LocalDate.fromString(r)),r instanceof Date&&(r=xe.LocalDate.fromDate(r))}catch(i){throw new TypeError("LocalDate could not be parsed "+i)}if(!(r instanceof xe.LocalDate))throw new TypeError("Expected Date/String/LocalDate, obtained "+ht.inspect(n));return r.toBuffer()},this.encodeTime=function(r){let n=r;try{typeof r=="string"&&(r=xe.LocalTime.fromString(r))}catch(i){throw new TypeError("LocalTime could not be parsed "+i)}if(!(r instanceof xe.LocalTime))throw new TypeError("Expected String/LocalTime, obtained "+ht.inspect(n));return r.toBuffer()},this.encodeUuid=function(r){if(typeof r=="string")try{r=xe.Uuid.fromString(r).getBuffer()}catch(n){throw new TypeError(n.message)}else if(r instanceof xe.Uuid)r=r.getBuffer();else throw new TypeError("Not a valid Uuid, expected Uuid/String/Buffer, obtained "+ht.inspect(r));return r},this.encodeInet=function(r){if(typeof r=="string"&&(r=xe.InetAddress.fromString(r)),r instanceof xe.InetAddress&&(r=r.getBuffer()),!(r instanceof Buffer))throw new TypeError("Not a valid Inet, expected InetAddress/Buffer, obtained "+ht.inspect(r));return r},this._encodeBigIntFromLong=function(r){typeof r=="number"?r=ls.fromNumber(r):typeof r=="string"&&(r=ls.fromString(r));let n=null;if(r instanceof ls?n=ls.toBuffer(r):r instanceof E4&&(n=ls.toBuffer(r.toImmutable())),n===null)throw new TypeError("Not a valid bigint, expected Long/Number/String/Buffer, obtained "+ht.inspect(r));return n},this._encodeBigIntFromBigInt=function(r){if(typeof r=="string"&&(r=BigInt(r)),typeof r!="bigint")throw new TypeError("Not a valid BigInt value, obtained "+ht.inspect(r));let n=it.allocBufferUnsafe(8);return n.writeUInt32BE(Number(r>>Sx)>>>0,0),n.writeUInt32BE(Number(r&w4),4),n},this.encodeLong=this.encodingOptions.useBigIntAsLong?this._encodeBigIntFromBigInt:this._encodeBigIntFromLong,this._encodeVarintFromInteger=function(r){typeof r=="number"&&(r=lo.fromNumber(r)),typeof r=="string"&&(r=lo.fromString(r));let n=null;if(r instanceof Buffer&&(n=r),r instanceof lo&&(n=lo.toBuffer(r)),n===null)throw new TypeError("Not a valid varint, expected Integer/Number/String/Buffer, obtained "+ht.inspect(r));return n},this._encodeVarintFromBigInt=function(r){if(typeof r=="string"&&(r=BigInt(r)),typeof r!="bigint")throw new TypeError("Not a valid varint, expected BigInt, obtained "+ht.inspect(r));if(r===Bu)return ho.int8Zero;if(r===wx)return ho.int8MaxValue;let n=[];if(r>Bu){for(;r!==Bu;)n.unshift(Number(r&Ap)),r=r>>Cx;n[0]>127&&n.unshift(0)}else{for(;r!==wx;)n.unshift(Number(r&Ap)),r=r>>Cx;n[0]<=127&&n.unshift(255)}return it.allocBufferFromArray(n)},this.encodeVarint=this.encodingOptions.useBigIntAsVarint?this._encodeVarintFromBigInt:this._encodeVarintFromInteger,this.encodeDecimal=function(r){typeof r=="number"?r=fo.fromNumber(r):typeof r=="string"&&(r=fo.fromString(r));let n=null;if(r instanceof fo)n=fo.toBuffer(r);else throw new TypeError("Not a valid varint, expected BigDecimal/Number/String/Buffer, obtained "+ht.inspect(r));return n},this.encodeString=function(r,n){if(typeof r!="string")throw new TypeError("Not a valid text value, expected String obtained "+ht.inspect(r));return it.allocBufferFromString(r,n)},this.encodeUtf8String=function(r){return this.encodeString(r,"utf8")},this.encodeAsciiString=function(r){return this.encodeString(r,"ascii")},this.encodeBlob=function(r){if(!(r instanceof Buffer))throw new TypeError("Not a valid blob, expected Buffer obtained "+ht.inspect(r));return r},this.encodeCustom=function(r,n){if(n.startsWith(dt.vector))return this.encodeVector(r,this.parseVectorTypeArgs(n,dt.vector,this.parseFqTypeName));let i=e[n];if(i)return i.call(this,r);throw new TypeError("No encoding handler found for type "+n)},this.encodeBoolean=function(r){return r?ho.int8One:ho.int8Zero},this.encodeInt=function(r){if(isNaN(r))throw new TypeError("Expected Number, obtained "+ht.inspect(r));let n=it.allocBufferUnsafe(4);return n.writeInt32BE(r,0),n},this.encodeSmallint=function(r){if(isNaN(r))throw new TypeError("Expected Number, obtained "+ht.inspect(r));let n=it.allocBufferUnsafe(2);return n.writeInt16BE(r,0),n},this.encodeTinyint=function(r){if(isNaN(r))throw new TypeError("Expected Number, obtained "+ht.inspect(r));let n=it.allocBufferUnsafe(1);return n.writeInt8(r,0),n},this.encodeList=function(r,n){if(!Array.isArray(r))throw new TypeError("Not a valid list value, expected Array obtained "+ht.inspect(r));if(r.length===0)return null;let i=[];i.push(this.getLengthBuffer(r));for(let s=0;s<r.length;s++){let o=r[s];if(o===null||typeof o>"u"||o===xe.unset)throw new TypeError("A collection can't contain null or unset values");let a=this.encode(o,n);i.push(this.getLengthBuffer(a)),i.push(a)}return Buffer.concat(i)},this.encodeSet=function(r,n){if(this.encodingOptions.set&&r instanceof this.encodingOptions.set){let i=[];return r.forEach(function(s){i.push(s)}),this.encodeList(i,n)}return this.encodeList(r,n)},this.encodeMap=function(r,n){let i=[],s=0,o=null,a=null,u=this;n&&(o=n[0],a=n[1]);function l(f,h){if(h===null||typeof h>"u"||h===xe.unset)throw new TypeError("A map can't contain null or unset keys");if(f===null||typeof f>"u"||f===xe.unset)throw new TypeError("A map can't contain null or unset values");let p=u.encode(h,o);i.push(u.getLengthBuffer(p)),i.push(p);let g=u.encode(f,a);i.push(u.getLengthBuffer(g)),g!==null&&i.push(g),s++}if(c(l,"addItem"),this.encodingOptions.map&&r instanceof this.encodingOptions.map)r.forEach(l);else for(let f in r){if(!r.hasOwnProperty(f))continue;let h=r[f];l(h,f)}return i.unshift(this.getLengthBuffer(s)),Buffer.concat(i)},this.encodeUdt=function(r,n){let i=[],s=0;for(let o=0;o<n.fields.length;o++){let a=n.fields[o],u=this.encode(r[a.name],a.type);if(!u){i.push(xx),s+=4;continue}if(u===xe.unset){i.push(Tx),s+=4;continue}let l=it.allocBufferUnsafe(4);l.writeInt32BE(u.length,0),i.push(l),i.push(u),s+=u.length+4}return Buffer.concat(i,s)},this.encodeTuple=function(r,n){let i=[],s=0,o=Math.min(n.length,r.length);for(let a=0;a<o;a++){let u=n[a],l=this.encode(r.get(a),u);if(!l){i.push(xx),s+=4;continue}if(l===xe.unset){i.push(Tx),s+=4;continue}let f=it.allocBufferUnsafe(4);f.writeInt32BE(l.length,0),i.push(f),i.push(l),s+=l.length+4}return Buffer.concat(i,s)},this.decodeVector=function(r,n){let i=n.subtype,s=n.dimensions,o=4,a=r.length/o;if(o*s!==r.length)throw new TypeError(`Expected buffer of subtype ${i} with dimensions ${s} to be of size ${a}, observed size ${r.length}`);let u=[],l=0;for(let f=0;f<s;f++)l=f*o,u[f]=this.decode(r.slice(l,l+o),i);return new Float32Array(u)},this.encodeVector=function(r,n){function i(){if(!(r instanceof Float32Array))throw new TypeError("Driver only supports vectors of 4 byte floating point values");if(n.hasOwnProperty("subtype")&&n.hasOwnProperty("dimensions")){let a=n.subtype,u=n.dimensions;if(r.length!==u)throw new TypeError(`Expected vector with ${u} dimensions, observed size of ${r.length}`);if(a.code!==U.float)throw new TypeError("Driver only supports vectors of 4 byte floating point values");return a}return{code:U.float}}if(c(i,"evalParams"),!Ii.isTypedArray(r))throw new TypeError("Expected TypedArray subclass, obtained "+ht.inspect(r));if(r.length===0)throw new TypeError("Cannot encode empty array as vector");let s=i(),o=[];for(let a of r)o.push(this.encode(a,s));return Buffer.concat(o)},this.parseVectorTypeArgs=function(r,n,i){let s=n.length+1,o=r.length-(n.length+2),a=Ln(r,s,o);if(a.length===2)return{subtype:i(a[0]),dimensions:parseInt(a[1],10)};throw new TypeError("Not a valid type "+r)},this.setRoutingKeyFromUser=function(r,n,i){let s=0,o=n.getRoutingKey();if(Array.isArray(o)){if(o.length===1){n.setRoutingKey(o[0]);return}s=0;for(let h=0;h<o.length;h++){let p=o[h];if(!p){n.setRoutingKey(null);return}s+=p.length+3}n.setRoutingKey(Np(o,s));return}if(o){if(o instanceof Buffer||o instanceof Ex.Token||o instanceof Ex.TokenRange)return;throw new TypeError(`Unexpected routingKey '${ht.inspect(o)}' provided. Expected Buffer, Array<Buffer>, Token, or TokenRange.`)}if(!r||r.length===0)return;let a=n.getRoutingIndexes();if(n.getRoutingNames()&&(a=n.getRoutingNames().map(h=>i[h])),!a)return;let u=[],l=n.getHints()||it.emptyArray,f=i?h=>this.encode(r[h].value,l[h]):h=>this.encode(r[h],l[h]);try{s=this._encodeRoutingKeyParts(u,a,f)}catch{}s!==0&&n.setRoutingKey(Np(u,s))},this.setRoutingKeyFromMeta=function(r,n,i){let s=i.getRoutingIndexes();if(!s)return;let o=new Array(s.length),a=c(l=>{let f=r.columns[l];return this.encode(n[l],f?f.type:null)},"encodeParam"),u=0;try{u=this._encodeRoutingKeyParts(o,s,a)}catch{}u!==0&&i.setRoutingKey(Np(o,u))},this._encodeRoutingKeyParts=function(r,n,i){let s=0;for(let o=0;o<n.length;o++){let a=n[o];if(a===void 0)return 0;let u=i(a);if(u==null||u===xe.unset)return 0;s+=u.length+3,r[o]=u}return s},this.parseTypeName=async function(r,n,i,s,o){i=i||0,s||(s=n.length);let a={code:0,info:null,options:{frozen:!1}},u;if(n.indexOf("'",i)===i)return a.info=n.substr(i+1,s-2),a;if(s||(s=n.length),n.indexOf(At.frozen,i)===i&&(i+=At.frozen.length+1,s-=At.frozen.length+2,a.options.frozen=!0),n.indexOf(At.list,i)===i){if(i+=At.list.length+1,s-=At.list.length+2,u=Ln(n,i,s,"<",">"),u.length!==1)throw new TypeError("Not a valid type "+n);return a.code=U.list,a.info=await this.parseTypeName(r,u[0],0,null,o),a}if(n.indexOf(At.set,i)===i){if(i+=At.set.length+1,s-=At.set.length+2,u=Ln(n,i,s,"<",">"),u.length!==1)throw new TypeError("Not a valid type "+n);return a.code=U.set,a.info=await this.parseTypeName(r,u[0],0,null,o),a}if(n.indexOf(At.map,i)===i){if(i+=At.map.length+1,s-=At.map.length+2,u=Ln(n,i,s,"<",">"),u.length!==2)throw new TypeError("Not a valid type "+n);return a.code=U.map,a.info=await this._parseChildTypes(r,u,o),a}if(n.indexOf(At.tuple,i)===i){if(i+=At.tuple.length+1,s-=At.tuple.length+2,u=Ln(n,i,s,"<",">"),u.length<1)throw new TypeError("Not a valid type "+n);return a.code=U.tuple,a.info=await this._parseChildTypes(r,u,o),a}if(n.indexOf(At.vector,i)===i){a.code=U.custom;let p=this.parseVectorTypeArgs(n,At.vector,g=>g);return p.subtype=await this.parseTypeName(r,p.subtype),a.info=p,a}let l=n.indexOf('"',i)===i;l&&(i++,s-=2),i>0&&(n=n.substr(i,s)),l&&(n=n.replace('""','"'));let f=U[n];if(typeof f=="number")return a.code=f,a;if(n===At.duration)return a.info=dt.duration,a;if(n===At.empty)return a.info="empty",a;let h=await o(r,n);if(h)return a.code=U.udt,a.info=h,a;throw new TypeError('Not a valid type "'+n+'"')},this._parseChildTypes=function(r,n,i){return Promise.all(n.map(s=>this.parseTypeName(r,s.trim(),0,null,i)))},this.parseFqTypeName=function(r,n,i){let s={code:0,info:null,options:{reversed:!1,frozen:!1}};n=n||0;let o;if(i||(i=r.length),i>Ze.reversed.length&&r.indexOf(Ze.reversed)===n&&(n+=Ze.reversed.length+1,i-=Ze.reversed.length+2,s.options.reversed=!0),i>Ze.frozen.length&&r.indexOf(Ze.frozen,n)===n&&(n+=Ze.frozen.length+1,i-=Ze.frozen.length+2,s.options.frozen=!0),r===Ze.empty)return s.info="empty",s;if(i<=T4){n>0&&(r=r.substr(n,i));let a=Bp[r];if(typeof a=="number")return s.code=a,s;throw new TypeError('Not a valid type "'+r+'"')}if(r.indexOf(Ze.list,n)===n){if(n+=Ze.list.length+1,i-=Ze.list.length+2,o=Ln(r,n,i),o.length!==1)throw new TypeError("Not a valid type "+r);return s.code=U.list,s.info=this.parseFqTypeName(o[0]),s}if(r.indexOf(Ze.set,n)===n){if(n+=Ze.set.length+1,i-=Ze.set.length+2,o=Ln(r,n,i),o.length!==1)throw new TypeError("Not a valid type "+r);return s.code=U.set,s.info=this.parseFqTypeName(o[0]),s}if(r.indexOf(Ze.map,n)===n){if(n+=Ze.map.length+1,i-=Ze.map.length+2,o=Ln(r,n,i),o.length!==2)throw new TypeError("Not a valid type "+r);return s.code=U.map,s.info=[this.parseFqTypeName(o[0]),this.parseFqTypeName(o[1])],s}if(r.indexOf(Ze.udt,n)===n)return n+=Ze.udt.length+1,i-=Ze.udt.length+2,this._parseUdtName(r,n,i);if(r.indexOf(Ze.tuple,n)===n){if(n+=Ze.tuple.length+1,i-=Ze.tuple.length+2,o=Ln(r,n,i),o.length<1)throw new TypeError("Not a valid type "+r);return s.code=U.tuple,s.info=o.map(a=>this.parseFqTypeName(a)),s}return r.indexOf(dt.vector,n)===n?(s.code=U.custom,s.info=this.parseVectorTypeArgs(r,dt.vector,this.parseFqTypeName),s):(s.info=r.substr(n,i),s)},this.parseKeyTypes=function(r){let n=0,i=r.length,s=r.indexOf(Ze.composite)===0;s&&(n=Ze.composite.length+1,i--);let o=[],a=n,u=0,l=!1,f=!1;for(;++n<i;)switch(r[n]){case",":if(u>0)break;l&&(a=r.indexOf(":",a)+1),o.push(r.substring(a,n)),a=n+1;break;case"(":if(u===0&&r.indexOf(Ze.collection,a)===a){l=!0,f=!0,n++,a=n;break}u++;break;case")":if(l&&u===0){o.push(r.substring(r.indexOf(":",a)+1,n)),a=n+1;break}u--;break}return a<i&&o.push(r.substring(a,i)),{types:o.map(h=>this.parseFqTypeName(h)),hasCollections:f,isComposite:s}},this._parseUdtName=function(r,n,i){let s=Ln(r,n,i);if(s.length<2)throw new TypeError("Not a valid type "+r);let o={code:U.udt,info:null},a={keyspace:s[0],name:it.allocBufferFromString(s[1],"hex").toString(),fields:[]};for(let u=2;u<s.length;u++){let l=s[u],f=l.indexOf(":"),h=this.parseFqTypeName(l,f+1,l.length-(f+1));a.fields.push({name:it.allocBufferFromString(l.substr(0,f),"hex").toString(),type:h})}return o.info=a,o}}c(b4,"defineInstanceMembers");function I4(){this.decoders={[U.custom]:this.decodeCustom,[U.ascii]:this.decodeAsciiString,[U.bigint]:this.decodeLong,[U.blob]:this.decodeBlob,[U.boolean]:this.decodeBoolean,[U.counter]:this.decodeLong,[U.decimal]:this.decodeDecimal,[U.double]:this.decodeDouble,[U.float]:this.decodeFloat,[U.int]:this.decodeInt,[U.text]:this.decodeUtf8String,[U.timestamp]:this.decodeTimestamp,[U.uuid]:this.decodeUuid,[U.varchar]:this.decodeUtf8String,[U.varint]:this.decodeVarint,[U.timeuuid]:this.decodeTimeUuid,[U.inet]:this.decodeInet,[U.date]:this.decodeDate,[U.time]:this.decodeTime,[U.smallint]:this.decodeSmallint,[U.tinyint]:this.decodeTinyint,[U.duration]:Nx,[U.list]:this.decodeList,[U.map]:this.decodeMap,[U.set]:this.decodeSet,[U.udt]:this.decodeUdt,[U.tuple]:this.decodeTuple},this.encoders={[U.custom]:this.encodeCustom,[U.ascii]:this.encodeAsciiString,[U.bigint]:this.encodeLong,[U.blob]:this.encodeBlob,[U.boolean]:this.encodeBoolean,[U.counter]:this.encodeLong,[U.decimal]:this.encodeDecimal,[U.double]:this.encodeDouble,[U.float]:this.encodeFloat,[U.int]:this.encodeInt,[U.text]:this.encodeUtf8String,[U.timestamp]:this.encodeTimestamp,[U.uuid]:this.encodeUuid,[U.varchar]:this.encodeUtf8String,[U.varint]:this.encodeVarint,[U.timeuuid]:this.encodeUuid,[U.inet]:this.encodeInet,[U.date]:this.encodeDate,[U.time]:this.encodeTime,[U.smallint]:this.encodeSmallint,[U.tinyint]:this.encodeTinyint,[U.duration]:Bx,[U.list]:this.encodeList,[U.map]:this.encodeMap,[U.set]:this.encodeSet,[U.udt]:this.encodeUdt,[U.tuple]:this.encodeTuple}}c(I4,"setEncoders");Ii.prototype.decode=function(t,e){if(t===null||t.length===0&&!_4.has(e.code))return null;let r=this.decoders[e.code];if(!r)throw new Error("Unknown data type: "+e.code);return r.call(this,t,e.info)};Ii.prototype.encode=function(t,e){if(t===void 0&&(t=this.encodingOptions.useUndefinedAsUnset&&this.protocolVersion>=4?xe.unset:null),t===xe.unset){if(!xe.protocolVersion.supportsUnset(this.protocolVersion))throw new TypeError("Unset value can not be used for this version of Cassandra, protocol version: "+this.protocolVersion);return t}if(t===null||t instanceof Buffer)return t;let r={code:null,info:null};if(e){if(typeof e=="number"?r.code=e:typeof e=="string"&&(r=U.getByName(e)),typeof e.code=="number"&&(r.code=e.code,r.info=e.info),typeof r.code!="number")throw new TypeError("Type information not valid, only String and Number values are valid hints")}else if(r=Ii.guessDataType(t),!r)throw new TypeError("Target data type could not be guessed, you should use prepared statements for accurate type mapping. Value: "+ht.inspect(t));let n=this.encoders[r.code];if(!n)throw new Error("Type not supported "+r.code);return n.call(this,t,r.info)};Ii.guessDataType=function(t){let e=null,r=null,n=typeof t;return n==="number"?e=U.double:n==="string"?(e=U.text,t.length===36&&C4.test(t)&&(e=U.uuid)):n==="boolean"?e=U.boolean:t instanceof Buffer?e=U.blob:t instanceof Date?e=U.timestamp:t instanceof ls?e=U.bigint:t instanceof lo?e=U.varint:t instanceof fo?e=U.decimal:t instanceof xe.Uuid?e=U.uuid:t instanceof xe.InetAddress?e=U.inet:t instanceof xe.Tuple?e=U.tuple:t instanceof xe.LocalDate?e=U.date:t instanceof xe.LocalTime?e=U.time:t instanceof xe.Duration?(e=U.custom,r=dt.duration):Ii.isTypedArray(t)?(e=U.custom,r=K4(dt.vector,[x4[U.float],t.length])):Array.isArray(t)?e=U.list:t instanceof S4?(e=U.custom,t instanceof bx?r=dt.lineString:t instanceof Ix?r=dt.point:t instanceof Ax&&(r=dt.polygon)):t instanceof _x&&(e=U.custom,r=dt.dateRange),e===null?null:{code:e,info:r}};function A4(t){if(!t)return ho.int16Zero;let e=it.allocBufferUnsafe(2);return typeof t=="number"?e.writeUInt16BE(t,0):e.writeUInt16BE(t.length,0),e}c(A4,"getLengthBufferV2");function N4(t){if(!t)return ho.int32Zero;let e=it.allocBufferUnsafe(4);return typeof t=="number"?e.writeInt32BE(t,0):e.writeInt32BE(t.length,0),e}c(N4,"getLengthBufferV3");function B4(t){return t===null?null:it.copyBuffer(t)}c(B4,"handleBufferCopy");function R4(t){return t}c(R4,"handleBufferRef");function O4(t,e){return t.readInt32BE(e)}c(O4,"decodeCollectionLengthV3");function D4(t,e){return t.readUInt16BE(e)}c(D4,"decodeCollectionLengthV2");function Nx(t){return xe.Duration.fromBuffer(t)}c(Nx,"decodeDuration");function Bx(t){if(!(t instanceof xe.Duration))throw new TypeError("Not a valid duration, expected Duration/Buffer obtained "+ht.inspect(t));return t.toBuffer()}c(Bx,"encodeDuration");function L4(t){return bx.fromBuffer(t)}c(L4,"decodeLineString");function P4(t){return t.toBuffer()}c(P4,"encodeLineString");function k4(t){return Ix.fromBuffer(t)}c(k4,"decodePoint");function F4(t){return t.toBuffer()}c(F4,"encodePoint");function q4(t){return Ax.fromBuffer(t)}c(q4,"decodePolygon");function U4(t){return t.toBuffer()}c(U4,"encodePolygon");function V4(t){return _x.fromBuffer(t)}c(V4,"decodeDateRange");function M4(t){return t.toBuffer()}c(M4,"encodeDateRange");function Ln(t,e,r,n,i){n=n||"(",i=i||")";let s=[],o=e,a=0;for(let u=e;u<e+r;u++){let l=t[u];l===n&&a++,l===i&&a--,a===0&&l===","&&(s.push(t.substr(o,u-o)),o=u+1)}return s.push(t.substr(o,r-(o-e))),s}c(Ln,"parseParams");function Np(t,e){if(e===0)return null;if(t.length===1)return t[0];let r=it.allocBufferUnsafe(e),n=0;for(let i=0;i<t.length;i++){let s=t[i];r.writeUInt16BE(s.length,n),n+=2,s.copy(r,n),n+=s.length,r[n]=0,n++}return r}c(Np,"concatRoutingKey");function K4(t,e){return`${t}(${e.join(",")})`}c(K4,"buildParameterizedCustomType");function H4(t){let e={};for(let r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}c(H4,"invertObject");Ii.isTypedArray=function(t){return t instanceof Object.getPrototypeOf(Uint8Array)};Rx.exports=Ii});var Dx=_((NQ,Ox)=>{"use strict";var go=require("util"),fs=oe(),me=Ke(),$4=ze(),Ma={globalTablesSpec:1,hasMorePages:2,noMetadata:4,metadataChanged:8,continuousPaging:1073741824,lastContinuousPage:2147483648},G4="Server timeout during write query at consistency %s (%d peer(s) acknowledged the write over %d required)",j4="Server timeout during batchlog write at consistency %s (%d peer(s) acknowledged the write over %d required)",z4="Server failure during write query at consistency %s (%d responses were required but only %d replicas responded, %d failed)",W4="Not enough replicas available for query at consistency %s (%d required but only %d alive)",Q4="Server timeout during read query at consistency %s (%s)",Y4="Server failure during read query at consistency %s (%d responses were required but only %d replicas responded, %d failed)",Op=class Op{constructor(e,r,n){this.header=e,this.opcode=e.opcode,this.offset=n||0,this.buf=r}remainingLength(){return this.buf.length-this.offset}getBuffer(){return this.buf}slice(e,r){return typeof r>"u"&&(r=this.buf.length),this.buf.slice(e,r)}unshift(e){if(this.offset>0)throw new Error("Can not modify the underlying buffer if already read");this.buf=Buffer.concat([e,this.buf],e.length+this.buf.length)}read(e){let r=this.buf.length;typeof e<"u"&&this.offset+e<this.buf.length&&(r=this.offset+e);let n=this.slice(this.offset,r);return this.offset=r,n}toEnd(){this.offset=this.buf.length}readInt(){let e=this.buf.readInt32BE(this.offset);return this.offset+=4,e}readShort(){let e=this.buf.readUInt16BE(this.offset);return this.offset+=2,e}readByte(){let e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readString(){let e=this.readShort();this.checkOffset(e);let r=this.buf.toString("utf8",this.offset,this.offset+e);return this.offset+=e,r}checkOffset(e){if(this.offset+e>this.buf.length){let r=new RangeError("Trying to access beyond buffer length");throw r.expectedLength=e,r}}readStringList(){let e=this.readShort(),r=new Array(e);for(let n=0;n<e;n++)r[n]=this.readString();return r}readBytes(){let e=this.readInt();return e<0?null:(this.checkOffset(e),this.read(e))}readShortBytes(){let e=this.readShort();return e<0?null:(this.checkOffset(e),this.read(e))}readMap(e,r,n){if(e<0)return null;let i={};for(let s=0;s<e;s++)i[r.call(this)]=n.call(this);return i}readStringMultiMap(){let e=this.readShort();if(e<0)return null;let r={};for(let n=0;n<e;n++)r[this.readString()]=this.readStringList();return r}readType(){let e,r={code:this.readShort(),type:null};switch(r.code){case me.dataTypes.custom:r.info=this.readString();break;case me.dataTypes.list:case me.dataTypes.set:r.info=this.readType();break;case me.dataTypes.map:r.info=[this.readType(),this.readType()];break;case me.dataTypes.udt:for(r.info={keyspace:this.readString(),name:this.readString(),fields:new Array(this.readShort())},e=0;e<r.info.fields.length;e++)r.info.fields[e]={name:this.readString(),type:this.readType()};break;case me.dataTypes.tuple:for(r.info=new Array(this.readShort()),e=0;e<r.info.length;e++)r.info[e]=this.readType();break}return r}readInet(){let e=this.readByte(),r=this.read(e);return{address:new me.InetAddress(r),port:this.readInt()}}readInetAddress(){let e=this.readByte();return new me.InetAddress(this.read(e))}readFlagsInfo(){if(this.header.flags===0)return fs.emptyObject;let e={};return this.header.flags&me.frameFlags.tracing&&(this.checkOffset(16),e.traceId=new me.Uuid(fs.copyBuffer(this.read(16)))),this.header.flags&me.frameFlags.warning&&(e.warnings=this.readStringList()),this.header.flags&me.frameFlags.customPayload&&(e.customPayload=this.readMap(this.readShort(),this.readString,this.readBytes)),e}readMetadata(e){let r,n=e===me.resultKind.prepared,i={};me.protocolVersion.supportsResultMetadataId(this.header.version)&&n&&(i.resultId=fs.copyBuffer(this.readShortBytes()));let s=this.readInt(),o=this.readInt();if(me.protocolVersion.supportsPreparedPartitionKey(this.header.version)&&n)for(i.partitionKeys=new Array(this.readInt()),r=0;r<i.partitionKeys.length;r++)i.partitionKeys[r]=this.readShort();for(s&Ma.hasMorePages&&(i.pageState=fs.copyBuffer(this.readBytes())),s&Ma.metadataChanged&&(i.newResultId=fs.copyBuffer(this.readShortBytes())),s&Ma.continuousPaging&&(i.continuousPageIndex=this.readInt(),i.lastContinuousPage=!!(s&Ma.lastContinuousPage)),s&Ma.globalTablesSpec&&(i.global_tables_spec=!0,i.keyspace=this.readString(),i.table=this.readString()),i.columns=new Array(o),i.columnsByName=fs.emptyObject,n&&(i.columnsByName={}),r=0;r<o;r++){let a={};i.global_tables_spec||(a.ksname=this.readString(),a.tablename=this.readString()),a.name=this.readString(),a.type=this.readType(),i.columns[r]=a,n&&(i.columnsByName[a.name]=r)}return i}readError(){let e=this.readInt(),r=this.readString(),n=new $4.ResponseError(e,r);switch(e){case me.responseErrorCodes.unavailableException:n.consistencies=this.readShort(),n.required=this.readInt(),n.alive=this.readInt(),n.message=go.format(W4,me.consistencyToString[n.consistencies],n.required,n.alive);break;case me.responseErrorCodes.readTimeout:case me.responseErrorCodes.readFailure:if(n.consistencies=this.readShort(),n.received=this.readInt(),n.blockFor=this.readInt(),e===me.responseErrorCodes.readFailure&&(me.protocolVersion.supportsFailureReasonMap(this.header.version)?(n.failures=this.readInt(),n.reasons=this.readMap(n.failures,this.readInetAddress,this.readShort)):n.failures=this.readInt()),n.isDataPresent=this.readByte(),e===me.responseErrorCodes.readTimeout){let i;n.received<n.blockFor?i=go.format("%d replica(s) responded over %d required",n.received,n.blockFor):n.isDataPresent?i="timeout while waiting for repair of inconsistent replica":i="the replica queried for the data didn't respond",n.message=go.format(Q4,me.consistencyToString[n.consistencies],i)}else n.message=go.format(Y4,me.consistencyToString[n.consistencies],n.blockFor,n.received,n.failures);break;case me.responseErrorCodes.writeTimeout:case me.responseErrorCodes.writeFailure:if(n.consistencies=this.readShort(),n.received=this.readInt(),n.blockFor=this.readInt(),e===me.responseErrorCodes.writeFailure&&(me.protocolVersion.supportsFailureReasonMap(this.header.version)?(n.failures=this.readInt(),n.reasons=this.readMap(n.failures,this.readInetAddress,this.readShort)):n.failures=this.readInt()),n.writeType=this.readString(),e===me.responseErrorCodes.writeTimeout){let i=n.writeType==="BATCH_LOG"?j4:G4;n.message=go.format(i,me.consistencyToString[n.consistencies],n.received,n.blockFor)}else n.message=go.format(z4,me.consistencyToString[n.consistencies],n.blockFor,n.received,n.failures);break;case me.responseErrorCodes.unprepared:n.queryId=fs.copyBuffer(this.readShortBytes());break;case me.responseErrorCodes.functionFailure:n.keyspace=this.readString(),n.functionName=this.readString(),n.argTypes=this.readStringList();break;case me.responseErrorCodes.alreadyExists:{n.keyspace=this.readString();let i=this.readString();i.length>0&&(n.table=i);break}}return n}readEvent(){let e=this.readString();switch(e){case me.protocolEvents.topologyChange:return{added:this.readString()==="NEW_NODE",inet:this.readInet(),eventType:e};case me.protocolEvents.statusChange:return{up:this.readString()==="UP",inet:this.readInet(),eventType:e};case me.protocolEvents.schemaChange:return this.parseSchemaChange()}return{eventType:e}}parseSchemaChange(){let e;if(!me.protocolVersion.supportsSchemaChangeFullMetadata(this.header.version))return e={eventType:me.protocolEvents.schemaChange,schemaChangeType:this.readString(),keyspace:this.readString(),table:this.readString()},e.isKeyspace=!e.table,e;switch(e={eventType:me.protocolEvents.schemaChange,schemaChangeType:this.readString(),target:this.readString(),keyspace:this.readString(),table:null,udt:null,signature:null},e.isKeyspace=e.target==="KEYSPACE",e.target){case"TABLE":e.table=this.readString();break;case"TYPE":e.udt=this.readString();break;case"FUNCTION":e.functionName=this.readString(),e.signature=this.readStringList();break;case"AGGREGATE":e.aggregate=this.readString(),e.signature=this.readStringList()}return e}};c(Op,"FrameReader");var Rp=Op;Ox.exports={FrameReader:Rp}});var kx=_(Pu=>{"use strict";var Dp=require("util"),{Transform:Lu,Writable:Lx}=require("stream"),Zt=Ke(),Px=oe(),Ka=ze(),{FrameHeader:Du}=Zt,{FrameReader:Z4}=Dx();function Ha(t){Lu.call(this,t),this.header=null,this.bodyLength=0,this.clearHeaderChunks(),this.version=0,this.headerSize=0}c(Ha,"Protocol");Dp.inherits(Ha,Lu);Ha.prototype._transform=function(t,e,r){let n=null;try{this.readItems(t)}catch(i){n=i}r(n)};Ha.prototype.readItems=function(t){if(!t||t.length===0)return;this.version===0&&(this.version=Du.getProtocolVersion(t),this.headerSize=Du.size(this.version));let e=0,r=this.header;if(this.header=null,this.headerChunks.byteLength!==0){if(this.headerChunks.parts.push(t),this.headerChunks.byteLength+t.length<this.headerSize){this.headerChunks.byteLength+=t.length;return}r=Du.fromBuffer(Buffer.concat(this.headerChunks.parts,this.headerSize)),e=this.headerSize-this.headerChunks.byteLength,this.clearHeaderChunks()}let n=[];for(;;){if(!r){if(this.headerSize>t.length-e){if(t.length-e<=0)break;let s=t.slice(e,t.length);this.headerChunks.parts.push(s),this.headerChunks.byteLength=s.length;break}r=Du.fromBuffer(t,e),e+=this.headerSize}let i=t.length-e;if(r.bodyLength<=i+this.bodyLength)n.push({header:r,chunk:t,offset:e,frameEnded:!0}),e+=r.bodyLength-this.bodyLength,this.bodyLength=0;else if(i>=0){this.header=r,this.bodyLength+=i,i>0&&n.push({header:r,chunk:t,offset:e,frameEnded:!1});break}r=null}for(let i=0;i<n.length;i++)this.push(n[i])};Ha.prototype.clearHeaderChunks=function(){this.headerChunks={byteLength:0,parts:[]}};function Nr(t,e){Lu.call(this,t),this.frames={},this.encoder=e}c(Nr,"Parser");Dp.inherits(Nr,Lu);Nr.prototype._transform=function(t,e,r){let n=this.frameState(t),i=null;try{this.parseBody(n,t)}catch(s){i=s}r(i),t.frameEnded&&(n.cellBuffer&&this.push({header:n.header,error:new Ka.DriverInternalError("There was an problem while parsing streaming frame, opcode "+n.header.opcode)}),this.push({header:n.header,frameEnded:!0}))};Nr.prototype.parseBody=function(t,e){if(t.isStreaming=t.byRow&&e.header.opcode===Zt.opcodes.result,!this.handleFrameBuffers(t,e))return;let r=new Z4(e.header,e.chunk,e.offset);if(t.flagsInfo===void 0){let n=r.offset;try{t.flagsInfo=r.readFlagsInfo()}catch(i){return this.handleParsingError(i,t,r,n)}}switch(e.header.opcode){case Zt.opcodes.result:return this.parseResult(t,r);case Zt.opcodes.ready:case Zt.opcodes.authSuccess:return this.push({header:t.header,ready:!0});case Zt.opcodes.authChallenge:return this.push({header:t.header,authChallenge:!0,token:r.readBytes()});case Zt.opcodes.authenticate:return this.push({header:t.header,mustAuthenticate:!0,authenticatorName:r.readString()});case Zt.opcodes.error:return this.push({header:t.header,error:r.readError()});case Zt.opcodes.supported:return this.push({header:t.header,supported:r.readStringMultiMap()});case Zt.opcodes.event:return this.push({header:t.header,event:r.readEvent()});default:return this.push({header:t.header,error:new Error("Received invalid opcode: "+e.header.opcode)})}};Nr.prototype.handleFrameBuffers=function(t,e){if(!t.isStreaming)return(t.bufferLength||0)+e.chunk.length-e.offset<e.header.bodyLength?(this.addFrameBuffer(t,e),!1):(t.buffers&&(e.chunk=this.getFrameBuffer(t,e),e.offset=0),!0);if(t.cellBuffer){if(e.offset!==0)throw new Ka.DriverInternalError("Following chunks can not have an offset greater than zero");if(t.cellBuffer.parts.push(e.chunk),!t.cellBuffer.expectedLength){if(t.cellBuffer.parts.length!==2)throw new Ka.DriverInternalError("Buffer for streaming frame can not contain more than 1 item");return e.chunk=Buffer.concat(t.cellBuffer.parts,t.cellBuffer.byteLength+e.chunk.length),t.cellBuffer=null,!0}if(t.cellBuffer.expectedLength>t.cellBuffer.byteLength+e.chunk.length)return t.cellBuffer.byteLength+=e.chunk.length,!1;e.chunk=Buffer.concat(t.cellBuffer.parts,t.cellBuffer.byteLength+e.chunk.length),t.cellBuffer=null}return!0};Nr.prototype.addFrameBuffer=function(t,e){if(!t.buffers){t.buffers=[e.chunk.slice(e.offset)],t.bufferLength=e.chunk.length-e.offset;return}if(e.offset>0)throw new Ka.DriverInternalError("Following chunks can not have an offset greater than zero");t.buffers.push(e.chunk),t.bufferLength+=e.chunk.length};Nr.prototype.getFrameBuffer=function(t,e){t.buffers.push(e.chunk);let r=Buffer.concat(t.buffers,t.bodyLength);return t.buffers=null,r};Nr.prototype.parseResult=function(t,e){let r,n=e.offset;try{if(!t.meta)switch(t.kind=e.readInt(),t.kind){case Zt.resultKind.voidResult:r={header:t.header,flags:t.flagsInfo};break;case Zt.resultKind.rows:t.meta=e.readMetadata(t.kind);break;case Zt.resultKind.setKeyspace:r={header:t.header,keyspaceSet:e.readString(),flags:t.flagsInfo};break;case Zt.resultKind.prepared:{let i=Px.copyBuffer(e.readShortBytes());t.meta=e.readMetadata(t.kind),r={header:t.header,id:i,meta:t.meta,flags:t.flagsInfo};break}case Zt.resultKind.schemaChange:r={header:t.header,schemaChange:e.parseSchemaChange(),flags:t.flagsInfo};break;default:throw Ka.DriverInternalError("Unexpected result kind: "+t.kind)}}catch(i){return this.handleParsingError(i,t,e,n)}if(r)return t.emitted?void 0:(t.emitted=!0,this.push(r));e.remainingLength()>0&&this.parseRows(t,e)};Nr.prototype.parseRows=function(t,e){if(t.parsingError)return;if(t.rowLength===void 0)try{t.rowLength=e.readInt()}catch(n){return this.handleParsingError(n,t,e)}if(t.rowLength===0)return this.push({header:t.header,result:{rows:Px.emptyArray,meta:t.meta,flags:t.flagsInfo}});let r=t.meta;t.rowIndex=t.rowIndex||0;for(let n=t.rowIndex;n<t.rowLength;n++){let i=e.offset,s=new Zt.Row(r.columns),o;for(let a=0;a<r.columns.length;a++){let u=r.columns[a];try{o=e.readBytes()}catch(l){return this.handleParsingError(l,t,e,i,n)}try{s[u.name]=this.encoder.decode(o,u.type)}catch(l){return this.handleParsingError(l,t,null)}}this.push({header:t.header,row:s,meta:t.meta,byRow:t.byRow,length:t.rowLength,flags:t.flagsInfo})}t.byRow&&this.push({header:t.header,byRowCompleted:!0,meta:t.meta,length:t.rowLength,flags:t.flagsInfo})};Nr.prototype.setOptions=function(t,e){if(this.frames[t.toString()])throw new Zt.DriverError("There was already state for this frame");this.frames[t.toString()]=e};Nr.prototype.clearOptions=function(t){delete this.frames[t.toString()]};Nr.prototype.frameState=function(t){let e=this.frames[t.header.streamId];return e?t.frameEnded&&delete this.frames[t.header.streamId]:(e={},t.frameEnded||(this.frames[t.header.streamId]=e)),e.header=t.header,e};Nr.prototype.handleParsingError=function(t,e,r,n,i){if(r&&e.isStreaming&&t instanceof RangeError)return this.bufferResultCell(e,r,n,i,t.expectedLength);e.parsingError=!0,e.cellBuffer=null,this.push({header:e.header,error:t})};Nr.prototype.bufferResultCell=function(t,e,r,n,i){!r&&r!==0&&(r=e.offset),t.rowIndex=n;let s=e.slice(r);t.cellBuffer={parts:[s],byteLength:s.length,expectedLength:i}};function $a(t){Lx.call(this,t),this.rowBuffer={}}c($a,"ResultEmitter");Dp.inherits($a,Lx);$a.prototype._write=function(t,e,r){let n=null;try{this.each(t)}catch(i){n=i}r(n)};$a.prototype.each=function(t){return t.error||t.result?this.emit("result",t.header,t.error,t.result):t.frameEnded?this.emit("frameEnded",t.header):t.lastContinuousPage?this.emit("lastContinuousPage",t.header):t.byRowCompleted?this.emit("byRowCompleted",t.header,t.row,t.meta,t.flags):t.byRow?this.emit("row",t.header,t.row,t.meta,t.length,t.flags):t.row?this.bufferAndEmit(t):t.event?this.emit("nodeEvent",t.header,t.event):this.emit("result",t.header,null,t)};$a.prototype.bufferAndEmit=function(t){let e=this.rowBuffer[t.header.streamId];e||(e=this.rowBuffer[t.header.streamId]=[]),e.push(t.row),e.length===t.length&&(this.emit("result",t.header,null,{rows:e,meta:t.meta,flags:t.flags}),delete this.rowBuffer[t.header.streamId])};Pu.Protocol=Ha;Pu.Parser=Nr;Pu.ResultEmitter=$a});var Vx=_((DQ,Ux)=>{"use strict";var X4=Ke(),ku=128,Fx=7,Lp=4,J4=256,eq=5e3,kp=class kp{constructor(e){this.currentGroup=qx(0),this.groupIndex=0,this.groups=[this.currentGroup],this.releaseTimeout=null,this.setVersion(e),this.inUse=0,this.releaseDelay=eq}setVersion(e){this.maxGroups=X4.protocolVersion.uses2BytesStreamIds(e)?J4:1}pop(){let e=this.currentGroup.pop();if(typeof e<"u")return this.inUse++,e;for(;this.groupIndex<this.groups.length-1;)if(this.currentGroup=this.groups[++this.groupIndex],e=this.currentGroup.pop(),typeof e<"u")return this.inUse++,e;return this._tryCreateGroup()}push(e){this.inUse--;let r=e>>Fx,n=this.groups[r];n.push(e),r<this.groupIndex&&(this.groupIndex=r,this.currentGroup=n),this._tryIssueRelease()}clear(){this.releaseTimeout&&(clearTimeout(this.releaseTimeout),this.releaseTimeout=null)}_tryCreateGroup(){return this.groups.length===this.maxGroups?null:(this.groupIndex=this.groups.length,this.currentGroup=qx(this.groupIndex<<Fx),this.groups.push(this.currentGroup),this.inUse++,this.currentGroup.pop())}_tryIssueRelease(){this.releaseTimeout||this.groups.length<=Lp||(this.releaseTimeout=setTimeout(()=>this._releaseGroups(),this.releaseDelay))}_releaseGroups(){let e=0,r=this.groups.length-1;for(;e++<Lp&&this.groups.length>Lp&&r>this.groupIndex&&this.groups[r].length===ku;)this.groups.pop(),r--;this.releaseTimeout=null,this._tryIssueRelease()}};c(kp,"StreamIdStack");var Pp=kp;function qx(t){let e=new Array(ku),r=t+ku-1;for(let n=0;n<ku;n++)e[n]=r-n;return e}c(qx,"generateGroup");Ux.exports=Pp});var Gx=_((PQ,$x)=>{"use strict";var tq=require("util"),Mx=oe(),Kx=ze(),Hx=Ti(),rq=Hx.ExecuteRequest,nq=Hx.QueryRequest,ii={init:0,completed:1,timedOut:2,cancelled:3},qp=class qp{constructor(e,r,n){this.request=e,this._rowCallback=r,this._callback=n,this._timeout=null,this._state=ii.init,this._rowIndex=0,this.streamId=-1}cancel(){this._state===ii.init&&(this._timeout!==null&&clearTimeout(this._timeout),this._state=ii.cancelled,this._callback=Mx.noop)}canBeWritten(){return this._state===ii.init}isByRow(){return this._rowCallback&&(this.request instanceof rq||this.request instanceof nq)}setRequestTimeout(e,r,n,i,s){if(this._state!==ii.init)return;let o=e.getReadTimeout()!==void 0?e.getReadTimeout():r;if(!(o>0))return;let a=this;this._timeout=setTimeout(c(function(){i();let l=tq.format("The host %s did not reply before timeout %d ms",n,o);a._markAsTimedOut(new Kx.OperationTimedOutError(l,n),s)},"requestTimedOut"),o)}setResultRow(e,r,n,i,s){if(this._markAsCompleted(),!this._rowCallback)return this.setResult(new Kx.DriverInternalError("RowCallback not found for streaming frame handler"));this._rowCallback(this._rowIndex++,e,n),this._rowIndex===n&&this._swapCallbackAndInvoke(null,{rowLength:n,meta:r,flags:i},s.bodyLength)}_markAsTimedOut(e,r){this._state===ii.init&&(this._state=ii.timedOut,this._swapCallbackAndInvoke(e,null,null,r))}_markAsCompleted(){this._state===ii.init&&(this._timeout!==null&&clearTimeout(this._timeout),this._state=ii.completed)}setResult(e,r,n){this._markAsCompleted(),this._swapCallbackAndInvoke(e,r,n)}_swapCallbackAndInvoke(e,r,n,i){let s=this._callback;this._callback=i||Mx.noop,s(e,r,n)}};c(qp,"OperationState");var Fp=qp;$x.exports=Fp});var Kp=_((FQ,zx)=>{"use strict";var jx=require("events"),Ga=require("util"),iq=require("tls"),sq=require("net"),oq=Ou(),{WriteQueue:aq}=Md(),yo=Ti(),Up=kx(),ja=oe(),Vr=Ke(),hs=ze(),cq=Vx(),uq=Gx(),lq=fr(),{ExecutionOptions:fq}=xi(),Mp=class Mp extends jx.EventEmitter{constructor(e,r,n){if(super(),this.setMaxListeners(0),!n)throw new Error("options is not defined");if(this.endpoint=e,this.endpointFriendlyName=this.endpoint,n.sni&&(this._serverName=e,this.endpoint=`${n.sni.addressResolver.getIp()}:${n.sni.port}`,this.endpointFriendlyName=`${this.endpoint} (${this._serverName})`),!this.endpoint||this.endpoint.indexOf(":")<0)throw new Error("EndPoint must contain the ip address and port separated by : symbol");let i=this.endpoint.lastIndexOf(":");this.address=this.endpoint.substr(0,i),this.port=this.endpoint.substr(i+1),Object.defineProperty(this,"options",{value:n,enumerable:!1,writable:!1}),r===null&&(r=Vr.protocolVersion.maxSupported,n.protocolOptions.maxVersion&&(r=n.protocolOptions.maxVersion),this._checkingVersion=!0),this.log=ja.log,this.protocolVersion=r,this._operations=new Map,this._pendingWrites=[],this._preparing=new Map,this._idleTimeout=null,this.timedOutOperations=0,this._streamIds=new cq(this.protocolVersion),this._metrics=n.metrics,this.encoder=new oq(r,n),this.keyspace=null,this.emitDrain=!1,this.connected=!1,this.isSocketOpen=!1,this.send=Ga.promisify(this.sendStream),this.closeAsync=Ga.promisify(this.close),this.openAsync=Ga.promisify(this.open),this.prepareOnceAsync=Ga.promisify(this.prepareOnce)}bindSocketListeners(){this.netClient.removeAllListeners("connect"),this.netClient.removeAllListeners("timeout"),this.isSocketOpen=!0,this.netClient.on("close",()=>{this.log("info",`Connection to ${this.endpointFriendlyName} closed`),this.isSocketOpen=!1;let r=this.connected;this.close(),r&&this.emit("socketClose")}),this.protocol=new Up.Protocol({objectMode:!0}),this.parser=new Up.Parser({objectMode:!0},this.encoder);let e=new Up.ResultEmitter({objectMode:!0});e.on("result",this.handleResult.bind(this)),e.on("row",this.handleRow.bind(this)),e.on("frameEnded",this.freeStreamId.bind(this)),e.on("nodeEvent",this.handleNodeEvent.bind(this)),this.netClient.pipe(this.protocol).pipe(this.parser).pipe(e),this.writeQueue=new aq(this.netClient,this.encoder,this.options)}open(e){let r=this;if(this.log("info",`Connecting to ${this.endpointFriendlyName}`),!this.options.sslOptions)this.netClient=new sq.Socket({highWaterMark:this.options.socketOptions.coalescingThreshold}),this.netClient.connect(this.port,this.address,c(function(){r.log("verbose",`Socket connected to ${r.endpointFriendlyName}`),r.bindSocketListeners(),r.startup(e)},"connectCallback"));else{let n=ja.extend({rejectUnauthorized:!1},this.options.sslOptions);this.options.sni&&(n.servername=this._serverName),this.netClient=iq.connect(this.port,this.address,n,c(function(){r.log("verbose",`Secure socket connected to ${r.endpointFriendlyName} with protocol ${r.netClient.getProtocol()}`),r.bindSocketListeners(),r.startup(e)},"tlsConnectCallback")),this.netClient.setMaxSendFragment(this.options.socketOptions.coalescingThreshold)}this.netClient.once("error",c(function(i){r.errorConnecting(i,!1,e)},"socketError")),this.netClient.once("timeout",c(function(){let i=new Vr.DriverError("Connection timeout");r.errorConnecting(i,!0,e)},"connectTimedOut")),this.netClient.setTimeout(this.options.socketOptions.connectTimeout),this.options.socketOptions.keepAlive&&this.netClient.setKeepAlive(!0,this.options.socketOptions.keepAliveDelay),this.netClient.setNoDelay(!!this.options.socketOptions.tcpNoDelay)}startup(e){this._checkingVersion&&this.log("info","Trying to use protocol version 0x"+this.protocolVersion.toString(16));let r=this,n=new yo.StartupRequest({noCompact:this.options.protocolOptions.noCompact,clientId:this.options.id,applicationName:this.options.applicationName,applicationVersion:this.options.applicationVersion});this.sendStream(n,null,c(function(o,a){if(o&&r._checkingVersion){let u=o instanceof hs.ResponseError&&o.code===Vr.responseErrorCodes.protocolError&&o.message.indexOf("Invalid or unsupported protocol version")>=0;if(!u&&Vr.protocolVersion.canStartupResponseErrorBeWrapped(r.protocolVersion)&&(u=o instanceof hs.ResponseError&&o.code===Vr.responseErrorCodes.serverError&&o.message.indexOf("ProtocolException: Invalid or unsupported protocol version")>0),u){let l=r.protocol.version;if(l===r.protocolVersion?l=Vr.protocolVersion.getLowerSupported(r.protocolVersion):Vr.protocolVersion.isSupported(r.protocol.version)||(r.log("info",`Protocol version ${r.protocol.version} not supported by this driver, downgrading`),l=Vr.protocolVersion.getLowerSupported(r.protocol.version)),!l)return i(new Error("Connection was unable to STARTUP using protocol version "+r.protocolVersion));r.log("info","Protocol 0x"+r.protocolVersion.toString(16)+" not supported, using 0x"+l.toString(16)),r.decreaseVersion(l),setImmediate(c(function(){r.close(c(function(){r.open(e)},"decreasingVersionOpening"))},"decreasingVersionClosing"));return}}if(a&&a.mustAuthenticate)return r.startAuthenticating(a.authenticatorName,i);i(o)},"responseCallback"));function i(s){return s?r.errorConnecting(s,!1,e):r.connectionReady(e)}c(i,"startupCallback")}errorConnecting(e,r,n){this.log("warning",`There was an error when trying to connect to the host ${this.endpointFriendlyName}`,e),r&&this.netClient.destroy(),this._metrics.onConnectionError(e),n(e)}connectionReady(e){this.emit("connected"),this.connected=!0,this.netClient.removeAllListeners("error"),this.netClient.on("error",this.handleSocketError.bind(this)),e()}decreaseVersion(e){this.protocolVersion=e,this.encoder.setProtocolVersion(e),this._streamIds.setVersion(e)}handleSocketError(e){this._metrics.onConnectionError(e),this.clearAndInvokePending(e)}clearAndInvokePending(e){this._idleTimeout&&(clearTimeout(this._idleTimeout),this._idleTimeout=null),this._streamIds.clear(),this.emitDrain&&this.emit("drain");let r=new Vr.DriverError("Socket was closed");r.isSocketError=!0,e&&(r.innerError=e);let n=Array.from(this._operations.values());this._operations=new Map,n.length>0&&this.log("info","Invoking "+n.length+" pending callbacks"),ja.each(n,function(s,o){s.setResult(r),o()});let i=this._pendingWrites;this._pendingWrites=[],ja.each(i,function(s,o){s.setResult(r),o()})}startAuthenticating(e,r){if(!this.options.authProvider)return r(new hs.AuthenticationError("Authentication provider not set"));let n=this.options.authProvider.newAuthenticator(this.endpoint,e),i=this;n.initialResponse(c(function(o,a){if(o)return i.onAuthenticationError(r,o);i.authenticate(n,a,r)},"initialResponseCallback"))}authenticate(e,r,n){let i=this,s=new yo.AuthResponseRequest(r);if(this.protocolVersion===1){if(!e.username)return i.onAuthenticationError(n,new hs.AuthenticationError("Only plain text authenticator providers allowed under protocol v1"));s=new yo.CredentialsRequest(e.username,e.password)}this.sendStream(s,null,c(function(a,u){if(a){if(a instanceof hs.ResponseError&&a.code===Vr.responseErrorCodes.badCredentials){let l=new hs.AuthenticationError(a.message);l.additionalInfo=a,a=l}return i.onAuthenticationError(n,a)}if(u.ready)return e.onAuthenticationSuccess(),n();if(u.authChallenge)return e.evaluateChallenge(u.token,c(function(f,h){if(f)return i.onAuthenticationError(n,f);i.authenticate(e,h,n)},"evaluateCallback"));n(new hs.DriverInternalError("Unexpected response from Cassandra: "+Ga.inspect(u)))},"authResponseCallback"))}onAuthenticationError(e,r){this._metrics.onAuthenticationError(r),e(r)}async changeKeyspace(e){if(!e||this.keyspace===e)return;if(this.toBeKeyspace===e)return lq.fromEvent(this,"keyspaceChanged");this.toBeKeyspace=e;let r=`USE "${e}"`;try{await this.send(new yo.QueryRequest(r,null,null),null),this.keyspace=e,this.emit("keyspaceChanged",null,e)}catch(n){throw this.log("error",`Connection to ${this.endpointFriendlyName} could not switch active keyspace: ${n}`,n),this.emit("keyspaceChanged",n),n}finally{this.toBeKeyspace=null}}prepareOnce(e,r,n){let i=(r||"")+e,s=this._preparing.get(i);if(s)return s.once("prepared",n);s=new jx.EventEmitter,s.setMaxListeners(0),s.once("prepared",n),this._preparing.set(i,s),this.sendStream(new yo.PrepareRequest(e,r),null,(o,a)=>{s.emit("prepared",o,a),this._preparing.delete(i)})}sendStream(e,r,n){r=r||fq.empty();let i=new uq(e,r.getRowCallback(),(o,a,u)=>{(!o||!o.isSocketError)&&this.emit("responseDequeued"),n(o,a,u)}),s=this._getStreamId();return i.setRequestTimeout(r,this.options.socketOptions.readTimeout,this.endpoint,()=>this.timedOutOperations++,()=>this.timedOutOperations--),s===null?(this.log("info","Enqueuing "+this._pendingWrites.length+", if this message is recurrent consider configuring more connections per host or lowering the pressure"),this._pendingWrites.push(i),i):(this._write(i,s),i)}_write(e,r){e.streamId=r;let n=this;this.writeQueue.push(e,c(function(s){if(s)return n._streamIds.push(r),e.setResult(s);n.log("verbose","Sent stream #"+r+" to "+n.endpointFriendlyName),e.isByRow()&&n.parser.setOptions(r,{byRow:!0}),n._setIdleTimeout(),n._operations.set(r,e)},"writeCallback"))}_setIdleTimeout(){if(!this.options.pooling.heartBeatInterval)return;let e=this,r=this._idleTimeout;e._idleTimeout=setTimeout(()=>e._idleTimeoutHandler(),e.options.pooling.heartBeatInterval),r&&clearTimeout(r)}_idleTimeoutHandler(){if(this.sendingIdleQuery){this._idleTimeout=setTimeout(()=>this._idleTimeoutHandler(),this.options.pooling.heartBeatInterval);return}this.log("verbose",`Connection to ${this.endpointFriendlyName} idling, issuing a request to prevent disconnects`),this.sendingIdleQuery=!0,this.sendStream(yo.options,null,e=>{this.sendingIdleQuery=!1,e&&(this.log("warning","Received heartbeat request error",e),this.emit("idleRequestError",e,this))})}_getStreamId(){return this._streamIds.pop()}freeStreamId(e){let r=e.streamId;r<0||(this._operations.delete(r),this._streamIds.push(r),this.emitDrain&&this._streamIds.inUse===0&&this._pendingWrites.length===0&&this.emit("drain"),this._writeNext())}_writeNext(){if(this._pendingWrites.length===0)return;let e=this._getStreamId();if(e===null)return;let r=this,n;for(;(n=this._pendingWrites.shift())&&!n.canBeWritten(););if(!n){this._streamIds.push(e);return}setImmediate(c(function(){r._write(n,e)},"writeNextPending"))}getInFlight(){return this._streamIds.inUse}handleResult(e,r,n){let i=e.streamId;if(i<0)return this.log("verbose","event received",e);let s=this._operations.get(i);if(!s)return this.log("error","The server replied with a wrong streamId #"+i);this.log("verbose","Received frame #"+i+" from "+this.endpointFriendlyName),s.setResult(r,n,e.bodyLength)}handleNodeEvent(e,r){switch(r.eventType){case Vr.protocolEvents.schemaChange:this.emit("nodeSchemaChange",r);break;case Vr.protocolEvents.topologyChange:this.emit("nodeTopologyChange",r);break;case Vr.protocolEvents.statusChange:this.emit("nodeStatusChange",r);break}}handleRow(e,r,n,i,s){let o=e.streamId;if(o<0)return this.log("verbose","Event received",e);let a=this._operations.get(o);if(!a)return this.log("error","The server replied with a wrong streamId #"+o);a.setResultRow(r,n,i,s,e)}close(e){if(e=e||ja.noop,!this.connected&&!this.isSocketOpen||(this.connected=!1,this.removeAllListeners("drain"),this.clearAndInvokePending(),!this.isSocketOpen))return e();this.isSocketOpen=!1,this.log("verbose",`Closing connection to ${this.endpointFriendlyName}`);let r=this,n=setTimeout(()=>{this.log("info",`${this.endpointFriendlyName} did not respond to connection close within ${this.options.socketOptions.connectTimeout}ms, destroying connection`),this.netClient.destroy()},this.options.socketOptions.connectTimeout);this.netClient.once("close",function(i){clearTimeout(n),i&&r.log("info","The socket closed with a transmission error"),setImmediate(e)}),this.netClient.removeAllListeners("error"),this.netClient.on("error",i=>this.clearAndInvokePending(i)),this.netClient.end()}getLocalAddress(){if(this.netClient)return this.netClient.localAddress}};c(Mp,"Connection");var Vp=Mp;zx.exports=Vp});var Yx=_((UQ,Qx)=>{"use strict";var Wx=require("util"),hq=require("events"),dq=Kp(),Fu=oe(),za=fr(),pq=ze(),gq=ma(),Wa=0,yq=Math.pow(2,15),Hp,Br={initial:0,closing:1,shuttingDown:2,shutDown:4},qu=class qu extends hq.EventEmitter{constructor(e,r){super(),this._address=e.address,this._newConnectionTimeout=null,this._state=Br.initial,this._opening=!1,this._host=e,this.responseCounter=0,this.options=e.options,this.protocolVersion=r,this.coreConnectionsLength=1,this.connections=Fu.emptyArray,this.setMaxListeners(0),this.log=Fu.log}getInFlight(){let e=this.connections.length;if(e===1)return this.connections[0].getInFlight();let r=0;for(let n=0;n<e;n++)r+=this.connections[n].getInFlight();return r}borrowConnection(e){if(this.connections.length===0)throw new Error("No connection available");let r=this.options.pooling.maxRequestsPerConnection,n=qu.minInFlight(this.connections,r,e);if(n.getInFlight()>=r)throw new pq.BusyConnectionError(this._address,r,this.connections.length);return n}static minInFlight(e,r,n){let i=e.length;if(i===1)return e[0];Wa++,Wa>=yq&&(Wa=0);let s;for(let o=Wa;o<Wa+i;o++){s=e[o%i],s===n&&(s=e[++o%i]);let a=e[(o+1)%i];if(a===n&&(a=e[(o+2)%i]),a.getInFlight()<s.getInFlight()&&(s=a),s.getInFlight()<r)break}return s}async warmup(e){if(this.connections.length<this.coreConnectionsLength){for(;this.connections.length<this.coreConnectionsLength;)await this._attemptNewConnection();this.log("info",`Connection pool to host ${this._address} created with ${this.connections.length} connection(s)`)}else this.log("info",`Connection pool to host ${this._address} contains ${this.connections.length} connection(s)`);if(e)try{for(let r of this.connections)await r.changeKeyspace(e)}catch{this.log("warning",`Connection(s) to host ${this._address} could not be switched to keyspace ${e}`)}}_createConnection(){let e=this.options.sni?this._host.hostId.toString():this._address,r=new dq(e,this.protocolVersion,this.options);return this._addListeners(r),r}_addListeners(e){e.on("responseDequeued",()=>this.responseCounter++);let r=this;function n(){r.remove(e)}c(n,"connectionErrorCallback"),e.on("idleRequestError",n),e.on("socketClose",n)}addExistingConnection(e){this._addListeners(e),this.connections=this.connections.slice(0),this.connections.push(e)}clearNewConnectionAttempt(){this._newConnectionTimeout&&(clearTimeout(this._newConnectionTimeout),this._newConnectionTimeout=null)}async _attemptNewConnection(){if(this._opening)return await za.fromEvent(this,"open");this._opening=!0;let e=this._createConnection(),r;try{await e.openAsync()}catch(n){r=n,this.log("warning",`Connection to ${this._address} could not be created: ${r}`,r)}if(this.isClosing()&&(this.log("info",`Connection to ${this._address} opened successfully but pool was being closed`),r=new Error("Connection closed")),r)za.toBackground(e.closeAsync());else{let n=this.connections.slice(0);n.push(e),this.connections=n,this.log("info",`Connection to ${this._address} opened successfully`)}if(this._opening=!1,this.emit("open",r,e),r)throw r}attemptNewConnectionImmediate(){let e=this;function r(){e.clearNewConnectionAttempt(),e.scheduleNewConnectionAttempt(0)}if(c(r,"openConnection"),this._state===Br.initial)return r();if(this._state===Br.closing)return this.once("close",r)}remove(e){let r=this.connections.indexOf(e);if(r<0)return;let n=this.connections.slice(0);n.splice(r,1),this.connections=n,setImmediate(c(function(){e.close()},"removeClose")),this.emit("remove")}scheduleNewConnectionAttempt(e){if(this.isClosing())return;let r=this;this._newConnectionTimeout=setTimeout(c(function(){if(r._newConnectionTimeout=null,!(r.connections.length>=r.coreConnectionsLength)){if(e>0&&r.options.sni){za.toBackground(r.options.sni.addressResolver.refresh().then(()=>r._attemptNewConnection()));return}za.toBackground(r._attemptNewConnection())}},"newConnectionTimeoutExpired"),e)}hasScheduledNewConnection(){return!!this._newConnectionTimeout||this._opening}increaseSize(){this.connections.length<this.coreConnectionsLength&&!this.hasScheduledNewConnection()&&this.scheduleNewConnectionAttempt(0)}getAndResetResponseCounter(){let e=this.responseCounter;return this.responseCounter=0,e}isClosing(){return this._state!==Br.initial}drainAndShutdown(){if(this.isClosing())return;if(this._state=Br.closing,this.clearNewConnectionAttempt(),this.connections.length===0)return this._afterClosing();let e=this,r=this.connections;this.connections=Fu.emptyArray;let n=0;this.log("info",Wx.format("Draining and closing %d connections to %s",r.length,this._address));let i=!1,s;for(let u=0;u<r.length;u++){let l=r[u];if(l.getInFlight()===0){o(l)();continue}l.emitDrain=!0,l.once("drain",o(l))}function o(u){return c(function(){u.close(),!(++n<r.length)&&(i||(i=!0,s&&clearTimeout(s),e._afterClosing()))},"delayedClose")}c(o,"getDelayedClose");let a=(this.options.socketOptions.readTimeout||mq().socketOptions.readTimeout)+100;s=setTimeout(c(function(){i=!0,r.forEach(c(function(f){f.close()},"connectionEach")),e._afterClosing()},"checkShutdown"),a)}_afterClosing(){let e=this;function r(){e._state===Br.shuttingDown?e._state=Br.shutDown:e._state=Br.initial,e.emit("close"),e._state===Br.shutDown&&e.emit("shutdown")}if(c(r,"resetState"),this._opening)return this.once("open",r);r()}async shutdown(){if(this.clearNewConnectionAttempt(),!this.connections.length){this._state=Br.shutDown;return}let e=this._state;if(this._state=Br.shuttingDown,e===Br.closing||e===Br.shuttingDown)return za.fromEvent(this,"shutdown");await this._closeAllConnections(),this._state=Br.shutDown,this.emit("shutdown")}async _closeAllConnections(){let e=this.connections;this.connections=Fu.emptyArray,e.length!==0&&(this.log("info",Wx.format("Closing %d connections to %s",e.length,this._address)),await Promise.all(e.map(r=>r.closeAsync())))}};c(qu,"HostConnectionPool");var $p=qu;function mq(){return Hp===void 0&&(Hp=gq.defaultOptions()),Hp}c(mq,"getDefaultOptions");Qx.exports=$p});var zp=_((MQ,Jx)=>{"use strict";var Gp=ze(),Zx=oe(),vq=Ke(),Xx=fr(),Xr=class Xr{constructor(e,r){this._client=e,this._loadBalancing=r,this.logEmitter=e.options.logEmitter,this.log=Zx.log}static async getPrepared(e,r,n,i){let s=e.metadata.getPreparedInfo(i,n);return s.queryId?s:s.preparing?await Xx.fromEvent(s,"prepared"):await new Xr(e,r)._prepare(s,n,i)}static async getPreparedMultiple(e,r,n,i){let s=[];for(let o of n){let a;if(o&&(a=typeof o=="string"?o:o.query),typeof a!="string")throw new Gp.ArgumentError("Query item should be a string");let{queryId:u,meta:l}=await Xr.getPrepared(e,r,a,i);s.push({query:a,params:Zx.adaptNamedParamsPrepared(o.params,l.columns),queryId:u,meta:l})}return s}async _prepare(e,r,n){e.preparing=!0;let i;try{return i=await Xx.newQueryPlan(this._loadBalancing,n,null),await this._prepareWithQueryPlan(e,i,r,n)}catch(s){throw e.preparing=!1,s.query=r,e.emit("prepared",s),s}}async _prepareWithQueryPlan(e,r,n,i){let s={};for(;;){let o=Xr.getNextHost(r,this._client.profileManager,s);if(o===null)throw new Gp.NoHostAvailableError(s);try{let u=await(await Xr._borrowWithKeyspace(o,i)).prepareOnceAsync(n,i);return this._client.options.prepareOnAllHosts&&await this._prepareOnAllHosts(r,n,i),e.preparing=!1,e.queryId=u.id,e.meta=u.meta,this._client.metadata.setPreparedById(e),e.emit("prepared",null,e),e}catch(a){if(s[o.address]=a,!a.isSocketError&&!(a instanceof Gp.OperationTimedOutError))throw a}}}static getNextHost(e,r,n){let i;for(;;){let s=e.next();if(s.done)return null;if(i=s.value,r.getDistance(i)!==vq.distance.ignored){if(i.isUp())break;n&&(n[i.address]="Host considered as DOWN")}}return i}static async prepareAllQueries(e,r){let n=[],i=new Map;r.forEach(s=>{let o;s.keyspace?(o=i.get(s.keyspace),o||(o=[],i.set(s.keyspace,o))):o=n,o.push(s.query)});for(let[s,o]of i)await Xr._borrowAndPrepare(e,s,o);await Xr._borrowAndPrepare(e,null,n)}static async _borrowAndPrepare(e,r,n){if(n.length===0)return;let i=await Xr._borrowWithKeyspace(e,r);for(let s of n)await i.prepareOnceAsync(s,r)}static async _borrowWithKeyspace(e,r){let n=e.borrowConnection();return r&&n.keyspace!==r&&await n.changeKeyspace(r),n}_prepareOnAllHosts(e,r,n){let i=[r],s,o=[];for(;(s=Xr.getNextHost(e,this._client.profileManager))!==null;)o.push(s);return Promise.all(o.map(a=>Xr._borrowAndPrepare(a,n,i).catch(u=>this.log("verbose",`Unexpected error while preparing query (${r}) on ${a.address}`,u))))}};c(Xr,"PrepareHandler");var jp=Xr;Jx.exports=jp});var rT=_((HQ,tT)=>{"use strict";var eT=require("events"),Uu=oe(),Vu=Ke(),Eq=Yx(),Sq=zp(),Cq=fr(),wq=200,Yp=class Yp extends eT.EventEmitter{constructor(e,r,n,i){super(),this.address=e,this.setDownAt=0,this.log=Uu.log,this.isUpSince=null,Object.defineProperty(this,"options",{value:n,enumerable:!1,writable:!1}),Object.defineProperty(this,"pool",{value:new Eq(this,r),enumerable:!1}),this.pool.on("open",s=>Cq.toBackground(this._onNewConnectionOpen(s))),this.pool.on("remove",()=>this._checkPoolState()),this.cassandraVersion=null,this.datacenter=null,this.rack=null,this.tokens=null,this.hostId=null,this.dseVersion=null,this.workloads=Uu.emptyArray,this._distance=Vu.distance.ignored,this._healthResponseCounter=0,Object.defineProperty(this,"_metadata",{value:i,enumerable:!1}),Object.defineProperty(this,"_healthResponseCountTimer",{value:null,enumerable:!1,writable:!0}),this.reconnectionSchedule=this.options.policies.reconnection.newSchedule(),this.reconnectionDelay=0}setDown(){this.setDownAt===0&&(this.pool.isClosing()||(this.setDownAt=Date.now(),this.pool.coreConnectionsLength>0?this.log("warning",`Host ${this.address} considered as DOWN. Reconnection delay ${this.reconnectionDelay}ms.`):this.log("info",`Host ${this.address} considered as DOWN.`),this.emit("down"),this._checkPoolState()))}setUp(e){this.setDownAt&&(this.log("info",`Setting host ${this.address} as UP`),this.setDownAt=0,this.isUpSince=Date.now(),this.reconnectionSchedule=this.options.policies.reconnection.newSchedule(),e&&this.pool.clearNewConnectionAttempt(),this.emit("up"))}checkIsUp(){this.isUp()||(this.reconnectionSchedule=this.options.policies.reconnection.newSchedule(),this.reconnectionDelay=0,this.pool.attemptNewConnectionImmediate())}shutdown(e){return this._healthResponseCountTimer&&clearInterval(this._healthResponseCountTimer),e?(this.pool.drainAndShutdown(),Promise.resolve()):this.pool.shutdown()}isUp(){return!this.setDownAt}canBeConsideredAsUp(){let e=this;function r(){return new Date().getTime()-e.setDownAt>=e.reconnectionDelay}return c(r,"hasTimePassed"),!this.setDownAt||r()}setDistance(e){let r=this._distance;return this._distance=e||Vu.distance.local,this.options.pooling.coreConnectionsPerHost?this.pool.coreConnectionsLength=this.options.pooling.coreConnectionsPerHost[this._distance]||0:this.pool.coreConnectionsLength=1,this._distance===r?this._distance:(this._healthResponseCountTimer&&clearInterval(this._healthResponseCountTimer),this._distance===Vu.distance.ignored?(this.emit("ignore"),this.pool.drainAndShutdown()):(this.isUp()||this.checkIsUp(),this._healthResponseCountTimer=setInterval(()=>{this._healthResponseCounter=this.pool.getAndResetResponseCounter()},wq)),this._distance)}setProtocolVersion(e){this.pool.protocolVersion=e}borrowConnection(e){return this.pool.borrowConnection(e)}warmupPool(e){return this.pool.warmup(e)}initializePool(){this.pool.increaseSize()}getActiveConnection(){return!this.isUp()||!this.pool.connections.length?null:this.pool.connections[0]}getResponseCount(){return this._healthResponseCounter+this.pool.responseCounter}checkHealth(e){e.timedOutOperations<=this.options.socketOptions.defunctReadTimeoutThreshold||this.removeFromPool(e)}removeFromPool(e){this.pool.remove(e),this._checkPoolState()}getInFlight(){return this.pool.getInFlight()}_checkPoolState(){if(this.pool.isClosing())return;this.pool.connections.length<this.pool.coreConnectionsLength&&(this.pool.hasScheduledNewConnection()||(this.reconnectionDelay=this.reconnectionSchedule.next().value,this.pool.scheduleNewConnectionAttempt(this.reconnectionDelay))),this._distance!==Vu.distance.ignored&&this.pool.coreConnectionsLength>0&&this.pool.connections.length===0&&this.setDown()}async _onNewConnectionOpen(e){if(e){this._checkPoolState();return}if(!this.isUp()&&this.options.rePrepareOnUp){this.log("info",`Re-preparing all queries on host ${this.address} before setting it as UP`);let r=this._metadata.getAllPrepared();try{await Sq.prepareAllQueries(this,r)}catch(n){this.log("warning",`Failed re-preparing on host ${this.address}: ${n}`,n)}}this.setUp(),this.pool.increaseSize()}getCassandraVersion(){return this.cassandraVersion?this.cassandraVersion.split("-")[0].split(".").map(e=>parseInt(e,10)):Uu.emptyArray}getDseVersion(){return this.dseVersion?this.dseVersion.split("-")[0].split(".").map(e=>parseInt(e,10)):Uu.emptyArray}};c(Yp,"Host");var Wp=Yp,Zp=class Zp extends eT.EventEmitter{constructor(){super(),this._items=new Map,this._values=null,Object.defineProperty(this,"length",{get:()=>this.values().length,enumerable:!0})}forEach(e){let r=this._items;for(let[n,i]of r)e(i,n)}get(e){return this._items.get(e)}keys(){return Array.from(this._items.keys())}remove(e){let r=this._items.get(e);if(r===void 0)return;this._values=null;let n=new Map(this._items);n.delete(e),this._items=n,this.emit("remove",r)}removeMultiple(e){this._values=null;let r=new Map(this._items),n=[];for(let i of e){let s=r.get(i);s&&(n.push(s),r.delete(i))}this._items=r,n.forEach(i=>this.emit("remove",i))}set(e,r){this._values=null;let n=this._items.get(e);if(n){this._items.set(e,r),this.emit("remove",n),this.emit("add",r);return}let i=new Map(this._items);return i.set(e,r),this._items=i,this.emit("add",r),r}slice(e,r){return!e&&!r?this.values():this.values().slice(e||0,r)}push(e,r){this.set(e,r)}values(){return this._values||(this._values=Object.freeze(Array.from(this._items.values()))),this._values}clear(){let e=this.values();return this._values=null,this._items=new Map,e.forEach(r=>this.emit("remove",r)),e}inspect(){return this._items}toJSON(){if(Object.fromEntries)return Object.fromEntries(this._items);let e={};for(let[r,n]of this._items)e[r]=n;return e}};c(Zp,"HostMap");var Qp=Zp;tT.exports={Host:Wp,HostMap:Qp}});var iT=_(Hu=>{"use strict";var xq=Ke(),Ai=Fa(),Xp=oe(),vt=fp(),{Integer:Ht}=xq,Mu=new vt(21461,4418,31633,34755),Ku=new vt(37759,10053,44355,19701),nT=vt.fromNumber(5),Tq=new vt(36045,60757,45015,65361),_q=new vt(60499,6789,47614,50382),bq=vt.fromNumber(1390208809),Iq=vt.fromNumber(944331445),r0=class r0{constructor(){}hash(e){throw new Error("You must implement a hash function for the tokenizer")}parse(e){throw new Error("You must implement a parse function for the tokenizer")}minToken(){throw new Error("You must implement a minToken function for the tokenizer")}split(e,r,n){throw new Error("You must implement a split function for the tokenizer")}splitBase(e,r,n,i,s){let o=Ht.fromInt(s),a=r.divide(o),u=r.modulo(o),l=[],f=e,h=a.add(Ht.ONE);for(let p=1;p<s;p++)u.greaterThan(Ht.ZERO)?f=f.add(h):f=f.add(a),i&&f.greaterThan(n)&&(f=f.subtract(i)),l.push(f),u=u.subtract(Ht.ONE);return l}stringify(e){return e.getValue().toString()}};c(r0,"Tokenizer");var Qa=r0,n0=class n0 extends Qa{constructor(){super()}hash(e){let r=e,n=0,i=r.length,s=i>>4,o=new vt,a=new vt,u=new vt,l=new vt;for(let f=0;f<s;f++)u=this.getBlock(r,n,f*2),l=this.getBlock(r,n,f*2+1),u.multiply(Mu),this.rotl64(u,31),u.multiply(Ku),o.xor(u),this.rotl64(o,27),o.add(a),o.multiply(nT).add(bq),l.multiply(Ku),this.rotl64(l,33),l.multiply(Mu),a.xor(l),this.rotl64(a,31),a.add(o),a.multiply(nT).add(Iq);switch(n+=s*16,u=new vt,l=new vt,i&15){case 15:l.xor(pr(r[n+14]).shiftLeft(48));case 14:l.xor(pr(r[n+13]).shiftLeft(40));case 13:l.xor(pr(r[n+12]).shiftLeft(32));case 12:l.xor(pr(r[n+11]).shiftLeft(24));case 11:l.xor(pr(r[n+10]).shiftLeft(16));case 10:l.xor(pr(r[n+9]).shiftLeft(8));case 9:l.xor(pr(r[n+8])),l.multiply(Ku),this.rotl64(l,33),l.multiply(Mu),a.xor(l);case 8:u.xor(pr(r[n+7]).shiftLeft(56));case 7:u.xor(pr(r[n+6]).shiftLeft(48));case 6:u.xor(pr(r[n+5]).shiftLeft(40));case 5:u.xor(pr(r[n+4]).shiftLeft(32));case 4:u.xor(pr(r[n+3]).shiftLeft(24));case 3:u.xor(pr(r[n+2]).shiftLeft(16));case 2:u.xor(pr(r[n+1]).shiftLeft(8));case 1:u.xor(pr(r[n])),u.multiply(Mu),this.rotl64(u,31),u.multiply(Ku),o.xor(u)}return o.xor(vt.fromNumber(i)),a.xor(vt.fromNumber(i)),o.add(a),a.add(o),this.fmix(o),this.fmix(a),o.add(a),new Ai.Murmur3Token(o)}getBlock(e,r,n){let i=n<<3,s=r+i;return new vt(e[s]|e[s+1]<<8,e[s+2]|e[s+3]<<8,e[s+4]|e[s+5]<<8,e[s+6]|e[s+7]<<8)}rotl64(e,r){let n=e.clone().shiftLeft(r);e.shiftRightUnsigned(64-r).or(n)}fmix(e){e.xor(new vt(e.getUint16(2)>>>1|e.getUint16(3)<<15&65535,e.getUint16(3)>>>1,0,0)),e.multiply(Tq);let r=new vt(e.getUint16(2)>>>1|e.getUint16(3)<<15&65535,e.getUint16(3)>>>1,0,0);e.xor(r),e.multiply(_q),e.xor(new vt(e.getUint16(2)>>>1|e.getUint16(3)<<15&65535,e.getUint16(3)>>>1,0,0))}parse(e){return new Ai.Murmur3Token(vt.fromString(e))}minToken(){return this._minToken||(this._minToken=this.parse("-9223372036854775808")),this._minToken}maxToken(){return this._maxToken||(this._maxToken=this.parse("9223372036854775807")),this._maxToken}maxValue(){return this._maxValue||(this._maxValue=Ht.fromString("9223372036854775807")),this._maxValue}minValue(){return this._minValue||(this._minValue=Ht.fromString("-9223372036854775808")),this._minValue}ringLength(){return this._ringLength||(this._ringLength=this.maxValue().subtract(this.minValue())),this._ringLength}split(e,r,n){e.equals(r)&&e.equals(this.minToken())&&(r=this.maxToken());let i=Ht.fromString(e.getValue().toString()),o=Ht.fromString(r.getValue().toString()).subtract(i);return o.isNegative()&&(o=o.add(this.ringLength())),this.splitBase(i,o,this.maxValue(),this.ringLength(),n).map(u=>this.parse(u.toString()))}stringify(e){let r=e.getValue();return r.getUint16(0)+","+r.getUint16(1)+","+r.getUint16(2)+","+r.getUint16(3)}};c(n0,"Murmur3Tokenizer");var Jp=n0,i0=class i0 extends Qa{constructor(){super(),this._crypto=require("crypto")}hash(e){Array.isArray(e)&&(e=Xp.allocBufferFromArray(e));let r=this._crypto.createHash("md5").update(e).digest();return new Ai.RandomToken(Ht.fromBuffer(r).abs())}parse(e){return new Ai.RandomToken(Ht.fromString(e))}minToken(){return this._minToken||(this._minToken=this.parse("-1")),this._minToken}maxValue(){return this._maxValue||(this._maxValue=Ht.fromNumber(Math.pow(2,127))),this._maxValue}maxToken(){return this._maxToken||(this._maxToken=new Ai.RandomToken(this.maxValue())),this._maxToken}ringLength(){return this._ringLength||(this._ringLength=this.maxValue().add(Ht.ONE)),this._ringLength}split(e,r,n){e.equals(r)&&e.equals(this.minToken())&&(r=this.maxToken());let i=e.getValue(),o=r.getValue().subtract(i);return o.lessThan(Ht.ZERO)&&(o=o.add(this.ringLength())),this.splitBase(i,o,this.maxValue(),this.ringLength(),n).map(u=>new Ai.RandomToken(u))}};c(i0,"RandomTokenizer");var e0=i0,s0=class s0 extends Qa{constructor(){super()}hash(e){Array.isArray(e)&&(e=Xp.allocBufferFromArray(e));let r=e.length;for(let n=e.length-1;n>0&&e[n]===0;n--)r=n;return new Ai.ByteOrderedToken(e.slice(0,r))}stringify(e){return e.getValue().toString("hex")}parse(e){return this.hash(Xp.allocBufferFromString(e,"hex"))}minToken(){return this._minToken||(this._minToken=this.hash([])),this._minToken}_toNumber(e,r){let n=e;e.length!==r&&(n=Buffer.alloc(r),e.copy(n));let i=new Array(Math.ceil(n.length/4));for(let s=0;s<i.length;s++){let o=n.length-(s+1)*4,a;if(o<0){o=o+4,a=0;for(let u=0;u<o;u++){let l=n[u];a=a|l<<(o-u-1)*8}}else a=n.readInt32BE(o);i[s]=a}return new Ht(i,0)}_toBuffer(e,r){let n=Ht.toBuffer(e);if(n.length===r)return n;let i,s;n[0]===0?(i=1,s=n.length-1):(i=0,s=n.length);let o=Buffer.alloc(r);return n.copy(o,r-s,i,s+i),o}split(e,r,n){let i=e.compare(r);if(i===0&&e.equals(this.minToken()))throw new Error("Cannot split whole ring with ordered partitioner");let s,o,a,u,l,f=Ht.fromNumber(n),h=Math.max(e.getValue().length,r.getValue().length);if(i<0){let g=0;for(;s=this._toNumber(e.getValue(),h),o=this._toNumber(r.getValue(),h),a=o.subtract(s),!(g===4||a.compare(f)>=0);)h+=1,g+=1}else{let g=0;for(;s=this._toNumber(e.getValue(),h),o=this._toNumber(r.getValue(),h),u=Ht.fromNumber(Math.pow(2,h*8)),l=u.subtract(Ht.ONE),a=o.subtract(s).add(u),!(g===4||a.compare(f)>=0);)h+=1,g+=1}return this.splitBase(s,a,l,u,n).map(g=>new Ai.ByteOrderedToken(this._toBuffer(g,h)))}};c(s0,"ByteOrderedTokenizer");var t0=s0;function pr(t){return t<128?new vt(t,0,0,0):new vt(t-256&65535,65535,65535,65535)}c(pr,"fromSignedByte");Hu.Murmur3Tokenizer=Jp;Hu.RandomTokenizer=e0;Hu.ByteOrderedTokenizer=t0});var o0=_((zQ,aT)=>{"use strict";var Aq=require("util"),sT=require("events");function oT(t){sT.EventEmitter.call(this),this.setMaxListeners(0),Object.defineProperty(this,"loading",{value:!1,enumerable:!1,writable:!0}),Object.defineProperty(this,"loaded",{value:!1,enumerable:!1,writable:!0}),this.name=t,this.bloomFilterFalsePositiveChance=0,this.caching=null,this.comment=null,this.gcGraceSeconds=0,this.compactionClass=null,this.compactionOptions=null,this.compression=null,this.localReadRepairChance=0,this.readRepairChance=0,this.extensions=null,this.crcCheckChance=null,this.populateCacheOnFlush=!1,this.defaultTtl=0,this.speculativeRetry="NONE",this.minIndexInterval=128,this.maxIndexInterval=2048,this.columns=null,this.columnsByName=null,this.partitionKeys=[],this.clusteringKeys=[],this.clusteringOrder=[],this.nodesync=null}c(oT,"DataCollection");Aq.inherits(oT,sT.EventEmitter);aT.exports=oT});var fT=_((QQ,lT)=>{"use strict";var Nq=require("util"),cT=o0();function uT(t){cT.call(this,t),this.replicateOnWrite=!0,this.memtableFlushPeriod=0,this.indexInterval=null,this.isCompact=!1,this.indexes=null,this.cdc=null,this.virtual=!1}c(uT,"TableMetadata");Nq.inherits(uT,cT);lT.exports=uT});var dT=_((ZQ,hT)=>{"use strict";function Bq(){this.name=null,this.keyspaceName=null,this.signature=null,this.argumentTypes=null,this.stateFunction=null,this.stateType=null,this.finalFunction=null,this.initConditionRaw=null,this.initCondition=null,this.returnType=null,this.deterministic=null}c(Bq,"Aggregate");hT.exports=Bq});var gT=_((JQ,pT)=>{"use strict";function Rq(){this.name=null,this.keyspaceName=null,this.signature=null,this.argumentNames=null,this.argumentTypes=null,this.body=null,this.calledOnNullInput=null,this.language=null,this.returnType=null,this.deterministic=null,this.monotonic=null,this.monotonicOn=null}c(Rq,"SchemaFunction");pT.exports=Rq});var mT=_((tY,yT)=>{"use strict";var a0=require("util"),Oq=oe(),c0=Ke(),Ya={custom:0,keys:1,composites:2};function Ni(t,e,r,n){this.name=t,this.target=e,this.kind=typeof r=="string"?u0(r):r,this.options=n}c(Ni,"Index");Ni.prototype.isCompositesKind=function(){return this.kind===Ya.composites};Ni.prototype.isKeysKind=function(){return this.kind===Ya.keys};Ni.prototype.isCustomKind=function(){return this.kind===Ya.custom};Ni.fromRows=function(t){return!t||t.length===0?Oq.emptyArray:t.map(function(e){let r=e.options;return new Ni(e.index_name,r.target,u0(e.kind),r)})};Ni.fromColumnRows=function(t,e){let r=[];for(let n=0;n<t.length;n++){let i=t[n],s=i.index_name;if(!s)continue;let o=e[i.column_name],a,u=JSON.parse(i.index_options);u!==null&&u.index_keys!==void 0?a=a0.format("keys(%s)",o.name):u!==null&&u.index_keys_and_values!==void 0?a=a0.format("entries(%s)",o.name):o.type.options.frozen&&(o.type.code===c0.dataTypes.map||o.type.code===c0.dataTypes.list||o.type.code===c0.dataTypes.set)?a=a0.format("full(%s)",o.name):a=o.name,r.push(new Ni(s,a,u0(i.index_type),u))}return r};function u0(t){return t?Ya[t.toLowerCase()]:Ya.custom}c(u0,"getKindByName");yT.exports=Ni});var CT=_((nY,ST)=>{"use strict";var Dq=require("util"),vT=o0();function ET(t){vT.call(this,t),this.tableName=null,this.whereClause=null,this.includeAllColumns=!1}c(ET,"MaterializedView");Dq.inherits(ET,vT);ST.exports=ET});var RT=_(h0=>{"use strict";var Za=require("util"),wT=require("events"),Lq=Ke(),Xt=oe(),Pq=ze(),$u=fr(),kq=fT(),_T=dT(),bT=gT(),IT=mT(),xT=CT(),{format:ds}=Za,Fq="SELECT * FROM system.schema_keyspaces",qq="SELECT * FROM system.schema_keyspaces where keyspace_name = '%s'",AT="SELECT * FROM system_schema.keyspaces",NT="SELECT * FROM system_schema.keyspaces where keyspace_name = '%s'",Uq="SELECT * FROM system.schema_columnfamilies WHERE keyspace_name='%s' AND columnfamily_name='%s'",Vq="SELECT * FROM system_schema.tables WHERE keyspace_name='%s' AND table_name='%s'",Mq="SELECT * FROM system.schema_columns WHERE keyspace_name='%s' AND columnfamily_name='%s'",Kq="SELECT * FROM system_schema.columns WHERE keyspace_name='%s' AND table_name='%s'",Hq="SELECT * FROM system_schema.indexes WHERE keyspace_name='%s' AND table_name='%s'",$q="SELECT * FROM system.schema_usertypes WHERE keyspace_name='%s' AND type_name='%s'",Gq="SELECT * FROM system_schema.types WHERE keyspace_name='%s' AND type_name='%s'",jq="SELECT * FROM system.schema_functions WHERE keyspace_name = '%s' AND function_name = '%s'",zq="SELECT * FROM system_schema.functions WHERE keyspace_name = '%s' AND function_name = '%s'",Wq="SELECT * FROM system.schema_aggregates WHERE keyspace_name = '%s' AND aggregate_name = '%s'",Qq="SELECT * FROM system_schema.aggregates WHERE keyspace_name = '%s' AND aggregate_name = '%s'",Yq="SELECT * FROM system_schema.views WHERE keyspace_name = '%s' AND view_name = '%s'",Zq="SELECT * FROM system_virtual_schema.keyspaces",Xq="SELECT * FROM system_virtual_schema.keyspaces where keyspace_name = '%s'",TT="SELECT * FROM system_virtual_schema.tables where keyspace_name = '%s' and table_name='%s'",Jq="SELECT * FROM system_virtual_schema.columns where keyspace_name = '%s' and table_name='%s'",d0=class d0{constructor(e,r){this.cc=r,this.encodingOptions=e.encoding,this.selectTable=null,this.selectColumns=null,this.selectIndexes=null,this.selectUdt=null,this.selectAggregates=null,this.selectFunctions=null,this.supportsVirtual=!1}_createKeyspace(e,r,n,i,s){return{name:e,durableWrites:r,strategy:n,strategyOptions:i,virtual:s===!0,udts:{},tables:{},functions:{},aggregates:{},views:{},tokenToReplica:r6(n,i),graphEngine:void 0}}getKeyspace(e){}getKeyspaces(e){}async getTable(e,r,n,i){let s=n&&n[r];if(s||(s=new kq(r),n&&(n[r]=s)),s.loaded)return s;if(s.loading)return $u.fromEvent(s,"load");try{s.loading=!0;let o,a=i,u=a?TT:this.selectTable,l=Za.format(u,e,r),f=await this._getFirstRow(l);if(!f&&this.supportsVirtual&&a===void 0){let g=Za.format(TT,e,r);try{f=await this._getFirstRow(g)}catch{}f&&(a=!0)}if(!f)return s.loading=!1,s.emit("load",null,null),null;let h=a?Jq:this.selectColumns,p=await this._getRows(Za.format(h,e,r));return this.selectIndexes&&!a&&(o=await this._getRows(Za.format(this.selectIndexes,e,r))),await this._parseTableOrView(s,f,p,o,a),s.loaded=!0,s.emit("load",null,s),s}catch(o){throw s.emit("load",o,null),o}finally{s.loading=!1}}async _getFirstRow(e){return(await this._getRows(e))[0]}async _getRows(e){return(await this.cc.query(e)).rows}async getUdt(e,r,n){let i=n&&n[r];if(i||(i=new wT.EventEmitter,n&&(n[r]=i),i.setMaxListeners(0),i.loading=!1,i.name=r,i.keyspace=e,i.fields=null),i.fields)return i;if(i.loading)return $u.fromEvent(i,"load");i.loading=!0;let s=ds(this.selectUdt,e,r);try{let o=await this._getFirstRow(s);return o?(await this._parseUdt(i,o),i.emit("load",null,i),i):(i.loading=!1,i.emit("load",null,null),null)}catch(o){throw i.emit("load",o),o}finally{i.loading=!1}}_parseUdt(e,r){}async _parseTableOrView(e,r,n,i,s){}getMaterializedView(e,r,n){}async getFunctions(e,r,n,i){let s=this.selectFunctions,o=c(u=>this._parseFunction(u),"parser");n&&(s=this.selectAggregates,o=c(u=>this._parseAggregate(u),"parser"));let a=i&&i[r];if(a||(a=new wT.EventEmitter,i&&(i[r]=a),a.setMaxListeners(0)),a.values)return a.values;if(a.loading)return $u.fromEvent(a,"load");a.loading=!0;try{let u=await this._getRows(ds(s,e,r)),l=await Promise.all(u.map(o)),f=new Map;return u.length>0&&(a.values=f),l.forEach(h=>a.values.set(h.signature.join(","),h)),a.emit("load",null,f),f}catch(u){throw a.emit("load",u),u}finally{a.loading=!1}}_parseAggregate(e){}_parseFunction(e){}_asMap(e){return e?this.encodingOptions.map&&e instanceof this.encodingOptions.map?e:new Map(Object.keys(e).map(r=>[r,e[r]])):new Map}_mapAsObject(e){if(!e)return e;if(this.encodingOptions.map&&e instanceof this.encodingOptions.map){let r={};return e.forEach((n,i)=>r[i]=n),r}return e}};c(d0,"SchemaParser");var Gu=d0,p0=class p0 extends Gu{constructor(e,r){super(e,r),this.selectTable=Uq,this.selectColumns=Mq,this.selectUdt=$q,this.selectAggregates=Wq,this.selectFunctions=jq}async getKeyspaces(e){let r={},n=await this.cc.query(Fq,e);for(let i=0;i<n.rows.length;i++){let s=n.rows[i],o=this._createKeyspace(s.keyspace_name,s.durable_writes,s.strategy_class,JSON.parse(s.strategy_options||null));r[o.name]=o}return r}async getKeyspace(e){let r=await this._getFirstRow(ds(qq,e));return r?this._createKeyspace(r.keyspace_name,r.durable_writes,r.strategy_class,JSON.parse(r.strategy_options)):null}async _parseTableOrView(e,r,n,i,s){let o,a,u,l=this.cc.getEncoder(),f={},h=[],p=[];e.bloomFilterFalsePositiveChance=r.bloom_filter_fp_chance,e.caching=r.caching,e.comment=r.comment,e.compactionClass=r.compaction_strategy_class,e.compactionOptions=JSON.parse(r.compaction_strategy_options),e.compression=JSON.parse(r.compression_parameters),e.gcGraceSeconds=r.gc_grace_seconds,e.localReadRepairChance=r.local_read_repair_chance,e.readRepairChance=r.read_repair_chance,e.populateCacheOnFlush=r.populate_io_cache_on_flush||e.populateCacheOnFlush,e.memtableFlushPeriod=r.memtable_flush_period_in_ms||e.memtableFlushPeriod,e.defaultTtl=r.default_time_to_live||e.defaultTtl,e.speculativeRetry=r.speculative_retry||e.speculativeRetry,e.indexInterval=r.index_interval||e.indexInterval,typeof r.min_index_interval<"u"?(e.minIndexInterval=r.min_index_interval||e.minIndexInterval,e.maxIndexInterval=r.max_index_interval||e.maxIndexInterval):(e.minIndexInterval=null,e.maxIndexInterval=null),typeof r.replicate_on_write<"u"&&(e.replicateOnWrite=r.replicate_on_write),e.columns=[];for(let y=0;y<n.length;y++){let v=n[y],m=l.parseFqTypeName(v.validator);switch(o={name:v.column_name,type:m,isStatic:!1},e.columns.push(o),f[o.name]=o,v.type){case"partition_key":h.push({c:o,index:v.component_index||0});break;case"clustering_key":p.push({c:o,index:v.component_index||0,order:o.type.options.reversed?"DESC":"ASC"});break;case"static":o.isStatic=!0;break}}h.length>0&&(e.partitionKeys=h.sort(Xt.propCompare("index")).map(y=>y.c),p.sort(Xt.propCompare("index")),e.clusteringKeys=p.map(y=>y.c),e.clusteringOrder=p.map(y=>y.order));let g=e.partitionKeys.length===0;if(g&&r.key_aliases){h=JSON.parse(r.key_aliases),u=l.parseKeyTypes(r.key_validator).types;for(let y=0;y<h.length;y++)a=h[y],o=f[a],o||(o={name:a,type:u[y]},e.columns.push(o)),e.partitionKeys.push(o)}let d=l.parseKeyTypes(r.comparator);if(g&&r.column_aliases){p=JSON.parse(r.column_aliases);for(let y=0;y<p.length;y++)a=p[y],o=f[a],o||(o={name:a,type:d.types[y]},e.columns.push(o)),e.clusteringKeys.push(o),e.clusteringOrder.push(o.type.options.reversed?"DESC":"ASC")}e.isCompact=!!r.is_dense,e.isCompact||(e.isCompact=!d.isComposite||!d.hasCollections&&e.clusteringKeys.length!==d.types.length-1),a=r.value_alias,e.isCompact&&a&&!f[a]&&(o={name:a,type:l.parseFqTypeName(r.default_validator)},e.columns.push(o),f[a]=o),e.columnsByName=f,e.indexes=IT.fromColumnRows(n,e.columnsByName)}getMaterializedView(e,r,n){return Promise.reject(new Pq.NotSupportedError("Materialized views are not supported on Cassandra versions below 3.0"))}async _parseAggregate(e){let r=this.cc.getEncoder(),n=new _T;n.name=e.aggregate_name,n.keyspaceName=e.keyspace_name,n.signature=e.signature||Xt.emptyArray,n.stateFunction=e.state_func,n.finalFunction=e.final_func,n.initConditionRaw=e.initcond,n.argumentTypes=(e.argument_types||Xt.emptyArray).map(s=>r.parseFqTypeName(s)),n.stateType=r.parseFqTypeName(e.state_type);let i=r.decode(n.initConditionRaw,n.stateType);return i!==null&&typeof i<"u"&&(n.initCondition=i.toString()),n.returnType=r.parseFqTypeName(e.return_type),n}async _parseFunction(e){let r=this.cc.getEncoder(),n=new bT;return n.name=e.function_name,n.keyspaceName=e.keyspace_name,n.signature=e.signature||Xt.emptyArray,n.argumentNames=e.argument_names||Xt.emptyArray,n.body=e.body,n.calledOnNullInput=e.called_on_null_input,n.language=e.language,n.argumentTypes=(e.argument_types||Xt.emptyArray).map(i=>r.parseFqTypeName(i)),n.returnType=r.parseFqTypeName(e.return_type),n}async _parseUdt(e,r){let n=this.cc.getEncoder(),i=r.field_names,s=r.field_types,o=new Array(i.length);for(let a=0;a<i.length;a++)o[a]={name:i[a],type:n.parseFqTypeName(s[a])};return e.fields=o,e}};c(p0,"SchemaParserV1");var l0=p0,g0=class g0 extends Gu{constructor(e,r,n){super(e,r),this.udtResolver=n,this.selectTable=Vq,this.selectColumns=Kq,this.selectUdt=Gq,this.selectAggregates=Qq,this.selectFunctions=zq,this.selectIndexes=Hq}async getKeyspaces(e){let r={},n=await this.cc.query(AT,e);for(let i=0;i<n.rows.length;i++){let s=this._parseKeyspace(n.rows[i]);r[s.name]=s}return r}async getKeyspace(e){let r=await this._getFirstRow(ds(NT,e));return r?this._parseKeyspace(r):null}async getMaterializedView(e,r,n){let i=n&&n[r];if(i||(i=new xT(r),n&&(n[r]=i)),i.loaded)return i;if(i.loading)return $u.fromEvent(i,"load");i.loading=!0;try{let s=await this._getFirstRow(ds(Yq,e,r));if(!s)return i.emit("load",null,null),i.loading=!1,null;let o=await this._getRows(ds(this.selectColumns,e,r));return await this._parseTableOrView(i,s,o,null,!1),i.loaded=!0,i.emit("load",null,i),i}catch(s){throw i.emit("load",s),s}finally{i.loading=!1}}_parseKeyspace(e,r){let n=e.replication,i,s;if(n){i=n.class,s={};for(let a in n)!n.hasOwnProperty(a)||a==="class"||(s[a]=n[a])}let o=this._createKeyspace(e.keyspace_name,e.durable_writes,i,s,r);return o.graphEngine=e.graph_engine,o}async _parseTableOrView(e,r,n,i,s){let o=this.cc.getEncoder(),a={},u=[],l=[];if(e.columns=await Promise.all(n.map(async m=>{let w=await o.parseTypeName(r.keyspace_name,m.type,0,null,this.udtResolver),x={name:m.column_name,type:w,isStatic:!1};switch(a[x.name]=x,m.kind){case"partition_key":u.push({c:x,index:m.position||0});break;case"clustering":l.push({c:x,index:m.position||0,order:m.clustering_order==="desc"?"DESC":"ASC"});break;case"static":x.isStatic=!0;break}return x})),e.columnsByName=a,e.partitionKeys=u.sort(Xt.propCompare("index")).map(m=>m.c),l.sort(Xt.propCompare("index")),e.clusteringKeys=l.map(m=>m.c),e.clusteringOrder=l.map(m=>m.order),s){e.virtual=!0;return}let f=e instanceof xT;e.bloomFilterFalsePositiveChance=r.bloom_filter_fp_chance,e.caching=JSON.stringify(r.caching),e.comment=r.comment;let h=this._asMap(r.compaction);if(h&&(e.compactionOptions={},e.compactionClass=h.get("class"),h.forEach((m,w)=>{w!=="class"&&(e.compactionOptions[w]=h.get(w))})),e.compression=this._mapAsObject(r.compression),e.gcGraceSeconds=r.gc_grace_seconds,e.localReadRepairChance=r.dclocal_read_repair_chance,e.readRepairChance=r.read_repair_chance,e.extensions=this._mapAsObject(r.extensions),e.crcCheckChance=r.crc_check_chance,e.memtableFlushPeriod=r.memtable_flush_period_in_ms||e.memtableFlushPeriod,e.defaultTtl=r.default_time_to_live||e.defaultTtl,e.speculativeRetry=r.speculative_retry||e.speculativeRetry,e.minIndexInterval=r.min_index_interval||e.minIndexInterval,e.maxIndexInterval=r.max_index_interval||e.maxIndexInterval,e.nodesync=r.nodesync||e.nodesync,!f){let m=r.cdc;m!==void 0&&(e.cdc=m)}if(f){e.tableName=r.base_table_name,e.whereClause=r.where_clause,e.includeAllColumns=r.include_all_columns;return}e.indexes=this._getIndexes(i);let p=r.flags;Array.isArray(p)&&(p=new Set(p));let g=p.has("dense"),d=p.has("super"),y=p.has("compound");e.isCompact=d||g||!y,!d&&!g&&!y?e6(e):g&&t6(e)}_getIndexes(e){return!e||e.length===0?Xt.emptyArray:e.map(r=>{let n=this._mapAsObject(r.options);return new IT(r.index_name,n.target,r.kind,n)})}async _parseAggregate(e){let r=this.cc.getEncoder(),n=new _T;return n.name=e.aggregate_name,n.keyspaceName=e.keyspace_name,n.signature=e.argument_types||Xt.emptyArray,n.stateFunction=e.state_func,n.finalFunction=e.final_func,n.initConditionRaw=e.initcond,n.initCondition=n.initConditionRaw,n.deterministic=e.deterministic||!1,n.argumentTypes=await Promise.all(n.signature.map(i=>r.parseTypeName(e.keyspace_name,i,0,null,this.udtResolver))),n.stateType=await r.parseTypeName(e.keyspace_name,e.state_type,0,null,this.udtResolver),n.returnType=await r.parseTypeName(e.keyspace_name,e.return_type,0,null,this.udtResolver),n}async _parseFunction(e){let r=this.cc.getEncoder(),n=new bT;return n.name=e.function_name,n.keyspaceName=e.keyspace_name,n.signature=e.argument_types||Xt.emptyArray,n.argumentNames=e.argument_names||Xt.emptyArray,n.body=e.body,n.calledOnNullInput=e.called_on_null_input,n.language=e.language,n.deterministic=e.deterministic||!1,n.monotonic=e.monotonic||!1,n.monotonicOn=e.monotonic_on||Xt.emptyArray,n.argumentTypes=await Promise.all(n.signature.map(i=>r.parseTypeName(e.keyspace_name,i,0,null,this.udtResolver))),n.returnType=await r.parseTypeName(e.keyspace_name,e.return_type,0,null,this.udtResolver),n}async _parseUdt(e,r){let n=this.cc.getEncoder(),i=r.field_types,s=r.keyspace_name;return e.fields=await Promise.all(r.field_names.map(async(o,a)=>{let u=await n.parseTypeName(s,i[a],0,null,this.udtResolver);return{name:o,type:u}})),e}};c(g0,"SchemaParserV2");var ju=g0,y0=class y0 extends ju{constructor(e,r,n){super(e,r,n),this.supportsVirtual=!0}async getKeyspaces(e){let r={},n=[{query:AT,virtual:!1},{query:Zq,virtual:!0}];return await Promise.all(n.map(async i=>{let s=null;try{s=await this.cc.query(i.query,e)}catch(o){if(i.virtual)return;throw o}for(let o=0;o<s.rows.length;o++){let a=this._parseKeyspace(s.rows[o],i.virtual);r[a.name]=a}})),r}async getKeyspace(e){let r=await this._getKeyspace(NT,e,!1);return r||this._getKeyspace(Xq,e,!0)}async _getKeyspace(e,r,n){try{let i=await this._getFirstRow(ds(e,r));return i?this._parseKeyspace(i,n):null}catch(i){if(n)return null;throw i}}};c(y0,"SchemaParserV3");var f0=y0;function e6(t){let e,r;for(e=0;e<t.clusteringKeys.length;e++){r=t.clusteringKeys[e];let n=t.columns.indexOf(r);t.columns.splice(n,1),delete t.columnsByName[r.name]}for(t.clusteringKeys=Xt.emptyArray,t.clusteringOrder=Xt.emptyArray,e=t.columns.length;e--;){if(r=t.columns[e],!r.isStatic&&t.partitionKeys.indexOf(r)===-1){t.columns.splice(e,1),delete t.columnsByName[r.name];continue}r.isStatic=!1}}c(e6,"pruneStaticCompactTableColumns");function t6(t){let e=t.columns.length;for(;e--;){let r=t.columns[e];if(!r.isStatic&&r.type.code===Lq.dataTypes.custom&&r.type.info==="empty"){t.columns.splice(e,1),delete t.columnsByName[r.name];continue}r.isStatic=!1}}c(t6,"pruneDenseTableColumns");function r6(t,e){if(/SimpleStrategy$/.test(t)){let r=parseInt(e.replication_factor,10);if(r>1)return n6(r)}return/NetworkTopologyStrategy$/.test(t)?i6(e):c(function(n,i,s){let o={};for(let a in s)s.hasOwnProperty(a)&&(o[a]=[s[a]]);return o},"noStrategy")}c(r6,"getTokenToReplicaMapper");function n6(t){return c(function(r,n,i){let s=n.length,o=Math.min(t,s),a={};for(let u=0;u<s;u++){let l=n[u],f=[i[l]];for(let h=1;h<s&&f.length<o;h++){let p=u+h;p>=s&&(p=p%s);let g=i[n[p]];f.indexOf(g)===-1&&f.push(g)}a[l]=f}return a},"tokenSimpleStrategy")}c(n6,"getTokenToReplicaSimpleMapper");function i6(t){return c(function(r,n,i,s){let o={},a=n.length;for(let u=0;u<a;u++){let l=n[u],f=[],h={},p={},g=[];for(let d=0;d<a;d++){let y=u+d;y>=a&&(y=y%a);let v=i[n[y]];if(f.indexOf(v)!==-1)continue;let m=v.datacenter,w=parseInt(t[m],10);if(!w)continue;w=Math.min(w,s[m].hostLength);let x=h[m]||0;if(x>=w)continue;let A=p[m];if(A||(A=p[m]=new Xt.HashSet),v.rack&&A.contains(v.rack)&&A.length<s[m].racks.length){g.length<w-x&&g.push(v);continue}if(h[v.datacenter]=++x,f.push(v),v.rack&&A.add(v.rack)&&A.length===s[m].racks.length&&(h[m]+=s6(w,x,f,g)),BT(t,s,h))break}o[l]=f}return o},"tokenNetworkStrategy")}c(i6,"getTokenToReplicaNetworkMapper");function s6(t,e,r,n){let i;for(i=0;i<t-e&&i<n.length;i++)r.push(n[i]);return i}c(s6,"addSkippedHosts");function BT(t,e,r){let n=Object.keys(t);for(let i=0;i<n.length;i++){let s=n[i],o=e[s];if(!o)continue;let a=Math.min(parseInt(t[s],10),o.hostLength);if(a>0&&(!r[s]||r[s]<a))return!1}return!0}c(BT,"isDoneForToken");function o6(t,e,r,n,i){let s=l0;return n&&n[0]===3?s=ju:n&&n[0]>=4&&(s=f0),!i||!(i instanceof s)?new s(t,e,r):i}c(o6,"getByVersion");h0.getByVersion=o6;h0.isDoneForToken=BT});var w0=_((aY,LT)=>{"use strict";var a6=require("events"),zu=require("util"),m0=iT(),Wu=oe(),Xa=ze(),mo=Ke(),Qu=Ti(),OT=RT(),Jr=fr(),{TokenRange:Yu}=Fa(),{ExecutionOptions:c6}=xi(),u6="SELECT * FROM system_traces.sessions WHERE session_id=%s",l6="SELECT * FROM system_traces.events WHERE session_id=%s",f6="SELECT schema_version FROM system.peers",h6="SELECT schema_version FROM system.local",DT=5,d6=400,S0=class S0{constructor(e,r){if(!e)throw new Xa.ArgumentError("Options are not defined");Object.defineProperty(this,"options",{value:e,enumerable:!1,writable:!1}),Object.defineProperty(this,"controlConnection",{value:r,enumerable:!1,writable:!1}),this.keyspaces={},this.initialized=!1,this._isDbaas=!1,this._schemaParser=OT.getByVersion(e,r,this.getUdt.bind(this)),this.log=Wu.log,this._preparedQueries=new E0(e.maxPrepared,(...n)=>this.log(...n))}setCassandraVersion(e){this._schemaParser=OT.getByVersion(this.options,this.controlConnection,this.getUdt.bind(this),e,this._schemaParser)}isDbaas(){return this._isDbaas}setProductTypeAsDbaas(){this._isDbaas=!0}setPartitioner(e){return/RandomPartitioner$/.test(e)?this.tokenizer=new m0.RandomTokenizer:/ByteOrderedPartitioner$/.test(e)?this.tokenizer=new m0.ByteOrderedTokenizer:this.tokenizer=new m0.Murmur3Tokenizer}buildTokens(e){if(!this.tokenizer)return this.log("error","Tokenizer could not be determined");let r=[],n={},i=e.values(),s=this.tokenizer.stringify,o={};i.forEach(u=>{if(!u.tokens)return;u.tokens.forEach(f=>{let h=this.tokenizer.parse(f);Wu.insertSorted(r,h,(p,g)=>p.compare(g)),n[s(h)]=u});let l=o[u.datacenter];l||(l=o[u.datacenter]={hostLength:0,racks:new Wu.HashSet}),l.hostLength++,l.racks.add(u.rack)}),this.primaryReplicas=n,this.ring=r;let a=new Set;if(this.ring.length===1){let u=this.tokenizer.minToken();a.add(new Yu(u,u,this.tokenizer))}else for(let u=0;u<this.ring.length;u++){let l=this.ring[u],f=this.ring[(u+1)%this.ring.length];a.add(new Yu(l,f,this.tokenizer))}this.tokenRanges=a,this.ringTokensAsStrings=new Array(r.length);for(let u=0;u<r.length;u++)this.ringTokensAsStrings[u]=s(r[u]);this.datacenters=o}refreshKeyspace(e,r){return Jr.optionalCallback(this._refreshKeyspace(e),r)}async _refreshKeyspace(e){if(!this.initialized)throw this._uninitializedError();this.log("info",zu.format("Retrieving keyspace %s metadata",e));try{let r=await this._schemaParser.getKeyspace(e);return r?(this.keyspaces[r.name]=r,r):(delete this.keyspaces[e],null)}catch(r){throw this.log("error","There was an error while trying to retrieve keyspace information",r),r}}refreshKeyspaces(e,r){if((typeof e=="function"||typeof e>"u")&&(r=e,e=!0),!this.initialized){let n=this._uninitializedError();return r?r(n):Promise.reject(n)}return Jr.optionalCallback(this.refreshKeyspacesInternal(e),r)}async refreshKeyspacesInternal(e){this.log("info","Retrieving keyspaces metadata");try{return this.keyspaces=await this._schemaParser.getKeyspaces(e),this.keyspaces}catch(r){throw this.log("error","There was an error while trying to retrieve keyspaces information",r),r}}_getKeyspaceReplicas(e){return e.replicas||(e.replicas=e.tokenToReplica(this.tokenizer,this.ringTokensAsStrings,this.primaryReplicas,this.datacenters)),e.replicas}getReplicas(e,r){if(!this.ring)return null;Buffer.isBuffer(r)&&(r=this.tokenizer.hash(r)),r instanceof Yu&&(r=r.end);let n;if(e&&(n=this.keyspaces[e],!n))return null;let i=Wu.binarySearch(this.ring,r,(a,u)=>a.compare(u));i<0&&(i=~i),i>=this.ring.length&&(i=i%this.ring.length);let s=this.ringTokensAsStrings[i];return e?this._getKeyspaceReplicas(n)[s]:[this.primaryReplicas[s]]}getTokenRanges(){return this.tokenRanges}getTokenRangesForHost(e,r){if(!this.ring)return null;let n;if(e&&(n=this.keyspaces[e],!n))return null;if(this.ring.length===1)return this.getTokenRanges();let i=this._getKeyspaceReplicas(n),s=new Set;return this.tokenRanges.forEach(o=>{i[this.tokenizer.stringify(o.end)].indexOf(r)!==-1&&s.add(o)}),s}newToken(e){if(!this.tokenizer)throw new Error("Partitioner not established.  This should only happen if metadata was disabled or you have not connected yet.");return Array.isArray(e)?this.tokenizer.hash(Buffer.concat(e)):zu.isString(e)?this.tokenizer.parse(e):this.tokenizer.hash(e)}newTokenRange(e,r){if(!this.tokenizer)throw new Error("Partitioner not established.  This should only happen if metadata was disabled or you have not connected yet.");return new Yu(e,r,this.tokenizer)}getPreparedInfo(e,r){return this._preparedQueries.getOrAdd(e,r)}clearPrepared(){this._preparedQueries.clear()}getPreparedById(e){return this._preparedQueries.getById(e)}setPreparedById(e){return this._preparedQueries.setById(e)}getAllPrepared(){return this._preparedQueries.getAll()}_uninitializedError(){return new Error("Metadata has not been initialized.  This could only happen if you have not connected yet.")}getUdt(e,r,n){return Jr.optionalCallback(this._getUdt(e,r),n)}async _getUdt(e,r){if(!this.initialized)throw this._uninitializedError();let n;if(this.options.isMetadataSyncEnabled){let i=this.keyspaces[e];if(!i)return null;n=i.udts}return await this._schemaParser.getUdt(e,r,n)}getTable(e,r,n){return Jr.optionalCallback(this._getTable(e,r),n)}async _getTable(e,r){if(!this.initialized)throw this._uninitializedError();let n,i;if(this.options.isMetadataSyncEnabled){let s=this.keyspaces[e];if(!s)return null;n=s.tables,i=s.virtual}return await this._schemaParser.getTable(e,r,n,i)}getFunctions(e,r,n){return Jr.optionalCallback(this._getFunctionsWrapper(e,r),n)}async _getFunctionsWrapper(e,r){if(!e||!r)throw new Xa.ArgumentError("You must provide the keyspace name and cql function name to retrieve the metadata");let n=await this._getFunctions(e,r,!1);return Array.from(n.values())}getFunction(e,r,n,i){return Jr.optionalCallback(this._getSingleFunction(e,r,n,!1),i)}getAggregates(e,r,n){return Jr.optionalCallback(this._getAggregates(e,r),n)}async _getAggregates(e,r){if(!e||!r)throw new Xa.ArgumentError("You must provide the keyspace name and cql aggregate name to retrieve the metadata");let n=await this._getFunctions(e,r,!0);return Array.from(n.values())}getAggregate(e,r,n,i){return Jr.optionalCallback(this._getSingleFunction(e,r,n,!0),i)}getMaterializedView(e,r,n){return Jr.optionalCallback(this._getMaterializedView(e,r),n)}async _getMaterializedView(e,r){if(!this.initialized)throw this._uninitializedError();let n;if(this.options.isMetadataSyncEnabled){let i=this.keyspaces[e];if(!i)return null;n=i.views}return await this._schemaParser.getMaterializedView(e,r,n)}async _getFunctions(e,r,n){if(!this.initialized)throw this._uninitializedError();let i;if(this.options.isMetadataSyncEnabled){let s=this.keyspaces[e];if(!s)return new Map;i=n?s.aggregates:s.functions}return await this._schemaParser.getFunctions(e,r,n,i)}async _getSingleFunction(e,r,n,i){if(!e||!r)throw new Xa.ArgumentError("You must provide the keyspace name and cql function name to retrieve the metadata");if(!Array.isArray(n))throw new Xa.ArgumentError("Signature must be an array of types");return n=n.map(o=>typeof o=="string"?o:mo.getDataTypeNameByCode(o)),(await this._getFunctions(e,r,i)).get(n.join(","))||null}getTrace(e,r,n){return!n&&typeof r=="function"&&(n=r,r=null),Jr.optionalCallback(this._getTrace(e,r),n)}async _getTrace(e,r){if(!this.initialized)throw this._uninitializedError();let n,i=0,s=c6.empty();s.getConsistency=()=>r;let o=new Qu.QueryRequest(zu.format(u6,e),null,s),a=new Qu.QueryRequest(zu.format(l6,e),null,s);for(;!n&&i++<DT;){let l=(await this.controlConnection.query(o)).rows[0];if(!l||typeof l.duration!="number"){await Jr.delay(d6);continue}n={requestType:l.request,coordinator:l.coordinator,parameters:l.parameters,startedAt:l.started_at,duration:l.duration,clientAddress:l.client,events:null};let f=await this.controlConnection.query(a);n.events=f.rows.map(h=>({id:h.event_id,activity:h.activity,source:h.source,elapsed:h.source_elapsed,thread:h.thread}))}if(!n)throw new Error(`Trace ${e.toString()} could not fully retrieved after ${DT} attempts`);return n}checkSchemaAgreement(e){return Jr.optionalCallback(this._checkSchemaAgreement(),e)}async _checkSchemaAgreement(){let e=this.controlConnection.connection;if(!e)return!1;try{return await this.compareSchemaVersions(e)}catch{return!1}}async adaptUserHints(e,r){if(!Array.isArray(r))return;let n=[];for(let i=0;i<r.length;i++){let s=r[i];if(typeof s!="string")continue;let o=mo.dataTypes.getByName(s);this._checkUdtTypes(n,o,e),r[i]=o}for(let i of n){let s=await this.getUdt(i.info.keyspace,i.info.name);if(!s)throw new TypeError("User defined type not found: "+i.info.keyspace+"."+i.info.name);i.info=s}}_checkUdtTypes(e,r,n){if(r.code===mo.dataTypes.udt){let i=r.info.split(".");if(r.info={keyspace:i[0],name:i[1]},!r.info.name){if(!n)throw new TypeError("No keyspace specified for udt: "+i.join("."));r.info.name=r.info.keyspace,r.info.keyspace=n}e.push(r);return}if(r.info){if(r.code===mo.dataTypes.list||r.code===mo.dataTypes.set)return this._checkUdtTypes(e,r.info,n);r.code===mo.dataTypes.map&&(this._checkUdtTypes(e,r.info[0],n),this._checkUdtTypes(e,r.info[1],n))}}async compareSchemaVersions(e){let r=new Set,n=await e.send(new Qu.QueryRequest(h6),null);n&&n.rows&&n.rows.length===1&&r.add(n.rows[0].schema_version.toString());let i=await e.send(new Qu.QueryRequest(f6),null);if(i&&i.rows)for(let s of i.rows){let o=s.schema_version;o&&r.add(o.toString())}return r.size===1}};c(S0,"Metadata");var v0=S0,C0=class C0{constructor(e,r){this.length=0,this._maxPrepared=e,this._mapByKey=new Map,this._mapById=new Map,this._logger=r}_getKey(e,r){return(e||"")+r}getOrAdd(e,r){let n=this._getKey(e,r),i=this._mapByKey.get(n);return i||(this._validateOverflow(),i=new a6.EventEmitter,i.setMaxListeners(0),i.query=r,i.keyspace=e,this._mapByKey.set(n,i),this.length++,i)}_validateOverflow(){if(this.length<this._maxPrepared)return;let e=[];this._logger("warning","Prepared statements exceeded maximum. This could be caused by preparing queries that contain parameters");let r=this.length-this._maxPrepared+1;for(let[n,i]of this._mapByKey){if(!i.queryId)continue;if(e.push([n,i])>=r)break}for(let[n,i]of e)this._mapByKey.delete(n),this._mapById.delete(i.queryId.toString("hex")),this.length--}setById(e){this._mapById.set(e.queryId.toString("hex"),e)}getById(e){return this._mapById.get(e.toString("hex"))}clear(){this._mapByKey=new Map,this._mapById=new Map,this.length=0}getAll(){return Array.from(this._mapByKey.values()).filter(e=>!!e.queryId)}};c(C0,"PreparedQueries");var E0=C0;LT.exports=v0});var FT=_((uY,kT)=>{"use strict";var p6=require("util"),g6=oe(),x0=fr(),PT=1e3,_0=class _0{constructor(e,r){this._delay=e,this._logger=r,this._queue=null,this._timeout=null}eventReceived(e,r){return new Promise((n,i)=>{e.callback=x0.getCallback(n,i),this._queue=this._queue||{callbacks:[],keyspaces:{}};let s=r?0:this._delay;if(e.all&&(this._queue.mainEvent=e),this._queue.callbacks.length===PT&&this._logger("warn",p6.format("Event debouncer queue exceeded %d events",PT)),this._queue.callbacks.push(e.callback),this._queue.mainEvent)return this._slideDelay(s);let o=this._queue.keyspaces[e.keyspace];o||(o=this._queue.keyspaces[e.keyspace]={events:[]}),e.cqlObject===void 0&&(o.mainEvent=e),o.events.push(e),this._slideDelay(s)})}_slideDelay(e){let r=this;function n(){let s=r._queue;r._queue=null,r._timeout=null,y6(s)}if(c(n,"process"),e===0)return this._timeout&&clearTimeout(this._timeout),n();let i=this._timeout;this._timeout=setTimeout(n,e),i&&clearTimeout(i)}shutdown(){this._queue&&(this._queue.callbacks.forEach(function(e){e()}),this._queue=null,clearTimeout(this._timeout),this._timeout=null)}};c(_0,"EventDebouncer");var T0=_0;function y6(t){if(t.mainEvent)return x0.toCallback(t.mainEvent.handler(),e=>{for(let r=0;r<t.callbacks.length;r++)t.callbacks[r](e)});g6.each(Object.keys(t.keyspaces),c(function(r,n){let i=t.keyspaces[r];if(i.mainEvent)return x0.toCallback(i.mainEvent.handler(),c(function(o){for(let a=0;a<i.events.length;a++)i.events[a].callback(o);n()},"mainEventCallback"));i.events.forEach(s=>{s.handler(),s.callback()}),n()},"eachKeyspace"))}c(y6,"processQueue");kT.exports=T0});var $T=_((fY,HT)=>{"use strict";var m6=require("events"),Ju=require("util"),qT=require("net"),Zu=require("dns"),en=ze(),{Host:UT,HostMap:v6}=rT(),E6=w0(),S6=FT(),C6=Kp(),Ja=Ti(),Bi=oe(),Xu=Ke(),ps=fr(),VT=Ju.format,w6="SELECT * FROM system.peers",x6="SELECT * FROM system.local WHERE key='local'",MT=1e3,T6=2e3,_6={created:"CREATED",updated:"UPDATED",dropped:"DROPPED"},b6="PRODUCT_TYPE",I6="DATASTAX_APOLLO",I0=class I0 extends m6.EventEmitter{constructor(e,r,n){super(),this.protocolVersion=null,this.hosts=new v6,this.setMaxListeners(0),this.log=Bi.log,Object.defineProperty(this,"options",{value:e,enumerable:!1,writable:!1}),this.metadata=new E6(this.options,this),this.initialized=!1,this.host=null,this.connection=null,this._addressTranslator=this.options.policies.addressResolution,this._reconnectionPolicy=this.options.policies.reconnection,this._reconnectionSchedule=this._reconnectionPolicy.newSchedule(),this._isShuttingDown=!1,this._encoder=null,this._debouncer=new S6(e.refreshSchemaDelay,this.log.bind(this)),this._profileManager=r,this._triedHosts=null,this._resolvedContactPoints=new Map,this._contactPoints=new Set,this._topologyChangeTimeout=null,this._nodeStatusChangeTimeout=null,n&&n.borrowHostConnection&&(this._borrowHostConnection=n.borrowHostConnection),n&&n.createConnection&&(this._createConnection=n.createConnection)}_addContactPoint(e,r,n,i){if(e===null){this._resolvedContactPoints.set(n,Bi.emptyArray);return}let s=parseInt(r,10)||this.options.protocolOptions.port,o=`${e}:${s}`;this._contactPoints.add(o);let a=i?`[${e}]:${s}`:o,u=this._resolvedContactPoints.get(n);(u===void 0||u===Bi.emptyArray)&&(u=[],this._resolvedContactPoints.set(n,u)),u.push(a)}async _parseContactPoint(e){let r=e,n=null;if(e.indexOf("[")===0&&e.indexOf("]:")>1){let s=e.lastIndexOf("]:");r=e.substr(1,s-1),n=e.substr(s+2)}else if(e.indexOf(":")>0){let s=e.split(":");s.length===2&&(r=s[0],n=s[1])}if(qT.isIP(r)){this._addContactPoint(r,n,e,qT.isIPv6(r));return}let i=await this._resolveAll(r);i.length>0?i.forEach(s=>this._addContactPoint(s.address,n,e,s.isIPv6)):this._addContactPoint(null,null,e,!1)}async init(){if(!this.initialized){if(!this.options.sni)await Promise.all(this.options.contactPoints.map(e=>this._parseContactPoint(e)));else{this.options.contactPoints.forEach(i=>this._contactPoints.add(i));let e=this.options.sni.address,r=e.lastIndexOf(":");if(r===-1)throw new new en.DriverInternalError("The SNI endpoint address should contain ip/name and port");let n=e.substr(0,r);this.options.sni.port=e.substr(r+1),this.options.sni.addressResolver=new Bi.AddressResolver({nameOrIp:n,dns:Zu}),await this.options.sni.addressResolver.init()}if(this._contactPoints.size===0)throw new en.NoHostAvailableError({},"No host could be resolved");await this._initializeConnection()}}_setHealthListeners(e,r){let n=this,i=0;function s(){e.removeListener("down",a),e.removeListener("ignore",a),r.removeListener("socketClose",u)}c(s,"removeListeners");function o(l){i++===0&&(s(),!n._isShuttingDown&&(l?n.log("warning",`Host ${e.address} used by the ControlConnection DOWN, connection to ${r.endpointFriendlyName} will not longer be used`):n.log("warning",`Connection to ${r.endpointFriendlyName} used by the ControlConnection was closed`),ps.toBackground(n._refresh())))}c(o,"startReconnecting");function a(){o(!0)}c(a,"downOrIgnoredHandler");function u(){o(!1)}c(u,"socketClosedHandler"),e.once("down",a),e.once("ignore",a),r.once("socketClose",u)}_borrowAConnection(e){let r=null;for(;!r;){let n=e.next(),i=n.value;if(n.done)throw new en.NoHostAvailableError(this._triedHosts);let s=this._profileManager.getDistance(i);if(!(!i.isUp()||s===Xu.distance.ignored))try{r=this._borrowHostConnection(i)}catch(o){this._triedHosts[i.address]=o}}return r}async _borrowFirstConnection(e){let r=null;for(;!r;){let n=e.next(),i=n.value;if(n.done)throw new en.NoHostAvailableError(this._triedHosts);try{r=await this._createConnection(i)}catch(s){this._triedHosts[i]=s}}if(!r){let n=new en.NoHostAvailableError(this._triedHosts);throw this.log("error","ControlConnection failed to acquire a connection"),n}this.protocolVersion=r.protocolVersion,this._encoder=r.encoder,this.connection=r}_borrowHostConnection(e){return e.borrowConnection()}async _createConnection(e){let r=new C6(e,null,this.options);try{await r.openAsync()}catch(n){throw ps.toBackground(r.closeAsync()),n}return r}async _refreshHosts(e,r){let n=this.connection;if(!n){if(r)throw new en.DriverInternalError("Connection reference has been lost when reconnecting");return}this.log("info","Refreshing local and peers info");let i=await n.send(new Ja.QueryRequest(x6),null);if(this._setLocalInfo(e,r,n,i),!this.host)throw new en.DriverInternalError("Information from system.local could not be retrieved");let s=await n.send(new Ja.QueryRequest(w6),null);if(await this.setPeersInfo(e,s),!this.initialized){let o=Xu.protocolVersion.getHighestCommon(n,this.hosts),a=o!==this.protocolVersion;if(this.protocolVersion=o,this.hosts.forEach(u=>u.setProtocolVersion(this.protocolVersion)),a){this.log("info",`Reconnecting since the protocol version changed to 0x${o.toString(16)}`),n.decreaseVersion(this.protocolVersion),await n.closeAsync();try{await n.openAsync()}catch(u){throw ps.toBackground(n.closeAsync()),u}}if(this.metadata.setCassandraVersion(this.host.getCassandraVersion()),this.metadata.buildTokens(this.hosts),!this.options.isMetadataSyncEnabled){this.metadata.initialized=!0;return}await this.metadata.refreshKeyspacesInternal(!1),this.metadata.initialized=!0}}async _refreshControlConnection(e){if(this.options.sni)this.connection=this._borrowAConnection(e);else try{this.connection=this._borrowAConnection(e)}catch{this.log("info","ControlConnection could not reconnect using existing connections.  Refreshing contact points and retrying"),this._contactPoints.clear(),this._resolvedContactPoints.clear(),await Promise.all(this.options.contactPoints.map(i=>this._parseContactPoint(i)));let n=Array.from(this._contactPoints).join(",");this.log("info",`Refreshed contact points: ${n}`),await this._initializeConnection()}}async _refresh(e){if(this._isShuttingDown){this.log("info","The ControlConnection will not be refreshed as the Client is being shutdown");return}this.host=null,this.connection=null;try{e||(this.log("info","Trying to acquire a connection to a new host"),this._triedHosts={},e=await ps.newQueryPlan(this._profileManager.getDefaultLoadBalancing(),null,null)),await this._refreshControlConnection(e)}catch(r){if(this.log("error","ControlConnection failed to acquire a connection",r),!this._isShuttingDown){let n=this._reconnectionSchedule.next().value;this.log("warning",`ControlConnection could not reconnect, scheduling reconnection in ${n}ms`),setTimeout(()=>this._refresh(),n),this.emit("newConnection",r)}return}this.log("info",`ControlConnection connected to ${this.connection.endpointFriendlyName}`);try{await this._refreshHosts(!1,!0),await this._registerToConnectionEvents()}catch(r){return this.log("error","ControlConnection failed to retrieve topology and keyspaces information",r),this._triedHosts[this.connection.endpoint]=r,r.isSocketError&&this.host&&this.host.removeFromPool(this.connection),await this._refresh(e)}this._reconnectionSchedule=this._reconnectionPolicy.newSchedule(),this._setHealthListeners(this.host,this.connection),this.emit("newConnection",null,this.connection,this.host),this.log("info",`ControlConnection connected to ${this.connection.endpointFriendlyName} and up to date`)}async _initializeConnection(){this.log("info","Getting first connection"),this.host=null,this.connection=null,this._triedHosts={};let e=Bi.shuffleArray(Array.from(this._contactPoints))[Symbol.iterator]();for(;;){await this._borrowFirstConnection(e),this.log("info",`ControlConnection using protocol version 0x${this.protocolVersion.toString(16)}, connected to ${this.connection.endpointFriendlyName}`);try{await this._getSupportedOptions(),await this._refreshHosts(!0,!0),await this._registerToConnectionEvents();break}catch(r){this.log("error","ControlConnection failed to retrieve topology and keyspaces information",r),this._triedHosts[this.connection.endpoint]=r}}this.host.pool.addExistingConnection(this.connection),this.initialized=!0,this._setHealthListeners(this.host,this.connection),this.log("info",`ControlConnection connected to ${this.connection.endpointFriendlyName}`)}async _getSupportedOptions(){let e=await this.connection.send(Ja.options,null),r=e.supported&&e.supported[b6];Array.isArray(r)&&r[0]===I6&&this.metadata.setProductTypeAsDbaas()}async _registerToConnectionEvents(){this.connection.on("nodeTopologyChange",this._nodeTopologyChangeHandler.bind(this)),this.connection.on("nodeStatusChange",this._nodeStatusChangeHandler.bind(this)),this.connection.on("nodeSchemaChange",this._nodeSchemaChangeHandler.bind(this));let e=new Ja.RegisterRequest(["TOPOLOGY_CHANGE","STATUS_CHANGE","SCHEMA_CHANGE"]);await this.connection.send(e,null)}_nodeTopologyChangeHandler(e){this.log("info","Received topology change",e),clearTimeout(this._topologyChangeTimeout),this._topologyChangeTimeout=setTimeout(()=>ps.toBackground(this._scheduleRefreshHosts()),MT)}_nodeStatusChangeHandler(e){let r=this,n=e.inet.address.toString(),i=this.options.protocolOptions.port;this._addressTranslator.translate(n,i,c(function(o){let a=r.hosts.get(o);if(!a){r.log("warning","Received status change event but host was not found: "+n);return}let u=r._profileManager.getDistance(a);if(e.up){if(u===Xu.distance.ignored)return a.setUp(!0);clearTimeout(r._nodeStatusChangeTimeout),r._nodeStatusChangeTimeout=setTimeout(()=>a.checkIsUp(),MT);return}if(u===Xu.distance.ignored)return a.setDown();r.log("warning","Received status change to DOWN for host "+a.address)},"translateCallback"))}_nodeSchemaChangeHandler(e){this.log("info","Schema change",e),this.options.isMetadataSyncEnabled&&ps.toBackground(this.handleSchemaChange(e,!1))}handleSchemaChange(e,r){let n=this,i,s;if(e.isKeyspace)return e.schemaChangeType===_6.dropped?(i=c(function(){delete n.metadata.keyspaces[e.keyspace]},"removeKeyspace"),this._scheduleObjectRefresh(i,e.keyspace,null,r)):this._scheduleKeyspaceRefresh(e.keyspace,r);let o=this.metadata.keyspaces[e.keyspace];return!o||(e.table?(s=e.table,i=c(function(){delete o.tables[e.table],delete o.views[e.table]},"clearTableState")):e.udt?(s=e.udt,i=c(function(){delete o.udts[e.udt]},"clearUdtState")):e.functionName?(s=e.functionName,i=c(function(){delete o.functions[e.functionName]},"clearFunctionState")):e.aggregate&&(s=e.aggregate,i=c(function(){delete o.aggregates[e.aggregate]},"clearKeyspaceState")),!i)?Promise.resolve():this._scheduleObjectRefresh(i,e.keyspace,s,r)}_scheduleObjectRefresh(e,r,n,i){return this._debouncer.eventReceived({handler:e,keyspace:r,cqlObject:n},i)}_scheduleKeyspaceRefresh(e,r){return this._debouncer.eventReceived({handler:()=>this.metadata.refreshKeyspace(e),keyspace:e},r)}_scheduleRefreshHosts(){return this._debouncer.eventReceived({handler:()=>this._refreshHosts(!1,!1),all:!0},!1)}_setLocalInfo(e,r,n,i){if(!i||!i.rows||!i.rows.length){this.log("warning","No local info could be obtained");return}let s=i.rows[0],o,a=this.options.sni?`${s.rpc_address}:${this.options.protocolOptions.port}`:n.endpoint;if(e)o=new UT(a,this.protocolVersion,this.options,this.metadata),this.hosts.set(a,o),this.log("info",`Adding host ${a}`);else if(o=this.hosts.get(a),!o){this.log("error","Localhost could not be found");return}o.datacenter=s.data_center,o.rack=s.rack,o.tokens=s.tokens,o.hostId=s.host_id,o.cassandraVersion=s.release_version,KT(o,s),this.metadata.setPartitioner(s.partitioner),this.log("info","Local info retrieved"),r&&(this.host=o)}async setPeersInfo(e,r){if(!r||!r.rows)return;let n={},i=this.options.protocolOptions.port,s=new Set;this.host&&this.host.datacenter&&s.add(this.host.datacenter);for(let o of r.rows){let a=await this.getAddressForPeerHost(o,i);if(!a)continue;n[a]=!0;let u=this.hosts.get(a),l=!u;l&&(u=new UT(a,this.protocolVersion,this.options,this.metadata),this.log("info",`Adding host ${a}`),l=!0),u.datacenter=o.data_center,u.rack=o.rack,u.tokens=o.tokens,u.hostId=o.host_id,u.cassandraVersion=o.release_version,KT(u,o),u.datacenter&&s.add(u.datacenter),l&&(this.hosts.set(a,u),e||(this._profileManager.getDistance(u),u.setDown()))}if(this.hosts.length>r.rows.length+1){this.log("info","Removing nodes from the pool");let o=[];this.hosts.forEach(a=>{!n[a.address]&&a!==this.host&&(this.log("info","Removing host "+a.address),o.push(a.address),a.shutdown(!0))}),this.hosts.removeMultiple(o)}if(e&&this.options.localDataCenter){let o=this.options.localDataCenter;if(!s.has(o))throw new en.ArgumentError(`localDataCenter was configured as '${o}', but only found hosts in data centers: [${Array.from(s).join(", ")}]`)}this.log("info","Peers info retrieved")}getAddressForPeerHost(e,r){return new Promise(n=>{let i=e.rpc_address,s=e.peer,o="0.0.0.0";if(!i)return this.log("error",VT("No rpc_address found for host %s in %s's peers system table. %s will be ignored.",s,this.host.address,s)),n(null);i.toString()===o&&(this.log("warning",VT("Found host with 0.0.0.0 as rpc_address, using listen_address (%s) to contact it instead. If this is incorrect you should avoid the use of 0.0.0.0 server side.",s)),i=s),this._addressTranslator.translate(i.toString(),r,n)})}async _resolveAll(e){let r=[],n=Ju.promisify(Zu.resolve4),i=Ju.promisify(Zu.resolve6),s=Ju.promisify(Zu.lookup),o=n(e).catch(()=>{}).then(l=>l||Bi.emptyArray),a=i(e).catch(()=>{}).then(l=>l||Bi.emptyArray),u;if(u=await o,u.forEach(l=>r.push({address:l,isIPv6:!1})),u=await a,u.forEach(l=>r.push({address:l,isIPv6:!0})),r.length===0)try{u=await s(e,{all:!0}),u.forEach(({address:l,family:f})=>r.push({address:l,isIPv6:f===6}))}catch(l){this.log("error",`Host with name ${e} could not be resolved`,l)}return r}_waitForReconnection(){return new Promise((e,r)=>{let n=ps.getCallback(e,r),i;function s(o){clearTimeout(i),n(o)}c(s,"newConnectionListener"),this.once("newConnection",s),i=setTimeout(()=>{this.removeListener("newConnection",s),n(new en.OperationTimedOutError("A connection could not be acquired before timeout."))},T6)})}async query(e,r=!0){let n=c(async()=>{if(!this.connection||this._isShuttingDown)throw new en.NoHostAvailableError({},"ControlConnection is not connected at the time");let i=typeof e=="string"?new Ja.QueryRequest(e,null,null):e;return await this.connection.send(i,null)},"queryOnConnection");return!this.connection&&r&&await this._waitForReconnection(),await n()}getEncoder(){if(!this._encoder)throw new en.DriverInternalError("Encoder is not defined");return this._encoder}shutdown(){this._isShuttingDown=!0,this._debouncer.shutdown(),this.emit("newConnection",new en.DriverError("ControlConnection is being shutdown")),clearTimeout(this._topologyChangeTimeout),clearTimeout(this._nodeStatusChangeTimeout)}async reset(){let e=this.hosts.clear();this._isShuttingDown=!0,await Promise.all(e.map(r=>r.shutdown())),this.initialized=!1,this._isShuttingDown=!1}getResolvedContactPoints(){return this._resolvedContactPoints}getLocalAddress(){if(this.connection)return this.connection.getLocalAddress()}getEndpoint(){if(this.connection)return this.connection.endpoint}};c(I0,"ControlConnection");var b0=I0;function KT(t,e){e.workloads!==void 0?t.workloads=e.workloads:e.workload?t.workloads=[e.workload]:t.workloads=Bi.emptyArray,e.dse_version!==void 0&&(t.dseVersion=e.dse_version)}c(KT,"setDseParameters");HT.exports=b0});var zT=_((dY,jT)=>{"use strict";var ec=ze(),GT=Ti(),el=Jh(),si=Ke(),A6=oe(),A0=fr(),N6=Object.freeze({decision:el.RetryPolicy.retryDecision.retry,useCurrentHost:!0,consistency:void 0}),N0=Object.freeze({decision:el.RetryPolicy.retryDecision.rethrow}),Te={none:0,socketError:1,socketErrorBeforeRequestWritten:2,clientTimeout:3,serverErrorUnprepared:4,serverErrorOverloaded:5,serverErrorReadTimeout:6,serverErrorUnavailable:7,serverErrorWriteTimeout:8,serverErrorOther:9},B6=new Map([[Te.none,(t,e,r)=>t.onSuccessfulResponse(r)],[Te.socketError,(t,e)=>t.onConnectionError(e)],[Te.clientTimeout,(t,e)=>t.onClientTimeoutError(e)],[Te.serverErrorOverloaded,(t,e)=>t.onOtherError(e)],[Te.serverErrorReadTimeout,(t,e)=>t.onReadTimeoutError(e)],[Te.serverErrorUnavailable,(t,e)=>t.onUnavailableError(e)],[Te.serverErrorWriteTimeout,(t,e)=>t.onWriteTimeoutError(e)],[Te.serverErrorOther,(t,e)=>t.onOtherError(e)]]),R6=new Map([[Te.socketError,(t,e)=>t.onOtherErrorRetry(e)],[Te.clientTimeout,(t,e)=>t.onClientTimeoutRetry(e)],[Te.serverErrorOverloaded,(t,e)=>t.onOtherErrorRetry(e)],[Te.serverErrorReadTimeout,(t,e)=>t.onReadTimeoutRetry(e)],[Te.serverErrorUnavailable,(t,e)=>t.onUnavailableRetry(e)],[Te.serverErrorWriteTimeout,(t,e)=>t.onWriteTimeoutRetry(e)],[Te.serverErrorOther,(t,e)=>t.onOtherErrorRetry(e)]]),gs=class gs{constructor(e,r,n){this._parent=e,this._operation=null,this._host=r,this._connection=n,this._cancelled=!1,this._startTime=null,this._retryCount=0,this._request=this._parent.request,e.speculativeExecutions++}start(){this._sendOnConnection()}async restart(){try{let{host:r,connection:n}=this._parent.getNextConnection();this._connection=n,this._host=r}catch(r){return this._parent.handleNoHostAvailable(r,this)}let e=this._parent.client.keyspace;if(e&&e!==this._connection.keyspace)try{await this._connection.changeKeyspace(e)}catch(r){return this._handleError(r,gs._getErrorCode(r))}this._cancelled||this._sendOnConnection()}_sendOnConnection(){this._startTime=process.hrtime(),this._operation=this._connection.sendStream(this._request,this._parent.executionOptions,(e,r,n)=>{let i=gs._getErrorCode(e);if(this._trackResponse(process.hrtime(this._startTime),i,e,n),!this._cancelled){if(i!==Te.none)return this._handleError(i,e);if(r.schemaChange)return A0.toBackground(this._parent.client.handleSchemaAgreementAndRefresh(this._connection,r.schemaChange).then(s=>{this._cancelled||this._parent.setCompleted(null,this._getResultSet(r,s))}));if(r.keyspaceSet&&(this._parent.client.keyspace=r.keyspaceSet),r.meta&&r.meta.newResultId&&this._request.queryId){let s=this._parent.client.metadata.getPreparedById(this._request.queryId);s.meta.resultId=r.meta.newResultId}this._parent.setCompleted(null,this._getResultSet(r))}})}_trackResponse(e,r,n,i){gs._invokeMetricsHandler(r,this._parent.client.metrics,n,e);let s=this._parent.client.options.requestTracker;if(s===null)return;let o=this._request.query||this._request.queries,a=this._request.params,u=this._request.length;n?s.onError(this._host,o,a,this._parent.executionOptions,u,n,e):s.onSuccess(this._host,o,a,this._parent.executionOptions,u,i,e)}_getResultSet(e,r){let n=new si.ResultSet(e,this._host.address,this._parent.triedHosts,this._parent.speculativeExecutions,this._request.consistency,r===void 0||r);return n.rawPageState&&(n.nextPageAsync=this._parent.getNextPageHandler()),n}static _invokeMetricsHandler(e,r,n,i){let s=B6.get(e);s!==void 0&&s(r,n,i),(!n||n instanceof ec.ResponseError)&&r.onResponse(i)}static _invokeMetricsHandlerForRetry(e,r,n){let i=R6.get(e);i!==void 0&&i(r,n)}cancel(){this._cancelled=!0,this._operation!==null&&this._operation.cancel()}wasCancelled(){return this._cancelled}_handleError(e,r){if(this._parent.triedHosts[this._host.address]=r,r.coordinator=this._host.address,e===Te.serverErrorUnprepared)return this._prepareAndRetry(r.queryId);e===Te.socketError||e===Te.socketErrorBeforeRequestWritten?this._host.removeFromPool(this._connection):e===Te.clientTimeout&&(this._parent.log("warning",r.message),this._host.checkHealth(this._connection));let n=this._getDecision(e,r);if(!n||n.decision===el.RetryPolicy.retryDecision.rethrow)return(this._request instanceof GT.QueryRequest||this._request instanceof GT.ExecuteRequest)&&(r.query=this._request.query),this._parent.setCompleted(r);let i=this._parent.client.metrics;return n.decision===el.RetryPolicy.retryDecision.ignore?(i.onIgnoreError(r),this._parent.setCompleted(null,this._getResultSet(A6.emptyObject))):(gs._invokeMetricsHandlerForRetry(e,i,r),this._retry(n.consistency,n.useCurrentHost))}_getDecision(e,r){let n={query:this._request&&this._request.query,executionOptions:this._parent.executionOptions,nbRetry:this._retryCount},i=n.executionOptions.getRetryPolicy();switch(e){case Te.socketErrorBeforeRequestWritten:return N6;case Te.socketError:case Te.clientTimeout:case Te.serverErrorOverloaded:return n.executionOptions.isIdempotent()?i.onRequestError(n,this._request.consistency,r):N0;case Te.serverErrorUnavailable:return i.onUnavailable(n,r.consistencies,r.required,r.alive);case Te.serverErrorReadTimeout:return i.onReadTimeout(n,r.consistencies,r.received,r.blockFor,r.isDataPresent);case Te.serverErrorWriteTimeout:return n.executionOptions.isIdempotent()?i.onWriteTimeout(n,r.consistencies,r.received,r.blockFor,r.writeType):N0;default:return N0}}static _getErrorCode(e){if(!e)return Te.none;if(e.isSocketError)return e.requestNotWritten?Te.socketErrorBeforeRequestWritten:Te.socketError;if(e instanceof ec.OperationTimedOutError)return Te.clientTimeout;if(e instanceof ec.ResponseError)switch(e.code){case si.responseErrorCodes.overloaded:case si.responseErrorCodes.isBootstrapping:case si.responseErrorCodes.truncateError:return Te.serverErrorOverloaded;case si.responseErrorCodes.unavailableException:return Te.serverErrorUnavailable;case si.responseErrorCodes.readTimeout:return Te.serverErrorReadTimeout;case si.responseErrorCodes.writeTimeout:return Te.serverErrorWriteTimeout;case si.responseErrorCodes.unprepared:return Te.serverErrorUnprepared}return Te.serverErrorOther}_retry(e,r,n){if(!this._cancelled){if(this._parent.log("info","Retrying request"),this._retryCount++,(n||typeof e=="number"&&this._request.consistency!==e)&&(this._request=this._request.clone(),typeof e=="number"&&(this._request.consistency=e),n&&(this._request.meta=n)),r!==!1){try{this._connection=this._host.borrowConnection(this._connection)}catch{return A0.toBackground(this.restart())}return this._sendOnConnection()}A0.toBackground(this.restart())}}_prepareAndRetry(e){let r=this._connection;this._parent.log("info",`Query 0x${e.toString("hex")} not prepared on host ${r.endpointFriendlyName}, preparing and retrying`);let n=this._parent.client.metadata.getPreparedById(e);if(!n)return this._parent.setCompleted(new ec.DriverInternalError(`Unprepared response invalid, id: 0x${e.toString("hex")}`));let i=this._connection.protocolVersion;if(!si.protocolVersion.supportsKeyspaceInRequest(i)&&n.keyspace&&n.keyspace!==r.keyspace)return this._parent.setCompleted(new Error(`Query was prepared on keyspace ${n.keyspace}, can't execute it on ${r.keyspace} (${n.query})`));let s=this;this._connection.prepareOnce(n.query,n.keyspace,function(o,a){if(o)return!o.isSocketError&&o instanceof ec.OperationTimedOutError&&s._parent.log("warning",`Unexpected timeout error when re-preparing query on host ${r.endpointFriendlyName}`),s._retry(void 0,!1);n.meta=a.meta,s._retry(void 0,!0,a.meta)})}};c(gs,"RequestExecution");var B0=gs;jT.exports=B0});var YT=_((gY,QT)=>{"use strict";var O6=require("util"),WT=ze(),D6=Ke(),R0=oe(),L6=zT(),tl=fr(),tc=class tc{constructor(e,r,n){this.client=n,this._speculativeExecutionPlan=n.options.policies.speculativeExecution.newPlan(n.keyspace,e.query||e.queries),this.logEmitter=n.options.logEmitter,this.log=R0.log,this.request=e,this.executionOptions=r,this.stackContainer=null,this.triedHosts={},this.speculativeExecutions=-1,this._hostIterator=null,this._resolveCallback=null,this._rejectCallback=null,this._newExecutionTimeout=null,this._executions=[]}static send(e,r,n){return new tc(e,r,n).send()}getNextConnection(){let e,r,n=this._hostIterator;for(;;){let i=n.next();if(i.done)throw new WT.NoHostAvailableError(this.triedHosts);if(e=i.value,this.client.profileManager.getDistance(e)!==D6.distance.ignored){if(!e.isUp()){this.triedHosts[e.address]="Host considered as DOWN";continue}try{r=e.borrowConnection(),this.triedHosts[e.address]=null;break}catch(o){this.triedHosts[e.address]=o}}}return{connection:r,host:e}}send(){return this.executionOptions.getCaptureStackTrace()&&Error.captureStackTrace(this.stackContainer={}),new Promise((e,r)=>{this._resolveCallback=e,this._rejectCallback=r;let n=this.executionOptions.getLoadBalancingPolicy(),i=this.executionOptions.getFixedHost();i?(this._hostIterator=R0.arrayIterator([i]),tl.toBackground(this._startNewExecution())):n.newQueryPlan(this.client.keyspace,this.executionOptions,(s,o)=>{if(s)return r(s);this._hostIterator=o,tl.toBackground(this._startNewExecution())})})}async _startNewExecution(e){e&&this.client.metrics.onSpeculativeExecution();let r,n;try{({host:r,connection:n}=this.getNextConnection())}catch(s){return this.handleNoHostAvailable(s,null)}if(e&&this._executions.length>=0&&this._executions[0].wasCancelled())return;if(this.client.keyspace&&this.client.keyspace!==n.keyspace)try{await n.changeKeyspace(this.client.keyspace)}catch(s){return this.triedHosts[r.address]=s,this._startNewExecution(e)}let i=new L6(this,r,n);this._executions.push(i),i.start(),this.executionOptions.isIdempotent()&&this._scheduleSpeculativeExecution(r)}_scheduleSpeculativeExecution(e){let r=this._speculativeExecutionPlan.nextExecution(e);if(!(typeof r!="number"||r<0)){if(r===0)return process.nextTick(()=>{tl.toBackground(this._startNewExecution(!0))});this._newExecutionTimeout=setTimeout(()=>tl.toBackground(this._startNewExecution(!0)),r)}}static setKeyspace(e){let r;for(let n of e.hosts.values())if(r=n.getActiveConnection(),r)break;if(!r)throw new WT.DriverInternalError("No active connection found");return r.changeKeyspace(e.keyspace)}setCompleted(e,r){this._newExecutionTimeout!==null&&clearTimeout(this._newExecutionTimeout);for(let n of this._executions)n.cancel();if(e)return this.executionOptions.getCaptureStackTrace()&&R0.fixStack(this.stackContainer.stack,e),this._rejectCallback(e);r.info.warnings&&r.info.warnings.forEach(function(n,i,s){this.log("warning",O6.format('Received warning (%d of %d) "%s" for "%s"',i+1,s.length,n,this.request.query||"batch"))},this),this._resolveCallback(r)}handleNoHostAvailable(e,r){if(r!==null){let n=this._executions.indexOf(r);this._executions.splice(n,1)}this._executions.length===0&&this.setCompleted(e)}getNextPageHandler(){let e=this.request,r=this.executionOptions,n=this.client;return c(function(s){return r.setPageState(s),new tc(e,r,n).send()},"nextPageHandler")}};c(tc,"RequestHandler");var O0=tc;QT.exports=O0});var s_=_((mY,i_)=>{"use strict";var vo=require("os"),ZT=require("path"),P6=require("fs"),P0=oe(),k6=fr(),ys=Ke(),XT=Ti(),{ExecutionOptions:JT}=xi(),e_=oo(),il=Lh(),{NoAuthProvider:F6}=Oa(),D0;try{D0=require("kerberos")}catch{}var q6=new il(6,0,5),U6=new il(5,1,13),V6=new il(6,0,0),t_="CALL InsightsRpc.reportInsight(?)",M6=5,k0=class k0{constructor(e,r){this._client=e,this._sessionId=ys.Uuid.random().toString(),this._enabled=!1,this._closed=!1,this._firstTimeout=null,this._recurrentTimeout=null,this._statusErrorLogs=0,r=r||{},this._statusEventDelay=r.statusEventDelay||3e5,this._errorCallback=r.errorCallback||P0.noop}init(){this._enabled=this._client.options.monitorReporting.enabled&&this._dseSupportsInsights(),this._enabled&&k6.toBackground(this._init())}async _init(){try{if(await this._sendStartupEvent(),this._closed)return;let e=Math.floor(this._statusEventDelay-.1*this._statusEventDelay*Math.random());this._firstTimeout=setTimeout(()=>{this._sendStatusEvent(),this._recurrentTimeout=setInterval(()=>this._sendStatusEvent(),this._statusEventDelay)},e)}catch(e){if(this._closed)return;this._client.log("verbose",`Insights startup message could not be sent (${e})`,e),this._errorCallback(e)}}async _sendStartupEvent(){let e=await this._getStartupMessage(),r=new XT.QueryRequest(t_,[e],JT.empty());await this._client.controlConnection.query(r,!1)}async _sendStatusEvent(){let e=new XT.QueryRequest(t_,[this._getStatusEvent()],JT.empty());try{await this._client.controlConnection.query(e,!1)}catch(r){if(this._closed)return;this._statusErrorLogs<M6&&(this._client.log("warning",`Insights status message could not be sent (${r})`,r),this._statusErrorLogs++),this._errorCallback(r)}}_dseSupportsInsights(){return this._client.hosts.length===0?!1:this._client.hosts.values().reduce((e,r)=>{if(!e)return e;let n=r.getDseVersion();if(n.length===0)return!1;let i=new il(...n);return i.compare(q6)>=0||i.compare(V6)<0&&i.compare(U6)>=0},!0)}async _getStartupMessage(){let e=this._client.controlConnection,r=this._client.options,n=await this._getAppInfo(r),i={metadata:{name:"driver.startup",insightMappingId:"v1",insightType:"EVENT",timestamp:Date.now(),tags:{language:"nodejs"}},data:{driverName:e_.description,driverVersion:e_.version,clientId:r.id,sessionId:this._sessionId,applicationName:n.applicationName,applicationVersion:n.applicationVersion,applicationNameWasGenerated:n.applicationNameWasGenerated,contactPoints:n_(e.getResolvedContactPoints()),dataCenters:this._getDataCenters(),initialControlConnection:e.host?e.host.address:void 0,protocolVersion:e.protocolVersion,localAddress:e.getLocalAddress(),hostName:vo.hostname(),executionProfiles:H6(this._client),poolSizeByHostDistance:{local:r.pooling.coreConnectionsPerHost[ys.distance.local],remote:r.pooling.coreConnectionsPerHost[ys.distance.remote]},heartbeatInterval:r.pooling.heartBeatInterval,compression:"NONE",reconnectionPolicy:nl(r.policies.reconnection),ssl:{enabled:!!r.sslOptions,certValidation:r.sslOptions?!!r.sslOptions.rejectUnauthorized:void 0},authProvider:{type:r.authProvider instanceof F6?void 0:K6(r.authProvider)},otherOptions:{coalescingThreshold:r.socketOptions.coalescingThreshold},platformInfo:{os:{name:vo.platform(),version:vo.release(),arch:vo.arch()},cpus:{length:vo.cpus().length,model:vo.cpus()[0].model},runtime:{node:process.versions.node,v8:process.versions.v8,uv:process.versions.uv,openssl:process.versions.openssl,kerberos:D0?D0.version:void 0}},configAntiPatterns:this._getConfigAntiPatterns(),periodicStatusInterval:Math.floor(this._statusEventDelay/1e3)}};return JSON.stringify(i)}_getConfigAntiPatterns(){let e=this._client.options,r={};return e.sslOptions&&!e.sslOptions.rejectUnauthorized&&(r.sslWithoutCertValidation="Client-to-node encryption is enabled but server certificate validation is disabled"),r}_getDataCenters(){let e=this._client.options.pooling.coreConnectionsPerHost[ys.distance.remote],r=new Set;return this._client.hosts.values().forEach(n=>{let i=this._client.profileManager.getDistance(n);(i===ys.distance.local||i===ys.distance.remote&&e>0)&&r.add(n.datacenter)}),Array.from(r)}async _getAppInfo(e){if(typeof e.applicationName=="string")return Promise.resolve({applicationName:e.applicationName,applicationVersion:e.applicationVersion,applicationNameWasGenerated:!1});let r=Promise.resolve();if(require.main&&require.main.filename){let o=ZT.dirname(require.main.filename);r=this._readPackageInfoFile(o)}let n=await r,i="Default Node.js Application",s;if(n)try{let o=JSON.parse(n);o.name&&(i=o.name,s=o.version)}catch{}return{applicationName:i,applicationVersion:s,applicationNameWasGenerated:!0}}_readPackageInfoFile(e){return new Promise(r=>{P6.readFile(ZT.join(e,"package.json"),"utf8",(n,i)=>{r(i)})})}_getStatusEvent(){let e=this._client.controlConnection,r=this._client.options,n=this._client.getState(),i={};n.getConnectedHosts().forEach(o=>{i[o.address]={connections:n.getOpenConnections(o),inFlightQueries:n.getInFlightQueries(o)}});let s={metadata:{name:"driver.status",insightMappingId:"v1",insightType:"EVENT",timestamp:Date.now(),tags:{language:"nodejs"}},data:{clientId:r.id,sessionId:this._sessionId,controlConnection:e.host?e.host.address:void 0,connectedNodes:i}};return JSON.stringify(s)}shutdown(){this._enabled&&(this._closed=!0,this._firstTimeout!==null&&clearTimeout(this._firstTimeout),this._recurrentTimeout!==null&&clearInterval(this._recurrentTimeout))}};c(k0,"InsightsClient");var L0=k0;i_.exports=L0;function n_(t){let e={};return t.forEach((r,n)=>e[n]=r),e}c(n_,"mapToObject");function nl(t){if(!t)return;let e=t.getOptions&&t.getOptions();return{type:t.constructor.name,options:e instanceof Map?n_(e):P0.emptyObject}}c(nl,"getPolicyInfo");function rl(t){if(typeof t=="number")return ys.consistencyToString[t]}c(rl,"getConsistencyString");function K6(t){return t?t.constructor.name:void 0}c(K6,"getConstructor");function H6(t){let e={},r=t.profileManager.getDefault();return r_(t,e,r,r),t.profileManager.getAll().filter(n=>n!==r).forEach(n=>r_(t,e,n,r)),e}c(H6,"getExecutionProfiles");function r_(t,e,r,n){let i=e[r.name]={};if(Pn(i,r,n,"readTimeout"),Pn(i,r,n,"loadBalancing",nl),Pn(i,r,n,"retry",nl),Pn(i,r,n,"consistency",rl),Pn(i,r,n,"serialConsistency",rl),r===n&&(i.speculativeExecution=nl(t.options.policies.speculativeExecution)),r.graphOptions){i.graphOptions={};let s=n.graphOptions||P0.emptyObject;Pn(i.graphOptions,r.graphOptions,s,"language"),Pn(i.graphOptions,r.graphOptions,s,"name"),Pn(i.graphOptions,r.graphOptions,s,"readConsistency",rl),Pn(i.graphOptions,r.graphOptions,s,"source"),Pn(i.graphOptions,r.graphOptions,s,"writeConsistency",rl),Object.keys(i.graphOptions).length===0&&(i.graphOptions=void 0)}}c(r_,"setExecutionProfileProperties");function Pn(t,e,r,n,i){let s=e[n];i=i||(o=>o),(e===r&&s!==void 0||s!==r[n])&&(t[n]=i(s))}c(Pn,"setExecutionProfileItem")});var F0=_(o_=>{o_.require=function(){if(typeof process=="object"&&process.versions&&process.versions.electron)try{let t=require("original-fs");if(Object.keys(t).length>0)return t}catch{}return require("fs")}});var q0=_((SY,a_)=>{a_.exports={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,END64HDR:20,END64SIG:117853008,END64START:4,END64OFF:8,END64NUMDISKS:16,ZIP64SIG:101075792,ZIP64HDR:56,ZIP64LEAD:12,ZIP64SIZE:4,ZIP64VEM:12,ZIP64VER:14,ZIP64DSK:16,ZIP64DSKDIR:20,ZIP64SUB:24,ZIP64TOT:32,ZIP64SIZB:40,ZIP64OFF:48,ZIP64EXTRA:56,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,AES_ENCRYPT:99,FLG_ENC:1,FLG_COMP1:2,FLG_COMP2:4,FLG_DESC:8,FLG_ENH:16,FLG_PATCH:32,FLG_STR:64,FLG_EFS:2048,FLG_MSK:4096,FILE:2,BUFFER:1,NONE:0,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535,EF_ZIP64_SUNCOMP:0,EF_ZIP64_SCOMP:8,EF_ZIP64_RHO:16,EF_ZIP64_DSN:24}});var U0=_((CY,c_)=>{c_.exports={INVALID_LOC:"Invalid LOC header (bad signature)",INVALID_CEN:"Invalid CEN header (bad signature)",INVALID_END:"Invalid END header (bad signature)",NO_DATA:"Nothing to decompress",BAD_CRC:"CRC32 checksum failed",FILE_IN_THE_WAY:"There is a file in the way: %s",UNKNOWN_METHOD:"Invalid/unsupported compression method",AVAIL_DATA:"inflate::Available inflate data did not terminate",INVALID_DISTANCE:"inflate::Invalid literal/length or distance code in fixed or dynamic block",TO_MANY_CODES:"inflate::Dynamic block code description: too many length or distance codes",INVALID_REPEAT_LEN:"inflate::Dynamic block code description: repeat more than specified lengths",INVALID_REPEAT_FIRST:"inflate::Dynamic block code description: repeat lengths with no first length",INCOMPLETE_CODES:"inflate::Dynamic block code description: code lengths codes incomplete",INVALID_DYN_DISTANCE:"inflate::Dynamic block code description: invalid distance code lengths",INVALID_CODES_LEN:"inflate::Dynamic block code description: invalid literal/length code lengths",INVALID_STORE_BLOCK:"inflate::Stored block length did not match one's complement",INVALID_BLOCK_TYPE:"inflate::Invalid block type (type == 3)",CANT_EXTRACT_FILE:"Could not extract the file",CANT_OVERRIDE:"Target file already exists",DISK_ENTRY_TOO_LARGE:"Number of disk entries is too large",NO_ZIP:"No zip file was loaded",NO_ENTRY:"Entry doesn't exist",DIRECTORY_CONTENT_ERROR:"A directory cannot have content",FILE_NOT_FOUND:"File not found: %s",NOT_IMPLEMENTED:"Not implemented",INVALID_FILENAME:"Invalid filename",INVALID_FORMAT:"Invalid or unsupported zip format. No END header found"}});var h_=_((wY,f_)=>{var $6=F0().require(),gr=require("path"),u_=q0(),G6=U0(),j6=typeof process=="object"&&process.platform==="win32",l_=c(t=>t&&typeof t=="object","is_Obj"),V0=new Uint32Array(256).map((t,e)=>{for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e>>>=1;return e>>>0});function Jt(t){this.sep=gr.sep,this.fs=$6,l_(t)&&l_(t.fs)&&typeof t.fs.statSync=="function"&&(this.fs=t.fs)}c(Jt,"Utils");f_.exports=Jt;Jt.prototype.makeDir=function(t){let e=this;function r(n){let i=n.split(e.sep)[0];n.split(e.sep).forEach(function(s){if(!(!s||s.substr(-1,1)===":")){i+=e.sep+s;var o;try{o=e.fs.statSync(i)}catch{e.fs.mkdirSync(i)}if(o&&o.isFile())throw G6.FILE_IN_THE_WAY.replace("%s",i)}})}c(r,"mkdirSync"),r(t)};Jt.prototype.writeFileTo=function(t,e,r,n){let i=this;if(i.fs.existsSync(t)){if(!r)return!1;var s=i.fs.statSync(t);if(s.isDirectory())return!1}var o=gr.dirname(t);i.fs.existsSync(o)||i.makeDir(o);var a;try{a=i.fs.openSync(t,"w",438)}catch{i.fs.chmodSync(t,438),a=i.fs.openSync(t,"w",438)}if(a)try{i.fs.writeSync(a,e,0,e.length,0)}finally{i.fs.closeSync(a)}return i.fs.chmodSync(t,n||438),!0};Jt.prototype.writeFileToAsync=function(t,e,r,n,i){typeof n=="function"&&(i=n,n=void 0);let s=this;s.fs.exists(t,function(o){if(o&&!r)return i(!1);s.fs.stat(t,function(a,u){if(o&&u.isDirectory())return i(!1);var l=gr.dirname(t);s.fs.exists(l,function(f){f||s.makeDir(l),s.fs.open(t,"w",438,function(h,p){h?s.fs.chmod(t,438,function(){s.fs.open(t,"w",438,function(g,d){s.fs.write(d,e,0,e.length,0,function(){s.fs.close(d,function(){s.fs.chmod(t,n||438,function(){i(!0)})})})})}):p?s.fs.write(p,e,0,e.length,0,function(){s.fs.close(p,function(){s.fs.chmod(t,n||438,function(){i(!0)})})}):s.fs.chmod(t,n||438,function(){i(!0)})})})})})};Jt.prototype.findFiles=function(t){let e=this;function r(n,i,s){typeof i=="boolean"&&(s=i,i=void 0);let o=[];return e.fs.readdirSync(n).forEach(function(a){var u=gr.join(n,a);e.fs.statSync(u).isDirectory()&&s&&(o=o.concat(r(u,i,s))),(!i||i.test(u))&&o.push(gr.normalize(u)+(e.fs.statSync(u).isDirectory()?e.sep:""))}),o}return c(r,"findSync"),r(t,void 0,!0)};Jt.prototype.getAttributes=function(){};Jt.prototype.setAttributes=function(){};Jt.crc32update=function(t,e){return V0[(t^e)&255]^t>>>8};Jt.crc32=function(t){typeof t=="string"&&(t=Buffer.from(t,"utf8")),V0.length||genCRCTable();let e=t.length,r=-1;for(let n=0;n<e;)r=Jt.crc32update(r,t[n++]);return~r>>>0};Jt.methodToString=function(t){switch(t){case u_.STORED:return"STORED ("+t+")";case u_.DEFLATED:return"DEFLATED ("+t+")";default:return"UNSUPPORTED ("+t+")"}};Jt.canonical=function(t){if(!t)return"";var e=gr.posix.normalize("/"+t.split("\\").join("/"));return gr.join(".",e)};Jt.sanitize=function(t,e){t=gr.resolve(gr.normalize(t));for(var r=e.split("/"),n=0,i=r.length;n<i;n++){var s=gr.normalize(gr.join(t,r.slice(n,i).join(gr.sep)));if(s.indexOf(t)===0)return s}return gr.normalize(gr.join(t,gr.basename(e)))};Jt.toBuffer=c(function(e){return Buffer.isBuffer(e)?e:e instanceof Uint8Array?Buffer.from(e):typeof e=="string"?Buffer.from(e,"utf8"):Buffer.alloc(0)},"toBuffer");Jt.readBigUInt64LE=function(t,e){var r=Buffer.from(t.slice(e,e+8));return r.swap64(),parseInt(`0x${r.toString("hex")}`)};Jt.isWin=j6;Jt.crcTable=V0});var g_=_((TY,p_)=>{var sl=F0().require(),d_=require("path");sl.existsSync=sl.existsSync||d_.existsSync;p_.exports=function(t){var e=t||"",r=i(),n=null;function i(){return{directory:!1,readonly:!1,hidden:!1,executable:!1,mtime:0,atime:0}}return c(i,"newAttr"),e&&sl.existsSync(e)?(n=sl.statSync(e),r.directory=n.isDirectory(),r.mtime=n.mtime,r.atime=n.atime,r.executable=(73&n.mode)!==0,r.readonly=(128&n.mode)===0,r.hidden=d_.basename(e)[0]==="."):console.warn("Invalid path: "+e),{get directory(){return r.directory},get readOnly(){return r.readonly},get hidden(){return r.hidden},get mtime(){return r.mtime},get atime(){return r.atime},get executable(){return r.executable},decodeAttributes:function(){},encodeAttributes:function(){},toJSON:function(){return{path:e,isDirectory:r.directory,isReadOnly:r.readonly,isHidden:r.hidden,isExecutable:r.executable,mTime:r.mtime,aTime:r.atime}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var Eo=_((bY,rc)=>{rc.exports=h_();rc.exports.Constants=q0();rc.exports.Errors=U0();rc.exports.FileAttr=g_()});var m_=_((IY,y_)=>{var nc=Eo(),ie=nc.Constants;y_.exports=function(){var t=20,e=10,r=0,n=0,i=0,s=0,o=0,a=0,u=0,l=0,f=0,h=0,p=0,g=0,d=0;t|=nc.isWin?2560:768,r|=ie.FLG_EFS;var y={};function v(m){m=new Date(m),i=(m.getFullYear()-1980&127)<<25|m.getMonth()+1<<21|m.getDate()<<16|m.getHours()<<11|m.getMinutes()<<5|m.getSeconds()>>1}return c(v,"setTime"),v(+new Date),{get made(){return t},set made(m){t=m},get version(){return e},set version(m){e=m},get flags(){return r},set flags(m){r=m},get method(){return n},set method(m){switch(m){case ie.STORED:this.version=10;case ie.DEFLATED:default:this.version=20}n=m},get time(){return new Date((i>>25&127)+1980,(i>>21&15)-1,i>>16&31,i>>11&31,i>>5&63,(i&31)<<1)},set time(m){v(m)},get timeHighByte(){return i>>>8&255},get crc(){return s},set crc(m){s=Math.max(0,m)>>>0},get compressedSize(){return o},set compressedSize(m){o=Math.max(0,m)>>>0},get size(){return a},set size(m){a=Math.max(0,m)>>>0},get fileNameLength(){return u},set fileNameLength(m){u=m},get extraLength(){return l},set extraLength(m){l=m},get commentLength(){return f},set commentLength(m){f=m},get diskNumStart(){return h},set diskNumStart(m){h=Math.max(0,m)>>>0},get inAttr(){return p},set inAttr(m){p=Math.max(0,m)>>>0},get attr(){return g},set attr(m){g=Math.max(0,m)>>>0},get fileAttr(){return g?(g>>>0|0)>>16&4095:0},get offset(){return d},set offset(m){d=Math.max(0,m)>>>0},get encrypted(){return(r&1)===1},get centralHeaderSize(){return ie.CENHDR+u+l+f},get realDataOffset(){return d+ie.LOCHDR+y.fnameLen+y.extraLen},get localHeader(){return y},loadLocalHeaderFromBinary:function(m){var w=m.slice(d,d+ie.LOCHDR);if(w.readUInt32LE(0)!==ie.LOCSIG)throw new Error(nc.Errors.INVALID_LOC);y={version:w.readUInt16LE(ie.LOCVER),flags:w.readUInt16LE(ie.LOCFLG),method:w.readUInt16LE(ie.LOCHOW),time:w.readUInt32LE(ie.LOCTIM),crc:w.readUInt32LE(ie.LOCCRC),compressedSize:w.readUInt32LE(ie.LOCSIZ),size:w.readUInt32LE(ie.LOCLEN),fnameLen:w.readUInt16LE(ie.LOCNAM),extraLen:w.readUInt16LE(ie.LOCEXT)}},loadFromBinary:function(m){if(m.length!==ie.CENHDR||m.readUInt32LE(0)!==ie.CENSIG)throw new Error(nc.Errors.INVALID_CEN);t=m.readUInt16LE(ie.CENVEM),e=m.readUInt16LE(ie.CENVER),r=m.readUInt16LE(ie.CENFLG),n=m.readUInt16LE(ie.CENHOW),i=m.readUInt32LE(ie.CENTIM),s=m.readUInt32LE(ie.CENCRC),o=m.readUInt32LE(ie.CENSIZ),a=m.readUInt32LE(ie.CENLEN),u=m.readUInt16LE(ie.CENNAM),l=m.readUInt16LE(ie.CENEXT),f=m.readUInt16LE(ie.CENCOM),h=m.readUInt16LE(ie.CENDSK),p=m.readUInt16LE(ie.CENATT),g=m.readUInt32LE(ie.CENATX),d=m.readUInt32LE(ie.CENOFF)},localHeaderToBinary:function(){var m=Buffer.alloc(ie.LOCHDR);return m.writeUInt32LE(ie.LOCSIG,0),m.writeUInt16LE(e,ie.LOCVER),m.writeUInt16LE(r,ie.LOCFLG),m.writeUInt16LE(n,ie.LOCHOW),m.writeUInt32LE(i,ie.LOCTIM),m.writeUInt32LE(s,ie.LOCCRC),m.writeUInt32LE(o,ie.LOCSIZ),m.writeUInt32LE(a,ie.LOCLEN),m.writeUInt16LE(u,ie.LOCNAM),m.writeUInt16LE(l,ie.LOCEXT),m},centralHeaderToBinary:function(){var m=Buffer.alloc(ie.CENHDR+u+l+f);return m.writeUInt32LE(ie.CENSIG,0),m.writeUInt16LE(t,ie.CENVEM),m.writeUInt16LE(e,ie.CENVER),m.writeUInt16LE(r,ie.CENFLG),m.writeUInt16LE(n,ie.CENHOW),m.writeUInt32LE(i,ie.CENTIM),m.writeUInt32LE(s,ie.CENCRC),m.writeUInt32LE(o,ie.CENSIZ),m.writeUInt32LE(a,ie.CENLEN),m.writeUInt16LE(u,ie.CENNAM),m.writeUInt16LE(l,ie.CENEXT),m.writeUInt16LE(f,ie.CENCOM),m.writeUInt16LE(h,ie.CENDSK),m.writeUInt16LE(p,ie.CENATT),m.writeUInt32LE(g,ie.CENATX),m.writeUInt32LE(d,ie.CENOFF),m.fill(0,ie.CENHDR),m},toJSON:function(){let m=c(function(w){return w+" bytes"},"bytes");return{made:t,version:e,flags:r,method:nc.methodToString(n),time:this.time,crc:"0x"+s.toString(16).toUpperCase(),compressedSize:m(o),size:m(a),fileNameLength:m(u),extraLength:m(l),commentLength:m(f),diskNumStart:h,inAttr:p,attr:g,offset:d,centralHeaderSize:m(ie.CENHDR+u+l+f)}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var E_=_((NY,v_)=>{var So=Eo(),pt=So.Constants;v_.exports=function(){var t=0,e=0,r=0,n=0,i=0;return{get diskEntries(){return t},set diskEntries(s){t=e=s},get totalEntries(){return e},set totalEntries(s){e=t=s},get size(){return r},set size(s){r=s},get offset(){return n},set offset(s){n=s},get commentLength(){return i},set commentLength(s){i=s},get mainHeaderSize(){return pt.ENDHDR+i},loadFromBinary:function(s){if((s.length!==pt.ENDHDR||s.readUInt32LE(0)!==pt.ENDSIG)&&(s.length<pt.ZIP64HDR||s.readUInt32LE(0)!==pt.ZIP64SIG))throw new Error(So.Errors.INVALID_END);s.readUInt32LE(0)===pt.ENDSIG?(t=s.readUInt16LE(pt.ENDSUB),e=s.readUInt16LE(pt.ENDTOT),r=s.readUInt32LE(pt.ENDSIZ),n=s.readUInt32LE(pt.ENDOFF),i=s.readUInt16LE(pt.ENDCOM)):(t=So.readBigUInt64LE(s,pt.ZIP64SUB),e=So.readBigUInt64LE(s,pt.ZIP64TOT),r=So.readBigUInt64LE(s,pt.ZIP64SIZE),n=So.readBigUInt64LE(s,pt.ZIP64OFF),i=0)},toBinary:function(){var s=Buffer.alloc(pt.ENDHDR+i);return s.writeUInt32LE(pt.ENDSIG,0),s.writeUInt32LE(0,4),s.writeUInt16LE(t,pt.ENDSUB),s.writeUInt16LE(e,pt.ENDTOT),s.writeUInt32LE(r,pt.ENDSIZ),s.writeUInt32LE(n,pt.ENDOFF),s.writeUInt16LE(i,pt.ENDCOM),s.fill(" ",pt.ENDHDR),s},toJSON:function(){let s=c(function(o,a){let u=o.toString(16).toUpperCase();for(;u.length<a;)u="0"+u;return"0x"+u},"offset");return{diskEntries:t,totalEntries:e,size:r+" bytes",offset:s(n,4),commentLength:i}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var K0=_(M0=>{M0.EntryHeader=m_();M0.MainHeader=E_()});var C_=_((OY,S_)=>{S_.exports=function(t){var e=require("zlib"),r={chunkSize:(parseInt(t.length/1024)+1)*1024};return{deflate:function(){return e.deflateRawSync(t,r)},deflateAsync:function(n){var i=e.createDeflateRaw(r),s=[],o=0;i.on("data",function(a){s.push(a),o+=a.length}),i.on("end",function(){var a=Buffer.alloc(o),u=0;a.fill(0);for(var l=0;l<s.length;l++){var f=s[l];f.copy(a,u),u+=f.length}n&&n(a)}),i.end(t)}}}});var x_=_((DY,w_)=>{var z6=+(process.versions?process.versions.node:"").split(".")[0]||0;w_.exports=function(t,e){var r=require("zlib");let n=z6>=15&&e>0?{maxOutputLength:e}:{};return{inflate:function(){return r.inflateRawSync(t,n)},inflateAsync:function(i){var s=r.createInflateRaw(n),o=[],a=0;s.on("data",function(u){o.push(u),a+=u.length}),s.on("end",function(){var u=Buffer.alloc(a),l=0;u.fill(0);for(var f=0;f<o.length;f++){var h=o[f];h.copy(u,l),l+=h.length}i&&i(u)}),s.end(t)}}}});var A_=_((LY,I_)=>{"use strict";var{randomFillSync:T_}=require("crypto"),W6=new Uint32Array(256).map((t,e)=>{for(let r=0;r<8;r++)e&1?e=e>>>1^3988292384:e>>>=1;return e>>>0}),b_=c((t,e)=>Math.imul(t,e)>>>0,"uMul"),__=c((t,e)=>W6[(t^e)&255]^t>>>8,"crc32update"),ic=c(()=>typeof T_=="function"?T_(Buffer.alloc(12)):ic.node(),"genSalt");ic.node=()=>{let t=Buffer.alloc(12),e=t.length;for(let r=0;r<e;r++)t[r]=Math.random()*256&255;return t};var ol={genSalt:ic};function al(t){let e=Buffer.isBuffer(t)?t:Buffer.from(t);this.keys=new Uint32Array([305419896,591751049,878082192]);for(let r=0;r<e.length;r++)this.updateKeys(e[r])}c(al,"Initkeys");al.prototype.updateKeys=function(t){let e=this.keys;return e[0]=__(e[0],t),e[1]+=e[0]&255,e[1]=b_(e[1],134775813)+1,e[2]=__(e[2],e[1]>>>24),t};al.prototype.next=function(){let t=(this.keys[2]|2)>>>0;return b_(t,t^1)>>8&255};function Q6(t){let e=new al(t);return function(r){let n=Buffer.alloc(r.length),i=0;for(let s of r)n[i++]=e.updateKeys(s^e.next());return n}}c(Q6,"make_decrypter");function Y6(t){let e=new al(t);return function(r,n,i=0){n||(n=Buffer.alloc(r.length));for(let s of r){let o=e.next();n[i++]=s^o,e.updateKeys(s)}return n}}c(Y6,"make_encrypter");function Z6(t,e,r){if(!t||!Buffer.isBuffer(t)||t.length<12)return Buffer.alloc(0);let n=Q6(r),i=n(t.slice(0,12)),s=(e.flags&8)===8?e.timeHighByte:e.crc>>>24;if(i[11]!==s)throw"ADM-ZIP: Wrong Password";return n(t.slice(12))}c(Z6,"decrypt");function X6(t){Buffer.isBuffer(t)&&t.length>=12?ol.genSalt=function(){return t.slice(0,12)}:t==="node"?ol.genSalt=ic.node:ol.genSalt=ic}c(X6,"_salter");function J6(t,e,r,n=!1){t==null&&(t=Buffer.alloc(0)),Buffer.isBuffer(t)||(t=Buffer.from(t.toString()));let i=Y6(r),s=ol.genSalt();s[11]=e.crc>>>24&255,n&&(s[10]=e.crc>>>16&255);let o=Buffer.alloc(t.length+12);return i(s,o),i(t,o,12)}c(J6,"encrypt");I_.exports={decrypt:Z6,encrypt:J6,_salter:X6}});var N_=_(cl=>{cl.Deflater=C_();cl.Inflater=x_();cl.ZipCrypto=A_()});var $0=_((FY,B_)=>{var Tt=Eo(),eU=K0(),Mr=Tt.Constants,H0=N_();B_.exports=function(t){var e=new eU.EntryHeader,r=Buffer.alloc(0),n=Buffer.alloc(0),i=!1,s=null,o=Buffer.alloc(0);function a(){return!t||!(t instanceof Uint8Array)?Buffer.alloc(0):(e.loadLocalHeaderFromBinary(t),t.slice(e.realDataOffset,e.realDataOffset+e.compressedSize))}c(a,"getCompressedDataFromZip");function u(d){return!((e.flags&8)!==8&&Tt.crc32(d)!==e.localHeader.crc)}c(u,"crc32OK");function l(d,y,v){if(typeof y>"u"&&typeof d=="string"&&(v=d,d=void 0),i)return d&&y&&y(Buffer.alloc(0),Tt.Errors.DIRECTORY_CONTENT_ERROR),Buffer.alloc(0);var m=a();if(m.length===0)return d&&y&&y(m),m;if(e.encrypted){if(typeof v!="string"&&!Buffer.isBuffer(v))throw new Error("ADM-ZIP: Incompatible password parameter");m=H0.ZipCrypto.decrypt(m,e,v)}var w=Buffer.alloc(e.size);switch(e.method){case Tt.Constants.STORED:if(m.copy(w),u(w))return d&&y&&y(w),w;throw d&&y&&y(w,Tt.Errors.BAD_CRC),new Error(Tt.Errors.BAD_CRC);case Tt.Constants.DEFLATED:var x=new H0.Inflater(m,e.size);if(d)x.inflateAsync(function(A){A.copy(A,0),y&&(u(A)?y(A):y(A,Tt.Errors.BAD_CRC))});else{if(x.inflate(w).copy(w,0),!u(w))throw new Error(Tt.Errors.BAD_CRC+" "+r.toString());return w}break;default:throw d&&y&&y(Buffer.alloc(0),Tt.Errors.UNKNOWN_METHOD),new Error(Tt.Errors.UNKNOWN_METHOD)}}c(l,"decompress");function f(d,y){if((!s||!s.length)&&Buffer.isBuffer(t))return d&&y&&y(a()),a();if(s.length&&!i){var v;switch(e.method){case Tt.Constants.STORED:return e.compressedSize=e.size,v=Buffer.alloc(s.length),s.copy(v),d&&y&&y(v),v;default:case Tt.Constants.DEFLATED:var m=new H0.Deflater(s);if(d)m.deflateAsync(function(x){v=Buffer.alloc(x.length),e.compressedSize=x.length,x.copy(v),y&&y(v)});else{var w=m.deflate();return e.compressedSize=w.length,w}m=null;break}}else if(d&&y)y(Buffer.alloc(0));else return Buffer.alloc(0)}c(f,"compress");function h(d,y){return(d.readUInt32LE(y+4)<<4)+d.readUInt32LE(y)}c(h,"readUInt64LE");function p(d){for(var y=0,v,m,w;y<d.length;)v=d.readUInt16LE(y),y+=2,m=d.readUInt16LE(y),y+=2,w=d.slice(y,y+m),y+=m,Mr.ID_ZIP64===v&&g(w)}c(p,"parseExtra");function g(d){var y,v,m,w;d.length>=Mr.EF_ZIP64_SCOMP&&(y=h(d,Mr.EF_ZIP64_SUNCOMP),e.size===Mr.EF_ZIP64_OR_32&&(e.size=y)),d.length>=Mr.EF_ZIP64_RHO&&(v=h(d,Mr.EF_ZIP64_SCOMP),e.compressedSize===Mr.EF_ZIP64_OR_32&&(e.compressedSize=v)),d.length>=Mr.EF_ZIP64_DSN&&(m=h(d,Mr.EF_ZIP64_RHO),e.offset===Mr.EF_ZIP64_OR_32&&(e.offset=m)),d.length>=Mr.EF_ZIP64_DSN+4&&(w=d.readUInt32LE(Mr.EF_ZIP64_DSN),e.diskNumStart===Mr.EF_ZIP64_OR_16&&(e.diskNumStart=w))}return c(g,"parseZip64ExtendedInformation"),{get entryName(){return r.toString()},get rawEntryName(){return r},set entryName(d){r=Tt.toBuffer(d);var y=r[r.length-1];i=y===47||y===92,e.fileNameLength=r.length},get extra(){return o},set extra(d){o=d,e.extraLength=d.length,p(d)},get comment(){return n.toString()},set comment(d){n=Tt.toBuffer(d),e.commentLength=n.length},get name(){var d=r.toString();return i?d.substr(d.length-1).split("/").pop():d.split("/").pop()},get isDirectory(){return i},getCompressedData:function(){return f(!1,null)},getCompressedDataAsync:function(d){f(!0,d)},setData:function(d){s=Tt.toBuffer(d),!i&&s.length?(e.size=s.length,e.method=Tt.Constants.DEFLATED,e.crc=Tt.crc32(d),e.changed=!0):e.method=Tt.Constants.STORED},getData:function(d){return e.changed?s:l(!1,null,d)},getDataAsync:function(d,y){e.changed?d(s):l(!0,d,y)},set attr(d){e.attr=d},get attr(){return e.attr},set header(d){e.loadFromBinary(d)},get header(){return e},packCentralHeader:function(){var d=e.centralHeaderToBinary(),y=Tt.Constants.CENHDR;return r.copy(d,y),y+=r.length,e.extraLength&&(o.copy(d,y),y+=e.extraLength),e.commentLength&&n.copy(d,y),d},packLocalHeader:function(){let d=0,y=e.localHeaderToBinary(),v=Buffer.alloc(y.length+r.length+o.length);return y.copy(v,d),d+=y.length,r.copy(v,d),d+=r.length,o.copy(v,d),d+=o.length,v},toJSON:function(){let d=c(function(y){return"<"+(y&&y.length+" bytes buffer"||"null")+">"},"bytes");return{entryName:this.entryName,name:this.name,comment:this.comment,isDirectory:this.isDirectory,header:e.toJSON(),compressedData:d(t),data:d(s)}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var D_=_((UY,O_)=>{var R_=$0(),tU=K0(),$t=Eo();O_.exports=function(t,e){var r=[],n={},i=Buffer.alloc(0),s=new tU.MainHeader,o=!1,a=null;let u=Object.assign(Object.create(null),e),{noSort:l}=u;t?p(u.readEntries):o=!0;function f(d){let y=s.diskEntries,v=s.offset;for(let m=0;m<y;m++){let w=v,x=new R_(t);x.header=t.slice(w,w+=$t.Constants.CENHDR),x.entryName=t.slice(w,w+=x.header.fileNameLength),v+=x.header.centralHeaderSize,d(x)}}c(f,"iterateEntries");function h(){if(o=!0,n={},s.diskEntries>(t.length-s.offset)/$t.Constants.CENHDR)throw new Error($t.Errors.DISK_ENTRY_TOO_LARGE);r=new Array(s.diskEntries);for(var d=s.offset,y=0;y<r.length;y++){var v=d,m=new R_(t);m.header=t.slice(v,v+=$t.Constants.CENHDR),m.entryName=t.slice(v,v+=m.header.fileNameLength),m.header.extraLength&&(m.extra=t.slice(v,v+=m.header.extraLength)),m.header.commentLength&&(m.comment=t.slice(v,v+m.header.commentLength)),d+=m.header.centralHeaderSize,r[y]=m,n[m.entryName]=m}}c(h,"readEntries");function p(d){var y=t.length-$t.Constants.ENDHDR,v=Math.max(0,y-65535),m=v,w=t.length,x=-1,A=0;for(y;y>=m;y--)if(t[y]===80){if(t.readUInt32LE(y)===$t.Constants.ENDSIG){x=y,A=y,w=y+$t.Constants.ENDHDR,m=y-$t.Constants.END64HDR;continue}if(t.readUInt32LE(y)===$t.Constants.END64SIG){m=v;continue}if(t.readUInt32LE(y)===$t.Constants.ZIP64SIG){x=y,w=y+$t.readBigUInt64LE(t,y+$t.Constants.ZIP64SIZE)+$t.Constants.ZIP64LEAD;break}}if(!~x)throw new Error($t.Errors.INVALID_FORMAT);s.loadFromBinary(t.slice(x,w)),s.commentLength&&(i=t.slice(A+$t.Constants.ENDHDR)),d&&h()}c(p,"readMainHeader");function g(){r.length>1&&!l&&r.sort((d,y)=>d.entryName.toLowerCase().localeCompare(y.entryName.toLowerCase()))}return c(g,"sortEntries"),{get entries(){return o||h(),r},get comment(){return i.toString()},set comment(d){i=$t.toBuffer(d),s.commentLength=i.length},getEntryCount:function(){return o?r.length:s.diskEntries},forEach:function(d){if(!o){f(d);return}r.forEach(d)},getEntry:function(d){return o||h(),n[d]||null},setEntry:function(d){o||h(),r.push(d),n[d.entryName]=d,s.totalEntries=r.length},deleteEntry:function(d){o||h();var y=n[d];if(y&&y.isDirectory){var v=this;this.getEntryChildren(y).forEach(function(m){m.entryName!==d&&v.deleteEntry(m.entryName)})}r.splice(r.indexOf(y),1),delete n[d],s.totalEntries=r.length},getEntryChildren:function(d){if(o||h(),d&&d.isDirectory){let y=[],v=d.entryName,m=v.length;return r.forEach(function(w){w.entryName.substr(0,m)===v&&y.push(w)}),y}return[]},compressToBuffer:function(){o||h(),g();let d=[],y=[],v=0,m=0;s.size=0,s.offset=0;for(let A of r){let O=A.getCompressedData();A.header.offset=m;let P=A.packLocalHeader(),j=P.length+O.length;m+=j,d.push(P),d.push(O);let Q=A.packCentralHeader();y.push(Q),s.size+=Q.length,v+=j+Q.length}v+=s.mainHeaderSize,s.offset=m,m=0;let w=Buffer.alloc(v);for(let A of d)A.copy(w,m),m+=A.length;for(let A of y)A.copy(w,m),m+=A.length;let x=s.toBinary();return i&&i.copy(x,$t.Constants.ENDHDR),x.copy(w,m),w},toAsyncBuffer:function(d,y,v,m){try{o||h(),g();let w=[],x=[],A=0,O=0;s.size=0,s.offset=0;let P=c(function(j){if(j.length>0){let Q=j.shift(),se=Q.entryName+Q.extra.toString();v&&v(se),Q.getCompressedDataAsync(function(re){m&&m(se),Q.header.offset=O;let k=Q.packLocalHeader(),Ae=k.length+re.length;O+=Ae,w.push(k),w.push(re);let q=Q.packCentralHeader();x.push(q),s.size+=q.length,A+=Ae+q.length,P(j)})}else{A+=s.mainHeaderSize,s.offset=O,O=0;let Q=Buffer.alloc(A);w.forEach(function(re){re.copy(Q,O),O+=re.length}),x.forEach(function(re){re.copy(Q,O),O+=re.length});let se=s.toBinary();i&&i.copy(se,$t.Constants.ENDHDR),se.copy(Q,O),d(Q)}},"compress2Buffer");P(Array.from(r))}catch(w){y(w)}}}}});var P_=_((MY,L_)=>{var Nt=Eo(),kn=require("path"),rU=$0(),nU=D_(),ms=c((t,e)=>typeof t=="boolean"?t:e,"get_Bool"),G0=c((t,e)=>typeof t=="string"?t:e,"get_Str"),iU={noSort:!1,readEntries:!1,method:Nt.Constants.NONE,fs:null};L_.exports=function(t,e){let r=null,n=Object.assign(Object.create(null),iU);t&&typeof t=="object"&&(t instanceof Uint8Array||(Object.assign(n,t),t=n.input?n.input:void 0,n.input&&delete n.input),Buffer.isBuffer(t)&&(r=t,n.method=Nt.Constants.BUFFER,t=void 0)),Object.assign(n,e);let i=new Nt(n);if(t&&typeof t=="string")if(i.fs.existsSync(t))n.method=Nt.Constants.FILE,n.filename=t,r=i.fs.readFileSync(t);else throw new Error(Nt.Errors.INVALID_FILENAME);let s=new nU(r,n),{canonical:o,sanitize:a}=Nt;function u(f){if(f&&s){var h;if(typeof f=="string"&&(h=s.getEntry(f)),typeof f=="object"&&typeof f.entryName<"u"&&typeof f.header<"u"&&(h=s.getEntry(f.entryName)),h)return h}return null}c(u,"getEntry");function l(f){let{join:h,normalize:p,sep:g}=kn.posix;return h(".",p(g+f.split("\\").join(g)+g))}return c(l,"fixPath"),{readFile:function(f,h){var p=u(f);return p&&p.getData(h)||null},readFileAsync:function(f,h){var p=u(f);p?p.getDataAsync(h):h(null,"getEntry failed for:"+f)},readAsText:function(f,h){var p=u(f);if(p){var g=p.getData();if(g&&g.length)return g.toString(h||"utf8")}return""},readAsTextAsync:function(f,h,p){var g=u(f);g?g.getDataAsync(function(d,y){if(y){h(d,y);return}d&&d.length?h(d.toString(p||"utf8")):h("")}):h("")},deleteFile:function(f){var h=u(f);h&&s.deleteEntry(h.entryName)},addZipComment:function(f){s.comment=f},getZipComment:function(){return s.comment||""},addZipEntryComment:function(f,h){var p=u(f);p&&(p.comment=h)},getZipEntryComment:function(f){var h=u(f);return h&&h.comment||""},updateFile:function(f,h){var p=u(f);p&&p.setData(h)},addLocalFile:function(f,h,p,g){if(i.fs.existsSync(f)){h=h?l(h):"";var d=f.split("\\").join("/").split("/").pop();h+=p||d;let y=i.fs.statSync(f);this.addFile(h,i.fs.readFileSync(f),g,y)}else throw new Error(Nt.Errors.FILE_NOT_FOUND.replace("%s",f))},addLocalFolder:function(f,h,p,g){if(p instanceof RegExp?p=function(d){return function(y){return d.test(y)}}(p):typeof p!="function"&&(p=c(function(){return!0},"filter")),h=h?l(h):"",f=kn.normalize(f),i.fs.existsSync(f)){let d=i.findFiles(f),y=this;d.length&&d.forEach(function(v){var m=kn.relative(f,v).split("\\").join("/");if(p(m)){var w=i.fs.statSync(v);w.isFile()?y.addFile(h+m,i.fs.readFileSync(v),"",g||w):y.addFile(h+m+"/",Buffer.alloc(0),"",g||w)}})}else throw new Error(Nt.Errors.FILE_NOT_FOUND.replace("%s",f))},addLocalFolderAsync:function(f,h,p,g){g instanceof RegExp?g=function(y){return function(v){return y.test(v)}}(g):typeof g!="function"&&(g=c(function(){return!0},"filter")),p=p?l(p):"",f=kn.normalize(f);var d=this;i.fs.open(f,"r",function(y){if(y&&y.code==="ENOENT")h(void 0,Nt.Errors.FILE_NOT_FOUND.replace("%s",f));else if(y)h(void 0,y);else{var v=i.findFiles(f),m=-1,w=c(function(){if(m+=1,m<v.length){var x=v[m],A=kn.relative(f,x).split("\\").join("/");A=A.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x20-\x7E]/g,""),g(A)?i.fs.stat(x,function(O,P){O&&h(void 0,O),P.isFile()?i.fs.readFile(x,function(j,Q){j?h(void 0,j):(d.addFile(p+A,Q,"",P),w())}):(d.addFile(p+A+"/",Buffer.alloc(0),"",P),w())}):process.nextTick(()=>{w()})}else h(!0,void 0)},"next");w()}})},addLocalFolderPromise:function(f,h){return new Promise((p,g)=>{let{filter:d,zipPath:y}=Object.assign({},h);this.addLocalFolderAsync(f,(v,m)=>{m&&g(m),v&&p(this)},y,d)})},addFile:function(f,h,p,g){let d=u(f),y=d!=null;y||(d=new rU,d.entryName=Nt.canonical(f)),d.comment=p||"";let v=typeof g=="object"&&g instanceof i.fs.Stats;v&&(d.header.time=g.mtime);var m=d.isDirectory?16:0;let w=d.isDirectory?16384:32768;return v?w|=4095&g.mode:typeof g=="number"?w|=4095&g:w|=d.isDirectory?493:420,m=(m|w<<16)>>>0,d.attr=m,d.setData(h),y||s.setEntry(d),d},getEntries:function(f){return s.password=f,s?s.entries:[]},getEntry:function(f){return u(f)},getEntryCount:function(){return s.getEntryCount()},forEach:function(f){return s.forEach(f)},extractEntryTo:function(f,h,p,g,d,y){g=ms(g,!1),d=ms(d,!1),p=ms(p,!0),y=G0(y,G0(d,void 0));var v=u(f);if(!v)throw new Error(Nt.Errors.NO_ENTRY);var m=o(v.entryName),w=a(h,y&&!v.isDirectory?y:p?m:kn.basename(m));if(v.isDirectory){var x=s.getEntryChildren(v);return x.forEach(function(P){if(P.isDirectory)return;var j=P.getData();if(!j)throw new Error(Nt.Errors.CANT_EXTRACT_FILE);var Q=o(P.entryName),se=a(h,p?Q:kn.basename(Q));let re=d?P.header.fileAttr:void 0;i.writeFileTo(se,j,g,re)}),!0}var A=v.getData(s.password);if(!A)throw new Error(Nt.Errors.CANT_EXTRACT_FILE);if(i.fs.existsSync(w)&&!g)throw new Error(Nt.Errors.CANT_OVERRIDE);let O=d?f.header.fileAttr:void 0;return i.writeFileTo(w,A,g,O),!0},test:function(f){if(!s)return!1;for(var h in s.entries)try{if(h.isDirectory)continue;var p=s.entries[h].getData(f);if(!p)return!1}catch{return!1}return!0},extractAllTo:function(f,h,p,g){if(h=ms(h,!1),g=G0(p,g),p=ms(p,!1),!s)throw new Error(Nt.Errors.NO_ZIP);s.entries.forEach(function(d){var y=a(f,o(d.entryName.toString()));if(d.isDirectory){i.makeDir(y);return}var v=d.getData(g);if(!v)throw new Error(Nt.Errors.CANT_EXTRACT_FILE);let m=p?d.header.fileAttr:void 0;i.writeFileTo(y,v,h,m);try{i.fs.utimesSync(y,d.header.time,d.header.time)}catch{throw new Error(Nt.Errors.CANT_EXTRACT_FILE)}})},extractAllToAsync:function(f,h,p,g){if(typeof h=="function"&&!g&&(g=h),h=ms(h,!1),typeof p=="function"&&!g&&(g=p),p=ms(p,!1),!g)return new Promise((w,x)=>{this.extractAllToAsync(f,h,p,function(A){A?x(A):w(this)})});if(!s){g(new Error(Nt.Errors.NO_ZIP));return}f=kn.resolve(f);let d=c(w=>a(f,kn.normalize(o(w.entryName.toString()))),"getPath"),y=c((w,x)=>new Error(w+': "'+x+'"'),"getError"),v=[],m=[];s.entries.forEach(w=>{w.isDirectory?v.push(w):m.push(w)});for(let w of v){let x=d(w),A=p?w.header.fileAttr:void 0;try{i.makeDir(x),A&&i.fs.chmodSync(x,A),i.fs.utimesSync(x,w.header.time,w.header.time)}catch{g(y("Unable to create folder",x))}}m.reverse().reduce(function(w,x){return function(A){if(A)w(A);else{let O=kn.normalize(o(x.entryName.toString())),P=a(f,O);x.getDataAsync(function(j,Q){if(Q)w(new Error(Q));else if(!j)w(new Error(Nt.Errors.CANT_EXTRACT_FILE));else{let se=p?x.header.fileAttr:void 0;i.writeFileToAsync(P,j,h,se,function(re){re||w(y("Unable to write file",P)),i.fs.utimes(P,x.header.time,x.header.time,function(k){k?w(y("Unable to set times",P)):w()})})}})}}},g)()},writeZip:function(f,h){if(arguments.length===1&&typeof f=="function"&&(h=f,f=""),!f&&n.filename&&(f=n.filename),!!f){var p=s.compressToBuffer();if(p){var g=i.writeFileTo(f,p,!0);typeof h=="function"&&h(g?null:new Error("failed"),"")}}},writeZipPromise:function(f,h){let{overwrite:p,perm:g}=Object.assign({overwrite:!0},h);return new Promise((d,y)=>{!f&&n.filename&&(f=n.filename),f||y("ADM-ZIP: ZIP File Name Missing"),this.toBufferPromise().then(v=>{let m=c(w=>w?d(w):y("ADM-ZIP: Wasn't able to write zip file"),"ret");i.writeFileToAsync(f,v,p,g,m)},y)})},toBufferPromise:function(){return new Promise((f,h)=>{s.toAsyncBuffer(f,h)})},toBuffer:function(f,h,p,g){return this.valueOf=2,typeof f=="function"?(s.toAsyncBuffer(f,h,p,g),null):s.compressToBuffer()}}}});var V_=_((HY,U_)=>{"use strict";var sU=require("https"),oU=require("fs"),F_=require("util"),aU=P_(),{URL:cU}=require("url"),uU=ze(),k_=oe(),{DsePlainTextAuthProvider:lU,NoAuthProvider:fU}=Oa(),hU=F_.promisify(oU.readFile);async function dU(t){if(!t.cloud)return;let e=new z0(t);await pU(e),await yU(e),e.clientOptions.sslOptions.checkServerIdentity||(e.clientOptions.sslOptions.checkServerIdentity=(r,n)=>q_(n,e.clientOptions.sni.address))}c(dU,"init");var W0=class W0{constructor(e){this.clientOptions=e,e.cloud.secureConnectBundle?(this.secureConnectBundle=e.cloud.secureConnectBundle,this.serviceUrl=null):this.serviceUrl=e.cloud.endpoint,this.logEmitter=e.logEmitter,this.contactPoints=null,this.localDataCenter=null}setSslOptions(e){this.clientOptions.sslOptions=Object.assign({ca:[e.get("ca.crt")],cert:e.get("cert"),key:e.get("key"),rejectUnauthorized:!0},this.clientOptions.sslOptions)}setAuthProvider(e,r){!e||!r||this.clientOptions.authProvider&&!(this.clientOptions.authProvider instanceof fU)||(this.clientOptions.authProvider=new lU(e,r))}};c(W0,"CloudOptions");var z0=W0;async function pU(t){if(t.serviceUrl)return;if(!t.secureConnectBundle)throw new TypeError("secureConnectBundle must be provided");let e=await hU(t.secureConnectBundle),r=new aU(e),n=new Map(r.getEntries().map(s=>[s.entryName,s.getData()]));if(!n.get("config.json"))throw new TypeError("Config file must be contained in secure bundle");let i=JSON.parse(n.get("config.json").toString("utf8"));if(!i.host||!i.port)throw new TypeError("Config file must include host and port information");t.serviceUrl=`${i.host}:${i.port}/metadata`,t.setSslOptions(n),t.setAuthProvider(i.username,i.password)}c(pU,"parseZipFile");function gU(t,e){let n=/^(.+?):(\d+)(.*)$/.exec(t.serviceUrl);if(e=k_.callbackOnce(e),!n||n.length!==4)throw new TypeError("url should be composed of host, port number and path, without scheme");let i=Object.assign({hostname:n[1],port:n[2],path:n[3]||void 0,timeout:t.clientOptions.socketOptions.connectTimeout},t.clientOptions.sslOptions),s=sU.get(i,o=>{let a="";k_.log("verbose",`Connected to metadata service with SSL/TLS protocol ${o.socket.getProtocol()}`,{},t),o.on("data",u=>a+=u.toString()).on("end",()=>{if(o.statusCode!==200)return e(j0(new Error(`Obtained http status ${o.statusCode}`),i));let u;try{if(u=JSON.parse(a),!u||!u.contact_info)throw new TypeError("contact_info should be defined in response")}catch(f){return e(j0(f,i,!0))}let l=u.contact_info;t.clientOptions.contactPoints=l.contact_points,t.clientOptions.localDataCenter=l.local_dc,t.clientOptions.sni={address:l.sni_proxy_address},e()})});s.on("error",o=>e(j0(o,i))),s.setTimeout(t.clientOptions.socketOptions.connectTimeout,()=>s.abort())}c(gU,"getMetadataServiceInfo");var yU=F_.promisify(gU);function j0(t,e,r){let n=r?"There was an error while parsing the metadata service information":"There was an error fetching the metadata information",i=`${e.hostname}:${e.port}${e.path?e.path:"/"}`;return new uU.NoHostAvailableError({[i]:t},n)}c(j0,"getServiceRequestError");function q_(t,e){let r=e.split(":")[0],n=t.subjectaltname,i=t.subject.CN;if(r===i)return;let s=[];if(n)for(let l of n.split(", "))l.startsWith("DNS:")?s.push(l.slice(4)):l.startsWith("URI:")&&s.push(new cU(l.slice(4)).hostname);let o=r.split("."),a=c(l=>mU(o,l),"wildcard"),u;if(s.length>0?u=s.some(a):u=a(i),!u){let l=new Error(`Host: ${r} is not cert's CN/altnames: ${i} / ${n}`);return l.reason=l.message,l.host=r,l.cert=t,l}}c(q_,"checkServerIdentity");function mU(t,e){if(!e)return!1;let r=e.split(".");if(t.length!==r.length)return!1;for(let u=t.length-1;u>0;u-=1)if(t[u]!==r[u])return!1;let n=t[0],i=r[0],s=i.split("*");if(s.length===1||i.includes("xn--"))return n===i;if(s.length>2||r.length<=2)return!1;let[o,a]=s;return!(o.length+a.length>n.length||!n.startsWith(o)||!n.endsWith(a))}c(mU,"checkParts");U_.exports={checkServerIdentity:q_,init:dU}});var Q0=_((GY,H_)=>{"use strict";var M_=oe();function K_(t,e){this.info=t.info;let r=t.rows;e=e||vU,this.length=t.rowLength,this.pageState=t.pageState,this.first=c(function(){let s=this.values().next();return s.done?null:s.value},"first"),this.forEach=c(function(i,s){if(!r.length)return;let o=this.values(),a=o.next(),u=0;for(;!a.done;)i.call(s||this,a.value,u++),a=o.next()},"forEach"),this.toArray=c(function(){return r.length?M_.iteratorToArray(this.values()):M_.emptyArray},"toArray"),this.values=c(function*(){for(let i of this.getTraversers()){let s=i.bulk||1;for(let o=0;o<s;o++)yield i.object}},"values"),this.getTraversers=function*(){for(let n of r)yield e(n)}}c(K_,"GraphResultSet");typeof Symbol<"u"&&typeof Symbol.iterator=="symbol"&&(K_.prototype[Symbol.iterator]=c(function(){return this.values()},"getIterator"));function vU(t){let e=JSON.parse(t.gremlin);return{object:e.result,bulk:e.bulk||1}}c(vU,"parsePlainJsonRow");H_.exports=K_});var fl=_((zY,$_)=>{"use strict";var EU=Ke(),{dataTypes:ll}=EU,Y0=class Y0{constructor(e,r){this.value=e,this.typeInfo=typeof r=="number"?{code:r}:r}};c(Y0,"GraphTypeWrapper");var vs=Y0,Z0=class Z0{constructor(e,r){if(this.value=e,!r||!r.name||!r.keyspace||!r.fields)throw new TypeError("udtInfo must be an object with name, keyspace and field properties defined");this.udtInfo=r}};c(Z0,"UdtGraphWrapper");var ul=Z0;function SU(t){return new vs(t,ll.int)}c(SU,"asInt");function CU(t){return new vs(t,ll.double)}c(CU,"asDouble");function wU(t){return new vs(t,ll.float)}c(wU,"asFloat");function xU(t){return new vs(t,ll.timestamp)}c(xU,"asTimestamp");function TU(t,e){return new ul(t,e)}c(TU,"asUdt");$_.exports={asInt:SU,asDouble:CU,asFloat:wU,asTimestamp:xU,asUdt:TU,UdtGraphWrapper:ul,GraphTypeWrapper:vs}});var W_=_((QY,z_)=>{"use strict";var{GraphTypeWrapper:_U,UdtGraphWrapper:bU}=fl(),hl=Ke(),IU=Ou(),{dataTypes:Co}=hl;function X0(t){if(t instanceof hl.Tuple)return{cqlType:"tuple",definition:t.elements.map(X0)};if(t instanceof Map){let r={cqlType:"map"};if(t.size>0){let n=t.entries().next().value;r.definition=n.map(X0)}return r}if(t instanceof bU)return j_(t);let e;return t instanceof _U?e=t.typeInfo:e=IU.guessDataType(t),e?dl(e):null}c(X0,"getTypeDefinitionByValue");function dl(t){return t.code===Co.udt?G_(t.info):t.code===Co.tuple||t.code===Co.map?{cqlType:hl.getDataTypeNameByCode(t),definition:t.info.map(dl)}:t.code===Co.list||t.code===Co.set?{cqlType:t.code===Co.list?"list":"set",definition:[dl(t.info)]}:{cqlType:hl.getDataTypeNameByCode(t)}}c(dl,"getDefinitionByType");function G_(t){return{cqlType:"udt",keyspace:t.keyspace,name:t.name,definition:t.fields.map(e=>Object.assign({fieldName:e.name},dl(e.type)))}}c(G_,"getUdtTypeDefinition");function j_(t){return G_(t.udtInfo)}c(j_,"getUdtTypeDefinitionByValue");z_.exports={getTypeDefinitionByValue:X0,getUdtTypeDefinitionByValue:j_}});var eg=_((ZY,X_)=>{"use strict";var J0=require("util");function Es(t,e){this.id=t,this.label=e}c(Es,"Element");function Q_(t,e,r){Es.call(this,t,e),this.properties=r}c(Q_,"Vertex");J0.inherits(Q_,Es);function Y_(t,e,r,n,i,s,o){Es.call(this,t,n),this.outV=e,this.outVLabel=r,this.inV=i,this.inVLabel=s,this.properties={},c(function(u){if(o){let l=Object.keys(o);for(let f=0;f<l.length;f++){let h=l[f];u.properties[h]=o[h].value}}},"adaptProperties")(this)}c(Y_,"Edge");J0.inherits(Y_,Es);function Z_(t,e,r,n){Es.call(this,t,e),this.value=r,this.key=this.label,this.properties=n}c(Z_,"VertexProperty");J0.inherits(Z_,Es);function AU(t,e){this.key=t,this.value=e}c(AU,"Property");function NU(t,e){this.labels=t,this.objects=e}c(NU,"Path");X_.exports={Edge:Y_,Element:Es,Path:NU,Property:AU,Vertex:Q_,VertexProperty:Z_}});var Fg=_((JY,eb)=>{"use strict";var Fn=Ke(),BU=oe(),{getTypeDefinitionByValue:RU,getUdtTypeDefinitionByValue:OU}=W_(),{Point:DU,Polygon:LU,LineString:PU}=Nu(),{Edge:kU}=eg(),{GraphTypeWrapper:FU,UdtGraphWrapper:qU}=fl(),{Tuple:J_,dataTypes:sc}=Fn,Cs="@type",Rr="@value",vg=class vg{constructor(){this.key="g:Edge"}deserialize(e){let r=e[Rr];return new kU(this.reader.read(r.id),this.reader.read(r.outV),r.outVLabel,r.label,this.reader.read(r.inV),r.inVLabel,this.reader.read(r.properties))}};c(vg,"EdgeDeserializer");var tg=vg,Eg=class Eg{constructor(e,r){if(!e)throw new Error("Deserializer must provide a type key");if(!r)throw new Error("Deserializer must provide a target type");this.key=e,this.targetType=r}deserialize(e){let r=e[Rr];return typeof r!="string"&&(r=r.toString()),this.targetType.fromString(r)}serialize(e){return{[Cs]:this.key,[Rr]:e.toString()}}canBeUsedFor(e){return e instanceof this.targetType}};c(Eg,"StringBasedTypeSerializer");var Or=Eg,Sg=class Sg extends Or{constructor(){super("g:UUID",Fn.Uuid)}};c(Sg,"UuidSerializer");var rg=Sg,Cg=class Cg extends Or{constructor(){super("g:Int64",Fn.Long)}};c(Cg,"LongSerializer");var ng=Cg,wg=class wg extends Or{constructor(){super("gx:BigDecimal",Fn.BigDecimal)}};c(wg,"BigDecimalSerializer");var ig=wg,xg=class xg extends Or{constructor(){super("gx:BigInteger",Fn.Integer)}};c(xg,"BigIntegerSerializer");var sg=xg,Tg=class Tg extends Or{constructor(){super("gx:InetAddress",Fn.InetAddress)}};c(Tg,"InetAddressSerializer");var og=Tg,_g=class _g extends Or{constructor(){super("gx:LocalDate",Fn.LocalDate)}};c(_g,"LocalDateSerializer");var ag=_g,bg=class bg extends Or{constructor(){super("gx:LocalTime",Fn.LocalTime)}};c(bg,"LocalTimeSerializer");var cg=bg,Ig=class Ig extends Or{constructor(){super("gx:Instant",Date)}serialize(e){return{[Cs]:this.key,[Rr]:e.toISOString()}}deserialize(e){return new Date(e[Rr])}};c(Ig,"InstantSerializer");var ug=Ig,Ag=class Ag extends Or{constructor(){super("dse:Blob",Buffer)}deserialize(e){return BU.allocBufferFromString(e[Rr],"base64")}serialize(e){return{[Cs]:this.key,[Rr]:e.toString("base64")}}};c(Ag,"BlobSerializer");var lg=Ag,Ng=class Ng extends Or{constructor(){super("dse:Point",DU)}};c(Ng,"PointSerializer");var fg=Ng,Bg=class Bg extends Or{constructor(){super("dse:LineString",PU)}};c(Bg,"LineStringSerializer");var hg=Bg,Rg=class Rg extends Or{constructor(){super("dse:Polygon",LU)}};c(Rg,"PolygonSerializer");var dg=Rg,Og=class Og{constructor(){this.key="dse:Tuple"}deserialize(e){let r=e[Rr].value;if(!Array.isArray(r))throw new Error("Expected Array, obtained: "+r);let n=[];for(let i of r)n.push(this.reader.read(i));return J_.fromArray(n)}serialize(e){let r={cqlType:"tuple",definition:e.elements.map(RU),value:e.elements.map(n=>this.writer.adaptObject(n))};return{[Cs]:this.key,[Rr]:r}}canBeUsedFor(e){return e instanceof J_}};c(Og,"TupleSerializer");var pg=Og,Dg=class Dg{constructor(){this.key="dse:Duration"}deserialize(e){let r=e[Rr];return new Fn.Duration(this.reader.read(r.months),this.reader.read(r.days),this.reader.read(r.nanos))}serialize(e){return{[Cs]:this.key,[Rr]:{months:e.months,days:e.days,nanos:e.nanoseconds}}}canBeUsedFor(e){return e instanceof Fn.Duration}};c(Dg,"DurationSerializer");var gg=Dg,Lg=class Lg{constructor(){this.key="dse:UDT"}deserialize(e){let r=e[Rr],n={},i=r.value;return r.definition.forEach((s,o)=>{n[s.fieldName]=this.reader.read(i[o])}),n}serialize(e){let r=OU(e);return r.value=Object.entries(e.value).map(([n,i])=>this.writer.adaptObject(i)),{[Cs]:this.key,[Rr]:r}}canBeUsedFor(e){return e instanceof qU}};c(Lg,"UdtSerializer");var yg=Lg,Pg=class Pg{constructor(e,r){this._name=e,this._transformFn=r||(n=>n)}serialize(e){return{[Cs]:this._name,[Rr]:this._transformFn(e)}}};c(Pg,"InternalSerializer");var Ss=Pg,UU={[sc.int]:new Ss("g:Int32"),[sc.bigint]:new Ss("g:Int64"),[sc.double]:new Ss("g:Double"),[sc.float]:new Ss("g:Float"),[sc.timestamp]:new Ss("g:Timestamp",t=>t.getTime())},kg=class kg{constructor(){this.key="client:wrapper"}serialize(e){let r=UU[e.typeInfo.code];if(!r)throw new Error(`No serializer found for wrapped value ${e}`);return r.serialize(e.value)}canBeUsedFor(e){return e instanceof FU}};c(kg,"GraphTypeWrapperSerializer");var mg=kg,VU=[tg,rg,ng,ig,sg,og,ag,cg,ug,lg,fg,hg,dg,pg,yg,mg,gg];function MU(){let t={};return VU.forEach(e=>{let r=new e;if(!r.key)throw new TypeError(`Key for ${e} instance not set`);t[r.key]=r}),t}c(MU,"getCustomSerializers");eb.exports=MU});var Vg=_((tZ,tb)=>{"use strict";var KU=Q0(),HU=Fg(),{asInt:$U,asDouble:GU,asFloat:jU,asTimestamp:zU,asUdt:WU,UdtGraphWrapper:QU,GraphTypeWrapper:YU}=fl(),{Edge:ZU,Element:XU,Path:JU,Property:e8,Vertex:t8,VertexProperty:r8}=eg(),Ug=class Ug{constructor(e,r){this.typeName=e,this.elementName=r}toString(){return this.elementName}};c(Ug,"EnumValue");var oi=Ug,n8={id:new oi("T","id"),key:new oi("T","key"),label:new oi("T","label"),value:new oi("T","value")},qg={both:new oi("Direction","BOTH"),in:new oi("Direction","IN"),out:new oi("Direction","OUT")};qg.in_=qg.in;tb.exports={Edge:ZU,Element:XU,Path:JU,Property:e8,Vertex:t8,VertexProperty:r8,asInt:$U,asDouble:GU,asFloat:jU,asTimestamp:zU,asUdt:WU,direction:qg,getCustomTypeSerializers:HU,GraphResultSet:KU,GraphTypeWrapper:YU,t:n8,UdtGraphWrapper:QU}});var nb=_((nZ,rb)=>{"use strict";var wn={P:Ri,TextP:Ri,Traversal:Ri,Traverser:Ri,EnumValue:Ri},i8={TraversalStrategy:Ri},s8=Ri,tn=Vg(),o8={Long:Ri};wn.t=tn.t;wn.direction=tn.direction;function Ri(){}c(Ri,"UnsupportedType");var He="@value",er="@type",uy=class uy{serialize(){throw new Error("serialize() method not implemented for "+this.constructor.name)}deserialize(){throw new Error("deserialize() method not implemented for "+this.constructor.name)}canBeUsedFor(){throw new Error("canBeUsedFor() method not implemented for "+this.constructor.name)}};c(uy,"TypeSerializer");var gt=uy,ly=class ly extends gt{serialize(e){return isNaN(e)?{[er]:"g:Double",[He]:"NaN"}:e===Number.POSITIVE_INFINITY?{[er]:"g:Double",[He]:"Infinity"}:e===Number.NEGATIVE_INFINITY?{[er]:"g:Double",[He]:"-Infinity"}:e}deserialize(e){var r=e[He];return r==="NaN"?NaN:r==="Infinity"?Number.POSITIVE_INFINITY:r==="-Infinity"?Number.NEGATIVE_INFINITY:parseFloat(r)}canBeUsedFor(e){return typeof e=="number"}};c(ly,"NumberSerializer");var Mg=ly,fy=class fy extends gt{serialize(e){return{[er]:"g:Date",[He]:e.getTime()}}deserialize(e){return new Date(e[He])}canBeUsedFor(e){return e instanceof Date}};c(fy,"DateSerializer");var Kg=fy,hy=class hy extends gt{serialize(e){return{[er]:"g:Int64",[He]:e.value}}canBeUsedFor(e){return e instanceof o8.Long}};c(hy,"LongSerializer");var Hg=hy,dy=class dy extends gt{serialize(e){let r=e;e instanceof wn.Traversal&&(r=e.getBytecode());let n={};n[er]="g:Bytecode";let i=n[He]={},s=this._serializeInstructions(r.sourceInstructions);s&&(i.source=s);let o=this._serializeInstructions(r.stepInstructions);return o&&(i.step=o),n}_serializeInstructions(e){if(e.length===0)return null;let r=new Array(e.length);r[0]=e[0];for(let n=0;n<e.length;n++)r[n]=e[n].map(i=>this.writer.adaptObject(i));return r}canBeUsedFor(e){return e instanceof s8||e instanceof wn.Traversal}};c(dy,"BytecodeSerializer");var $g=dy,py=class py extends gt{serialize(e){let r={};r[er]="g:P";let n=r[He]={predicate:e.operator};return e.other===void 0||e.other===null?n.value=this.writer.adaptObject(e.value):n.value=[this.writer.adaptObject(e.value),this.writer.adaptObject(e.other)],r}canBeUsedFor(e){return e instanceof wn.P}};c(py,"PSerializer");var Gg=py,gy=class gy extends gt{serialize(e){let r={};r[er]="g:TextP";let n=r[He]={predicate:e.operator};return e.other===void 0||e.other===null?n.value=this.writer.adaptObject(e.value):n.value=[this.writer.adaptObject(e.value),this.writer.adaptObject(e.other)],r}canBeUsedFor(e){return e instanceof wn.TextP}};c(gy,"TextPSerializer");var jg=gy,yy=class yy extends gt{serialize(e){return{[er]:"g:Lambda",[He]:{arguments:e.length,language:"gremlin-javascript",script:e.toString()}}}canBeUsedFor(e){return typeof e=="function"}};c(yy,"LambdaSerializer");var zg=yy,my=class my extends gt{serialize(e){return{[er]:"g:"+e.typeName,[He]:e.elementName}}canBeUsedFor(e){return e&&e.typeName&&e instanceof wn.EnumValue}};c(my,"EnumSerializer");var Wg=my,vy=class vy extends gt{serialize(e){return{[er]:"g:Traverser",[He]:{value:this.writer.adaptObject(e.object),bulk:this.writer.adaptObject(e.bulk)}}}deserialize(e){let r=e[He];return new wn.Traverser(this.reader.read(r.value),this.reader.read(r.bulk))}canBeUsedFor(e){return e instanceof wn.Traverser}};c(vy,"TraverserSerializer");var Qg=vy,Ey=class Ey extends gt{serialize(e){return{[er]:"g:"+e.constructor.name,[He]:e.configuration}}canBeUsedFor(e){return e instanceof i8.TraversalStrategy}};c(Ey,"TraversalStrategySerializer");var Yg=Ey,Sy=class Sy extends gt{deserialize(e){let r=e[He];return new tn.Vertex(this.reader.read(r.id),r.label,this.reader.read(r.properties))}serialize(e){return{[er]:"g:Vertex",[He]:{id:this.writer.adaptObject(e.id),label:e.label}}}canBeUsedFor(e){return e instanceof tn.Vertex}};c(Sy,"VertexSerializer");var Zg=Sy,Cy=class Cy extends gt{deserialize(e){let r=e[He];return new tn.VertexProperty(this.reader.read(r.id),r.label,this.reader.read(r.value),this.reader.read(r.properties))}};c(Cy,"VertexPropertySerializer");var Xg=Cy,wy=class wy extends gt{deserialize(e){let r=e[He];return new tn.Property(r.key,this.reader.read(r.value))}};c(wy,"PropertySerializer");var Jg=wy,xy=class xy extends gt{deserialize(e){let r=e[He];return new tn.Edge(this.reader.read(r.id),new tn.Vertex(this.reader.read(r.outV),this.reader.read(r.outVLabel)),r.label,new tn.Vertex(this.reader.read(r.inV),this.reader.read(r.inVLabel)),this.reader.read(r.properties))}serialize(e){return{[er]:"g:Edge",[He]:{id:this.writer.adaptObject(e.id),label:e.label,outV:this.writer.adaptObject(e.outV.id),outVLabel:e.outV.label,inV:this.writer.adaptObject(e.inV.id),inVLabel:e.inV.label}}}canBeUsedFor(e){return e instanceof tn.Edge}};c(xy,"EdgeSerializer");var ey=xy,Ty=class Ty extends gt{deserialize(e){let r=e[He],n=r.objects.map(i=>this.reader.read(i));return new tn.Path(this.reader.read(r.labels),n)}};c(Ty,"PathSerializer");var ty=Ty,_y=class _y extends gt{deserialize(e){let r=e[He];return new tn.Path(this.reader.read(r.labels),this.reader.read(r.objects))}};c(_y,"Path3Serializer");var ry=_y,by=class by extends gt{deserialize(e){return wn.t[e[He]]}};c(by,"TSerializer");var ny=by,Iy=class Iy extends gt{deserialize(e){return wn.direction[e[He].toLowerCase()]}};c(Iy,"DirectionSerializer");var iy=Iy,Ay=class Ay extends gt{constructor(e){super(),this.typeKey=e}deserialize(e){let r=e[He];if(!Array.isArray(r))throw new Error("Expected Array, obtained: "+r);return r.map(n=>this.reader.read(n))}serialize(e){return{[er]:this.typeKey,[He]:e.map(r=>this.writer.adaptObject(r))}}canBeUsedFor(e){return Array.isArray(e)}};c(Ay,"ArraySerializer");var pl=Ay,Ny=class Ny extends gt{deserialize(e){let r=e[He];if(!Array.isArray(r))throw new Error("Expected Array, obtained: "+r);let n=[];for(let i=0,s=r.length;i<s;i+=2){let o=r.slice(i,i+2);n=n.concat(Array(this.reader.read(o[1])).fill(this.reader.read(o[0])))}return n}};c(Ny,"BulkSetSerializer");var sy=Ny,By=class By extends gt{deserialize(e){let r=e[He];if(!Array.isArray(r))throw new Error("Expected Array, obtained: "+r);let n=new Map;for(let i=0;i<r.length;i+=2)n.set(this.reader.read(r[i]),this.reader.read(r[i+1]));return n}serialize(e){let r=[];return e.forEach((n,i)=>{r.push(this.writer.adaptObject(i)),r.push(this.writer.adaptObject(n))}),{[er]:"g:Map",[He]:r}}canBeUsedFor(e){return e instanceof Map}};c(By,"MapSerializer");var oy=By,Ry=class Ry extends pl{constructor(){super("g:List")}};c(Ry,"ListSerializer");var ay=Ry,Oy=class Oy extends pl{constructor(){super("g:Set")}};c(Oy,"SetSerializer");var cy=Oy;rb.exports={BulkSetSerializer:sy,BytecodeSerializer:$g,DateSerializer:Kg,DirectionSerializer:iy,EdgeSerializer:ey,EnumSerializer:Wg,LambdaSerializer:zg,ListSerializer:ay,LongSerializer:Hg,MapSerializer:oy,NumberSerializer:Mg,Path3Serializer:ry,PathSerializer:ty,PropertySerializer:Jg,PSerializer:Gg,TextPSerializer:jg,SetSerializer:cy,TSerializer:ny,TraverserSerializer:Qg,TraversalStrategySerializer:Yg,typeKey:er,valueKey:He,VertexPropertySerializer:Xg,VertexSerializer:Zg}});var ab=_((sZ,ob)=>{"use strict";var Ne=nb(),Dy=class Dy{constructor(e){this._options=e||{},this._serializers=this.getDefaultSerializers().map(n=>{let i=new n;return i.writer=this,i});let r=this._options.serializers||{};Object.keys(r).forEach(n=>{let i=r[n];i.serialize&&(i.writer=this,this._serializers.unshift(i))})}getDefaultSerializers(){return sb}adaptObject(e){let r;for(let n=0;n<this._serializers.length;n++){let i=this._serializers[n];if(i.canBeUsedFor&&i.canBeUsedFor(e)){r=i;break}}return r?r.serialize(e):Array.isArray(e)?e.map(n=>this.adaptObject(n)):e}write(e){return JSON.stringify(this.adaptObject(e))}};c(Dy,"GraphSON2Writer");var gl=Dy,Ly=class Ly extends gl{getDefaultSerializers(){return c8}};c(Ly,"GraphSON3Writer");var yl=Ly,Py=class Py{constructor(e){this._options=e||{},this._deserializers={};let r=this.getDefaultDeserializers();if(Object.keys(r).forEach(n=>{let i=r[n],s=new i;s.reader=this,this._deserializers[n]=s}),this._options.serializers){let n=this._options.serializers||{};Object.keys(n).forEach(i=>{let s=n[i];s.deserialize&&(s.reader=this,this._deserializers[i]=s)})}}getDefaultDeserializers(){return ib}read(e){if(e===void 0)return;if(e===null)return null;if(Array.isArray(e))return e.map(n=>this.read(n));let r=e[Ne.typeKey];if(r){let n=this._deserializers[r];return n?n.deserialize(e):e[Ne.valueKey]}return e&&typeof e=="object"&&e.constructor===Object?this._deserializeObject(e):e}_deserializeObject(e){let r=Object.keys(e),n={};for(let i=0;i<r.length;i++)n[r[i]]=this.read(e[r[i]]);return n}};c(Py,"GraphSON2Reader");var ml=Py,ky=class ky extends ml{getDefaultDeserializers(){return a8}};c(ky,"GraphSON3Reader");var vl=ky,ib={"g:Traverser":Ne.TraverserSerializer,"g:TraversalStrategy":Ne.TraversalStrategySerializer,"g:Int32":Ne.NumberSerializer,"g:Int64":Ne.NumberSerializer,"g:Float":Ne.NumberSerializer,"g:Double":Ne.NumberSerializer,"g:Date":Ne.DateSerializer,"g:Direction":Ne.DirectionSerializer,"g:Vertex":Ne.VertexSerializer,"g:Edge":Ne.EdgeSerializer,"g:VertexProperty":Ne.VertexPropertySerializer,"g:Property":Ne.PropertySerializer,"g:Path":Ne.Path3Serializer,"g:TextP":Ne.TextPSerializer,"g:T":Ne.TSerializer,"g:BulkSet":Ne.BulkSetSerializer},a8=Object.assign({},ib,{"g:List":Ne.ListSerializer,"g:Set":Ne.SetSerializer,"g:Map":Ne.MapSerializer}),sb=[Ne.NumberSerializer,Ne.DateSerializer,Ne.BytecodeSerializer,Ne.TraverserSerializer,Ne.TraversalStrategySerializer,Ne.PSerializer,Ne.TextPSerializer,Ne.LambdaSerializer,Ne.EnumSerializer,Ne.VertexSerializer,Ne.EdgeSerializer,Ne.LongSerializer],c8=sb.concat([Ne.ListSerializer,Ne.SetSerializer,Ne.MapSerializer]);ob.exports={GraphSON3Writer:yl,GraphSON3Reader:vl,GraphSON2Writer:gl,GraphSON2Reader:ml,GraphSONWriter:yl,GraphSONReader:vl}});var fb=_((aZ,lb)=>{"use strict";var u8=require("util"),ws=Ke(),tr=oe(),{DefaultExecutionOptions:l8,proxyExecuteKey:f8}=xi(),cb=ws.Long,Oi,h8=Object.freeze({graphson1:"graphson-1.0",graphson2:"graphson-2.0",graphson3:"graphson-3.0"}),ur=Object.freeze({language:"graph-language",source:"graph-source",name:"graph-name",results:"graph-results",writeConsistency:"graph-write-consistency",readConsistency:"graph-read-consistency",timeout:"request-timeout"});function d8(t,e,r,n){return t.getOrCreateGraphOptions(n,c(function(){let s=n.graphOptions||tr.emptyObject,o=t.getDefault(),a={customPayload:{[ur.language]:tr.allocBufferFromString(s.language||e.language),[ur.source]:tr.allocBufferFromString(s.source||e.source)},graphLanguage:s.language||e.language,graphResults:s.results||e.results,graphSource:s.source||e.source,graphName:tr.ifUndefined(s.name,e.name)};n!==o?a.retry=n.retry||e.retry:a.retry=r||e.retry,e.executeAs&&(a.customPayload[f8]=tr.allocBufferFromString(e.executeAs)),a.graphName&&(a.customPayload[ur.name]=tr.allocBufferFromString(a.graphName));let u=tr.ifUndefined(s.results,e.graphResults);u!==void 0&&(a.customPayload[ur.results]=tr.allocBufferFromString(u));let l=tr.ifUndefined(s.readConsistency,e.readConsistency);l!==void 0&&(a.customPayload[ur.readConsistency]=tr.allocBufferFromString(El(l)));let f=tr.ifUndefined(s.writeConsistency,e.writeConsistency);return f!==void 0&&(a.customPayload[ur.writeConsistency]=tr.allocBufferFromString(El(f))),a.readTimeout=tr.ifUndefined3(n.readTimeout,o.readTimeout,e.readTimeout),a.readTimeout>0&&(a.customPayload[ur.timeout]=ub(a.readTimeout)),a},"createDefaultOptions"))}c(d8,"getDefaultGraphOptions");function wo(t,e,r,n,i){if(i=i||tr.allocBufferFromString,n!==null){if(n!==void 0){t[r]=i(n);return}e.customPayload[r]&&(t[r]=e.customPayload[r])}}c(wo,"setPayloadKey");function ub(t){return t=cb.fromNumber(t),cb.toBuffer(t)}c(ub,"longBuffer");function El(t){if(t==null)return;p8();let e=Oi[t];if(!e)throw new Error(u8.format("Consistency %s not found, use values defined as properties in types.consistencies object",t));return e}c(El,"getConsistencyName");function p8(){if(Oi)return;Oi={};let t=Object.keys(ws.consistencies);for(let e=0;e<t.length;e++){let r=t[e];Oi[ws.consistencies[r]]=r.toUpperCase()}Oi[ws.consistencies.localQuorum]="LOCAL_QUORUM",Oi[ws.consistencies.eachQuorum]="EACH_QUORUM",Oi[ws.consistencies.localSerial]="LOCAL_SERIAL",Oi[ws.consistencies.localOne]="LOCAL_ONE"}c(p8,"loadConsistencyNames");var qy=class qy extends l8{constructor(e,r,n,i){e=e||tr.emptyObject,super(e,r,null),this._defaultGraphOptions=d8(r.profileManager,n,i,this.getProfile()),this._preferredHost=null,this._graphSubProtocol=e.graphResults||this._defaultGraphOptions.graphResults,this._graphLanguage=e.graphLanguage||this._defaultGraphOptions.graphLanguage}setPreferredHost(e){this._preferredHost=e}getPreferredHost(){return this._preferredHost}getGraphSource(){return this.getRawQueryOptions().graphSource||this._defaultGraphOptions.graphSource}getGraphLanguage(){return this._graphLanguage}setGraphLanguage(e){this._graphLanguage=e}getGraphName(){return tr.ifUndefined(this.getRawQueryOptions().graphName,this._defaultGraphOptions.graphName)}getGraphSubProtocol(){return this._graphSubProtocol}setGraphSubProtocol(e){this._graphSubProtocol=e}getReadTimeout(){return this.getRawQueryOptions().readTimeout||this._defaultGraphOptions.readTimeout}getRetryPolicy(){return this.getRawQueryOptions().retry||this._defaultGraphOptions.retry}getRowParser(){let e=this.getRawQueryOptions().rowParserFactory;return e?e(this.getGraphSubProtocol()):null}getQueryWriter(){let e=this.getRawQueryOptions().queryWriterFactory;return e?e(this.getGraphSubProtocol()):null}setGraphPayload(){let e=this.getRawQueryOptions(),r=this._defaultGraphOptions,n=Object.assign({},this.getCustomPayload());wo(n,r,ur.language,this.getGraphLanguage()!==this._defaultGraphOptions.graphLanguage?this.getGraphLanguage():void 0),wo(n,r,ur.source,e.graphSource),wo(n,r,ur.name,e.graphName),wo(n,r,ur.readConsistency,El(e.graphReadConsistency)),wo(n,r,ur.writeConsistency,El(e.graphWriteConsistency)),wo(n,r,ur.timeout,this.getReadTimeout()>0?this.getReadTimeout():null,ub),n[ur.results]=r.graphResults===this.getGraphSubProtocol()?r.customPayload[ur.results]:tr.allocBufferFromString(this.getGraphSubProtocol()),this.setCustomPayload(n)}};c(qy,"GraphExecutionOptions");var Fy=qy;lb.exports={GraphExecutionOptions:Fy,graphProtocol:h8,payloadKeys:ur}});var mb=_((uZ,yb)=>{"use strict";var hb=oe(),g8=yu(),y8=Q0(),{GraphSON2Reader:m8,GraphSON2Writer:v8,GraphSON3Reader:E8,GraphSON3Writer:S8}=ab(),Sl=Fg(),{GraphExecutionOptions:C8,graphProtocol:qn}=fb(),db="gremlin-groovy",w8="Core",x8=new m8({serializers:Sl()}),T8=new v8({serializers:Sl()}),_8=new E8({serializers:Sl()}),b8=new S8({serializers:Sl()}),I8=new Map([[qn.graphson2,pb(x8)],[qn.graphson3,pb(_8)]]),A8=new Map([[qn.graphson1,t=>JSON.stringify(t)],[qn.graphson2,gb(T8)],[qn.graphson3,gb(b8)]]),xs=class xs{constructor(e,r,n){this._client=e,this._handler=n,this._defaultProfileRetryPolicy=e.profileManager.getDefaultConfiguredRetryPolicy(),this._graphBaseOptions=hb.extend({executeAs:e.options.queryOptions.executeAs,language:db,source:"g",readTimeout:0,retry:new g8.retry.FallthroughRetryPolicy},r.graphOptions,e.profileManager.getDefault().graphOptions),this._graphBaseOptions.readTimeout===null&&(this._graphBaseOptions.readTimeout=e.options.socketOptions.readTimeout)}async send(e,r,n){if(Array.isArray(r))throw new TypeError("Parameters must be a Object instance as an associative array");if(!e)throw new TypeError("Query must be defined");let i=new C8(n,this._client,this._graphBaseOptions,this._defaultProfileRetryPolicy);if(i.getGraphSource()==="a"){let o=await this._getAnalyticsMaster();i.setPreferredHost(o)}let s=typeof e=="object"&&e.graphLanguage&&e.value&&e.queryWriterFactory;if(s&&i.setGraphLanguage(e.graphLanguage),this._setGraphProtocol(i),i.setGraphPayload(),r=xs._buildGraphParameters(r,i.getGraphSubProtocol()),typeof e!="string"){let o=i.getQueryWriter();s?o=e.queryWriterFactory(i.getGraphSubProtocol()):o||(o=xs._writerFactory(i.getGraphSubProtocol())),e=o(s?e.value:e)}return await this._executeGraphQuery(e,r,i)}async _executeGraphQuery(e,r,n){let i=await this._handler.call(this._client,e,r,n),s=n.getRowParser()||xs._rowParserFactory(n.getGraphSubProtocol());return new y8(i,s)}async _getAnalyticsMaster(){try{let e=await this._client.execute("CALL DseClientTool.getAnalyticsGraphServer()",hb.emptyArray);if(e.rows.length===0)return this._client.log("verbose","Empty response querying graph analytics server, query will not be routed optimally"),null;let r=e.rows[0].result;if(!r||!r.location)return this._client.log("verbose","Unexpected response querying graph analytics server, query will not be routed optimally",e.rows[0]),null;let n=r.location.substr(0,r.location.lastIndexOf(":")),i=this._client.options.policies.addressResolution;return await new Promise(s=>{i.translate(n,this._client.options.protocolOptions.port,o=>s(this._client.hosts.get(o)))})}catch(e){return this._client.log("verbose","Error querying graph analytics server, query will not be routed optimally",e),null}}_setGraphProtocol(e){let r=e.getGraphSubProtocol();if(!r){if(e.getGraphName()){let n=this._client.metadata.keyspaces[e.getGraphName()];n&&n.graphEngine===w8&&(r=qn.graphson3)}r||(e.getGraphLanguage()===db?r=qn.graphson1:r=qn.graphson2),e.setGraphSubProtocol(r)}}static _buildGraphParameters(e,r){if(!e||typeof e!="object")return null;let n=xs._writerFactory(r);return[r!==qn.graphson1&&r!==qn.graphson2?n(new Map(Object.entries(e))):n(e)]}static _rowParserFactory(e){let r=I8.get(e);return r||null}static _writerFactory(e){let r=A8.get(e);if(!r)throw new Error(`No writer defined for protocol ${e}`);return r}};c(xs,"GraphExecutor");var Uy=xs;function pb(t){return e=>{let r=t.read(JSON.parse(e.gremlin));return{object:r.result,bulk:r.bulk||1}}}c(pb,"getRowParser");function gb(t){return e=>t.write(e)}c(gb,"getDefaultWriter");yb.exports=Uy});var wb=_((fZ,Cb)=>{"use strict";var vb=require("events"),Vy=require("util"),_s=oe(),Ts=ze(),bs=Ke(),{ProfileManager:N8}=kd(),Cl=Ti(),Eb=ma(),B8=nx(),R8=oo().description,{version:O8}=oo(),{DefaultExecutionOptions:My}=xi(),D8=$T(),Ky=YT(),Sb=zp(),L8=s_(),P8=V_(),k8=mb(),xn=fr(),F8=32;function st(t){vb.EventEmitter.call(this),this.options=Eb.extend({logEmitter:this.emit.bind(this),id:bs.Uuid.random()},t),Object.defineProperty(this,"profileManager",{value:new N8(this.options)}),Object.defineProperty(this,"controlConnection",{value:new D8(this.options,this.profileManager),writable:!0}),Object.defineProperty(this,"insightsClient",{value:new L8(this)}),this.setMaxListeners(0),this.connected=!1,this.isShuttingDown=!1,this.keyspace=t.keyspace,this.metadata=this.controlConnection.metadata,this.hosts=this.controlConnection.hosts,this.metrics=this.options.metrics,this._graphExecutor=new k8(this,t,this._execute)}c(st,"Client");Vy.inherits(st,vb.EventEmitter);st.prototype.connect=function(t){return this.connected&&t?t():xn.optionalCallback(this._connect(),t)};st.prototype._connect=async function(){if(!this.connected){if(this.isShuttingDown)throw new Ts.NoHostAvailableError(null,"Connecting after shutdown is not supported");if(this.connecting)return xn.fromEvent(this,"connected");this.connecting=!0,this.log("info",Vy.format("Connecting to cluster using '%s' version %s",R8,O8));try{await P8.init(this.options),await this.controlConnection.init(),this.hosts=this.controlConnection.hosts,await this.profileManager.init(this,this.hosts),this.keyspace&&await Ky.setKeyspace(this),Eb.setMetadataDependent(this),await this._warmup()}catch(t){throw await this.controlConnection.reset(),this.connected=!1,this.connecting=!1,this.emit("connected",t),t}this._setHostListeners(),this.profileManager.getDistance(this.controlConnection.host),this.insightsClient.init(),this.connected=!0,this.connecting=!1,this.emit("connected")}};st.prototype.execute=function(t,e,r,n){n||(typeof r=="function"?(n=r,r=null):typeof e=="function"&&(n=e,e=null));try{let i=My.create(r,this);return xn.optionalCallback(this._execute(t,e,i),n)}catch(i){return n?n(i):Promise.reject(i)}};st.prototype.executeGraph=function(t,e,r,n){return n=n||r||e,typeof n=="function"?(e=typeof e!="function"?e:null,xn.toCallback(this._graphExecutor.send(t,e,r),n)):this._graphExecutor.send(t,e,r)};st.prototype.eachRow=function(t,e,r,n,i){!i&&n&&typeof r=="function"?(i=_s.validateFn(n,"rowCallback"),n=r):(i=i||_s.noop,n=_s.validateFn(n||r||e,"rowCallback")),e=typeof e!="function"?e:null;let s;try{s=My.create(r,this,n)}catch(l){return i(l)}let o=0,a=c(()=>xn.toCallback(this._execute(t,e,s),u),"nextPage");function u(l,f){if(l)return i(l);if(o+=f.rowLength,f.rawPageState!==void 0){if(s.setPageState(f.rawPageState),s.isAutoPage())return a();f.nextPage=a}f.rowLength=o,i(null,f)}c(u,"pageCallback"),xn.toCallback(this._execute(t,e,s),u)};st.prototype.stream=function(t,e,r,n){n=n||_s.noop;let i=new bs.ResultStream({objectMode:1});function s(a,u){if(a&&i.emit("error",a),u&&u.nextPage){i._valve(c(function(){try{u.nextPage()}catch(f){i.emit("error",f)}},"pageValve"));return}i._valve(null),i.add(null),n(a)}c(s,"onFinish");let o=!0;return this.eachRow(t,e,r,c(function(u,l){i.add(l)},"rowCallback"),c(function(u,l){if(o)return setImmediate(c(function(){s(u,l)},"eachRowFinishedImmediate"));s(u,l)},"eachRowFinished")),o=!1,i};st.prototype.batch=function(t,e,r){return!r&&typeof e=="function"&&(r=e,e=null),xn.optionalCallback(this._batch(t,e),r)};st.prototype._batch=async function(t,e){if(!Array.isArray(t))throw new Ts.ArgumentError("Queries should be an Array");if(t.length===0)throw new Ts.ArgumentError("Queries array should not be empty");await this._connect();let r=My.create(e,this),n;if(r.isPrepared()){let s=this.controlConnection.protocolVersion,o=bs.protocolVersion.supportsKeyspaceInRequest(s)&&e.keyspace||this.keyspace;n=await Sb.getPreparedMultiple(this,r.getLoadBalancingPolicy(),t,o)}else{n=new Array(t.length);for(let s=0;s<t.length;s++){let o=t[s];if(!o)throw new Ts.ArgumentError(`Invalid query at index ${s}`);let a=typeof o=="string"?o:o.query;if(!a)throw new Ts.ArgumentError(`Invalid query at index ${s}`);n[s]={query:a,params:o.params}}}let i=await this._createBatchRequest(n,r);return await Ky.send(i,r,this)};st.prototype.getReplicas=function(t,e){return this.metadata.getReplicas(t,e)};st.prototype.getState=function(){return B8.from(this)};st.prototype.log=_s.log;st.prototype.shutdown=function(t){return xn.optionalCallback(this._shutdown(),t)};st.prototype._shutdown=async function(){if(this.log("info","Shutting down"),!this.hosts||!this.connected){this.connected=!1;return}this.connecting&&(this.log("warning","Shutting down while connecting"),await xn.fromEvent(this,"connected")),this.connected=!1,this.isShuttingDown=!0;let t=this.hosts.values();this.insightsClient.shutdown(),this.controlConnection.shutdown(),this.options.policies.speculativeExecution.shutdown(),this.options.requestTracker&&this.options.requestTracker.shutdown(),await Promise.all(t.map(e=>e.shutdown(!1)))};st.prototype._waitForSchemaAgreement=async function(t){if(this.hosts.length===1)return!0;let e=process.hrtime(),r=this.options.protocolOptions.maxSchemaAgreementWaitSeconds;this.log("info","Waiting for schema agreement");let n;for(;!n&&process.hrtime(e)[0]<r;){if(n=await this.metadata.compareSchemaVersions(t),n){this.log("info","Schema versions match");break}await xn.delay(500)}return n};st.prototype.handleSchemaAgreementAndRefresh=async function(t,e){let r=!1;try{r=await this._waitForSchemaAgreement(t)}catch(n){this.log("warning","There was an error while waiting for the schema agreement between nodes",n)}if(!this.options.isMetadataSyncEnabled)return r;try{await this.controlConnection.handleSchemaChange(e,!0)}catch(n){this.log("warning","There was an error while handling schema change",n)}return r};st.prototype._execute=async function(t,e,r){let n=this.controlConnection.protocolVersion;if(!r.isPrepared()&&e&&!Array.isArray(e)&&!bs.protocolVersion.supportsNamedParameters(n))throw new Ts.ArgumentError("Named parameters for simple statements are not supported, use prepare flag");let i;if(this.connected||await this._connect(),!r.isPrepared())i=await this._createQueryRequest(t,r,e);else{let s=r.getLoadBalancingPolicy(),o=bs.protocolVersion.supportsKeyspaceInRequest(n)&&r.getKeyspace()||this.keyspace,{queryId:a,meta:u}=await Sb.getPrepared(this,s,t,o);i=await this._createExecuteRequest(t,a,r,e,u)}return await Ky.send(i,r,this)};st.prototype._setHostListeners=function(){function t(n,i){return()=>n.emit("hostUp",i)}c(t,"getHostUpListener");function e(n,i){return()=>n.emit("hostDown",i)}c(e,"getHostDownListener");let r=this;this.hosts.on("add",c(function(i){i.on("up",t(r,i)),i.on("down",e(r,i)),r.emit("hostAdd",i)},"hostAddedListener")),this.hosts.on("remove",c(function(i){i.removeAllListeners(),r.emit("hostRemove",i)},"hostRemovedListener")),this.hosts.forEach(function(n){n.on("up",t(r,n)),n.on("down",e(r,n))})};st.prototype._warmup=function(){let t=this.hosts.values();return xn.times(t.length,F8,async e=>{let r=t[e],n=this.profileManager.getDistance(r);if(n!==bs.distance.ignored)if(this.options.pooling.warmup&&n===bs.distance.local)try{await r.warmupPool(this.keyspace)}catch(i){this.log("warning",`Connection pool to host ${r.address} could not be created: ${i}`,i)}else r.initializePool()})};st.prototype._getEncoder=function(){let t=this.controlConnection.getEncoder();if(!t)throw new Ts.DriverInternalError("Encoder is not defined");return t};st.prototype._createBatchRequest=async function(t,e){let r=t[0];return r.meta?(await this._setRoutingInfo(e,r.params,r.meta),new Cl.BatchRequest(t,e)):new Cl.BatchRequest(t,e)};st.prototype._createExecuteRequest=async function(t,e,r,n,i){return n=_s.adaptNamedParamsPrepared(n,i.columns),await this._setRoutingInfo(r,n,i),new Cl.ExecuteRequest(t,e,n,r,i)};st.prototype._createQueryRequest=async function(t,e,r){await this.metadata.adaptUserHints(this.keyspace,e.getHints());let n=_s.adaptNamedParamsWithHints(r,e);return this._getEncoder().setRoutingKeyFromUser(n.params,e,n.keyIndexes),new Cl.QueryRequest(t,n.params,e,n.namedParameters)};st.prototype._setRoutingInfo=async function(t,e,r){let n=this._getEncoder();if(!t.getKeyspace()&&r.keyspace&&t.setKeyspace(r.keyspace),t.getRoutingKey())return n.setRoutingKeyFromUser(e,t);if(Array.isArray(r.partitionKeys))return t.setRoutingIndexes(r.partitionKeys),n.setRoutingKeyFromMeta(r,e,t);try{let i=await this.metadata.getTable(r.keyspace,r.table);if(!i)return;t.setRoutingIndexes(i.partitionKeys.map(s=>r.columnsByName[s.name])),r.partitionKeys=t.getRoutingIndexes(),n.setRoutingKeyFromMeta(r,e,t)}catch{this.log("warning",Vy.format("Table %s.%s metadata could not be retrieved",r.keyspace,r.table))}};Cb.exports=st});var jy=_((dZ,xb)=>{"use strict";var q8=require("events"),$y=class $y extends q8{constructor(e,r,n){super(),this.key=e,this.value=r,this.edges=n||[]}};c($y,"Node");var oc=$y,Gy=class Gy extends oc{constructor(){super([],null),this.length=0}getOrCreate(e,r){typeof e.next!="function"&&(e=e[Symbol.iterator]());let n=this,i=!1,s=e.next();for(;;){let o;for(let l=1;l<n.key.length;l++){if(s.done||n.key[l]!==s.value){o=this._createBranch(n,l,s.done,r);break}s=e.next()}if(s.done){i=!0;break}if(o!==void 0)break;let a=n.edges,u;for(let l=0;l<a.length;l++){let f=a[l];if(f.key[0]===s.value){u=f,s=e.next();break}}if(u===void 0)break;n=u}if(!i){let o=r();return n.edges.push(new oc(U8(s.value,e),o)),this._onItemAdded(),o}return n.value===null&&n.edges.length>0&&(n.value=r()),n.value}_createBranch(e,r,n,i){let s=new oc(e.key.slice(r),e.value,e.edges);return e.key=e.key.slice(0,r),e.edges=[s],n?(e.value=i(),this._onItemAdded()):e.value=null,s}_onItemAdded(){this.length++,this.emit("add",this.length)}};c(Gy,"Tree");var Hy=Gy;function U8(t,e){let r=[t],n=e.next();for(;!n.done;)r.push(n.value),n=e.next();return r}c(U8,"iteratorToArray");xb.exports=Hy});var xl=_(wl=>{"use strict";var V8=ze(),zy=class zy{constructor(e,r,n,i){this.key=e,this.value=r,this.hasChildValues=n,this.isInOperator=i}};c(zy,"QueryOperator");var Un=zy,Wy=class Wy{constructor(e,r,n){this.sign=e,this.value=r,this.inverted=!!n}};c(Wy,"QueryAssignment");var Di=Wy,M8={in_:c(function(e){if(!Array.isArray(e))throw new V8.ArgumentError("IN operator supports only Array values");return new Un("IN",e,!1,!0)},"in_"),gt:c(function(e){return new Un(">",e)},"gt"),gte:c(function(e){return new Un(">=",e)},"gte"),lt:c(function(e){return new Un("<",e)},"lt"),lte:c(function(e){return new Un("<=",e)},"lte"),notEq:c(function(e){return new Un("!=",e)},"notEq"),and:function(t,e){return new Un("AND",[t,e],!0)},incr:c(function(e){return new Di("+",e)},"incr"),decr:c(function(e){return new Di("-",e)},"decr"),append:c(function(e){return new Di("+",e)},"append"),prepend:c(function(e){return new Di("+",e,!0)},"prepend"),remove:c(function(e){return new Di("-",e)},"remove")};wl.q=M8;wl.QueryAssignment=Di;wl.QueryOperator=Un});var Yy=_((mZ,bb)=>{"use strict";var _b=xl(),Tb=_b.QueryOperator,K8=_b.QueryAssignment,Dr=class Dr{static*getSelectKey(e,r,n){yield*Dr._yieldKeyAndOperators(e,r),yield*Dr._getSelectDocInfo(n)}static*getSelectAllKey(e){yield"root",yield*Dr._getSelectDocInfo(e)}static*_getSelectDocInfo(e){if(e&&(e.fields&&e.fields.length>0&&(yield"|f|",yield*e.fields),typeof e.limit=="number"&&(yield"|l|"),e.orderBy)){yield"|o|";let r=Object.keys(e.orderBy);for(let n=0;n<r.length;n++){let i=r[n];yield i,yield e.orderBy[i]}}}static*getInsertKey(e,r){yield*e,r&&(r.fields&&r.fields.length>0&&(yield"|f|",yield*r.fields),typeof r.ttl=="number"&&(yield"|t|"),r.ifNotExists&&(yield"|e|"))}static*getUpdateKey(e,r,n){yield*Dr._yieldKeyAndAllQs(e,r),n&&(n.fields&&n.fields.length>0&&(yield"|f|",yield*n.fields),typeof n.ttl=="number"&&(yield"|t|"),n.ifExists&&(yield"|e|"),n.when&&(yield*Dr._yieldKeyAndOperators(Object.keys(n.when),n.when)))}static*getRemoveKey(e,r,n){yield*Dr._yieldKeyAndOperators(e,r),n&&(n.fields&&n.fields.length>0&&(yield"|f|",yield*n.fields),n.ifExists&&(yield"|e|"),n.deleteOnlyColumns&&(yield"|dc|"),n.when&&(yield*Dr._yieldKeyAndOperators(Object.keys(n.when),n.when)))}static*_yieldKeyAndOperators(e,r){for(let n=0;n<e.length;n++){let i=e[n];yield i,yield*Dr._yieldOperators(r[i])}}static*_yieldOperators(e){e!=null&&e instanceof Tb&&(yield e.key,e.hasChildValues&&(yield*Dr._yieldOperators(e.value[0]),yield"|/|",yield*Dr._yieldOperators(e.value[1])))}static*_yieldKeyAndAllQs(e,r){for(let n=0;n<e.length;n++){let i=e[n];yield i;let s=r[i];s!=null&&(s instanceof Tb?yield*Dr._yieldOperators(s):s instanceof K8&&(yield s.sign,yield s.inverted))}}};c(Dr,"Cache");var Qy=Dr;bb.exports=Qy});var Tl=_((EZ,Ib)=>{"use strict";var em=Yy(),tm=class tm{constructor(e,r,n,i){this.doc=e,this.docInfo=r,this.handler=n,this.cache=i}getQueries(){let e=Object.keys(this.doc),r=this.cache.getOrCreate(this.getCacheKey(e),()=>({queries:null}));return r.queries===null&&(r.queries=this.createQueries(e)),r.queries}getCacheKey(e){throw new Error("getCacheKey must be implemented")}createQueries(e){throw new Error("getCacheKey must be implemented")}pushQueries(e){let r=!0,n;return this.getQueries().then(i=>(i.forEach(s=>{r=r&&s.isIdempotent,n=s.isCounter,e.push({query:s.query,params:s.paramsGetter(this.doc,this.docInfo,this.getMappingInfo())})}),{isIdempotent:r,isCounter:n}))}getMappingInfo(){return this.handler.info}};c(tm,"ModelBatchItem");var xo=tm,rm=class rm extends xo{constructor(e,r,n,i){super(e,r,n,i)}getCacheKey(e){return em.getInsertKey(e,this.docInfo)}createQueries(e){return this.handler.createInsertQueries(e,this.doc,this.docInfo)}};c(rm,"InsertModelBatchItem");var Zy=rm,nm=class nm extends xo{constructor(e,r,n,i){super(e,r,n,i)}getCacheKey(e){return em.getUpdateKey(e,this.doc,this.docInfo)}createQueries(e){return this.handler.createUpdateQueries(e,this.doc,this.docInfo)}};c(nm,"UpdateModelBatchItem");var Xy=nm,im=class im extends xo{constructor(e,r,n,i){super(e,r,n,i)}getCacheKey(e){return em.getRemoveKey(e,this.doc,this.docInfo)}createQueries(e){return this.handler.createDeleteQueries(e,this.doc,this.docInfo)}};c(im,"RemoveModelBatchItem");var Jy=im;Ib.exports={ModelBatchItem:xo,InsertModelBatchItem:Zy,UpdateModelBatchItem:Xy,RemoveModelBatchItem:Jy}});var um=_((CZ,Ab)=>{"use strict";var sm=jy(),am=Tl(),H8=am.InsertModelBatchItem,$8=am.UpdateModelBatchItem,G8=am.RemoveModelBatchItem,cm=class cm{constructor(e){this._handler=e,this._cache={insert:new sm,update:new sm,remove:new sm}}insert(e,r){return new H8(e,r,this._handler,this._cache.insert)}update(e,r){return new $8(e,r,this._handler,this._cache.update)}remove(e,r){return new G8(e,r,this._handler,this._cache.update)}};c(cm,"ModelBatchMapper");var om=cm;Ab.exports=om});var hm=_((xZ,Nb)=>{"use strict";var j8=um(),fm=class fm{constructor(e,r){this.name=e,this._handler=r,this.batching=new j8(this._handler)}get(e,r,n){return n===void 0&&typeof r=="string"&&(n=r,r=null),this._handler.getSelectExecutor(e,r,!0).then(i=>i(e,r,n)).then(i=>i.first())}find(e,r,n){return n===void 0&&typeof r=="string"&&(n=r,r=null),this._handler.getSelectExecutor(e,r,!1).then(i=>i(e,r,n))}findAll(e,r){return r===void 0&&typeof e=="string"&&(r=e,e=null),this._handler.getSelectAllExecutor(e)(e,r)}insert(e,r,n){return n===void 0&&typeof r=="string"&&(n=r,r=null),this._handler.getInsertExecutor(e,r).then(i=>i(e,r,n))}update(e,r,n){return n===void 0&&typeof r=="string"&&(n=r,r=null),this._handler.getUpdateExecutor(e,r).then(i=>i(e,r,n))}remove(e,r,n){return n===void 0&&typeof r=="string"&&(n=r,r=null),this._handler.getDeleteExecutor(e,r).then(i=>i(e,r,n))}mapWithQuery(e,r,n){return this._handler.getExecutorFromQuery(e,r,n)}};c(fm,"ModelMapper");var lm=fm;Nb.exports=lm});var Lb=_((_Z,Db)=>{"use strict";var _l=require("vm"),Ob=xl(),Bb=Ob.QueryOperator,dm=Ob.QueryAssignment,z8=Ke(),Rb=z8.dataTypes,bl="gen-param-getter.js",Ye=class Ye{static getSelect(e,r,n,i,s,o){let a="SELECT ";return a+=i.length>0?i.map(u=>`"${u.columnName}"`).join(", "):"*",a+=` FROM ${r}.${e}`,n.length>0&&(a+=" WHERE ",a+=Ye._getConditionWithOperators(n)),s.length>0&&(a+=" ORDER BY ",a+=s.map(u=>`"${u[0]}" ${u[1]}`).join(", ")),typeof o=="number"&&(a+=" LIMIT ?"),a}static selectParamsGetter(e,r){let n=`(function getParametersSelect(doc, docInfo, mappingInfo) {
`;return n+="  return [",n+=Ye._valueGetterExpression(e),typeof r=="number"&&(e.length>0&&(n+=", "),n+="docInfo['limit']"),n+=`];
})`,new _l.Script(n,{filename:bl}).runInThisContext()}static getInsert(e,r,n,i,s){let o=i&&i.ttl,a=n.filter(u=>e.columnsByName[u.columnName]!==void 0);return{query:Ye._getInsertQuery(e.name,r,a,s,o),paramsGetter:Ye._insertParamsGetter(a,i),isIdempotent:!s}}static _getInsertQuery(e,r,n,i,s){let o=`INSERT INTO ${r}.${e} (`;return o+=n.map(a=>`"${a.columnName}"`).join(", "),o+=") VALUES (",o+=n.map(()=>"?").join(", "),o+=")",i===!0&&(o+=" IF NOT EXISTS"),typeof s=="number"&&(o+=" USING TTL ?"),o}static _insertParamsGetter(e,r){let n=`(function getParametersInsert(doc, docInfo, mappingInfo) {
`;return n+="  return [",n+=Ye._valueGetterExpression(e),r&&typeof r.ttl=="number"&&(n+=", docInfo['ttl']"),n+=`];
})`,new _l.Script(n,{filename:bl}).runInThisContext()}static getUpdate(e,r,n,i,s,o){let a=i&&i.ttl,u=new Set(e.partitionKeys.concat(e.clusteringKeys).map(p=>p.name)),l=!0,f=!1,h=n.filter(p=>{let g=e.columnsByName[p.columnName];return g===void 0?!1:(g.type.code===Rb.list&&p.value instanceof dm?l=!1:g.type.code===Rb.counter&&(l=!1,f=!0),!0)});return{query:Ye._getUpdateQuery(e.name,r,u,h,s,o,a),isIdempotent:l&&s.length===0&&!o,paramsGetter:Ye._updateParamsGetter(u,h,s,a),isCounter:f}}static _getUpdateQuery(e,r,n,i,s,o,a){let u=`UPDATE ${r}.${e} `;return typeof a=="number"&&(u+="USING TTL ? "),u+="SET ",u+=i.filter(l=>!n.has(l.columnName)).map(l=>l.value instanceof dm?l.value.inverted?`"${l.columnName}" = ? ${l.value.sign} "${l.columnName}"`:`"${l.columnName}" = "${l.columnName}" ${l.value.sign} ?`:`"${l.columnName}" = ?`).join(", "),u+=" WHERE ",u+=i.filter(l=>n.has(l.columnName)).map(l=>`"${l.columnName}" = ?`).join(" AND "),o===!0?u+=" IF EXISTS":s.length>0&&(u+=" IF "+Ye._getConditionWithOperators(s)),u}static _updateParamsGetter(e,r,n,i){let s=`(function getParametersUpdate(doc, docInfo, mappingInfo) {
`;return s+="  return [",typeof i=="number"&&(s+="docInfo['ttl'], "),s+=Ye._assignmentGetterExpression(r.filter(a=>!e.has(a.columnName))),s+=", ",s+=Ye._valueGetterExpression(r.filter(a=>e.has(a.columnName))),n.length>0&&(s+=", "+Ye._valueGetterExpression(n,"docInfo.when")),s+=`];
})`,new _l.Script(s,{filename:bl}).runInThisContext()}static getDelete(e,r,n,i,s,o){let a=i&&i.deleteOnlyColumns,u=new Set(e.partitionKeys.concat(e.clusteringKeys).map(f=>f.name)),l=n.filter(f=>e.columnsByName[f.columnName]!==void 0);return{query:Ye._getDeleteQuery(e.name,r,u,l,s,o,a),paramsGetter:Ye._deleteParamsGetter(u,l,s),isIdempotent:s.length===0&&!o}}static _getDeleteQuery(e,r,n,i,s,o,a){let u="DELETE";if(a){let l=i.filter(f=>!n.has(f.columnName)).map(f=>`"${f.columnName}"`).join(", ");l!==""&&(u+=" "+l)}return u+=` FROM ${r}.${e} WHERE `,u+=i.filter(l=>n.has(l.columnName)).map(l=>`"${l.columnName}" = ?`).join(" AND "),o===!0?u+=" IF EXISTS":s.length>0&&(u+=" IF "+Ye._getConditionWithOperators(s)),u}static _deleteParamsGetter(e,r,n){let i=`(function getParametersDelete(doc, docInfo, mappingInfo) {
`;return i+="  return [",i+=Ye._valueGetterExpression(r.filter(o=>e.has(o.columnName))),n.length>0&&(i+=", "+Ye._valueGetterExpression(n,"docInfo.when")),i+=`];
})`,new _l.Script(i,{filename:bl}).runInThisContext()}static _valueGetterExpression(e,r){return r=r||"doc",e.map(n=>Ye._valueGetterSingle(`${r}['${n.propertyName}']`,n.propertyName,n.value,n.fromModel)).join(", ")}static _valueGetterSingle(e,r,n,i){let s=e;if(n instanceof Bb){if(n.hasChildValues)return`${Ye._valueGetterSingle(`${e}.value[0]`,r,n.value[0],i)}, ${Ye._valueGetterSingle(`${e}.value[1]`,r,n.value[1],i)}`;if(s=`${e}.value`,n.isInOperator&&i)return`${s}.map(v => ${Ye._getMappingFunctionCall(r,"v")})`}return i?Ye._getMappingFunctionCall(r,s):s}static _assignmentGetterExpression(e,r){return r=r||"doc",e.map(n=>{let i=`${r}['${n.propertyName}']${n.value instanceof dm?".value":""}`;return n.fromModel?Ye._getMappingFunctionCall(n.propertyName,i):i}).join(", ")}static _getConditionWithOperators(e){return e.map(r=>Ye._getSingleCondition(r.columnName,r.value)).join(" AND ")}static _getMappingFunctionCall(e,r){return`mappingInfo.getFromModelFn('${e}')(${r})`}static _getSingleCondition(e,r){return r instanceof Bb?r.hasChildValues?`${Ye._getSingleCondition(e,r.value[0])} ${r.key} ${Ye._getSingleCondition(e,r.value[1])}`:`"${e}" ${r.key} ?`:`"${e}" = ?`}};c(Ye,"QueryGenerator");var pm=Ye;Db.exports=pm});var mm=_((IZ,kb)=>{"use strict";var W8=require("vm"),gm=oe(),Pb=Ke(),To=class To{static getSelectAdapter(e,r){let n=r.columns;if(!n)throw new Error("Expected ROWS result obtained VOID");let i=`(function rowAdapter(row, info) {
  const item = info.newInstance();
`;for(let o of n)i+=`  item['${e.getPropertyName(o.name)}'] = `,e.getToModelFn(o.name)?i+=`info.getToModelFn('${o.name}')(row['${o.name}']);
`:i+=`row['${o.name}'];
`;return i+=`  return item;
})`,new W8.Script(i,{filename:"gen-result-mapper.js"}).runInThisContext()}static getMutationAdapter(e){return e.columns===null||e.columns.length===1&&e.columns[0].name==="[applied]"&&e.columns[0].type.code===Pb.dataTypes.boolean?gm.noop:To._getConditionalRowAdapter(e)}static _getConditionalRowAdapter(e){return c(function(n,i){let s=i.newInstance();for(let o=1;o<e.columns.length;o++){let a=e.columns[o];s[i.getPropertyName(a.name)]=n[a.name]}return s},"conditionalRowAdapter")}static getCustomQueryAdapter(e,r){return r.columns===null||r.columns.length===0?{canCache:!0,fn:gm.noop}:r.columns[0].name==="[applied]"&&r.columns[0].type.code===Pb.dataTypes.boolean?{canCache:!1,fn:To._getConditionalRowAdapter(r)}:{canCache:!0,fn:To.getSelectAdapter(e,r)}}};c(To,"ResultMapper");var ym=To;kb.exports=ym});var Il=_((NZ,Fb)=>{"use strict";var Q8=require("util"),Y8=oe(),Z8=Q8.inspect.custom||"inspect",Em=class Em{constructor(e,r,n){this._rs=e,this._info=r,this._rowAdapter=n,this._isEmptyLwt=e.columns!==null&&e.columns.length===1&&this._rs.rowLength===1&&e.columns[0].name==="[applied]",this.length=this._isEmptyLwt?0:e.rowLength||0,this.pageState=e.pageState}wasApplied(){return this._rs.wasApplied()}first(){return!this._rs.rowLength||this._isEmptyLwt?null:this._rowAdapter(this._rs.rows[0],this._info)}*[Symbol.iterator](){if(!this._isEmptyLwt)for(let e=0;e<this._rs.rows.length;e++)yield this._rowAdapter(this._rs.rows[e],this._info)}toArray(){return this._isEmptyLwt||!this._rs.rows?Y8.emptyArray:this._rs.rows.map(e=>this._rowAdapter(e,this._info))}forEach(e,r){let n=0;r=r||this;for(let i of this)e.call(r,i,n++)}[Z8](){return this.toArray()}};c(Em,"Result");var vm=Em;Fb.exports=vm});var Mb=_((RZ,Vb)=>{"use strict";var rn={all:1,none:0,some:-1},wm=class wm{static getForSelect(e,r,n,i,s,o){return Promise.all(r.tables.map(a=>a.isView?e.metadata.getMaterializedView(r.keyspace,a.name):e.metadata.getTable(r.keyspace,a.name))).then(a=>{for(let l=0;l<a.length;l++){let f=a[l];if(f===null)throw new Error(`Table "${r.tables[l].name}" could not be retrieved`);if(!(_o(f.partitionKeys,i)!==rn.all||n&&_o(f.clusteringKeys,i)!==rn.all||i.length>f.partitionKeys.length&&!i.reduce((d,y)=>d&&(Cm(f.partitionKeys,v=>v.name===y.columnName)||Cm(f.clusteringKeys,v=>v.name===y.columnName)),!0)||!s.reduce((g,d)=>g&&f.columnsByName[d.columnName]!==void 0,!0)||!o.reduce((g,d,y)=>{if(!g)return!1;let v=f.clusteringKeys[y];return v&&v.name===d[0]},!0)))return f.name}let u=`No table matches the filter (${n?"all PKs have to be specified":"PKs"}): [${i.map(l=>l.columnName)}]`;throw s.length>0&&(u+=`; fields: [${s.map(l=>l.columnName)}]`),o.length>0&&(u+=`; orderBy: [${o.map(l=>l[0])}]`),new Error(u)})}static getForSelectAll(e){return e.tables[0].name}static getForInsert(e,r,n){return Promise.all(r.tables.filter(i=>!i.isView).map(i=>e.metadata.getTable(r.keyspace,i.name))).then(i=>{let s=i.filter((o,a)=>{if(o===null)throw new Error(`Table "${r.tables[a].name}" could not be retrieved`);if(_o(o.partitionKeys,n)!==rn.all)return!1;let u=_o(o.clusteringKeys,n);if(u===rn.all)return!0;if(u===rn.some)return!1;let l=Ub(o);return n.length===o.partitionKeys.length+l&&l>0});if(s.length===0)throw new Error(`No table matches (all PKs have to be specified) fields: [${n.map(o=>o.columnName)}]`);return s})}static getForUpdate(e,r,n,i){return Promise.all(r.tables.filter(s=>!s.isView).map(s=>e.metadata.getTable(r.keyspace,s.name))).then(s=>{let o=s.filter((a,u)=>{if(a===null)throw new Error(`Table "${r.tables[u].name}" could not be retrieved`);if(_o(a.partitionKeys,n)!==rn.all)return!1;let l=_o(a.clusteringKeys,n);if(l===rn.some||l===rn.none&&!qb(a))return!1;let f=n.reduce((h,p)=>h+(a.columnsByName[p.columnName]!==void 0?1:0),0);return f<=a.partitionKeys.length+a.clusteringKeys.length&&(!qb(a)||f<=a.partitionKeys.length)?!1:i.reduce((h,p)=>h&&a.columnsByName[p.columnName]!==void 0,!0)});if(o.length===0){let a=`No table matches (all PKs and columns to set have to be specified) fields: [${n.map(u=>u.columnName)}]`;throw i.length>0&&(a+=`; condition: [${i.map(u=>u.columnName)}]`),new Error(a)}return o})}static getForDelete(e,r,n,i){return Promise.all(r.tables.filter(s=>!s.isView).map(s=>e.metadata.getTable(r.keyspace,s.name))).then(s=>{let o=s.filter((a,u)=>{if(a===null)throw new Error(`Table "${r.tables[u].name}" could not be retrieved`);let l=a.partitionKeys.concat(a.clusteringKeys).map(h=>h.name),f=n.map(h=>h.columnName);for(let h=0;h<l.length;h++)if(f.indexOf(l[h])===-1)return!1;return i.reduce((h,p)=>h&&a.columnsByName[p.columnName]!==void 0,!0)});if(o.length===0){let a=`No table matches (all PKs have to be specified) fields: [${n.map(u=>u.columnName)}]`;throw i.length>0&&(a+=`; condition: [${i.map(u=>u.columnName)}]`),new Error(a)}return o})}};c(wm,"ObjectSelector");var Sm=wm;function Cm(t,e){return t.filter(e).length>0}c(Cm,"contains");function _o(t,e){if(t.length===0)return rn.all;let r=e.reduce((n,i)=>n+(Cm(t,s=>i.columnName===s.name)?1:0),0);return r===0?rn.none:r===t.length?rn.all:rn.some}c(_o,"keysAreIncluded");function qb(t){return Ub(t)>0}c(qb,"hasStaticColumn");function Ub(t){return t.columns.reduce((e,r)=>e+(r.isStatic?1:0),0)}c(Ub,"staticColumnCount");Vb.exports=Sm});var _m=_((DZ,Kb)=>{"use strict";var X8=ze(),J8=oe(),Tm=class Tm{static getPropertiesInfo(e,r,n,i){let s=e;return r&&r.fields&&r.fields.length>0&&(s=r.fields),s.map(o=>({propertyName:o,columnName:i.getColumnName(o),value:n[o],fromModel:i.getFromModelFn(o)}))}static adaptOrderBy(e,r){return!e||!e.orderBy?J8.emptyArray:Object.keys(e.orderBy).map(n=>{let i=e.orderBy[n],s=typeof i=="string"?i.toUpperCase():i;if(s!=="ASC"&&s!=="DESC")throw new X8.ArgumentError('Order must be either "ASC" or "DESC", obtained: '+i);return[r.getColumnName(n),s]})}static adaptOptions(e,r){let n={prepare:!0,executionProfile:void 0,timestamp:void 0,isIdempotent:r};return typeof e=="string"?n.executionProfile=e:e!=null&&(n.executionProfile=e.executionProfile,n.timestamp=e.timestamp,e.isIdempotent!==void 0&&(n.isIdempotent=e.isIdempotent)),n}static adaptAllOptions(e,r){let n={prepare:!0,executionProfile:void 0,fetchSize:void 0,pageState:void 0,timestamp:void 0,isIdempotent:void 0};return typeof e=="string"?n.executionProfile=e:e!=null&&(n.executionProfile=e.executionProfile,n.fetchSize=e.fetchSize,n.pageState=e.pageState,n.timestamp=e.timestamp,n.isIdempotent=e.isIdempotent),r&&(n.isIdempotent=!0),n}static adaptBatchOptions(e,r,n){let i={prepare:!0,executionProfile:void 0,timestamp:void 0,logged:void 0,isIdempotent:r,counter:n};return typeof e=="string"?i.executionProfile=e:e!=null&&(i.executionProfile=e.executionProfile,i.timestamp=e.timestamp,i.logged=e.logged!==!1,e.isIdempotent!==void 0&&(i.isIdempotent=e.isIdempotent)),i}};c(Tm,"DocInfoAdapter");var xm=Tm;Kb.exports=xm});var $b=_((PZ,Hb)=>{"use strict";var Is=oe(),As=Lb(),Al=mm(),Nl=Il(),ac=Yy(),cc=jy(),uc=Mb(),yr=_m(),Bl=100,Im=class Im{constructor(e,r){this._client=e,this._cache={select:new cc().on("add",n=>this._validateCacheLength(n)),selectAll:new cc().on("add",n=>this._validateCacheLength(n)),insert:new cc().on("add",n=>this._validateCacheLength(n)),update:new cc().on("add",n=>this._validateCacheLength(n)),remove:new cc().on("add",n=>this._validateCacheLength(n)),customQueries:new Map},this.info=r}getSelectExecutor(e,r,n){let i=Object.keys(e);if(i.length===0)return Promise.reject(new Error("Expected object with keys"));let s=ac.getSelectKey(i,e,r),o=this._cache.select.getOrCreate(s,()=>({executor:null,resultAdapter:null}));if(o.executor!==null)return Promise.resolve(o.executor);let a=yr.getPropertiesInfo(i,null,e,this.info),u=yr.getPropertiesInfo(Is.emptyArray,r,e,this.info),l=yr.adaptOrderBy(r,this.info),f=r&&r.limit;return this._client.connect().then(()=>uc.getForSelect(this._client,this.info,n,a,u,l)).then(h=>{let p=As.getSelect(h,this.info.keyspace,a,u,l,f),g=As.selectParamsGetter(a,f),d=this;return o.executor=c(function(v,m,w){return d._executeSelect(p,g,v,m,w,o)},"selectExecutor"),o.executor})}getSelectAllExecutor(e){let r=ac.getSelectAllKey(e),n=this._cache.selectAll.getOrCreate(r,()=>({executor:null,resultAdapter:null}));if(n.executor!==null)return n.executor;let i=yr.getPropertiesInfo(Is.emptyArray,e,Is.emptyObject,this.info),s=yr.adaptOrderBy(e,this.info),o=e&&e.limit,a=uc.getForSelectAll(this.info),u=As.getSelect(a,this.info.keyspace,Is.emptyArray,i,s,o),l=As.selectParamsGetter(Is.emptyArray,o),f=this;return n.executor=c(function(p,g){return f._executeSelect(u,l,null,p,g,n)},"selectAllExecutor"),n.executor}_executeSelect(e,r,n,i,s,o){let a=yr.adaptAllOptions(s,!0);return this._client.execute(e,r(n,i,this.info),a).then(u=>(o.resultAdapter===null&&(o.resultAdapter=Al.getSelectAdapter(this.info,u)),new Nl(u,this.info,o.resultAdapter)))}getInsertExecutor(e,r){let n=Object.keys(e);if(n.length===0)return Promise.reject(new Error("Expected object with keys"));let i=ac.getInsertKey(n,r),s=this._cache.insert.getOrCreate(i,()=>({executor:null}));return s.executor!==null?Promise.resolve(s.executor):this.createInsertQueries(n,e,r).then(o=>o.length===1?this._setSingleExecutor(s,o[0]):this._setBatchExecutor(s,o))}createInsertQueries(e,r,n){let i=yr.getPropertiesInfo(e,n,r,this.info),s=n&&n.ifNotExists;return this._client.connect().then(()=>uc.getForInsert(this._client,this.info,i)).then(o=>{if(o.length>1&&s)throw new Error("Batch with ifNotExists conditions cannot span multiple tables");return o.map(a=>As.getInsert(a,this.info.keyspace,i,n,s))})}getUpdateExecutor(e,r){let n=Object.keys(e);if(n.length===0)return Promise.reject(new Error("Expected object with keys"));let i=ac.getUpdateKey(n,e,r),s=this._cache.update.getOrCreate(i,()=>({executor:null}));return s.executor!==null?Promise.resolve(s.executor):this.createUpdateQueries(n,e,r).then(o=>o.length===1?this._setSingleExecutor(s,o[0]):this._setBatchExecutor(s,o))}createUpdateQueries(e,r,n){let i=yr.getPropertiesInfo(e,n,r,this.info),s=n&&n.ifExists,o=n&&n.when?yr.getPropertiesInfo(Object.keys(n.when),null,n.when,this.info):Is.emptyArray;if(o.length>0&&s)throw new Error("Both when and ifExists conditions can not be applied to the same statement");return this._client.connect().then(()=>uc.getForUpdate(this._client,this.info,i,o)).then(a=>{if(a.length>1&&(o.length>0||s))throw new Error("Batch with when or ifExists conditions cannot span multiple tables");return a.map(u=>As.getUpdate(u,this.info.keyspace,i,n,o,s))})}getDeleteExecutor(e,r){let n=Object.keys(e);if(n.length===0)return Promise.reject(new Error("Expected object with keys"));let i=ac.getRemoveKey(n,e,r),s=this._cache.remove.getOrCreate(i,()=>({executor:null}));return s.executor!==null?Promise.resolve(s.executor):this.createDeleteQueries(n,e,r).then(o=>o.length===1?this._setSingleExecutor(s,o[0]):this._setBatchExecutor(s,o))}createDeleteQueries(e,r,n){let i=yr.getPropertiesInfo(e,n,r,this.info),s=n&&n.ifExists,o=n&&n.when?yr.getPropertiesInfo(Object.keys(n.when),null,n.when,this.info):Is.emptyArray;if(o.length>0&&s)throw new Error("Both when and ifExists conditions can not be applied to the same statement");return this._client.connect().then(()=>uc.getForDelete(this._client,this.info,i,o)).then(a=>{if(a.length>1&&(o.length>0||s))throw new Error("Batch with when or ifExists conditions cannot span multiple tables");return a.map(u=>As.getDelete(u,this.info.keyspace,i,n,o,s))})}getExecutorFromQuery(e,r,n){let i=this,s=n?yr.adaptAllOptions(n):null;return c(function(a,u){let l=s||yr.adaptAllOptions(u);return i._client.execute(e,r(a),l).then(f=>{let h=i._cache.customQueries.get(e);if(h===void 0){let p=Al.getCustomQueryAdapter(i.info,f);h=p.fn,p.canCache&&(i._cache.customQueries.set(e,h),i._cache.customQueries.size===Bl&&i._client.log("warning",`Custom queries cache reached ${Bl} items, this could be caused by hard-coding parameter values inside the query, which should be avoided`))}return new Nl(f,i.info,h)})},"queryMappedExecutor")}_setSingleExecutor(e,r){let n=this;return e.executor=c(function(s,o,a){let u=yr.adaptOptions(a,r.isIdempotent);return n._client.execute(r.query,r.paramsGetter(s,o,n.info),u).then(l=>new Nl(l,n.info,Al.getMutationAdapter(l)))},"singleExecutor"),e.executor}_setBatchExecutor(e,r){let n=this,i=r.reduce((s,o)=>s&&o.isIdempotent,!0);return e.executor=c(function(o,a,u){let l=r.map(h=>({query:h.query,params:h.paramsGetter(o,a,n.info)})),f=yr.adaptOptions(u,i);return n._client.batch(l,f).then(h=>new Nl(h,n.info,Al.getMutationAdapter(h)))},"batchExecutor"),e.executor}_validateCacheLength(e){e===Bl&&this._client.log("warning",`ModelMapper cache reached ${Bl} items, this could be caused by building the object to map in different ways (with different shapes) each time. Use the same or few object structures for a model and represent unset values with undefined or types.unset`)}};c(Im,"MappingHandler");var bm=Im;Hb.exports=bm});var Dm=_(Rl=>{"use strict";var Bm=class Bm{newObjectInstance(){return{}}getColumnName(e){return e}getPropertyName(e){return e}};c(Bm,"TableMappings");var lc=Bm,Rm=class Rm extends lc{constructor(){super()}getColumnName(e){return e.replace(/[a-z][A-Z]/g,(r,n)=>r.charAt(0)+"_"+r.charAt(1)).toLowerCase()}getPropertyName(e){return e.replace(/_[a-z]/g,(r,n)=>n===0?r:r.substr(1).toUpperCase())}};c(Rm,"UnderscoreCqlToCamelCaseMappings");var Am=Rm,Om=class Om extends lc{constructor(){super()}getColumnName(e){return super.getColumnName(e)}getPropertyName(e){return super.getPropertyName(e)}newObjectInstance(){return super.newObjectInstance()}};c(Om,"DefaultTableMappings");var Nm=Om;Rl.TableMappings=lc;Rl.UnderscoreCqlToCamelCaseMappings=Am;Rl.DefaultTableMappings=Nm});var Wb=_((UZ,zb)=>{"use strict";var jb=Dm(),e5=jb.TableMappings,Gb=jb.DefaultTableMappings,Ns=class Ns{constructor(e,r,n,i){this.keyspace=e,this.tables=r,this._mappings=n,this._columns=i,this._documentProperties=new Map;for(let s of i.values())this._documentProperties.set(s.propertyName,s)}getColumnName(e){let r=this._documentProperties.get(e);return r!==void 0?r.columnName:this._mappings.getColumnName(e)}getPropertyName(e){let r=this._columns.get(e);return r!==void 0?r.propertyName:this._mappings.getPropertyName(e)}getFromModelFn(e){let r=this._documentProperties.get(e);return r!==void 0?r.fromModel:null}getToModelFn(e){let r=this._columns.get(e);return r!==void 0?r.toModel:null}newInstance(){return this._mappings.newObjectInstance()}static parse(e,r){let n=new Map;return!e||!e.models||Object.keys(e.models).forEach(i=>{let s=e.models[i];n.set(i,Ns._create(i,r,s))}),n}static _create(e,r,n){if(!r&&(!n||!n.keyspace))throw new Error("You should specify the keyspace of the model in the MappingOptions when the Client is not using a keyspace");if(!n)return Ns.createDefault(e,r);let i;if(n.tables&&n.tables.length>0?i=n.tables.map(o=>{let a={name:null,isView:!1};if(typeof o=="string"?a.name=o:o&&(a.name=o.name,a.isView=!!o.isView),!a.name)throw new Error(`Table name not specified for model '${e}'`);return a}):i=[{name:e,isView:!1}],n.mappings&&!(n.mappings instanceof e5))throw new Error("mappings should be an instance of TableMappings");let s=new Map;return n.columns!==null&&typeof n.columns=="object"&&Object.keys(n.columns).forEach(o=>{s.set(o,Pm.parse(o,n.columns[o]))}),new Ns(n.keyspace||r,i,n.mappings||new Gb,s)}static createDefault(e,r){return new Ns(r,[{name:e,isView:!1}],new Gb,new Map)}};c(Ns,"ModelMappingInfo");var Lm=Ns,bo=class bo{constructor(e,r,n,i){if(this.columnName=e,this.propertyName=r,n&&typeof n!="function")throw new TypeError(`toModel type for property '${r}' should be a function (obtained ${typeof n})`);if(i&&typeof i!="function")throw new TypeError(`fromModel type for property '${r}' should be a function (obtained ${typeof i})`);this.toModel=n,this.fromModel=i}static parse(e,r){return r?typeof r=="string"?new bo(e,r):new bo(e,r.name||e,r.toModel,r.fromModel):new bo(e,e)}};c(bo,"ModelColumnInfo");var Pm=bo;zb.exports=Lm});var Zb=_((MZ,Yb)=>{"use strict";var t5=hm(),r5=$b(),n5=_m(),i5=ze(),s5=Il(),o5=mm(),Qb=Wb(),{ModelBatchItem:a5}=Tl(),Fm=class Fm{constructor(e,r){if(!e)throw new Error("client must be defined");this.client=e,this._modelMappingInfos=Qb.parse(r,e.keyspace),this._modelMappers=new Map}forModel(e){let r=this._modelMappers.get(e);if(r===void 0){let n=this._modelMappingInfos.get(e);if(n===void 0){if(!this.client.keyspace)throw new Error(`No mapping information found for model '${e}'. Mapper is unable to create default mappings without setting the keyspace`);n=Qb.createDefault(e,this.client.keyspace),this.client.log("info",`Mapping information for model '${e}' not found, creating default mapping. Keyspace: ${n.keyspace}; Table: ${n.tables[0].name}.`)}else this.client.log("info",`Creating model mapper for '${e}' using mapping information. Keyspace: ${n.keyspace}; Table${n.tables.length>1?"s":""}: ${n.tables.map(i=>i.name)}.`);r=new t5(e,new r5(this.client,n)),this._modelMappers.set(e,r)}return r}batch(e,r){if(!Array.isArray(e)||!(e.length>0))return Promise.reject(new i5.ArgumentError("First parameter items should be an Array with 1 or more ModelBatchItem instances"));let n=[],i=!0,s;return Promise.all(e.map(o=>o instanceof a5?o.pushQueries(n).then(a=>{i=i&&a.isIdempotent,s=a.isCounter}):Promise.reject(new Error("Batch items must be instances of ModelBatchItem, use modelMapper.batching object to create each item")))).then(()=>this.client.batch(n,n5.adaptBatchOptions(r,i,s))).then(o=>{let a=e[0].getMappingInfo();return new s5(o,a,o5.getMutationAdapter(o))})}};c(Fm,"Mapper");var km=Fm;Yb.exports=km});var Xb=_(Vn=>{"use strict";Vn.Mapper=Zb();Vn.ModelMapper=hm();Vn.ModelBatchMapper=um();Vn.ModelBatchItem=Tl().ModelBatchItem;Vn.Result=Il();var qm=Dm();Vn.TableMappings=qm.TableMappings;Vn.DefaultTableMappings=qm.DefaultTableMappings;Vn.UnderscoreCqlToCamelCaseMappings=qm.UnderscoreCqlToCamelCaseMappings;Vn.q=xl().q});var eI=_(Vm=>{"use strict";var{Stream:c5}=require("stream"),Jb=oe();function u5(t,e,r,n){if(!t)throw new TypeError("Client instance is not defined");if(typeof e=="string"){if(Array.isArray(r))return new Ol(t,e,r,n).execute();if(r instanceof c5)return new Um(t,e,r,n).execute();throw new TypeError("parameters should be an Array or a Stream instance")}if(Array.isArray(e))return n=r,new Ol(t,null,e,n).execute();throw new TypeError("A string query or query and parameters array should be provided")}c(u5,"executeConcurrent");var Mm=class Mm{constructor(e,r,n,i){this._client=e,this._query=r,this._parameters=n,i=i||Jb.emptyObject,this._raiseOnFirstError=i.raiseOnFirstError!==!1,this._concurrencyLevel=Math.min(i.concurrencyLevel||100,this._parameters.length),this._queryOptions={prepare:!0,executionProfile:i.executionProfile},this._result=new fc(i),this._stop=!1}execute(){let e=new Array(this._concurrencyLevel);for(let r=0;r<this._concurrencyLevel;r++)e[r]=this._executeOneAtATime(r,0);return Promise.all(e).then(()=>this._result)}_executeOneAtATime(e,r){let n=e+this._concurrencyLevel*r;if(n>=this._parameters.length||this._stop)return Promise.resolve();let i=this._parameters[n],s,o;return this._query===null?(s=i.query,o=i.params):(s=this._query,o=i),this._client.execute(s,o,this._queryOptions).then(a=>this._result.setResultItem(n,a)).catch(a=>this._setError(n,a)).then(()=>this._executeOneAtATime(e,r+1))}_setError(e,r){if(this._result.setError(e,r),this._raiseOnFirstError)throw this._stop=!0,r}};c(Mm,"ArrayBasedExecutor");var Ol=Mm,Km=class Km{constructor(e,r,n,i){this._client=e,this._query=r,this._stream=n,i=i||Jb.emptyObject,this._raiseOnFirstError=i.raiseOnFirstError!==!1,this._concurrencyLevel=i.concurrencyLevel||100,this._queryOptions={prepare:!0,executionProfile:i.executionProfile},this._inFlight=0,this._index=0,this._result=new fc(i),this._resolveCallback=null,this._rejectCallback=null,this._readEnded=!1}execute(){return new Promise((e,r)=>{this._resolveCallback=e,this._rejectCallback=r,this._stream.on("data",n=>this._executeOne(n)).on("error",n=>this._setReadEnded(n)).on("end",()=>this._setReadEnded())})}_executeOne(e){if(!Array.isArray(e))return this._setReadEnded(new TypeError("Stream should be in objectMode and should emit Array instances"));if(this._readEnded)return;let r=this._index++;this._inFlight++,this._client.execute(this._query,e,this._queryOptions).then(n=>{this._result.setResultItem(r,n),this._inFlight--}).catch(n=>{this._inFlight--,this._setError(r,n)}).then(()=>{this._stream.isPaused()&&this._stream.resume(),this._readEnded&&this._inFlight===0&&this._resolveCallback(this._result)}),this._inFlight>=this._concurrencyLevel&&this._stream.pause()}_setReadEnded(e){this._readEnded||(this._readEnded=!0,e?this._rejectCallback(e):this._inFlight===0&&this._resolveCallback(this._result))}_setError(e,r){this._result.setError(e,r),this._raiseOnFirstError&&(this._readEnded=!0,this._rejectCallback(r))}};c(Km,"StreamBasedExecutor");var Um=Km,Hm=class Hm{constructor(e){this._collectResults=e.collectResults,this._maxErrors=e.maxErrors||100,this.totalExecuted=0,this.errors=[],this._collectResults?this.resultItems=[]:Object.defineProperty(this,"resultItems",{enumerable:!1,get:()=>{throw new Error("Property resultItems can not be accessed when collectResults is set to false")}})}setResultItem(e,r){this.totalExecuted++,this._collectResults&&(this.resultItems[e]=r)}setError(e,r){this.totalExecuted++,this.errors.length<this._maxErrors&&this.errors.push(r),this._collectResults&&(this.resultItems[e]=r)}};c(Hm,"ResultSetGroup");var fc=Hm;Vm.executeConcurrent=u5;Vm.ResultSetGroup=fc});var tI=_($m=>{"use strict";$m.graph=Vg();$m.search=bp()});var Dl=_(Bt=>{"use strict";var l5=ma();Bt.Client=wb();Bt.ExecutionProfile=kd().ExecutionProfile;Bt.ExecutionOptions=xi().ExecutionOptions;Bt.types=Ke();Bt.errors=ze();Bt.policies=yu();Bt.auth=Oa();Bt.mapping=Xb();Bt.tracker=ld();Bt.metrics=yd();Bt.concurrent=eI();var rI=Fa();Bt.token={Token:rI.Token,TokenRange:rI.TokenRange};var f5=w0();Bt.metadata={Metadata:f5};Bt.Encoder=Ou();Bt.geometry=Nu();Bt.datastax=tI();Bt.defaultOptions=function(){return l5.defaultOptions()};Bt.version=oo().version});var nI=_((WZ,h5)=>{h5.exports={model:{modelName:"new_model",dbVersion:"5.x",dbVendor:"Cassandra"},container:{name:"new_keyspace",indexes:[],replStrategy:"SimpleStrategy",addToCqlScript:!0},collection:{collectionName:"new_table",collectionUsers:[],collation:{},tableOptions:{}},field:{name:"new_column",subtype:{valueDependencies:[{value:"object",dependency:{key:"type",value:"jsonObject"}},{value:"array",dependency:{key:"type",value:"jsonArray"}}]}},patternField:{name:"^[a-zA-Z0-9_.-]+$"},multipleField:{primaryKey:!1},subschema:{},arrayItem:{},choice:{},relationship:{},user:{},view:{viewOn:""},UDFs:{name:"new_udf",udfID:"",udfDescription:"",udfFunction:"",udfComments:""},UDAs:{name:"new_uda",udfID:"",udfDescription:"",udfFunction:"",udfComments:""},SecIndxs:{name:"new_index",indexType:"Secondary",SecIndxKey:"",SecIndxID:"",SecIndxDescription:"",SecIndxFunction:"",SecIndxComments:""}}});var oI=_((QZ,sI)=>{"use strict";var iI=Dl().types,d5=nI(),p5={numeric:"num",char:"str",timestamp:"ts",reference:"udt"},g5=d5.field.name;sI.exports=t=>{let e=c((x,A,O)=>{let j=iI.getDataTypeNameByCode(x.type||x).split("<")[0];return A&&j==="udt"?(A.push({udt:x,sample:O}),r(x)):n(j,x,O,A)},"getColumnType"),r=c(x=>{let A=t.get(x,"type.info.name",t.get(x,"info.name",x.name));return{type:"reference",$ref:`#/definitions/${A}`,refName:A}},"getRef"),n=c((x,A,O,P)=>{let j=u(x);return x==="map"?i(j,A,O,P):x==="tuple"?s(j,A,O,P):x==="set"||x==="list"?o(j,A,O,P):x==="custom"&&w(A)?a(j,A,O,P):j},"getType"),i=c((x,A,O,P)=>{let j=(A.info||A.type.info)[0],Q=(A.info||A.type.info)[1],se=e(j),re=p({valueData:Q,sample:O,udtHash:P}),k=se.mode?{keySubtype:se.mode}:{},Ae=se.type,q=m(re),T=l(x.type,q);return Object.assign({},x,k,{keyType:Ae,subtype:T,properties:re})},"handleMap"),s=c((x,A,O,P)=>{O=Array.isArray(O)?O:[];let j=(A.info||A.type.info).map(Q=>{let se=O.find(k=>d(k,Q));return e(Q,P,se)});return Object.assign({},x,{items:j})},"handleTuple"),o=c((x,A,O,P)=>{let j=A.info||A.type.info,Q=y(j,O,P),se=(Q[0]||{type:"text"}).type,re=l(x.type,se);return Object.assign({},x,{items:t.uniqWith(Q,t.isEqual),subtype:re})},"handleList"),a=c((x,A,O,P)=>{let j=A.info||A.type.info,Q=j.dimensions,se=y(j.subtype,O,P),re=t.uniqWith(se,t.isEqual),k=(re[0]||{mode:"float"}).mode;return{...x,dimension:Q,subtype:k,items:re}},"handleVector"),u=c(x=>{switch(x){case"int":return{type:"numeric",mode:"integer"};case"smallint":case"tinyint":case"bigint":case"counter":case"decimal":case"double":case"float":case"varint":return{type:"numeric",mode:x};case"text":case"varchar":case"ascii":case"inet":return{type:"char",mode:x};case"boolean":return{type:"bool"};case"timestamp":case"timeuuid":case"blob":case"date":case"time":case"uuid":return{type:x};case"tuple":case"list":case"set":case"map":return{type:x};default:return{type:"char"}}},"getAppType"),l=c((x,A)=>`${x}<${p5[A]||A}>`,"getSubType"),f=c((x,A,O)=>!A||typeof A!="object"?h(x,O):Object.keys(A).reduce((P,j)=>Object.assign({},P,{[j]:e(x,O,A[j])}),{}),"getProperties"),h=c((x,A)=>{let O=e(x,A);return{[O.refName||g5]:t.omit(O,"refName")}},"getDefaultProperties"),p=c(({valueData:x,sample:A,udtHash:O})=>{let P=f(x,A,O),j=Object.entries(P),Q=t.uniqWith(j,([,se],[,re])=>se.type===re.type&&se.$ref===re.$ref&&se.mode===re.mode);return Object.fromEntries(Q)},"getMapProperties"),g=c(x=>{switch(x){case"smallint":case"tinyint":case"int":case"bigint":case"counter":case"decimal":case"double":case"float":case"varint":return"number";case"text":case"varchar":case"ascii":case"inet":case"timestamp":case"timeuuid":case"blob":case"date":case"time":case"uuid":return"string";case"boolean":return"boolean";case"tuple":case"list":case"set":return"array";case"map":return"object";default:return"string"}},"getJsonType"),d=c((x,A)=>{let P=iI.getDataTypeNameByCode(A.type||A).split("<")[0],j=g(P);return j==="array"?Array.isArray(x):j==="array"?Object(x)===x:typeof x===j},"isTypeEqual"),y=c((x,A,O)=>!Array.isArray(A)||A.length===0?v(x,O):A.map(P=>e(x,O,P)),"getItems"),v=c((x,A)=>[e(x,A)],"getDefaultItems"),m=c(x=>{let A=Object.keys(x).pop(),O=(x[A]||{}).type;return O||"text"},"getChildTypeByProperties"),w=c(x=>{let A=x.info||x.type.info,O=A==null?void 0:A.dimensions;return!isNaN(+O)},"isVector");return{getColumnType:e}}});var hI=_((ZZ,fI)=>{"use strict";var aI="compaction",cI="compression",uI="caching",y5=[uI,aI,cI],lI=c(t=>String(t||"").replace(/[\"\`]/g,"'"),"changeQuotes"),m5=c((t,e)=>{switch(t){case aI:return E5(e);case uI:return S5(e);case cI:return v5(e);default:return null}},"handleSpecialOption"),v5=c(t=>{let{compression:e}=t;return lI(JSON.stringify(e))},"handleCompressionOption"),E5=c(t=>{let{compactionClass:e,compactionOptions:r}=t,n=Object.assign({},{class:e},r);return lI(JSON.stringify(n))},"handleCompactionOption"),S5=c(t=>{let e=JSON.parse(t.caching);return{keys:e.keys,rowsPerPartition:e.rows_per_partition}},"handleCashingOption"),C5=c(t=>(e,r)=>{let n=r.propertyKeyword;if(y5.includes(n)){let i=m5(n,t);return Object.assign({},e,{[n]:i})}return t.hasOwnProperty(n)?Object.assign({},e,{[n]:t[n]}):e},"generateTableOptionsReducer");fI.exports={createTableOptionsFromMeta(t,e){return e.reduce(C5(t),{})}}});var gI=_((JZ,pI)=>{"use strict";var dI=Dl(),jm=class jm extends dI.policies.retry.RetryPolicy{constructor(e){super(),this.hackoladeLogger=e}onReadTimeout(e,r,n,i,s){let a=e.nbRetry;return this.hackoladeLogger&&this.hackoladeLogger.log("info",{exception:"Read timeout",respondedNodes:n,needNodesForSuccess:i,query:e.query,nbRetry:e.nbRetry,isLastTry:a>2},"Retry policy info"),a>2?this.rethrowResult():this.retryResult(dI.types.consistencies.one)}onUnavailable(e,r,n,i,s){return this.hackoladeLogger&&this.hackoladeLogger.log("info",{exception:"Unavailable",query:e.query,nbRetry:e.nbRetry,isLastTry:e.nbRetry>0},"Retry policy info"),e.nbRetry>0?this.rethrowResult():this.retryResult(void 0,!1)}onRequestError=function(e,r,n){return this.hackoladeLogger&&this.hackoladeLogger.log("info",{exception:"Request error",query:e.query,nbRetry:e.nbRetry,error:{...n}},"Retry policy info"),this.retryResult(void 0,!1)}};c(jm,"CassandraRetryPolicy");var Gm=jm;pI.exports=Gm});var Ll=_(ai=>{"use strict";var yI=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",w5=yI+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",mI="["+yI+"]["+w5+"]*",x5=new RegExp("^"+mI+"$"),T5=c(function(t,e){let r=[],n=e.exec(t);for(;n;){let i=[];i.startIndex=e.lastIndex-n[0].length;let s=n.length;for(let o=0;o<s;o++)i.push(n[o]);r.push(i),n=e.exec(t)}return r},"getAllMatches"),_5=c(function(t){let e=x5.exec(t);return!(e===null||typeof e>"u")},"isName");ai.isExist=function(t){return typeof t<"u"};ai.isEmptyObject=function(t){return Object.keys(t).length===0};ai.merge=function(t,e,r){if(e){let n=Object.keys(e),i=n.length;for(let s=0;s<i;s++)r==="strict"?t[n[s]]=[e[n[s]]]:t[n[s]]=e[n[s]]}};ai.getValue=function(t){return ai.isExist(t)?t:""};ai.isName=_5;ai.getAllMatches=T5;ai.nameRegexp=mI});var Wm=_(wI=>{"use strict";var zm=Ll(),b5={allowBooleanAttributes:!1,unpairedTags:[]};wI.validate=function(t,e){e=Object.assign({},b5,e);let r=[],n=!1,i=!1;t[0]==="\uFEFF"&&(t=t.substr(1));for(let s=0;s<t.length;s++)if(t[s]==="<"&&t[s+1]==="?"){if(s+=2,s=EI(t,s),s.err)return s}else if(t[s]==="<"){let o=s;if(s++,t[s]==="!"){s=SI(t,s);continue}else{let a=!1;t[s]==="/"&&(a=!0,s++);let u="";for(;s<t.length&&t[s]!==">"&&t[s]!==" "&&t[s]!=="	"&&t[s]!==`
`&&t[s]!=="\r";s++)u+=t[s];if(u=u.trim(),u[u.length-1]==="/"&&(u=u.substring(0,u.length-1),s--),!L5(u)){let h;return u.trim().length===0?h="Invalid space after '<'.":h="Tag '"+u+"' is an invalid name.",Ct("InvalidTag",h,mr(t,s))}let l=N5(t,s);if(l===!1)return Ct("InvalidAttr","Attributes for '"+u+"' have open quote.",mr(t,s));let f=l.value;if(s=l.index,f[f.length-1]==="/"){let h=s-f.length;f=f.substring(0,f.length-1);let p=CI(f,e);if(p===!0)n=!0;else return Ct(p.err.code,p.err.msg,mr(t,h+p.err.line))}else if(a)if(l.tagClosed){if(f.trim().length>0)return Ct("InvalidTag","Closing tag '"+u+"' can't have attributes or invalid starting.",mr(t,o));if(r.length===0)return Ct("InvalidTag","Closing tag '"+u+"' has not been opened.",mr(t,o));{let h=r.pop();if(u!==h.tagName){let p=mr(t,h.tagStartPos);return Ct("InvalidTag","Expected closing tag '"+h.tagName+"' (opened in line "+p.line+", col "+p.col+") instead of closing tag '"+u+"'.",mr(t,o))}r.length==0&&(i=!0)}}else return Ct("InvalidTag","Closing tag '"+u+"' doesn't have proper closing.",mr(t,s));else{let h=CI(f,e);if(h!==!0)return Ct(h.err.code,h.err.msg,mr(t,s-f.length+h.err.line));if(i===!0)return Ct("InvalidXml","Multiple possible root nodes found.",mr(t,s));e.unpairedTags.indexOf(u)!==-1||r.push({tagName:u,tagStartPos:o}),n=!0}for(s++;s<t.length;s++)if(t[s]==="<")if(t[s+1]==="!"){s++,s=SI(t,s);continue}else if(t[s+1]==="?"){if(s=EI(t,++s),s.err)return s}else break;else if(t[s]==="&"){let h=O5(t,s);if(h==-1)return Ct("InvalidChar","char '&' is not expected.",mr(t,s));s=h}else if(i===!0&&!vI(t[s]))return Ct("InvalidXml","Extra text at the end",mr(t,s));t[s]==="<"&&s--}}else{if(vI(t[s]))continue;return Ct("InvalidChar","char '"+t[s]+"' is not expected.",mr(t,s))}if(n){if(r.length==1)return Ct("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",mr(t,r[0].tagStartPos));if(r.length>0)return Ct("InvalidXml","Invalid '"+JSON.stringify(r.map(s=>s.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return Ct("InvalidXml","Start tag expected.",1);return!0};function vI(t){return t===" "||t==="	"||t===`
`||t==="\r"}c(vI,"isWhiteSpace");function EI(t,e){let r=e;for(;e<t.length;e++)if(t[e]=="?"||t[e]==" "){let n=t.substr(r,e-r);if(e>5&&n==="xml")return Ct("InvalidXml","XML declaration allowed only at the start of the document.",mr(t,e));if(t[e]=="?"&&t[e+1]==">"){e++;break}else continue}return e}c(EI,"readPI");function SI(t,e){if(t.length>e+5&&t[e+1]==="-"&&t[e+2]==="-"){for(e+=3;e<t.length;e++)if(t[e]==="-"&&t[e+1]==="-"&&t[e+2]===">"){e+=2;break}}else if(t.length>e+8&&t[e+1]==="D"&&t[e+2]==="O"&&t[e+3]==="C"&&t[e+4]==="T"&&t[e+5]==="Y"&&t[e+6]==="P"&&t[e+7]==="E"){let r=1;for(e+=8;e<t.length;e++)if(t[e]==="<")r++;else if(t[e]===">"&&(r--,r===0))break}else if(t.length>e+9&&t[e+1]==="["&&t[e+2]==="C"&&t[e+3]==="D"&&t[e+4]==="A"&&t[e+5]==="T"&&t[e+6]==="A"&&t[e+7]==="["){for(e+=8;e<t.length;e++)if(t[e]==="]"&&t[e+1]==="]"&&t[e+2]===">"){e+=2;break}}return e}c(SI,"readCommentAndCDATA");var I5='"',A5="'";function N5(t,e){let r="",n="",i=!1;for(;e<t.length;e++){if(t[e]===I5||t[e]===A5)n===""?n=t[e]:n!==t[e]||(n="");else if(t[e]===">"&&n===""){i=!0;break}r+=t[e]}return n!==""?!1:{value:r,index:e,tagClosed:i}}c(N5,"readAttributeStr");var B5=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function CI(t,e){let r=zm.getAllMatches(t,B5),n={};for(let i=0;i<r.length;i++){if(r[i][1].length===0)return Ct("InvalidAttr","Attribute '"+r[i][2]+"' has no space in starting.",hc(r[i]));if(r[i][3]!==void 0&&r[i][4]===void 0)return Ct("InvalidAttr","Attribute '"+r[i][2]+"' is without value.",hc(r[i]));if(r[i][3]===void 0&&!e.allowBooleanAttributes)return Ct("InvalidAttr","boolean attribute '"+r[i][2]+"' is not allowed.",hc(r[i]));let s=r[i][2];if(!D5(s))return Ct("InvalidAttr","Attribute '"+s+"' is an invalid name.",hc(r[i]));if(!n.hasOwnProperty(s))n[s]=1;else return Ct("InvalidAttr","Attribute '"+s+"' is repeated.",hc(r[i]))}return!0}c(CI,"validateAttributeString");function R5(t,e){let r=/\d/;for(t[e]==="x"&&(e++,r=/[\da-fA-F]/);e<t.length;e++){if(t[e]===";")return e;if(!t[e].match(r))break}return-1}c(R5,"validateNumberAmpersand");function O5(t,e){if(e++,t[e]===";")return-1;if(t[e]==="#")return e++,R5(t,e);let r=0;for(;e<t.length;e++,r++)if(!(t[e].match(/\w/)&&r<20)){if(t[e]===";")break;return-1}return e}c(O5,"validateAmpersand");function Ct(t,e,r){return{err:{code:t,msg:e,line:r.line||r,col:r.col}}}c(Ct,"getErrorObject");function D5(t){return zm.isName(t)}c(D5,"validateAttrName");function L5(t){return zm.isName(t)}c(L5,"validateTagName");function mr(t,e){let r=t.substring(0,e).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}c(mr,"getLineNumberForPosition");function hc(t){return t.startIndex+t[1].length}c(hc,"getPositionFromMatch")});var TI=_(Qm=>{var xI={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(t,e,r){return t}},P5=c(function(t){return Object.assign({},xI,t)},"buildOptions");Qm.buildOptions=P5;Qm.defaultOptions=xI});var bI=_((aX,_I)=>{"use strict";var Zm=class Zm{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,r){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:r})}addChild(e){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}};c(Zm,"XmlNode");var Ym=Zm;_I.exports=Ym});var AI=_((uX,II)=>{var k5=Ll();function F5(t,e){let r={};if(t[e+3]==="O"&&t[e+4]==="C"&&t[e+5]==="T"&&t[e+6]==="Y"&&t[e+7]==="P"&&t[e+8]==="E"){e=e+9;let n=1,i=!1,s=!1,o="";for(;e<t.length;e++)if(t[e]==="<"&&!s){if(i&&V5(t,e))e+=7,[entityName,val,e]=q5(t,e+1),val.indexOf("&")===-1&&(r[$5(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(i&&M5(t,e))e+=8;else if(i&&K5(t,e))e+=8;else if(i&&H5(t,e))e+=9;else if(U5)s=!0;else throw new Error("Invalid DOCTYPE");n++,o=""}else if(t[e]===">"){if(s?t[e-1]==="-"&&t[e-2]==="-"&&(s=!1,n--):n--,n===0)break}else t[e]==="["?i=!0:o+=t[e];if(n!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:r,i:e}}c(F5,"readDocType");function q5(t,e){let r="";for(;e<t.length&&t[e]!=="'"&&t[e]!=='"';e++)r+=t[e];if(r=r.trim(),r.indexOf(" ")!==-1)throw new Error("External entites are not supported");let n=t[e++],i="";for(;e<t.length&&t[e]!==n;e++)i+=t[e];return[r,i,e]}c(q5,"readEntityExp");function U5(t,e){return t[e+1]==="!"&&t[e+2]==="-"&&t[e+3]==="-"}c(U5,"isComment");function V5(t,e){return t[e+1]==="!"&&t[e+2]==="E"&&t[e+3]==="N"&&t[e+4]==="T"&&t[e+5]==="I"&&t[e+6]==="T"&&t[e+7]==="Y"}c(V5,"isEntity");function M5(t,e){return t[e+1]==="!"&&t[e+2]==="E"&&t[e+3]==="L"&&t[e+4]==="E"&&t[e+5]==="M"&&t[e+6]==="E"&&t[e+7]==="N"&&t[e+8]==="T"}c(M5,"isElement");function K5(t,e){return t[e+1]==="!"&&t[e+2]==="A"&&t[e+3]==="T"&&t[e+4]==="T"&&t[e+5]==="L"&&t[e+6]==="I"&&t[e+7]==="S"&&t[e+8]==="T"}c(K5,"isAttlist");function H5(t,e){return t[e+1]==="!"&&t[e+2]==="N"&&t[e+3]==="O"&&t[e+4]==="T"&&t[e+5]==="A"&&t[e+6]==="T"&&t[e+7]==="I"&&t[e+8]==="O"&&t[e+9]==="N"}c(H5,"isNotation");function $5(t){if(k5.isName(t))return t;throw new Error(`Invalid entity name ${t}`)}c($5,"validateEntityName");II.exports=F5});var BI=_((fX,NI)=>{var G5=/^[-+]?0x[a-fA-F0-9]+$/,j5=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);var z5={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function W5(t,e={}){if(e=Object.assign({},z5,e),!t||typeof t!="string")return t;let r=t.trim();if(e.skipLike!==void 0&&e.skipLike.test(r))return t;if(e.hex&&G5.test(r))return Number.parseInt(r,16);{let n=j5.exec(r);if(n){let i=n[1],s=n[2],o=Q5(n[3]),a=n[4]||n[6];if(!e.leadingZeros&&s.length>0&&i&&r[2]!==".")return t;if(!e.leadingZeros&&s.length>0&&!i&&r[1]!==".")return t;{let u=Number(r),l=""+u;return l.search(/[eE]/)!==-1||a?e.eNotation?u:t:r.indexOf(".")!==-1?l==="0"&&o===""||l===o||i&&l==="-"+o?u:t:s?o===l||i+o===l?u:t:r===l||r===i+l?u:t}}else return t}}c(W5,"toNumber");function Q5(t){return t&&t.indexOf(".")!==-1&&(t=t.replace(/0+$/,""),t==="."?t="0":t[0]==="."?t="0"+t:t[t.length-1]==="."&&(t=t.substr(0,t.length-1))),t}c(Q5,"trimZeros");NI.exports=W5});var DI=_((dX,OI)=>{"use strict";var RI=Ll(),dc=bI(),Y5=AI(),Z5=BI(),tv=class tv{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"\xA2"},pound:{regex:/&(pound|#163);/g,val:"\xA3"},yen:{regex:/&(yen|#165);/g,val:"\xA5"},euro:{regex:/&(euro|#8364);/g,val:"\u20AC"},copyright:{regex:/&(copy|#169);/g,val:"\xA9"},reg:{regex:/&(reg|#174);/g,val:"\xAE"},inr:{regex:/&(inr|#8377);/g,val:"\u20B9"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(r,n)=>String.fromCharCode(Number.parseInt(n,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(r,n)=>String.fromCharCode(Number.parseInt(n,16))}},this.addExternalEntities=X5,this.parseXml=nV,this.parseTextData=J5,this.resolveNameSpace=eV,this.buildAttributesMap=rV,this.isItStopNode=aV,this.replaceEntitiesValue=sV,this.readStopNodeData=uV,this.saveTextToParentTag=oV,this.addChild=iV}};c(tv,"OrderedObjParser");var Xm=tv;function X5(t){let e=Object.keys(t);for(let r=0;r<e.length;r++){let n=e[r];this.lastEntities[n]={regex:new RegExp("&"+n+";","g"),val:t[n]}}}c(X5,"addExternalEntities");function J5(t,e,r,n,i,s,o){if(t!==void 0&&(this.options.trimValues&&!n&&(t=t.trim()),t.length>0)){o||(t=this.replaceEntitiesValue(t));let a=this.options.tagValueProcessor(e,t,r,i,s);return a==null?t:typeof a!=typeof t||a!==t?a:this.options.trimValues?ev(t,this.options.parseTagValue,this.options.numberParseOptions):t.trim()===t?ev(t,this.options.parseTagValue,this.options.numberParseOptions):t}}c(J5,"parseTextData");function eV(t){if(this.options.removeNSPrefix){let e=t.split(":"),r=t.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(t=r+e[1])}return t}c(eV,"resolveNameSpace");var tV=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function rV(t,e,r){if(!this.options.ignoreAttributes&&typeof t=="string"){let n=RI.getAllMatches(t,tV),i=n.length,s={};for(let o=0;o<i;o++){let a=this.resolveNameSpace(n[o][1]),u=n[o][4],l=this.options.attributeNamePrefix+a;if(a.length)if(this.options.transformAttributeName&&(l=this.options.transformAttributeName(l)),l==="__proto__"&&(l="#__proto__"),u!==void 0){this.options.trimValues&&(u=u.trim()),u=this.replaceEntitiesValue(u);let f=this.options.attributeValueProcessor(a,u,e);f==null?s[l]=u:typeof f!=typeof u||f!==u?s[l]=f:s[l]=ev(u,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(s[l]=!0)}if(!Object.keys(s).length)return;if(this.options.attributesGroupName){let o={};return o[this.options.attributesGroupName]=s,o}return s}}c(rV,"buildAttributesMap");var nV=c(function(t){t=t.replace(/\r\n?/g,`
`);let e=new dc("!xml"),r=e,n="",i="";for(let s=0;s<t.length;s++)if(t[s]==="<")if(t[s+1]==="/"){let a=Bs(t,">",s,"Closing Tag is not closed."),u=t.substring(s+2,a).trim();if(this.options.removeNSPrefix){let h=u.indexOf(":");h!==-1&&(u=u.substr(h+1))}this.options.transformTagName&&(u=this.options.transformTagName(u)),r&&(n=this.saveTextToParentTag(n,r,i));let l=i.substring(i.lastIndexOf(".")+1);if(u&&this.options.unpairedTags.indexOf(u)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${u}>`);let f=0;l&&this.options.unpairedTags.indexOf(l)!==-1?(f=i.lastIndexOf(".",i.lastIndexOf(".")-1),this.tagsNodeStack.pop()):f=i.lastIndexOf("."),i=i.substring(0,f),r=this.tagsNodeStack.pop(),n="",s=a}else if(t[s+1]==="?"){let a=Jm(t,s,!1,"?>");if(!a)throw new Error("Pi Tag is not closed.");if(n=this.saveTextToParentTag(n,r,i),!(this.options.ignoreDeclaration&&a.tagName==="?xml"||this.options.ignorePiTags)){let u=new dc(a.tagName);u.add(this.options.textNodeName,""),a.tagName!==a.tagExp&&a.attrExpPresent&&(u[":@"]=this.buildAttributesMap(a.tagExp,i,a.tagName)),this.addChild(r,u,i)}s=a.closeIndex+1}else if(t.substr(s+1,3)==="!--"){let a=Bs(t,"-->",s+4,"Comment is not closed.");if(this.options.commentPropName){let u=t.substring(s+4,a-2);n=this.saveTextToParentTag(n,r,i),r.add(this.options.commentPropName,[{[this.options.textNodeName]:u}])}s=a}else if(t.substr(s+1,2)==="!D"){let a=Y5(t,s);this.docTypeEntities=a.entities,s=a.i}else if(t.substr(s+1,2)==="!["){let a=Bs(t,"]]>",s,"CDATA is not closed.")-2,u=t.substring(s+9,a);n=this.saveTextToParentTag(n,r,i);let l=this.parseTextData(u,r.tagname,i,!0,!1,!0,!0);l==null&&(l=""),this.options.cdataPropName?r.add(this.options.cdataPropName,[{[this.options.textNodeName]:u}]):r.add(this.options.textNodeName,l),s=a+2}else{let a=Jm(t,s,this.options.removeNSPrefix),u=a.tagName,l=a.rawTagName,f=a.tagExp,h=a.attrExpPresent,p=a.closeIndex;this.options.transformTagName&&(u=this.options.transformTagName(u)),r&&n&&r.tagname!=="!xml"&&(n=this.saveTextToParentTag(n,r,i,!1));let g=r;if(g&&this.options.unpairedTags.indexOf(g.tagname)!==-1&&(r=this.tagsNodeStack.pop(),i=i.substring(0,i.lastIndexOf("."))),u!==e.tagname&&(i+=i?"."+u:u),this.isItStopNode(this.options.stopNodes,i,u)){let d="";if(f.length>0&&f.lastIndexOf("/")===f.length-1)u[u.length-1]==="/"?(u=u.substr(0,u.length-1),i=i.substr(0,i.length-1),f=u):f=f.substr(0,f.length-1),s=a.closeIndex;else if(this.options.unpairedTags.indexOf(u)!==-1)s=a.closeIndex;else{let v=this.readStopNodeData(t,l,p+1);if(!v)throw new Error(`Unexpected end of ${l}`);s=v.i,d=v.tagContent}let y=new dc(u);u!==f&&h&&(y[":@"]=this.buildAttributesMap(f,i,u)),d&&(d=this.parseTextData(d,u,i,!0,h,!0,!0)),i=i.substr(0,i.lastIndexOf(".")),y.add(this.options.textNodeName,d),this.addChild(r,y,i)}else{if(f.length>0&&f.lastIndexOf("/")===f.length-1){u[u.length-1]==="/"?(u=u.substr(0,u.length-1),i=i.substr(0,i.length-1),f=u):f=f.substr(0,f.length-1),this.options.transformTagName&&(u=this.options.transformTagName(u));let d=new dc(u);u!==f&&h&&(d[":@"]=this.buildAttributesMap(f,i,u)),this.addChild(r,d,i),i=i.substr(0,i.lastIndexOf("."))}else{let d=new dc(u);this.tagsNodeStack.push(r),u!==f&&h&&(d[":@"]=this.buildAttributesMap(f,i,u)),this.addChild(r,d,i),r=d}n="",s=p}}else n+=t[s];return e.child},"parseXml");function iV(t,e,r){let n=this.options.updateTag(e.tagname,r,e[":@"]);n===!1||(typeof n=="string"&&(e.tagname=n),t.addChild(e))}c(iV,"addChild");var sV=c(function(t){if(this.options.processEntities){for(let e in this.docTypeEntities){let r=this.docTypeEntities[e];t=t.replace(r.regx,r.val)}for(let e in this.lastEntities){let r=this.lastEntities[e];t=t.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){let r=this.htmlEntities[e];t=t.replace(r.regex,r.val)}t=t.replace(this.ampEntity.regex,this.ampEntity.val)}return t},"replaceEntitiesValue");function oV(t,e,r,n){return t&&(n===void 0&&(n=Object.keys(e.child).length===0),t=this.parseTextData(t,e.tagname,r,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,n),t!==void 0&&t!==""&&e.add(this.options.textNodeName,t),t=""),t}c(oV,"saveTextToParentTag");function aV(t,e,r){let n="*."+r;for(let i in t){let s=t[i];if(n===s||e===s)return!0}return!1}c(aV,"isItStopNode");function cV(t,e,r=">"){let n,i="";for(let s=e;s<t.length;s++){let o=t[s];if(n)o===n&&(n="");else if(o==='"'||o==="'")n=o;else if(o===r[0])if(r[1]){if(t[s+1]===r[1])return{data:i,index:s}}else return{data:i,index:s};else o==="	"&&(o=" ");i+=o}}c(cV,"tagExpWithClosingIndex");function Bs(t,e,r,n){let i=t.indexOf(e,r);if(i===-1)throw new Error(n);return i+e.length-1}c(Bs,"findClosingIndex");function Jm(t,e,r,n=">"){let i=cV(t,e+1,n);if(!i)return;let s=i.data,o=i.index,a=s.search(/\s/),u=s,l=!0;a!==-1&&(u=s.substring(0,a),s=s.substring(a+1).trimStart());let f=u;if(r){let h=u.indexOf(":");h!==-1&&(u=u.substr(h+1),l=u!==i.data.substr(h+1))}return{tagName:u,tagExp:s,closeIndex:o,attrExpPresent:l,rawTagName:f}}c(Jm,"readTagExp");function uV(t,e,r){let n=r,i=1;for(;r<t.length;r++)if(t[r]==="<")if(t[r+1]==="/"){let s=Bs(t,">",r,`${e} is not closed`);if(t.substring(r+2,s).trim()===e&&(i--,i===0))return{tagContent:t.substring(n,r),i:s};r=s}else if(t[r+1]==="?")r=Bs(t,"?>",r+1,"StopNode is not closed.");else if(t.substr(r+1,3)==="!--")r=Bs(t,"-->",r+3,"StopNode is not closed.");else if(t.substr(r+1,2)==="![")r=Bs(t,"]]>",r,"StopNode is not closed.")-2;else{let s=Jm(t,r,">");s&&((s&&s.tagName)===e&&s.tagExp[s.tagExp.length-1]!=="/"&&i++,r=s.closeIndex)}}c(uV,"readStopNodeData");function ev(t,e,r){if(e&&typeof t=="string"){let n=t.trim();return n==="true"?!0:n==="false"?!1:Z5(t,r)}else return RI.isExist(t)?t:""}c(ev,"parseValue");OI.exports=Xm});var kI=_(PI=>{"use strict";function lV(t,e){return LI(t,e)}c(lV,"prettify");function LI(t,e,r){let n,i={};for(let s=0;s<t.length;s++){let o=t[s],a=fV(o),u="";if(r===void 0?u=a:u=r+"."+a,a===e.textNodeName)n===void 0?n=o[a]:n+=""+o[a];else{if(a===void 0)continue;if(o[a]){let l=LI(o[a],e,u),f=dV(l,e);o[":@"]?hV(l,o[":@"],u,e):Object.keys(l).length===1&&l[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?l=l[e.textNodeName]:Object.keys(l).length===0&&(e.alwaysCreateTextNode?l[e.textNodeName]="":l=""),i[a]!==void 0&&i.hasOwnProperty(a)?(Array.isArray(i[a])||(i[a]=[i[a]]),i[a].push(l)):e.isArray(a,u,f)?i[a]=[l]:i[a]=l}}}return typeof n=="string"?n.length>0&&(i[e.textNodeName]=n):n!==void 0&&(i[e.textNodeName]=n),i}c(LI,"compress");function fV(t){let e=Object.keys(t);for(let r=0;r<e.length;r++){let n=e[r];if(n!==":@")return n}}c(fV,"propName");function hV(t,e,r,n){if(e){let i=Object.keys(e),s=i.length;for(let o=0;o<s;o++){let a=i[o];n.isArray(a,r+"."+a,!0,!0)?t[a]=[e[a]]:t[a]=e[a]}}}c(hV,"assignAttributes");function dV(t,e){let{textNodeName:r}=e,n=Object.keys(t).length;return!!(n===0||n===1&&(t[r]||typeof t[r]=="boolean"||t[r]===0))}c(dV,"isLeafTag");PI.prettify=lV});var qI=_((mX,FI)=>{var{buildOptions:pV}=TI(),gV=DI(),{prettify:yV}=kI(),mV=Wm(),nv=class nv{constructor(e){this.externalEntities={},this.options=pV(e)}parse(e,r){if(typeof e!="string")if(e.toString)e=e.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(r){r===!0&&(r={});let s=mV.validate(e,r);if(s!==!0)throw Error(`${s.err.msg}:${s.err.line}:${s.err.col}`)}let n=new gV(this.options);n.addExternalEntities(this.externalEntities);let i=n.parseXml(e);return this.options.preserveOrder||i===void 0?i:yV(i,this.options)}addEntity(e,r){if(r.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(r==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=r}};c(nv,"XMLParser");var rv=nv;FI.exports=rv});var HI=_((EX,KI)=>{var vV=`
`;function EV(t,e){let r="";return e.format&&e.indentBy.length>0&&(r=vV),VI(t,e,"",r)}c(EV,"toXml");function VI(t,e,r,n){let i="",s=!1;for(let o=0;o<t.length;o++){let a=t[o],u=SV(a);if(u===void 0)continue;let l="";if(r.length===0?l=u:l=`${r}.${u}`,u===e.textNodeName){let d=a[u];CV(l,e)||(d=e.tagValueProcessor(u,d),d=MI(d,e)),s&&(i+=n),i+=d,s=!1;continue}else if(u===e.cdataPropName){s&&(i+=n),i+=`<![CDATA[${a[u][0][e.textNodeName]}]]>`,s=!1;continue}else if(u===e.commentPropName){i+=n+`<!--${a[u][0][e.textNodeName]}-->`,s=!0;continue}else if(u[0]==="?"){let d=UI(a[":@"],e),y=u==="?xml"?"":n,v=a[u][0][e.textNodeName];v=v.length!==0?" "+v:"",i+=y+`<${u}${v}${d}?>`,s=!0;continue}let f=n;f!==""&&(f+=e.indentBy);let h=UI(a[":@"],e),p=n+`<${u}${h}`,g=VI(a[u],e,l,f);e.unpairedTags.indexOf(u)!==-1?e.suppressUnpairedNode?i+=p+">":i+=p+"/>":(!g||g.length===0)&&e.suppressEmptyNode?i+=p+"/>":g&&g.endsWith(">")?i+=p+`>${g}${n}</${u}>`:(i+=p+">",g&&n!==""&&(g.includes("/>")||g.includes("</"))?i+=n+e.indentBy+g+n:i+=g,i+=`</${u}>`),s=!0}return i}c(VI,"arrToStr");function SV(t){let e=Object.keys(t);for(let r=0;r<e.length;r++){let n=e[r];if(t.hasOwnProperty(n)&&n!==":@")return n}}c(SV,"propName");function UI(t,e){let r="";if(t&&!e.ignoreAttributes)for(let n in t){if(!t.hasOwnProperty(n))continue;let i=e.attributeValueProcessor(n,t[n]);i=MI(i,e),i===!0&&e.suppressBooleanAttributes?r+=` ${n.substr(e.attributeNamePrefix.length)}`:r+=` ${n.substr(e.attributeNamePrefix.length)}="${i}"`}return r}c(UI,"attr_to_str");function CV(t,e){t=t.substr(0,t.length-e.textNodeName.length-1);let r=t.substr(t.lastIndexOf(".")+1);for(let n in e.stopNodes)if(e.stopNodes[n]===t||e.stopNodes[n]==="*."+r)return!0;return!1}c(CV,"isStopNode");function MI(t,e){if(t&&t.length>0&&e.processEntities)for(let r=0;r<e.entities.length;r++){let n=e.entities[r];t=t.replace(n.regex,n.val)}return t}c(MI,"replaceEntitiesValue");KI.exports=EV});var GI=_((CX,$I)=>{"use strict";var wV=HI(),xV={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Li(t){this.options=Object.assign({},xV,t),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=bV),this.processTextOrObjNode=TV,this.options.format?(this.indentate=_V,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}c(Li,"Builder");Li.prototype.build=function(t){return this.options.preserveOrder?wV(t,this.options):(Array.isArray(t)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(t={[this.options.arrayNodeName]:t}),this.j2x(t,0).val)};Li.prototype.j2x=function(t,e){let r="",n="";for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i))if(typeof t[i]>"u")this.isAttribute(i)&&(n+="");else if(t[i]===null)this.isAttribute(i)?n+="":i[0]==="?"?n+=this.indentate(e)+"<"+i+"?"+this.tagEndChar:n+=this.indentate(e)+"<"+i+"/"+this.tagEndChar;else if(t[i]instanceof Date)n+=this.buildTextValNode(t[i],i,"",e);else if(typeof t[i]!="object"){let s=this.isAttribute(i);if(s)r+=this.buildAttrPairStr(s,""+t[i]);else if(i===this.options.textNodeName){let o=this.options.tagValueProcessor(i,""+t[i]);n+=this.replaceEntitiesValue(o)}else n+=this.buildTextValNode(t[i],i,"",e)}else if(Array.isArray(t[i])){let s=t[i].length,o="",a="";for(let u=0;u<s;u++){let l=t[i][u];if(!(typeof l>"u"))if(l===null)i[0]==="?"?n+=this.indentate(e)+"<"+i+"?"+this.tagEndChar:n+=this.indentate(e)+"<"+i+"/"+this.tagEndChar;else if(typeof l=="object")if(this.options.oneListGroup){let f=this.j2x(l,e+1);o+=f.val,this.options.attributesGroupName&&l.hasOwnProperty(this.options.attributesGroupName)&&(a+=f.attrStr)}else o+=this.processTextOrObjNode(l,i,e);else if(this.options.oneListGroup){let f=this.options.tagValueProcessor(i,l);f=this.replaceEntitiesValue(f),o+=f}else o+=this.buildTextValNode(l,i,"",e)}this.options.oneListGroup&&(o=this.buildObjectNode(o,i,a,e)),n+=o}else if(this.options.attributesGroupName&&i===this.options.attributesGroupName){let s=Object.keys(t[i]),o=s.length;for(let a=0;a<o;a++)r+=this.buildAttrPairStr(s[a],""+t[i][s[a]])}else n+=this.processTextOrObjNode(t[i],i,e);return{attrStr:r,val:n}};Li.prototype.buildAttrPairStr=function(t,e){return e=this.options.attributeValueProcessor(t,""+e),e=this.replaceEntitiesValue(e),this.options.suppressBooleanAttributes&&e==="true"?" "+t:" "+t+'="'+e+'"'};function TV(t,e,r){let n=this.j2x(t,r+1);return t[this.options.textNodeName]!==void 0&&Object.keys(t).length===1?this.buildTextValNode(t[this.options.textNodeName],e,n.attrStr,r):this.buildObjectNode(n.val,e,n.attrStr,r)}c(TV,"processTextOrObjNode");Li.prototype.buildObjectNode=function(t,e,r,n){if(t==="")return e[0]==="?"?this.indentate(n)+"<"+e+r+"?"+this.tagEndChar:this.indentate(n)+"<"+e+r+this.closeTag(e)+this.tagEndChar;{let i="</"+e+this.tagEndChar,s="";return e[0]==="?"&&(s="?",i=""),(r||r==="")&&t.indexOf("<")===-1?this.indentate(n)+"<"+e+r+s+">"+t+i:this.options.commentPropName!==!1&&e===this.options.commentPropName&&s.length===0?this.indentate(n)+`<!--${t}-->`+this.newLine:this.indentate(n)+"<"+e+r+s+this.tagEndChar+t+this.indentate(n)+i}};Li.prototype.closeTag=function(t){let e="";return this.options.unpairedTags.indexOf(t)!==-1?this.options.suppressUnpairedNode||(e="/"):this.options.suppressEmptyNode?e="/":e=`></${t}`,e};Li.prototype.buildTextValNode=function(t,e,r,n){if(this.options.cdataPropName!==!1&&e===this.options.cdataPropName)return this.indentate(n)+`<![CDATA[${t}]]>`+this.newLine;if(this.options.commentPropName!==!1&&e===this.options.commentPropName)return this.indentate(n)+`<!--${t}-->`+this.newLine;if(e[0]==="?")return this.indentate(n)+"<"+e+r+"?"+this.tagEndChar;{let i=this.options.tagValueProcessor(e,t);return i=this.replaceEntitiesValue(i),i===""?this.indentate(n)+"<"+e+r+this.closeTag(e)+this.tagEndChar:this.indentate(n)+"<"+e+r+">"+i+"</"+e+this.tagEndChar}};Li.prototype.replaceEntitiesValue=function(t){if(t&&t.length>0&&this.options.processEntities)for(let e=0;e<this.options.entities.length;e++){let r=this.options.entities[e];t=t.replace(r.regex,r.val)}return t};function _V(t){return this.options.indentBy.repeat(t)}c(_V,"indentate");function bV(t){return t.startsWith(this.options.attributeNamePrefix)&&t!==this.options.textNodeName?t.substr(this.attrPrefixLen):!1}c(bV,"isAttribute");$I.exports=Li});var zI=_((xX,jI)=>{"use strict";var IV=Wm(),AV=qI(),NV=GI();jI.exports={XMLParser:AV,XMLValidator:IV,XMLBuilder:NV}});var QI=_((TX,WI)=>{"use strict";WI.exports=t=>{let e=c((a,u,l)=>{if(t.isUndefined(l))return u;if((l==null?void 0:l.type)!=="reference")return Array.isArray(u)&&l.items?((l==null?void 0:l.type)==="tuple"?n:r)(l.items,u):t.isPlainObject(u)?s(l.properties||{},u):u},"handleItem"),r=c((a,u)=>u.map(l=>e(a,l,a==null?void 0:a[0])).filter(l=>!t.isBoolean(l)&&!t.isEmpty(l)),"handleItems"),n=c((a,u)=>{let l=u.map((f,h)=>e(a,f,a==null?void 0:a[h]));return l.some(f=>f===void 0)?[]:l},"handleTuple"),i=c(({properties:a,records:u})=>Object.entries(a).reduce((l,[f,h])=>({...l,[f]:s(h==null?void 0:h.properties,u==null?void 0:u[f])}),{}),"handleMap"),s=c((a,u)=>t.isPlainObject(u)?Object.entries(u).reduce((l,[f,h])=>{let p=a==null?void 0:a[f],g=p==null?void 0:p.type;return(g==="list"||g==="set")&&p.items?{...l,[f]:r(p.items,h)}:g==="tuple"&&p.items?{...l,[f]:n(p.items,h)}:g==="map"&&p.properties?{...l,[f]:i({properties:p.properties,records:h})}:{...l,[f]:h}},{}):u,"filterUdt");return{filterUdts:c((a,u)=>u.map(l=>s(a,l)),"filterUdts")}}});var ZI=_((bX,YI)=>{var BV=require("crypto"),sv=class sv{constructor(e){this.hash=this.getPreKeyedHash(e),this.password=e}update(e){this.hash.update(e)}digest(){return this.hash.digest()}getPreKeyedHash(e){let r=BV.createHash("sha1"),n=Buffer.alloc(e.length*2);for(let i=0,s=0;i<e.length;i++)n[s++]=e[i].charCodeAt()>>8,n[s++]=e[i].charCodeAt();return r.update(n),r.update(Buffer.from("Mighty Aphrodite")),r}};c(sv,"PasswordDigest");var iv=sv;YI.exports=iv});var Io=_((AX,XI)=>{var RV=c((t,e,r)=>Uint8Array.prototype.slice?Uint8Array.prototype.slice.call(t,e,r):t.slice(e,r),"sliceBuffer");XI.exports=RV});var tA=_((BX,eA)=>{var ov=4294967296,JI=[];for(Ao=0;Ao<256;Ao++)JI[Ao]=(Ao>15?"":"0")+Ao.toString(16);var Ao,pc=eA.exports=function(t,e){t instanceof Buffer?(this.buffer=t,this.offset=e||0):Object.prototype.toString.call(t)=="[object Uint8Array]"?(this.buffer=new Buffer(t),this.offset=e||0):(this.buffer=this.buffer||new Buffer(8),this.offset=0,this.setValue.apply(this,arguments))};pc.MAX_INT=Math.pow(2,53);pc.MIN_INT=-Math.pow(2,53);pc.prototype={constructor:pc,_2scomp:function(){for(var t=this.buffer,e=this.offset,r=1,n=e+7;n>=e;n--){var i=(t[n]^255)+r;t[n]=i&255,r=i>>8}},setValue:function(t,e){var r=!1;if(arguments.length==1)if(typeof t=="number"){if(r=t<0,t=Math.abs(t),e=t%ov,t=t/ov,t>ov)throw new RangeError(t+" is outside Int64 range");t=t|0}else if(typeof t=="string")t=(t+"").replace(/^0x/,""),e=t.substr(-8),t=t.length>8?t.substr(0,t.length-8):"",t=parseInt(t,16),e=parseInt(e,16);else throw new Error(t+" must be a Number or String");for(var n=this.buffer,i=this.offset,s=7;s>=0;s--)n[i+s]=e&255,e=s==4?t:e>>>8;r&&this._2scomp()},toNumber:function(t){for(var e=this.buffer,r=this.offset,n=e[r]&128,i=0,s=1,o=7,a=1;o>=0;o--,a*=256){var u=e[r+o];n&&(u=(u^255)+s,s=u>>8,u=u&255),i+=u*a}return!t&&i>=pc.MAX_INT?n?-1/0:1/0:n?-i:i},valueOf:function(){return this.toNumber(!1)},toString:function(t){return this.valueOf().toString(t||10)},toOctetString:function(t){for(var e=new Array(8),r=this.buffer,n=this.offset,i=0;i<8;i++)e[i]=JI[r[n+i]];return e.join(t||"")},toBuffer:function(t){if(t&&this.offset===0)return this.buffer;var e=new Buffer(8);return this.buffer.copy(e,0,this.offset,this.offset+8),e},copy:function(t,e){this.buffer.copy(t,e||0,this.offset,this.offset+8)},compare:function(t){if((this.buffer[this.offset]&128)!=(t.buffer[t.offset]&128))return t.buffer[t.offset]-this.buffer[this.offset];for(var e=0;e<8;e++)if(this.buffer[this.offset+e]!==t.buffer[t.offset+e])return this.buffer[this.offset+e]-t.buffer[t.offset+e];return 0},equals:function(t){return this.compare(t)===0},inspect:function(){return"[Int64 value:"+this+" octets:"+this.toOctetString(" ")+"]"}}});var Rs=_((RX,rA)=>{var OV=tA(),LV=Io(),cv=class cv{constructor(e){this.buffer=Buffer.from(e),this.offset=0}readInt(){return this.buffer.readUInt32BE(this.shift(4))}readUTF(){let e=this.buffer.readUInt16BE(this.shift(2));return this.read(e).toString()}read(e){return LV(this.buffer,this.offset,this.shift(e)+e)}readLong(){let e=this.read(8);return typeof e.readBigUInt64BE=="function"?e.readBigUInt64BE():+new OV(e).toString()}readByte(){return this.buffer.readUInt8(this.shift(1))}readShort(){return this.read(2).readUInt16BE()}shift(e){let r=this.offset;return this.offset+=e,r}available(){return this.buffer.length-this.offset}};c(cv,"InputStream");var av=cv;rA.exports=av});var iA=_((DX,nA)=>{var PV=Io(),kV=Rs(),lv=class lv extends kV{constructor(e,r){super(e),this.digest=r}readInt(){return this.updateDigest(4),super.readInt()}readUTF(){return this.updateDigest(2),super.readUTF()}read(e){return this.updateDigest(e),super.read(e)}readLong(){return super.readLong()}readByte(){return this.updateDigest(1),super.readByte()}updateDigest(e){this.digest.update(PV(this.buffer,this.offset,this.offset+e))}};c(lv,"DigestInputStream");var uv=lv;nA.exports=uv});var oA=_((PX,sA)=>{var hv=class hv{constructor({certType:e,value:r}){this.certType=e,this.value=r}};c(hv,"Certificate");var fv=hv;sA.exports=fv});var gv=_((FX,aA)=>{var pv=class pv{constructor({alias:e,date:r,chain:n,protectedPrivateKey:i}){this.certType="X.509",this.alias=e,this.date=r,this.chain=n,this.protectedPrivateKey=i}};c(pv,"KeyEntry");var dv=pv;aA.exports=dv});var vv=_((UX,cA)=>{var mv=class mv{constructor({alias:e,date:r,cert:n}){this.certType="X.509",this.alias=e,this.date=r,this.cert=n}};c(mv,"TrustedKeyEntry");var yv=mv;cA.exports=yv});var lA=_((MX,uA)=>{var FV=ZI(),qV=iA(),UV=Rs(),VV=oA(),MV=gv(),KV=vv(),HV=Io(),ci=class ci{constructor(e,r){this.keystore=e,this.password=r,r?(this.messageDigest=new FV(r),this.dataInputStream=new qV(e,this.messageDigest)):this.dataInputStream=new UV(e)}assertMagic(e){if(e!==ci.MAGIC)throw new Error("Invalid keystore format")}assertVersion(e){if(e!==ci.VERSION_1&&e!==ci.VERSION_2)throw new Error("Invalid keystore format")}parse(){let e=this.dataInputStream.readInt(),r=this.dataInputStream.readInt();this.assertMagic(e),this.assertVersion(r);let n=this.dataInputStream.readInt(),i=[];for(let s=0;s<n;s++){let o=this.dataInputStream.readInt(),a=this.dataInputStream.readUTF(),u=new Date(+this.dataInputStream.readLong().toString());if(o===ci.PRIVATE_KEY_TAG){let l=this.getPrivateKeyEntry(),f=this.readCertificateChain(r),h=new MV({alias:a,date:u,chain:f,protectedPrivateKey:l});i.push(h)}else if(o===ci.TRUSTED_CERT_TAG){let l=this.readCert(r),f=new KV({alias:a,date:u,cert:l});i.push(f)}else throw new Error("Unrecognized keystore entry")}return this.validateChecksum(),i}validateChecksum(){if(!this.password)return;let e=this.messageDigest.digest(),r=HV(this.dataInputStream.buffer,this.dataInputStream.offset,this.dataInputStream.offset+e.length);if(!e.every((i,s)=>r[s]===i))throw new Error("Password verification failed")}getPrivateKeyEntry(){return this.dataInputStream.read(this.dataInputStream.readInt())}readCert(e){let r="X.509";e===ci.VERSION_2&&(r=this.dataInputStream.readUTF());let n=this.dataInputStream.read(this.dataInputStream.readInt());return new VV({certType:r,value:n})}readCertificateChain(e){let r=this.dataInputStream.readInt(),n=[];for(let i=0;i<r;i++)n.push(this.readCert(e));return n}};c(ci,"JavaKeyStoreParser");var Pi=ci;Pi.MAGIC=4277010157;Pi.VERSION_1=1;Pi.VERSION_2=2;Pi.PRIVATE_KEY_TAG=1;Pi.TRUSTED_CERT_TAG=2;uA.exports=Pi});var ve=_((HX,fA)=>{fA.exports={options:{usePureJavaScript:!1}}});var pA=_(($X,dA)=>{var Ev={};dA.exports=Ev;var hA={};Ev.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=$V(t,e);else{var i=0,s=e.length,o=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var u=0,l=t[i];u<a.length;++u)l+=a[u]<<8,a[u]=l%s,l=l/s|0;for(;l>0;)a.push(l%s),l=l/s|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var f=new RegExp(".{1,"+r+"}","g");n=n.match(f).join(`\r
`)}return n};Ev.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=hA[e];if(!r){r=hA[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,s=e.charAt(0),o=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var u=0,l=a;u<o.length;++u)l+=o[u]*i,o[u]=l&255,l>>=8;for(;l>0;)o.push(l&255),l>>=8}for(var f=0;t[f]===s&&f<t.length-1;++f)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function $V(t,e){var r=0,n=e.length,i=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var u="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)u+=i;for(r=s.length-1;r>=0;--r)u+=e[s[r]];return u}c($V,"_encodeWithByteBuffer")});var qe=_((jX,vA)=>{var gA=ve(),yA=pA(),B=vA.exports=gA.util=gA.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){B.nextTick=process.nextTick,typeof setImmediate=="function"?B.setImmediate=setImmediate:B.setImmediate=B.nextTick;return}if(typeof setImmediate=="function"){B.setImmediate=function(){return setImmediate.apply(void 0,arguments)},B.nextTick=function(a){return setImmediate(a)};return}if(B.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(u){if(u.source===window&&u.data===t){u.stopPropagation();var l=e.slice();e.length=0,l.forEach(function(f){f()})}};var o=a;c(a,"handler");var t="forge.setImmediate",e=[];B.setImmediate=function(u){e.push(u),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var u=e.slice();e.length=0,u.forEach(function(l){l()})}).observe(i,{attributes:!0});var s=B.setImmediate;B.setImmediate=function(u){Date.now()-r>15?(r=Date.now(),s(u)):(e.push(u),e.length===1&&i.setAttribute("a",n=!n))}}B.nextTick=B.setImmediate})();B.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;B.globalScope=function(){return B.isNodejs?global:typeof self>"u"?window:self}();B.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};B.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};B.isArrayBufferView=function(t){return t&&B.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function gc(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}c(gc,"_checkBitsParam");B.ByteBuffer=Sv;function Sv(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(B.isArrayBuffer(t)||B.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Sv||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}c(Sv,"ByteStringBuffer");B.ByteStringBuffer=Sv;var GV=4096;B.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>GV&&(this.data.substr(0,1),this._constructedStringLength=0)};B.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};B.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};B.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};B.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};B.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};B.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(B.encodeUtf8(t))};B.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};B.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};B.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};B.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};B.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};B.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};B.ByteStringBuffer.prototype.putInt=function(t,e){gc(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};B.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};B.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};B.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};B.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};B.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};B.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};B.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};B.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};B.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};B.ByteStringBuffer.prototype.getInt=function(t){gc(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};B.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};B.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};B.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};B.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};B.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};B.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};B.ByteStringBuffer.prototype.copy=function(){var t=B.createBuffer(this.data);return t.read=this.read,t};B.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};B.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};B.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};B.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};B.ByteStringBuffer.prototype.toString=function(){return B.decodeUtf8(this.bytes())};function jV(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=B.isArrayBuffer(t),n=B.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}c(jV,"DataBuffer");B.DataBuffer=jV;B.DataBuffer.prototype.length=function(){return this.write-this.read};B.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};B.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};B.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};B.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};B.DataBuffer.prototype.putBytes=function(t,e){if(B.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(B.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof B.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&B.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof B.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=B.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=B.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=B.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=B.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=B.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};B.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};B.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};B.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};B.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};B.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};B.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};B.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};B.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};B.DataBuffer.prototype.putInt=function(t,e){gc(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};B.DataBuffer.prototype.putSignedInt=function(t,e){return gc(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};B.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};B.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};B.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};B.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};B.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};B.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};B.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};B.DataBuffer.prototype.getInt=function(t){gc(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};B.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};B.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};B.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};B.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};B.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};B.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};B.DataBuffer.prototype.copy=function(){return new B.DataBuffer(this)};B.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};B.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};B.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};B.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};B.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return B.binary.raw.encode(e);if(t==="hex")return B.binary.hex.encode(e);if(t==="base64")return B.binary.base64.encode(e);if(t==="utf8")return B.text.utf8.decode(e);if(t==="utf16")return B.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};B.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=B.encodeUtf8(t)),new B.ByteBuffer(t)};B.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};B.xorBytes=function(t,e,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};B.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};B.bytesToHex=function(t){return B.createBuffer(t).toHex()};B.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var ki="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Fi=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],mA="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";B.encode64=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.length;)i=t.charCodeAt(a++),s=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=ki.charAt(i>>2),r+=ki.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=ki.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":ki.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};B.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,s,o=0;o<t.length;)r=Fi[t.charCodeAt(o++)-43],n=Fi[t.charCodeAt(o++)-43],i=Fi[t.charCodeAt(o++)-43],s=Fi[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(e+=String.fromCharCode((i&3)<<6|s)));return e};B.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};B.decodeUtf8=function(t){return decodeURIComponent(escape(t))};B.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:yA.encode,decode:yA.decode}};B.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};B.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};B.binary.hex.encode=B.bytesToHex;B.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,s=r;for(t.length&1&&(i=1,n[s++]=parseInt(t[0],16));i<t.length;i+=2)n[s++]=parseInt(t.substr(i,2),16);return e?s-r:n};B.binary.base64.encode=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.byteLength;)i=t[a++],s=t[a++],o=t[a++],r+=ki.charAt(i>>2),r+=ki.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=ki.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":ki.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};B.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,u=0,l=r;u<t.length;)i=Fi[t.charCodeAt(u++)-43],s=Fi[t.charCodeAt(u++)-43],o=Fi[t.charCodeAt(u++)-43],a=Fi[t.charCodeAt(u++)-43],n[l++]=i<<2|s>>4,o!==64&&(n[l++]=(s&15)<<4|o>>2,a!==64&&(n[l++]=(o&3)<<6|a));return e?l-r:n.subarray(0,l)};B.binary.base58.encode=function(t,e){return B.binary.baseN.encode(t,mA,e)};B.binary.base58.decode=function(t,e){return B.binary.baseN.decode(t,mA,e)};B.text={utf8:{},utf16:{}};B.text.utf8.encode=function(t,e,r){t=B.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};B.text.utf8.decode=function(t){return B.decodeUtf8(String.fromCharCode.apply(null,t))};B.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<t.length;++a)i[o++]=t.charCodeAt(a),s+=2;return e?s-r:n};B.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};B.deflate=function(t,e,r){if(e=B.decode64(t.deflate(B.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};B.inflate=function(t,e,r){var n=t.inflate(B.encode64(e)).rval;return n===null?null:B.decode64(n)};var Cv=c(function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=B.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},"_setStorageObject"),wv=c(function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(B.decode64(r))),r},"_getStorageObject"),zV=c(function(t,e,r,n){var i=wv(t,e);i===null&&(i={}),i[r]=n,Cv(t,e,i)},"_setItem"),WV=c(function(t,e,r){var n=wv(t,e);return n!==null&&(n=r in n?n[r]:null),n},"_getItem"),QV=c(function(t,e,r){var n=wv(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),Cv(t,e,n)}},"_removeItem"),YV=c(function(t,e){Cv(t,e,null)},"_clearItems"),Pl=c(function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(u){o=u}if(s)break}if(!s)throw o;return n},"_callStorageFunction");B.setItem=function(t,e,r,n,i){Pl(zV,arguments,i)};B.getItem=function(t,e,r,n){return Pl(WV,arguments,n)};B.removeItem=function(t,e,r,n){Pl(QV,arguments,n)};B.clearItems=function(t,e,r){Pl(YV,arguments,r)};B.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};B.format=function(t){for(var e=/%./g,r,n,i=0,s=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&s.push(n),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(t.substring(o)),s.join("")};B.formatNumber=function(t,e,r,n){var i=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=n===void 0?".":n,u=i<0?"-":"",l=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",f=l.length>3?l.length%3:0;return u+(f?l.substr(0,f)+a:"")+l.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-l).toFixed(s).slice(2):"")};B.formatSize=function(t){return t>=1073741824?t=B.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=B.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=B.formatNumber(t/1024,0)+" KiB":t=B.formatNumber(t,0)+" bytes",t};B.bytesFromIP=function(t){return t.indexOf(".")!==-1?B.bytesFromIPv4(t):t.indexOf(":")!==-1?B.bytesFromIPv6(t):null};B.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=B.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};B.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=B.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=B.hexToBytes(t[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};B.bytesToIP=function(t){return t.length===4?B.bytesToIPv4(t):t.length===16?B.bytesToIPv6(t):null};B.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};B.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var s=B.bytesToHex(t[i]+t[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var u=r[n];u.end-u.start>0&&(e.splice(u.start,u.end-u.start+1,""),u.start===0&&e.unshift(""),u.end===7&&e.push(""))}return e.join(":")};B.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in B&&!t.update)return e(null,B.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return B.cores=navigator.hardwareConcurrency,e(null,B.cores);if(typeof Worker>"u")return B.cores=1,e(null,B.cores);if(typeof Blob>"u")return B.cores=2,e(null,B.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),u=a+4;Date.now()<u;);self.postMessage({st:a,et:u})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,u){if(a===0){var l=Math.floor(o.reduce(function(f,h){return f+h},0)/o.length);return B.cores=Math.max(1,l),URL.revokeObjectURL(r),e(null,B.cores)}i(u,function(f,h){o.push(s(u,h)),n(o,a-1,u)})}c(n,"sample");function i(o,a){for(var u=[],l=[],f=0;f<o;++f){var h=new Worker(r);h.addEventListener("message",function(p){if(l.push(p.data),l.length===o){for(var g=0;g<o;++g)u[g].terminate();a(null,l)}}),u.push(h)}for(var f=0;f<o;++f)u[f].postMessage(f)}c(i,"map");function s(o,a){for(var u=[],l=0;l<o;++l)for(var f=a[l],h=u[l]=[],p=0;p<o;++p)if(l!==p){var g=a[p];(f.st>g.st&&f.st<g.et||g.st>f.st&&g.st<f.et)&&h.push(p)}return u.reduce(function(d,y){return Math.max(d,y.length)},0)}c(s,"reduce")}});var kl=_((WX,EA)=>{var Gt=ve();qe();EA.exports=Gt.cipher=Gt.cipher||{};Gt.cipher.algorithms=Gt.cipher.algorithms||{};Gt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Gt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Gt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Gt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Gt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Gt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Gt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Gt.cipher.algorithms[t]=e};Gt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Gt.cipher.algorithms?Gt.cipher.algorithms[t]:null};var xv=Gt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};xv.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Gt.util.createBuffer(),this.output=t.output||Gt.util.createBuffer(),this.mode.start(e)};xv.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};xv.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var _v=_((QX,SA)=>{var jt=ve();qe();jt.cipher=jt.cipher||{};var _e=SA.exports=jt.cipher.modes=jt.cipher.modes||{};_e.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};_e.ecb.prototype.start=function(t){};_e.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};_e.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};_e.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};_e.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};_e.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};_e.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Fl(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};_e.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};_e.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};_e.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};_e.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};_e.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=jt.util.createBuffer(),this._partialBytes=0};_e.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Fl(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};_e.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};_e.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};_e.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=jt.util.createBuffer(),this._partialBytes=0};_e.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Fl(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};_e.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};_e.ofb.prototype.decrypt=_e.ofb.prototype.encrypt;_e.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=jt.util.createBuffer(),this._partialBytes=0};_e.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Fl(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};_e.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}ql(this._inBlock)};_e.ctr.prototype.decrypt=_e.ctr.prototype.encrypt;_e.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=jt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};_e.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=jt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=jt.util.createBuffer(t.additionalData):r=jt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=jt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Tv(n*8)))}this._inBlock=this._j0.slice(0),ql(this._inBlock),this._partialBytes=0,r=jt.util.createBuffer(r),this._aDataLength=Tv(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};_e.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),ql(this._inBlock)};_e.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),ql(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};_e.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=jt.util.createBuffer();var n=this._aDataLength.concat(Tv(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};_e.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var s=t[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};_e.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};_e.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,s=this._m[r][i];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};_e.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};_e.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],u=o/n|0,l=(n-1-o%n)*e;a[u]=1<<e-1<<l,s[o]=this.generateSubHashTable(this.multiply(a,t),e)}return s};_e.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],u=i[o];i[s+o]=[a[0]^u[0],a[1]^u[1],a[2]^u[2],a[3]^u[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var l=i[s^n];i[s]=[t[0]^l[0],t[1]^l[1],t[2]^l[2],t[3]^l[3]]}return i};function Fl(t,e){if(typeof t=="string"&&(t=jt.util.createBuffer(t)),jt.util.isArray(t)&&t.length>4){var r=t;t=jt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!jt.util.isArray(t)){for(var i=[],s=e/4,n=0;n<s;++n)i.push(t.getInt32());t=i}return t}c(Fl,"transformIV");function ql(t){t[t.length-1]=t[t.length-1]+1&4294967295}c(ql,"inc32");function Tv(t){return[t/4294967296|0,t&4294967295]}c(Tv,"from64To32")});var qi=_((ZX,TA)=>{var et=ve();kl();_v();qe();TA.exports=et.aes=et.aes||{};et.aes.startEncrypting=function(t,e,r,n){var i=Ul({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};et.aes.createEncryptionCipher=function(t,e){return Ul({key:t,output:null,decrypt:!1,mode:e})};et.aes.startDecrypting=function(t,e,r,n){var i=Ul({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};et.aes.createDecryptionCipher=function(t,e){return Ul({key:t,output:null,decrypt:!0,mode:e})};et.aes.Algorithm=function(t,e){Av||wA();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return Iv(r._w,n,i,!1)},decrypt:function(n,i){return Iv(r._w,n,i,!0)}}}),r._init=!1};et.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=et.util.createBuffer(e);else if(et.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=et.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!et.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!et.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=xA(e,t.decrypt&&!o),this._init=!0}};et.aes._expandKey=function(t,e){return Av||wA(),xA(t,e)};et.aes._updateBlock=Iv;Bo("AES-ECB",et.cipher.modes.ecb);Bo("AES-CBC",et.cipher.modes.cbc);Bo("AES-CFB",et.cipher.modes.cfb);Bo("AES-OFB",et.cipher.modes.ofb);Bo("AES-CTR",et.cipher.modes.ctr);Bo("AES-GCM",et.cipher.modes.gcm);function Bo(t,e){var r=c(function(){return new et.aes.Algorithm(t,e)},"factory");et.cipher.registerAlgorithm(t,r)}c(Bo,"registerAlgorithm");var Av=!1,No=4,vr,bv,CA,Os,Tn;function wA(){Av=!0,CA=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;vr=new Array(256),bv=new Array(256),Os=new Array(4),Tn=new Array(4);for(var e=0;e<4;++e)Os[e]=new Array(256),Tn[e]=new Array(256);for(var r=0,n=0,i,s,o,a,u,l,f,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,vr[r]=a,bv[a]=r,u=t[a],i=t[r],s=t[i],o=t[s],l=u<<24^a<<16^a<<8^(a^u),f=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var h=0;h<4;++h)Os[h][r]=l,Tn[h][a]=f,l=l<<24|l>>>8,f=f<<24|f>>>8;r===0?r=n=1:(r=i^t[t[t[i^o]]],n^=t[t[n]])}}c(wA,"initialize");function xA(t,e){for(var r=t.slice(0),n,i=1,s=r.length,o=s+6+1,a=No*o,u=s;u<a;++u)n=r[u-1],u%s===0?(n=vr[n>>>16&255]<<24^vr[n>>>8&255]<<16^vr[n&255]<<8^vr[n>>>24]^CA[i]<<24,i++):s>6&&u%s===4&&(n=vr[n>>>24]<<24^vr[n>>>16&255]<<16^vr[n>>>8&255]<<8^vr[n&255]),r[u]=r[u-s]^n;if(e){var l,f=Tn[0],h=Tn[1],p=Tn[2],g=Tn[3],d=r.slice(0);a=r.length;for(var u=0,y=a-No;u<a;u+=No,y-=No)if(u===0||u===a-No)d[u]=r[y],d[u+1]=r[y+3],d[u+2]=r[y+2],d[u+3]=r[y+1];else for(var v=0;v<No;++v)l=r[y+v],d[u+(3&-v)]=f[vr[l>>>24]]^h[vr[l>>>16&255]]^p[vr[l>>>8&255]]^g[vr[l&255]];r=d}return r}c(xA,"_expandKey");function Iv(t,e,r,n){var i=t.length/4-1,s,o,a,u,l;n?(s=Tn[0],o=Tn[1],a=Tn[2],u=Tn[3],l=bv):(s=Os[0],o=Os[1],a=Os[2],u=Os[3],l=vr);var f,h,p,g,d,y,v;f=e[0]^t[0],h=e[n?3:1]^t[1],p=e[2]^t[2],g=e[n?1:3]^t[3];for(var m=3,w=1;w<i;++w)d=s[f>>>24]^o[h>>>16&255]^a[p>>>8&255]^u[g&255]^t[++m],y=s[h>>>24]^o[p>>>16&255]^a[g>>>8&255]^u[f&255]^t[++m],v=s[p>>>24]^o[g>>>16&255]^a[f>>>8&255]^u[h&255]^t[++m],g=s[g>>>24]^o[f>>>16&255]^a[h>>>8&255]^u[p&255]^t[++m],f=d,h=y,p=v;r[0]=l[f>>>24]<<24^l[h>>>16&255]<<16^l[p>>>8&255]<<8^l[g&255]^t[++m],r[n?3:1]=l[h>>>24]<<24^l[p>>>16&255]<<16^l[g>>>8&255]<<8^l[f&255]^t[++m],r[2]=l[p>>>24]<<24^l[g>>>16&255]<<16^l[f>>>8&255]<<8^l[h&255]^t[++m],r[n?1:3]=l[g>>>24]<<24^l[f>>>16&255]<<16^l[h>>>8&255]<<8^l[p&255]^t[++m]}c(Iv,"_updateBlock");function Ul(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=et.cipher.createDecipher(r,t.key):n=et.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof et.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}c(Ul,"_createCipher")});var Ui=_((JX,_A)=>{var yc=ve();yc.pki=yc.pki||{};var Nv=_A.exports=yc.pki.oids=yc.oids=yc.oids||{};function z(t,e){Nv[t]=e,Nv[e]=t}c(z,"_IN");function Ge(t,e){Nv[t]=e}c(Ge,"_I_");z("1.2.840.113549.1.1.1","rsaEncryption");z("1.2.840.113549.1.1.4","md5WithRSAEncryption");z("1.2.840.113549.1.1.5","sha1WithRSAEncryption");z("1.2.840.113549.1.1.7","RSAES-OAEP");z("1.2.840.113549.1.1.8","mgf1");z("1.2.840.113549.1.1.9","pSpecified");z("1.2.840.113549.1.1.10","RSASSA-PSS");z("1.2.840.113549.1.1.11","sha256WithRSAEncryption");z("1.2.840.113549.1.1.12","sha384WithRSAEncryption");z("1.2.840.113549.1.1.13","sha512WithRSAEncryption");z("1.3.101.112","EdDSA25519");z("1.2.840.10040.4.3","dsa-with-sha1");z("1.3.14.3.2.7","desCBC");z("1.3.14.3.2.26","sha1");z("1.3.14.3.2.29","sha1WithRSASignature");z("2.16.840.1.101.3.4.2.1","sha256");z("2.16.840.1.101.3.4.2.2","sha384");z("2.16.840.1.101.3.4.2.3","sha512");z("2.16.840.1.101.3.4.2.4","sha224");z("2.16.840.1.101.3.4.2.5","sha512-224");z("2.16.840.1.101.3.4.2.6","sha512-256");z("1.2.840.113549.2.2","md2");z("1.2.840.113549.2.5","md5");z("1.2.840.113549.1.7.1","data");z("1.2.840.113549.1.7.2","signedData");z("1.2.840.113549.1.7.3","envelopedData");z("1.2.840.113549.1.7.4","signedAndEnvelopedData");z("1.2.840.113549.1.7.5","digestedData");z("1.2.840.113549.1.7.6","encryptedData");z("1.2.840.113549.1.9.1","emailAddress");z("1.2.840.113549.1.9.2","unstructuredName");z("1.2.840.113549.1.9.3","contentType");z("1.2.840.113549.1.9.4","messageDigest");z("1.2.840.113549.1.9.5","signingTime");z("1.2.840.113549.1.9.6","counterSignature");z("1.2.840.113549.1.9.7","challengePassword");z("1.2.840.113549.1.9.8","unstructuredAddress");z("1.2.840.113549.1.9.14","extensionRequest");z("1.2.840.113549.1.9.20","friendlyName");z("1.2.840.113549.1.9.21","localKeyId");z("1.2.840.113549.1.9.22.1","x509Certificate");z("1.2.840.113549.1.12.10.1.1","keyBag");z("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");z("1.2.840.113549.1.12.10.1.3","certBag");z("1.2.840.113549.1.12.10.1.4","crlBag");z("1.2.840.113549.1.12.10.1.5","secretBag");z("1.2.840.113549.1.12.10.1.6","safeContentsBag");z("1.2.840.113549.1.5.13","pkcs5PBES2");z("1.2.840.113549.1.5.12","pkcs5PBKDF2");z("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");z("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");z("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");z("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");z("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");z("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");z("1.2.840.113549.2.7","hmacWithSHA1");z("1.2.840.113549.2.8","hmacWithSHA224");z("1.2.840.113549.2.9","hmacWithSHA256");z("1.2.840.113549.2.10","hmacWithSHA384");z("1.2.840.113549.2.11","hmacWithSHA512");z("1.2.840.113549.3.7","des-EDE3-CBC");z("2.16.840.1.101.3.4.1.2","aes128-CBC");z("2.16.840.1.101.3.4.1.22","aes192-CBC");z("2.16.840.1.101.3.4.1.42","aes256-CBC");z("2.5.4.3","commonName");z("2.5.4.4","surname");z("2.5.4.5","serialNumber");z("2.5.4.6","countryName");z("2.5.4.7","localityName");z("2.5.4.8","stateOrProvinceName");z("2.5.4.9","streetAddress");z("2.5.4.10","organizationName");z("2.5.4.11","organizationalUnitName");z("2.5.4.12","title");z("2.5.4.13","description");z("2.5.4.15","businessCategory");z("2.5.4.17","postalCode");z("2.5.4.42","givenName");z("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");z("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");z("2.16.840.1.113730.1.1","nsCertType");z("2.16.840.1.113730.1.13","nsComment");Ge("2.5.29.1","authorityKeyIdentifier");Ge("2.5.29.2","keyAttributes");Ge("2.5.29.3","certificatePolicies");Ge("2.5.29.4","keyUsageRestriction");Ge("2.5.29.5","policyMapping");Ge("2.5.29.6","subtreesConstraint");Ge("2.5.29.7","subjectAltName");Ge("2.5.29.8","issuerAltName");Ge("2.5.29.9","subjectDirectoryAttributes");Ge("2.5.29.10","basicConstraints");Ge("2.5.29.11","nameConstraints");Ge("2.5.29.12","policyConstraints");Ge("2.5.29.13","basicConstraints");z("2.5.29.14","subjectKeyIdentifier");z("2.5.29.15","keyUsage");Ge("2.5.29.16","privateKeyUsagePeriod");z("2.5.29.17","subjectAltName");z("2.5.29.18","issuerAltName");z("2.5.29.19","basicConstraints");Ge("2.5.29.20","cRLNumber");Ge("2.5.29.21","cRLReason");Ge("2.5.29.22","expirationDate");Ge("2.5.29.23","instructionCode");Ge("2.5.29.24","invalidityDate");Ge("2.5.29.25","cRLDistributionPoints");Ge("2.5.29.26","issuingDistributionPoint");Ge("2.5.29.27","deltaCRLIndicator");Ge("2.5.29.28","issuingDistributionPoint");Ge("2.5.29.29","certificateIssuer");Ge("2.5.29.30","nameConstraints");z("2.5.29.31","cRLDistributionPoints");z("2.5.29.32","certificatePolicies");Ge("2.5.29.33","policyMappings");Ge("2.5.29.34","policyConstraints");z("2.5.29.35","authorityKeyIdentifier");Ge("2.5.29.36","policyConstraints");z("2.5.29.37","extKeyUsage");Ge("2.5.29.46","freshestCRL");Ge("2.5.29.54","inhibitAnyPolicy");z("1.3.6.1.4.1.11129.2.4.2","timestampList");z("1.3.6.1.5.5.7.1.1","authorityInfoAccess");z("1.3.6.1.5.5.7.3.1","serverAuth");z("1.3.6.1.5.5.7.3.2","clientAuth");z("1.3.6.1.5.5.7.3.3","codeSigning");z("1.3.6.1.5.5.7.3.4","emailProtection");z("1.3.6.1.5.5.7.3.8","timeStamping")});var _n=_((tJ,IA)=>{var ot=ve();qe();Ui();var ee=IA.exports=ot.asn1=ot.asn1||{};ee.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};ee.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};ee.create=function(t,e,r,n,i){if(ot.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:t,type:e,constructed:r,composed:r||ot.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=ee.copy(a)),a};ee.copy=function(t,e){var r;if(ot.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(ee.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:ee.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};ee.equals=function(t,e,r){if(ot.util.isArray(t)){if(!ot.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!ee.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&ee.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};ee.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function mc(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}c(mc,"_checkBufferLength");var ZV=c(function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;mc(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}},"_getValueLength");ee.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=ot.util.createBuffer(t));var r=t.length(),n=Vl(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function Vl(t,e,r,n){var i;mc(t,e,2);var s=t.getByte();e--;var o=s&192,a=s&31;i=t.length();var u=ZV(t,e);if(e-=i-t.length(),u!==void 0&&u>e){if(n.strict){var l=new Error("Too few bytes to read ASN.1 value.");throw l.available=t.length(),l.remaining=e,l.requested=u,l}u=e}var f,h,p=(s&32)===32;if(p)if(f=[],u===void 0)for(;;){if(mc(t,e,2),t.bytes(2)==="\0\0"){t.getBytes(2),e-=2;break}i=t.length(),f.push(Vl(t,e,r+1,n)),e-=i-t.length()}else for(;u>0;)i=t.length(),f.push(Vl(t,u,r+1,n)),e-=i-t.length(),u-=i-t.length();if(f===void 0&&o===ee.Class.UNIVERSAL&&a===ee.Type.BITSTRING&&(h=t.bytes(u)),f===void 0&&n.decodeBitStrings&&o===ee.Class.UNIVERSAL&&a===ee.Type.BITSTRING&&u>1){var g=t.read,d=e,y=0;if(a===ee.Type.BITSTRING&&(mc(t,e,1),y=t.getByte(),e--),y===0)try{i=t.length();var v={strict:!0,decodeBitStrings:!0},m=Vl(t,e,r+1,v),w=i-t.length();e-=w,a==ee.Type.BITSTRING&&w++;var x=m.tagClass;w===u&&(x===ee.Class.UNIVERSAL||x===ee.Class.CONTEXT_SPECIFIC)&&(f=[m])}catch{}f===void 0&&(t.read=g,e=d)}if(f===void 0){if(u===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");u=e}if(a===ee.Type.BMPSTRING)for(f="";u>0;u-=2)mc(t,e,2),f+=String.fromCharCode(t.getInt16()),e-=2;else f=t.getBytes(u),e-=u}var A=h===void 0?null:{bitStringContents:h};return ee.create(o,a,p,f,A)}c(Vl,"_fromDer");ee.toDer=function(t){var e=ot.util.createBuffer(),r=t.tagClass|t.type,n=ot.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=ee.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(ee.toDer(t.value[s]))}else if(t.type===ee.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===ee.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(n),e};ee.oidToDer=function(t){var e=t.split("."),r=ot.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,s,o,a=2;a<e.length;++a){n=!0,i=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var u=i.length-1;u>=0;--u)r.putByte(i[u])}return r};ee.derToOid=function(t){var e;typeof t=="string"&&(t=ot.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};ee.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var u=t.charAt(10),l=10;u!=="+"&&u!=="-"&&(a=parseInt(t.substr(10,2),10),l+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,0),l&&(u=t.charAt(l),u==="+"||u==="-")){var f=parseInt(t.substr(l+1,2),10),h=parseInt(t.substr(l+4,2),10),p=f*60+h;p*=6e4,u==="+"?e.setTime(+e-p):e.setTime(+e+p)}return e};ee.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),u=0,l=0,f=!1;t.charAt(t.length-1)==="Z"&&(f=!0);var h=t.length-5,p=t.charAt(h);if(p==="+"||p==="-"){var g=parseInt(t.substr(h+1,2),10),d=parseInt(t.substr(h+4,2),10);l=g*60+d,l*=6e4,p==="+"&&(l*=-1),f=!0}return t.charAt(14)==="."&&(u=parseFloat(t.substr(14),10)*1e3),f?(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,u),e.setTime(+e+l)):(e.setFullYear(r,n,i),e.setHours(s,o,a,u)),e};ee.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};ee.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};ee.integerToDer=function(t){var e=ot.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};ee.derToInteger=function(t){typeof t=="string"&&(t=ot.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};ee.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&ot.util.isArray(e.value))for(var s=0,o=0;i&&o<e.value.length;++o)i=e.value[o].optional||!1,t.value[s]&&(i=ee.validate(t.value[s],e.value[o],r,n),i?++s:e.value[o].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var u=t.bitStringContents.charCodeAt(0);if(u!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var bA=/[^\\u0000-\\u00ff]/;ee.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",s=0;s<e*r;++s)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case ee.Class.UNIVERSAL:n+="Universal:";break;case ee.Class.APPLICATION:n+="Application:";break;case ee.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case ee.Class.PRIVATE:n+="Private:";break}if(t.tagClass===ee.Class.UNIVERSAL)switch(n+=t.type,t.type){case ee.Type.NONE:n+=" (None)";break;case ee.Type.BOOLEAN:n+=" (Boolean)";break;case ee.Type.INTEGER:n+=" (Integer)";break;case ee.Type.BITSTRING:n+=" (Bit string)";break;case ee.Type.OCTETSTRING:n+=" (Octet string)";break;case ee.Type.NULL:n+=" (Null)";break;case ee.Type.OID:n+=" (Object Identifier)";break;case ee.Type.ODESC:n+=" (Object Descriptor)";break;case ee.Type.EXTERNAL:n+=" (External or Instance of)";break;case ee.Type.REAL:n+=" (Real)";break;case ee.Type.ENUMERATED:n+=" (Enumerated)";break;case ee.Type.EMBEDDED:n+=" (Embedded PDV)";break;case ee.Type.UTF8:n+=" (UTF8)";break;case ee.Type.ROID:n+=" (Relative Object Identifier)";break;case ee.Type.SEQUENCE:n+=" (Sequence)";break;case ee.Type.SET:n+=" (Set)";break;case ee.Type.PRINTABLESTRING:n+=" (Printable String)";break;case ee.Type.IA5String:n+=" (IA5String (ASCII))";break;case ee.Type.UTCTIME:n+=" (UTC time)";break;case ee.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case ee.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,a+=ee.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",t.type===ee.Type.OID){var u=ee.derToOid(t.value);n+=u,ot.pki&&ot.pki.oids&&u in ot.pki.oids&&(n+=" ("+ot.pki.oids[u]+") ")}if(t.type===ee.Type.INTEGER)try{n+=ee.derToInteger(t.value)}catch{n+="0x"+ot.util.bytesToHex(t.value)}else if(t.type===ee.Type.BITSTRING){if(t.value.length>1?n+="0x"+ot.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var l=t.value.charCodeAt(0);l==1?n+=" (1 unused bit shown)":l>1&&(n+=" ("+l+" unused bits shown)")}}else if(t.type===ee.Type.OCTETSTRING)bA.test(t.value)||(n+="("+t.value+") "),n+="0x"+ot.util.bytesToHex(t.value);else if(t.type===ee.Type.UTF8)try{n+=ot.util.decodeUtf8(t.value)}catch(f){if(f.message==="URI malformed")n+="0x"+ot.util.bytesToHex(t.value)+" (malformed UTF8)";else throw f}else t.type===ee.Type.PRINTABLESTRING||t.type===ee.Type.IA5String?n+=t.value:bA.test(t.value)?n+="0x"+ot.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Mn=_((nJ,AA)=>{var Ml=ve();AA.exports=Ml.md=Ml.md||{};Ml.md.algorithms=Ml.md.algorithms||{}});var Ro=_((iJ,NA)=>{var ui=ve();Mn();qe();var XV=NA.exports=ui.hmac=ui.hmac||{};XV.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in ui.md.algorithms)e=ui.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=ui.util.createBuffer(o);else if(ui.util.isArray(o)){var a=o;o=ui.util.createBuffer();for(var u=0;u<a.length;++u)o.putByte(a[u])}var l=o.length();l>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=ui.util.createBuffer(),n=ui.util.createBuffer(),l=o.length();for(var u=0;u<l;++u){var a=o.at(u);r.putByte(54^a),n.putByte(92^a)}if(l<e.blockLength)for(var a=e.blockLength-l,u=0;u<a;++u)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(s){e.update(s)},i.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},i.digest=i.getMac,i}});var Hl=_((sJ,DA)=>{var Kn=ve();Mn();qe();var RA=DA.exports=Kn.md5=Kn.md5||{};Kn.md.md5=Kn.md.algorithms.md5=RA;RA.create=function(){OA||JV();var t=null,e=Kn.util.createBuffer(),r=new Array(16),n={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=Kn.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Kn.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),BA(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Kn.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Bv.substr(0,n.blockLength-o));for(var a,u=0,l=n.fullMessageLength.length-1;l>=0;--l)a=n.fullMessageLength[l]*8+u,u=a/4294967296>>>0,i.putInt32Le(a>>>0);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3};BA(f,r,i);var h=Kn.util.createBuffer();return h.putInt32Le(f.h0),h.putInt32Le(f.h1),h.putInt32Le(f.h2),h.putInt32Le(f.h3),h},n};var Bv=null,Kl=null,vc=null,Oo=null,OA=!1;function JV(){Bv="\x80",Bv+=Kn.util.fillString("\0",64),Kl=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],vc=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],Oo=new Array(64);for(var t=0;t<64;++t)Oo[t]=Math.floor(Math.abs(Math.sin(t+1))*4294967296);OA=!0}c(JV,"_init");function BA(t,e,r){for(var n,i,s,o,a,u,l,f,h=r.length();h>=64;){for(i=t.h0,s=t.h1,o=t.h2,a=t.h3,f=0;f<16;++f)e[f]=r.getInt32Le(),u=a^s&(o^a),n=i+u+Oo[f]+e[f],l=vc[f],i=a,a=o,o=s,s+=n<<l|n>>>32-l;for(;f<32;++f)u=o^a&(s^o),n=i+u+Oo[f]+e[Kl[f]],l=vc[f],i=a,a=o,o=s,s+=n<<l|n>>>32-l;for(;f<48;++f)u=s^o^a,n=i+u+Oo[f]+e[Kl[f]],l=vc[f],i=a,a=o,o=s,s+=n<<l|n>>>32-l;for(;f<64;++f)u=o^(s|~a),n=i+u+Oo[f]+e[Kl[f]],l=vc[f],i=a,a=o,o=s,s+=n<<l|n>>>32-l;t.h0=t.h0+i|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,h-=64}}c(BA,"_update")});var Ds=_((aJ,PA)=>{var Gl=ve();qe();var LA=PA.exports=Gl.pem=Gl.pem||{};LA.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=$l(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=$l(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=$l(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=$l(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Gl.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};LA.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(t),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Gl.util.decode64(s[3])};if(e.push(a),!!s[2]){for(var u=s[2].split(i),l=0;s&&l<u.length;){for(var f=u[l].replace(/\s+$/,""),h=l+1;h<u.length;++h){var p=u[h];if(!/\s/.test(p[0]))break;f+=p,l=h}if(s=f.match(n),s){for(var g={name:s[1],values:[]},d=s[2].split(","),y=0;y<d.length;++y)g.values.push(eM(d[y]));if(a.procType)if(!a.contentDomain&&g.name==="Content-Domain")a.contentDomain=d[0]||"";else if(!a.dekInfo&&g.name==="DEK-Info"){if(g.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:d[0],parameters:d[1]||null}}else a.headers.push(g);else{if(g.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(g.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:d[0],type:d[1]}}}++l}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function $l(t){for(var e=t.name+": ",r=[],n=c(function(u,l){return" "+l},"insertSpace"),i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<e.length;++i,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=i-o-1,o=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(o=i);return e}c($l,"foldHeader");function eM(t){return t.replace(/^\s+/,"")}c(eM,"ltrim")});var Ec=_((uJ,FA)=>{var ut=ve();kl();_v();qe();FA.exports=ut.des=ut.des||{};ut.des.startEncrypting=function(t,e,r,n){var i=jl({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};ut.des.createEncryptionCipher=function(t,e){return jl({key:t,output:null,decrypt:!1,mode:e})};ut.des.startDecrypting=function(t,e,r,n){var i=jl({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};ut.des.createDecryptionCipher=function(t,e){return jl({key:t,output:null,decrypt:!0,mode:e})};ut.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return kA(r._keys,n,i,!1)},decrypt:function(n,i){return kA(r._keys,n,i,!0)}}}),r._init=!1};ut.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=ut.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=uM(e),this._init=!0}};Hn("DES-ECB",ut.cipher.modes.ecb);Hn("DES-CBC",ut.cipher.modes.cbc);Hn("DES-CFB",ut.cipher.modes.cfb);Hn("DES-OFB",ut.cipher.modes.ofb);Hn("DES-CTR",ut.cipher.modes.ctr);Hn("3DES-ECB",ut.cipher.modes.ecb);Hn("3DES-CBC",ut.cipher.modes.cbc);Hn("3DES-CFB",ut.cipher.modes.cfb);Hn("3DES-OFB",ut.cipher.modes.ofb);Hn("3DES-CTR",ut.cipher.modes.ctr);function Hn(t,e){var r=c(function(){return new ut.des.Algorithm(t,e)},"factory");ut.cipher.registerAlgorithm(t,r)}c(Hn,"registerAlgorithm");var tM=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],rM=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],nM=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],iM=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],sM=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],oM=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],aM=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],cM=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function uM(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],p=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],g=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=t.length()>8?3:1,v=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],w=0,x,A=0;A<y;A++){var O=t.getInt32(),P=t.getInt32();x=(O>>>4^P)&252645135,P^=x,O^=x<<4,x=(P>>>-16^O)&65535,O^=x,P^=x<<-16,x=(O>>>2^P)&858993459,P^=x,O^=x<<2,x=(P>>>-16^O)&65535,O^=x,P^=x<<-16,x=(O>>>1^P)&1431655765,P^=x,O^=x<<1,x=(P>>>8^O)&16711935,O^=x,P^=x<<8,x=(O>>>1^P)&1431655765,P^=x,O^=x<<1,x=O<<8|P>>>20&240,O=P<<24|P<<8&16711680|P>>>8&65280|P>>>24&240,P=x;for(var j=0;j<m.length;++j){m[j]?(O=O<<2|O>>>26,P=P<<2|P>>>26):(O=O<<1|O>>>27,P=P<<1|P>>>27),O&=-15,P&=-15;var Q=e[O>>>28]|r[O>>>24&15]|n[O>>>20&15]|i[O>>>16&15]|s[O>>>12&15]|o[O>>>8&15]|a[O>>>4&15],se=u[P>>>28]|l[P>>>24&15]|f[P>>>20&15]|h[P>>>16&15]|p[P>>>12&15]|g[P>>>8&15]|d[P>>>4&15];x=(se>>>16^Q)&65535,v[w++]=Q^x,v[w++]=se^x<<16}}return v}c(uM,"_createKeys");function kA(t,e,r,n){var i=t.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],u=e[1];o=(a>>>4^u)&252645135,u^=o,a^=o<<4,o=(a>>>16^u)&65535,u^=o,a^=o<<16,o=(u>>>2^a)&858993459,a^=o,u^=o<<2,o=(u>>>8^a)&16711935,a^=o,u^=o<<8,o=(a>>>1^u)&1431655765,u^=o,a^=o<<1,a=a<<1|a>>>31,u=u<<1|u>>>31;for(var l=0;l<i;l+=3){for(var f=s[l+1],h=s[l+2],p=s[l];p!=f;p+=h){var g=u^t[p],d=(u>>>4|u<<28)^t[p+1];o=a,a=u,u=o^(rM[g>>>24&63]|iM[g>>>16&63]|oM[g>>>8&63]|cM[g&63]|tM[d>>>24&63]|nM[d>>>16&63]|sM[d>>>8&63]|aM[d&63])}o=a,a=u,u=o}a=a>>>1|a<<31,u=u>>>1|u<<31,o=(a>>>1^u)&1431655765,u^=o,a^=o<<1,o=(u>>>8^a)&16711935,a^=o,u^=o<<8,o=(u>>>2^a)&858993459,a^=o,u^=o<<2,o=(a>>>16^u)&65535,u^=o,a^=o<<16,o=(a>>>4^u)&252645135,u^=o,a^=o<<4,r[0]=a,r[1]=u}c(kA,"_updateBlock");function jl(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=ut.cipher.createDecipher(r,t.key):n=ut.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof ut.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}c(jl,"_createCipher")});var zl=_((fJ,qA)=>{var Er=ve();Ro();Mn();qe();var lM=Er.pkcs5=Er.pkcs5||{},li;Er.util.isNodejs&&!Er.options.usePureJavaScript&&(li=require("crypto"));qA.exports=Er.pbkdf2=lM.pbkdf2=function(t,e,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),Er.util.isNodejs&&!Er.options.usePureJavaScript&&li.pbkdf2&&(i===null||typeof i!="object")&&(li.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?li.pbkdf2Sync.length===4?li.pbkdf2(t,e,r,n,function(x,A){if(x)return s(x);s(null,A.toString("binary"))}):li.pbkdf2(t,e,r,n,i,function(x,A){if(x)return s(x);s(null,A.toString("binary"))}):li.pbkdf2Sync.length===4?li.pbkdf2Sync(t,e,r,n).toString("binary"):li.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Er.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Er.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var u=Math.ceil(n/o),l=n-(u-1)*o,f=Er.hmac.create();f.start(i,t);var h="",p,g,d;if(!s){for(var y=1;y<=u;++y){f.start(null,null),f.update(e),f.update(Er.util.int32ToBytes(y)),p=d=f.digest().getBytes();for(var v=2;v<=r;++v)f.start(null,null),f.update(d),g=f.digest().getBytes(),p=Er.util.xorBytes(p,g,o),d=g;h+=y<u?p:p.substr(0,l)}return h}var y=1,v;function m(){if(y>u)return s(null,h);f.start(null,null),f.update(e),f.update(Er.util.int32ToBytes(y)),p=d=f.digest().getBytes(),v=2,w()}c(m,"outer");function w(){if(v<=r)return f.start(null,null),f.update(d),g=f.digest().getBytes(),p=Er.util.xorBytes(p,g,o),d=g,++v,Er.util.setImmediate(w);h+=y<u?p:p.substr(0,l),++y,m()}c(w,"inner"),m()}});var Ov=_((dJ,HA)=>{var $n=ve();Mn();qe();var VA=HA.exports=$n.sha256=$n.sha256||{};$n.md.sha256=$n.md.algorithms.sha256=VA;VA.create=function(){MA||fM();var t=null,e=$n.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=$n.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=$n.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),UA(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=$n.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Rv.substr(0,n.blockLength-o));for(var a,u,l=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)a=n.fullMessageLength[f+1]*8,u=a/4294967296>>>0,l+=u,i.putInt32(l>>>0),l=a>>>0;i.putInt32(l);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};UA(h,r,i);var p=$n.util.createBuffer();return p.putInt32(h.h0),p.putInt32(h.h1),p.putInt32(h.h2),p.putInt32(h.h3),p.putInt32(h.h4),p.putInt32(h.h5),p.putInt32(h.h6),p.putInt32(h.h7),p},n};var Rv=null,MA=!1,KA=null;function fM(){Rv="\x80",Rv+=$n.util.fillString("\0",64),KA=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],MA=!0}c(fM,"_init");function UA(t,e,r){for(var n,i,s,o,a,u,l,f,h,p,g,d,y,v,m,w=r.length();w>=64;){for(l=0;l<16;++l)e[l]=r.getInt32();for(;l<64;++l)n=e[l-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[l-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[l]=n+e[l-7]+i+e[l-16]|0;for(f=t.h0,h=t.h1,p=t.h2,g=t.h3,d=t.h4,y=t.h5,v=t.h6,m=t.h7,l=0;l<64;++l)o=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),a=v^d&(y^v),s=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),u=f&h|p&(f^h),n=m+o+a+KA[l]+e[l],i=s+u,m=v,v=y,y=d,d=g+n>>>0,g=p,p=h,h=f,f=n+i>>>0;t.h0=t.h0+f|0,t.h1=t.h1+h|0,t.h2=t.h2+p|0,t.h3=t.h3+g|0,t.h4=t.h4+d|0,t.h5=t.h5+y|0,t.h6=t.h6+v|0,t.h7=t.h7+m|0,w-=64}}c(UA,"_update")});var Dv=_((gJ,$A)=>{var Gn=ve();qe();var Wl=null;Gn.util.isNodejs&&!Gn.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Wl=require("crypto"));var hM=$A.exports=Gn.prng=Gn.prng||{};hM.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(l,f){if(!f)return e.generateSync(l);var h=e.plugin.cipher,p=e.plugin.increment,g=e.plugin.formatKey,d=e.plugin.formatSeed,y=Gn.util.createBuffer();e.key=null,v();function v(m){if(m)return f(m);if(y.length()>=l)return f(null,y.getBytes(l));if(e.generated>1048575&&(e.key=null),e.key===null)return Gn.util.nextTick(function(){s(v)});var w=h(e.key,e.seed);e.generated+=w.length,y.putBytes(w),e.key=g(h(e.key,p(e.seed))),e.seed=d(h(e.key,e.seed)),Gn.util.setImmediate(v)}c(v,"generate")},e.generateSync=function(l){var f=e.plugin.cipher,h=e.plugin.increment,p=e.plugin.formatKey,g=e.plugin.formatSeed;e.key=null;for(var d=Gn.util.createBuffer();d.length()<l;){e.generated>1048575&&(e.key=null),e.key===null&&o();var y=f(e.key,e.seed);e.generated+=y.length,d.putBytes(y),e.key=p(f(e.key,h(e.seed))),e.seed=g(f(e.key,e.seed))}return d.getBytes(l)};function s(l){if(e.pools[0].messageLength>=32)return a(),l();var f=32-e.pools[0].messageLength<<5;e.seedFile(f,function(h,p){if(h)return l(h);e.collect(p),a(),l()})}c(s,"_reseed");function o(){if(e.pools[0].messageLength>=32)return a();var l=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(l)),a()}c(o,"_reseedSync");function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var l=e.plugin.md.create();l.update(e.keyBytes);for(var f=1,h=0;h<32;++h)e.reseeds%f===0&&(l.update(e.pools[h].digest().getBytes()),e.pools[h].start()),f=f<<1;e.keyBytes=l.digest().getBytes(),l.start(),l.update(e.keyBytes);var p=l.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(p),e.generated=0}c(a,"_seed");function u(l){var f=null,h=Gn.util.globalScope,p=h.crypto||h.msCrypto;p&&p.getRandomValues&&(f=c(function(O){return p.getRandomValues(O)},"getRandomValues"));var g=Gn.util.createBuffer();if(f)for(;g.length()<l;){var d=Math.max(1,Math.min(l-g.length(),65536)/4),y=new Uint32Array(Math.floor(d));try{f(y);for(var v=0;v<y.length;++v)g.putInt32(y[v])}catch(O){if(!(typeof QuotaExceededError<"u"&&O instanceof QuotaExceededError))throw O}}if(g.length()<l)for(var m,w,x,A=Math.floor(Math.random()*65536);g.length()<l;){w=16807*(A&65535),m=16807*(A>>16),w+=(m&32767)<<16,w+=m>>15,w=(w&2147483647)+(w>>31),A=w&4294967295;for(var v=0;v<3;++v)x=A>>>(v<<3),x^=Math.floor(Math.random()*256),g.putByte(x&255)}return g.getBytes(l)}return c(u,"defaultSeedFile"),Wl?(e.seedFile=function(l,f){Wl.randomBytes(l,function(h,p){if(h)return f(h);f(null,p.toString())})},e.seedFileSync=function(l){return Wl.randomBytes(l).toString()}):(e.seedFile=function(l,f){try{f(null,u(l))}catch(h){f(h)}},e.seedFileSync=u),e.collect=function(l){for(var f=l.length,h=0;h<f;++h)e.pools[e.pool].update(l.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(l,f){for(var h="",p=0;p<f;p+=8)h+=String.fromCharCode(l>>p&255);e.collect(h)},e.registerWorker=function(l){if(l===self)e.seedFile=function(h,p){function g(d){var y=d.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",g),p(y.forge.prng.err,y.forge.prng.bytes))}c(g,"listener"),self.addEventListener("message",g),self.postMessage({forge:{prng:{needed:h}}})};else{var f=c(function(h){var p=h.data;p.forge&&p.forge.prng&&e.seedFile(p.forge.prng.needed,function(g,d){l.postMessage({forge:{prng:{err:g,bytes:d}}})})},"listener");l.addEventListener("message",f)}},e}});var nn=_((mJ,Lv)=>{var zt=ve();qi();Ov();Dv();qe();(function(){if(zt.random&&zt.random.getBytes){Lv.exports=zt.random;return}(function(t){var e={},r=new Array(4),n=zt.util.createBuffer();e.formatKey=function(h){var p=zt.util.createBuffer(h);return h=new Array(4),h[0]=p.getInt32(),h[1]=p.getInt32(),h[2]=p.getInt32(),h[3]=p.getInt32(),zt.aes._expandKey(h,!1)},e.formatSeed=function(h){var p=zt.util.createBuffer(h);return h=new Array(4),h[0]=p.getInt32(),h[1]=p.getInt32(),h[2]=p.getInt32(),h[3]=p.getInt32(),h},e.cipher=function(h,p){return zt.aes._updateBlock(h,p,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=zt.md.sha256;function i(){var h=zt.prng.create(e);return h.getBytes=function(p,g){return h.generate(p,g)},h.getBytesSync=function(p){return h.generate(p)},h}c(i,"spawnPrng");var s=i(),o=null,a=zt.util.globalScope,u=a.crypto||a.msCrypto;if(u&&u.getRandomValues&&(o=c(function(h){return u.getRandomValues(h)},"getRandomValues")),zt.options.usePureJavaScript||!zt.util.isNodejs&&!o){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var l="";for(var f in navigator)try{typeof navigator[f]=="string"&&(l+=navigator[f])}catch{}s.collect(l),l=null}t&&(t().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),t().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!zt.random)zt.random=s;else for(var f in s)zt.random[f]=s[f];zt.random.createInstance=i,Lv.exports=zt.random})(typeof jQuery<"u"?jQuery:null)})()});var kv=_((EJ,zA)=>{var Lr=ve();qe();var Pv=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],GA=[1,2,3,5],dM=c(function(t,e){return t<<e&65535|(t&65535)>>16-e},"rol"),pM=c(function(t,e){return(t&65535)>>e|t<<16-e&65535},"ror");zA.exports=Lr.rc2=Lr.rc2||{};Lr.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Lr.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(Pv[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,Pv[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,Pv[r.at(a+1)^r.at(a+s)]);return r};var jA=c(function(t,e,r){var n=!1,i=null,s=null,o=null,a,u,l,f,h=[];for(t=Lr.rc2.expandKey(t,e),l=0;l<64;l++)h.push(t.getInt16Le());r?(a=c(function(d){for(l=0;l<4;l++)d[l]+=h[f]+(d[(l+3)%4]&d[(l+2)%4])+(~d[(l+3)%4]&d[(l+1)%4]),d[l]=dM(d[l],GA[l]),f++},"mixRound"),u=c(function(d){for(l=0;l<4;l++)d[l]+=h[d[(l+3)%4]&63]},"mashRound")):(a=c(function(d){for(l=3;l>=0;l--)d[l]=pM(d[l],GA[l]),d[l]-=h[f]+(d[(l+3)%4]&d[(l+2)%4])+(~d[(l+3)%4]&d[(l+1)%4]),f--},"mixRound"),u=c(function(d){for(l=3;l>=0;l--)d[l]-=h[d[(l+3)%4]&63]},"mashRound"));var p=c(function(d){var y=[];for(l=0;l<4;l++){var v=i.getInt16Le();o!==null&&(r?v^=o.getInt16Le():o.putInt16Le(v)),y.push(v&65535)}f=r?0:63;for(var m=0;m<d.length;m++)for(var w=0;w<d[m][0];w++)d[m][1](y);for(l=0;l<4;l++)o!==null&&(r?o.putInt16Le(y[l]):y[l]^=o.getInt16Le()),s.putInt16Le(y[l])},"runPlan"),g=null;return g={start:function(d,y){d&&typeof d=="string"&&(d=Lr.util.createBuffer(d)),n=!1,i=Lr.util.createBuffer(),s=y||new Lr.util.createBuffer,o=d,g.output=s},update:function(d){for(n||i.putBuffer(d);i.length()>=8;)p([[5,a],[1,u],[6,a],[1,u],[5,a]])},finish:function(d){var y=!0;if(r)if(d)y=d(8,i,!r);else{var v=i.length()===8?8:8-i.length();i.fillWithByte(v,v)}if(y&&(n=!0,g.update()),!r&&(y=i.length()===0,y))if(d)y=d(8,s,!r);else{var m=s.length(),w=s.at(m-1);w>m?y=!1:s.truncate(w)}return y}},g},"createCipher");Lr.rc2.startEncrypting=function(t,e,r){var n=Lr.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Lr.rc2.createEncryptionCipher=function(t,e){return jA(t,e,!0)};Lr.rc2.startDecrypting=function(t,e,r){var n=Lr.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Lr.rc2.createDecryptionCipher=function(t,e){return jA(t,e,!1)}});var Cc=_((CJ,t2)=>{var Fv=ve();t2.exports=Fv.jsbn=Fv.jsbn||{};var fi,gM=0xdeadbeefcafe,WA=(gM&16777215)==15715070;function K(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}c(K,"BigInteger");Fv.jsbn.BigInteger=K;function Ue(){return new K(null)}c(Ue,"nbi");function yM(t,e,r,n,i,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}c(yM,"am1");function mM(t,e,r,n,i,s){for(var o=e&32767,a=e>>15;--s>=0;){var u=this.data[t]&32767,l=this.data[t++]>>15,f=a*u+l*o;u=o*u+((f&32767)<<15)+r.data[n]+(i&1073741823),i=(u>>>30)+(f>>>15)+a*l+(i>>>30),r.data[n++]=u&1073741823}return i}c(mM,"am2");function QA(t,e,r,n,i,s){for(var o=e&16383,a=e>>14;--s>=0;){var u=this.data[t]&16383,l=this.data[t++]>>14,f=a*u+l*o;u=o*u+((f&16383)<<14)+r.data[n]+i,i=(u>>28)+(f>>14)+a*l,r.data[n++]=u&268435455}return i}c(QA,"am3");typeof navigator>"u"?(K.prototype.am=QA,fi=28):WA&&navigator.appName=="Microsoft Internet Explorer"?(K.prototype.am=mM,fi=30):WA&&navigator.appName!="Netscape"?(K.prototype.am=yM,fi=26):(K.prototype.am=QA,fi=28);K.prototype.DB=fi;K.prototype.DM=(1<<fi)-1;K.prototype.DV=1<<fi;var qv=52;K.prototype.FV=Math.pow(2,qv);K.prototype.F1=qv-fi;K.prototype.F2=2*fi-qv;var vM="0123456789abcdefghijklmnopqrstuvwxyz",Ql=new Array,Do,sn;Do=48;for(sn=0;sn<=9;++sn)Ql[Do++]=sn;Do=97;for(sn=10;sn<36;++sn)Ql[Do++]=sn;Do=65;for(sn=10;sn<36;++sn)Ql[Do++]=sn;function YA(t){return vM.charAt(t)}c(YA,"int2char");function ZA(t,e){var r=Ql[t.charCodeAt(e)];return r??-1}c(ZA,"intAt");function EM(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}c(EM,"bnpCopyTo");function SM(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}c(SM,"bnpFromInt");function Vi(t){var e=Ue();return e.fromInt(t),e}c(Vi,"nbv");function CM(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var o=r==8?t[n]&255:ZA(t,n);if(o<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&t[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&K.ZERO.subTo(this,this)}c(CM,"bnpFromString");function wM(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}c(wM,"bnpClamp");function xM(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=YA(n));o>=0;)a<e?(n=(this.data[o]&(1<<a)-1)<<e-a,n|=this.data[--o]>>(a+=this.DB-e)):(n=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=YA(n));return i?s:"0"}c(xM,"bnToString");function TM(){var t=Ue();return K.ZERO.subTo(this,t),t}c(TM,"bnNegate");function _M(){return this.s<0?this.negate():this}c(_M,"bnAbs");function bM(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}c(bM,"bnCompareTo");function Yl(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}c(Yl,"nbits");function IM(){return this.t<=0?0:this.DB*(this.t-1)+Yl(this.data[this.t-1]^this.s&this.DM)}c(IM,"bnBitLength");function AM(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}c(AM,"bnpDLShiftTo");function NM(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}c(NM,"bnpDRShiftTo");function BM(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}c(BM,"bnpLShiftTo");function RM(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<i,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}c(RM,"bnpRShiftTo");function OM(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}c(OM,"bnpSubTo");function DM(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&K.ZERO.subTo(e,e)}c(DM,"bnpMultiplyTo");function LM(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}c(LM,"bnpSquareTo");function PM(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Ue());var s=Ue(),o=this.s,a=t.s,u=this.DB-Yl(n.data[n.t-1]);u>0?(n.lShiftTo(u,s),i.lShiftTo(u,r)):(n.copyTo(s),i.copyTo(r));var l=s.t,f=s.data[l-1];if(f!=0){var h=f*(1<<this.F1)+(l>1?s.data[l-2]>>this.F2:0),p=this.FV/h,g=(1<<this.F1)/h,d=1<<this.F2,y=r.t,v=y-l,m=e??Ue();for(s.dlShiftTo(v,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),K.ONE.dlShiftTo(l,m),m.subTo(s,s);s.t<l;)s.data[s.t++]=0;for(;--v>=0;){var w=r.data[--y]==f?this.DM:Math.floor(r.data[y]*p+(r.data[y-1]+d)*g);if((r.data[y]+=s.am(0,w,r,v,0,l))<w)for(s.dlShiftTo(v,m),r.subTo(m,r);r.data[y]<--w;)r.subTo(m,r)}e!=null&&(r.drShiftTo(l,e),o!=a&&K.ZERO.subTo(e,e)),r.t=l,r.clamp(),u>0&&r.rShiftTo(u,r),o<0&&K.ZERO.subTo(r,r)}}}c(PM,"bnpDivRemTo");function kM(t){var e=Ue();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(K.ZERO)>0&&t.subTo(e,e),e}c(kM,"bnMod");function Ls(t){this.m=t}c(Ls,"Classic");function FM(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}c(FM,"cConvert");function qM(t){return t}c(qM,"cRevert");function UM(t){t.divRemTo(this.m,null,t)}c(UM,"cReduce");function VM(t,e,r){t.multiplyTo(e,r),this.reduce(r)}c(VM,"cMulTo");function MM(t,e){t.squareTo(e),this.reduce(e)}c(MM,"cSqrTo");Ls.prototype.convert=FM;Ls.prototype.revert=qM;Ls.prototype.reduce=UM;Ls.prototype.mulTo=VM;Ls.prototype.sqrTo=MM;function KM(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}c(KM,"bnpInvDigit");function Ps(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}c(Ps,"Montgomery");function HM(t){var e=Ue();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(K.ZERO)>0&&this.m.subTo(e,e),e}c(HM,"montConvert");function $M(t){var e=Ue();return t.copyTo(e),this.reduce(e),e}c($M,"montRevert");function GM(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}c(GM,"montReduce");function jM(t,e){t.squareTo(e),this.reduce(e)}c(jM,"montSqrTo");function zM(t,e,r){t.multiplyTo(e,r),this.reduce(r)}c(zM,"montMulTo");Ps.prototype.convert=HM;Ps.prototype.revert=$M;Ps.prototype.reduce=GM;Ps.prototype.mulTo=zM;Ps.prototype.sqrTo=jM;function WM(){return(this.t>0?this.data[0]&1:this.s)==0}c(WM,"bnpIsEven");function QM(t,e){if(t>4294967295||t<1)return K.ONE;var r=Ue(),n=Ue(),i=e.convert(this),s=Yl(t)-1;for(i.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,i,r);else{var o=r;r=n,n=o}return e.revert(r)}c(QM,"bnpExp");function YM(t,e){var r;return t<256||e.isEven()?r=new Ls(e):r=new Ps(e),this.exp(t,r)}c(YM,"bnModPowInt");K.prototype.copyTo=EM;K.prototype.fromInt=SM;K.prototype.fromString=CM;K.prototype.clamp=wM;K.prototype.dlShiftTo=AM;K.prototype.drShiftTo=NM;K.prototype.lShiftTo=BM;K.prototype.rShiftTo=RM;K.prototype.subTo=OM;K.prototype.multiplyTo=DM;K.prototype.squareTo=LM;K.prototype.divRemTo=PM;K.prototype.invDigit=KM;K.prototype.isEven=WM;K.prototype.exp=QM;K.prototype.toString=xM;K.prototype.negate=TM;K.prototype.abs=_M;K.prototype.compareTo=bM;K.prototype.bitLength=IM;K.prototype.mod=kM;K.prototype.modPowInt=YM;K.ZERO=Vi(0);K.ONE=Vi(1);function ZM(){var t=Ue();return this.copyTo(t),t}c(ZM,"bnClone");function XM(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}c(XM,"bnIntValue");function JM(){return this.t==0?this.s:this.data[0]<<24>>24}c(JM,"bnByteValue");function eK(){return this.t==0?this.s:this.data[0]<<16>>16}c(eK,"bnShortValue");function tK(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}c(tK,"bnpChunkSize");function rK(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}c(rK,"bnSigNum");function nK(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Vi(r),i=Ue(),s=Ue(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(t)+o}c(nK,"bnpToRadix");function iK(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,s=0,o=0,a=0;a<t.length;++a){var u=ZA(t,a);if(u<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=e*o+u,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),i&&K.ZERO.subTo(this,this)}c(iK,"bnpFromRadix");function sK(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(K.ONE.shiftLeft(t-1),Uv,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(K.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}c(sK,"bnpFromNumber");function oK(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}c(oK,"bnToByteArray");function aK(t){return this.compareTo(t)==0}c(aK,"bnEquals");function cK(t){return this.compareTo(t)<0?this:t}c(cK,"bnMin");function uK(t){return this.compareTo(t)>0?this:t}c(uK,"bnMax");function lK(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}c(lK,"bnpBitwiseTo");function fK(t,e){return t&e}c(fK,"op_and");function hK(t){var e=Ue();return this.bitwiseTo(t,fK,e),e}c(hK,"bnAnd");function Uv(t,e){return t|e}c(Uv,"op_or");function dK(t){var e=Ue();return this.bitwiseTo(t,Uv,e),e}c(dK,"bnOr");function XA(t,e){return t^e}c(XA,"op_xor");function pK(t){var e=Ue();return this.bitwiseTo(t,XA,e),e}c(pK,"bnXor");function JA(t,e){return t&~e}c(JA,"op_andnot");function gK(t){var e=Ue();return this.bitwiseTo(t,JA,e),e}c(gK,"bnAndNot");function yK(){for(var t=Ue(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}c(yK,"bnNot");function mK(t){var e=Ue();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}c(mK,"bnShiftLeft");function vK(t){var e=Ue();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}c(vK,"bnShiftRight");function EK(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}c(EK,"lbit");function SK(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+EK(this.data[t]);return this.s<0?this.t*this.DB:-1}c(SK,"bnGetLowestSetBit");function CK(t){for(var e=0;t!=0;)t&=t-1,++e;return e}c(CK,"cbit");function wK(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=CK(this.data[r]^e);return t}c(wK,"bnBitCount");function xK(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}c(xK,"bnTestBit");function TK(t,e){var r=K.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}c(TK,"bnpChangeBit");function _K(t){return this.changeBit(t,Uv)}c(_K,"bnSetBit");function bK(t){return this.changeBit(t,JA)}c(bK,"bnClearBit");function IK(t){return this.changeBit(t,XA)}c(IK,"bnFlipBit");function AK(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}c(AK,"bnpAddTo");function NK(t){var e=Ue();return this.addTo(t,e),e}c(NK,"bnAdd");function BK(t){var e=Ue();return this.subTo(t,e),e}c(BK,"bnSubtract");function RK(t){var e=Ue();return this.multiplyTo(t,e),e}c(RK,"bnMultiply");function OK(t){var e=Ue();return this.divRemTo(t,e,null),e}c(OK,"bnDivide");function DK(t){var e=Ue();return this.divRemTo(t,null,e),e}c(DK,"bnRemainder");function LK(t){var e=Ue(),r=Ue();return this.divRemTo(t,e,r),new Array(e,r)}c(LK,"bnDivideAndRemainder");function PK(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}c(PK,"bnpDMultiply");function kK(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}c(kK,"bnpDAddOffset");function Sc(){}c(Sc,"NullExp");function e2(t){return t}c(e2,"nNop");function FK(t,e,r){t.multiplyTo(e,r)}c(FK,"nMulTo");function qK(t,e){t.squareTo(e)}c(qK,"nSqrTo");Sc.prototype.convert=e2;Sc.prototype.revert=e2;Sc.prototype.mulTo=FK;Sc.prototype.sqrTo=qK;function UK(t){return this.exp(t,new Sc)}c(UK,"bnPow");function VK(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}c(VK,"bnpMultiplyLowerTo");function MK(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}c(MK,"bnpMultiplyUpperTo");function Lo(t){this.r2=Ue(),this.q3=Ue(),K.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}c(Lo,"Barrett");function KK(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=Ue();return t.copyTo(e),this.reduce(e),e}c(KK,"barrettConvert");function HK(t){return t}c(HK,"barrettRevert");function $K(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}c($K,"barrettReduce");function GK(t,e){t.squareTo(e),this.reduce(e)}c(GK,"barrettSqrTo");function jK(t,e,r){t.multiplyTo(e,r),this.reduce(r)}c(jK,"barrettMulTo");Lo.prototype.convert=KK;Lo.prototype.revert=HK;Lo.prototype.reduce=$K;Lo.prototype.mulTo=jK;Lo.prototype.sqrTo=GK;function zK(t,e){var r=t.bitLength(),n,i=Vi(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Ls(e):e.isEven()?s=new Lo(e):s=new Ps(e);var o=new Array,a=3,u=n-1,l=(1<<n)-1;if(o[1]=s.convert(this),n>1){var f=Ue();for(s.sqrTo(o[1],f);a<=l;)o[a]=Ue(),s.mulTo(f,o[a-2],o[a]),a+=2}var h=t.t-1,p,g=!0,d=Ue(),y;for(r=Yl(t.data[h])-1;h>=0;){for(r>=u?p=t.data[h]>>r-u&l:(p=(t.data[h]&(1<<r+1)-1)<<u-r,h>0&&(p|=t.data[h-1]>>this.DB+r-u)),a=n;!(p&1);)p>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),g)o[p].copyTo(i),g=!1;else{for(;a>1;)s.sqrTo(i,d),s.sqrTo(d,i),a-=2;a>0?s.sqrTo(i,d):(y=i,i=d,d=y),s.mulTo(d,o[p],i)}for(;h>=0&&!(t.data[h]&1<<r);)s.sqrTo(i,d),y=i,i=d,d=y,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}c(zK,"bnModPow");function WK(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}c(WK,"bnGCD");function QK(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}c(QK,"bnpModInt");function YK(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return K.ZERO;for(var r=t.clone(),n=this.clone(),i=Vi(1),s=Vi(0),o=Vi(0),a=Vi(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),e&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(K.ONE)!=0)return K.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}c(YK,"bnModInverse");var bn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ZK=(1<<26)/bn[bn.length-1];function XK(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=bn[bn.length-1]){for(e=0;e<bn.length;++e)if(r.data[0]==bn[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<bn.length;){for(var n=bn[e],i=e+1;i<bn.length&&n<ZK;)n*=bn[i++];for(n=r.modInt(n);e<i;)if(n%bn[e++]==0)return!1}return r.millerRabin(t)}c(XK,"bnIsProbablePrime");function JK(t){var e=this.subtract(K.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=e7(),s,o=0;o<t;++o){do s=new K(this.bitLength(),i);while(s.compareTo(K.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(n,this);if(a.compareTo(K.ONE)!=0&&a.compareTo(e)!=0){for(var u=1;u++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(K.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}c(JK,"bnpMillerRabin");function e7(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}c(e7,"bnGetPrng");K.prototype.chunkSize=tK;K.prototype.toRadix=nK;K.prototype.fromRadix=iK;K.prototype.fromNumber=sK;K.prototype.bitwiseTo=lK;K.prototype.changeBit=TK;K.prototype.addTo=AK;K.prototype.dMultiply=PK;K.prototype.dAddOffset=kK;K.prototype.multiplyLowerTo=VK;K.prototype.multiplyUpperTo=MK;K.prototype.modInt=QK;K.prototype.millerRabin=JK;K.prototype.clone=ZM;K.prototype.intValue=XM;K.prototype.byteValue=JM;K.prototype.shortValue=eK;K.prototype.signum=rK;K.prototype.toByteArray=oK;K.prototype.equals=aK;K.prototype.min=cK;K.prototype.max=uK;K.prototype.and=hK;K.prototype.or=dK;K.prototype.xor=pK;K.prototype.andNot=gK;K.prototype.not=yK;K.prototype.shiftLeft=mK;K.prototype.shiftRight=vK;K.prototype.getLowestSetBit=SK;K.prototype.bitCount=wK;K.prototype.testBit=xK;K.prototype.setBit=_K;K.prototype.clearBit=bK;K.prototype.flipBit=IK;K.prototype.add=NK;K.prototype.subtract=BK;K.prototype.multiply=RK;K.prototype.divide=OK;K.prototype.remainder=DK;K.prototype.divideAndRemainder=LK;K.prototype.modPow=zK;K.prototype.modInverse=YK;K.prototype.pow=UK;K.prototype.gcd=WK;K.prototype.isProbablePrime=XK});var Po=_((xJ,s2)=>{var jn=ve();Mn();qe();var n2=s2.exports=jn.sha1=jn.sha1||{};jn.md.sha1=jn.md.algorithms.sha1=n2;n2.create=function(){i2||t7();var t=null,e=jn.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=jn.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=jn.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),r2(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=jn.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Vv.substr(0,n.blockLength-o));for(var a,u,l=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)a=n.fullMessageLength[f+1]*8,u=a/4294967296>>>0,l+=u,i.putInt32(l>>>0),l=a>>>0;i.putInt32(l);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};r2(h,r,i);var p=jn.util.createBuffer();return p.putInt32(h.h0),p.putInt32(h.h1),p.putInt32(h.h2),p.putInt32(h.h3),p.putInt32(h.h4),p},n};var Vv=null,i2=!1;function t7(){Vv="\x80",Vv+=jn.util.fillString("\0",64),i2=!0}c(t7,"_init");function r2(t,e,r){for(var n,i,s,o,a,u,l,f,h=r.length();h>=64;){for(i=t.h0,s=t.h1,o=t.h2,a=t.h3,u=t.h4,f=0;f<16;++f)n=r.getInt32(),e[f]=n,l=a^s&(o^a),n=(i<<5|i>>>27)+l+u+1518500249+n,u=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<20;++f)n=e[f-3]^e[f-8]^e[f-14]^e[f-16],n=n<<1|n>>>31,e[f]=n,l=a^s&(o^a),n=(i<<5|i>>>27)+l+u+1518500249+n,u=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<32;++f)n=e[f-3]^e[f-8]^e[f-14]^e[f-16],n=n<<1|n>>>31,e[f]=n,l=s^o^a,n=(i<<5|i>>>27)+l+u+1859775393+n,u=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<40;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,l=s^o^a,n=(i<<5|i>>>27)+l+u+1859775393+n,u=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<60;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,l=s&o|a&(s^o),n=(i<<5|i>>>27)+l+u+2400959708+n,u=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<80;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,l=s^o^a,n=(i<<5|i>>>27)+l+u+3395469782+n,u=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+u|0,h-=64}}c(r2,"_update")});var Mv=_((_J,a2)=>{var zn=ve();qe();nn();Po();var o2=a2.exports=zn.pkcs1=zn.pkcs1||{};o2.encode_rsa_oaep=function(t,e,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=zn.md.sha1.create(),o||(o=s);var a=Math.ceil(t.n.bitLength()/8),u=a-2*s.digestLength-2;if(e.length>u){var l=new Error("RSAES-OAEP input message length is too long.");throw l.length=e.length,l.maxLength=u,l}n||(n=""),s.update(n,"raw");for(var f=s.digest(),h="",p=u-e.length,g=0;g<p;g++)h+="\0";var d=f.getBytes()+h+""+e;if(!i)i=zn.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var l=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw l.seedLength=i.length,l.digestLength=s.digestLength,l}var y=Zl(i,a-s.digestLength-1,o),v=zn.util.xorBytes(d,y,d.length),m=Zl(v,s.digestLength,o),w=zn.util.xorBytes(i,m,i.length);return"\0"+w+v};o2.decode_rsa_oaep=function(t,e,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=e.length,v.expectedLength=o,v}if(i===void 0?i=zn.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),u=e.charAt(0),l=e.substring(1,i.digestLength+1),f=e.substring(1+i.digestLength),h=Zl(f,i.digestLength,s),p=zn.util.xorBytes(l,h,l.length),g=Zl(p,o-i.digestLength-1,s),d=zn.util.xorBytes(f,g,f.length),y=d.substring(0,i.digestLength),v=u!=="\0",m=0;m<i.digestLength;++m)v|=a.charAt(m)!==y.charAt(m);for(var w=1,x=i.digestLength,A=i.digestLength;A<d.length;A++){var O=d.charCodeAt(A),P=O&1^1,j=w?65534:0;v|=O&j,w=w&P,x+=w}if(v||d.charCodeAt(x)!==1)throw new Error("Invalid RSAES-OAEP padding.");return d.substring(x+1)};function Zl(t,e,r){r||(r=zn.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}c(Zl,"rsa_mgf1")});var Hv=_((IJ,Kv)=>{var Mi=ve();qe();Cc();nn();(function(){if(Mi.prime){Kv.exports=Mi.prime;return}var t=Kv.exports=Mi.prime=Mi.prime||{},e=Mi.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=c(function(h,p){return h|p},"op_or");t.generateProbablePrime=function(h,p,g){typeof p=="function"&&(g=p,p={}),p=p||{};var d=p.algorithm||"PRIMEINC";typeof d=="string"&&(d={name:d}),d.options=d.options||{};var y=p.prng||Mi.random,v={nextBytes:function(m){for(var w=y.getBytesSync(m.length),x=0;x<m.length;++x)m[x]=w.charCodeAt(x)}};if(d.name==="PRIMEINC")return s(h,v,d.options,g);throw new Error("Invalid prime generation algorithm: "+d.name)};function s(h,p,g,d){return"workers"in g?u(h,p,g,d):o(h,p,g,d)}c(s,"primeincFindPrime");function o(h,p,g,d){var y=l(h,p),v=0,m=f(y.bitLength());"millerRabinTests"in g&&(m=g.millerRabinTests);var w=10;"maxBlockTime"in g&&(w=g.maxBlockTime),a(y,h,p,v,m,w,d)}c(o,"primeincFindPrimeWithoutWorkers");function a(h,p,g,d,y,v,m){var w=+new Date;do{if(h.bitLength()>p&&(h=l(p,g)),h.isProbablePrime(y))return m(null,h);h.dAddOffset(r[d++%8],0)}while(v<0||+new Date-w<v);Mi.util.setImmediate(function(){a(h,p,g,d,y,v,m)})}c(a,"_primeinc");function u(h,p,g,d){if(typeof Worker>"u")return o(h,p,g,d);var y=l(h,p),v=g.workers,m=g.workLoad||100,w=m*30/8,x=g.workerScript||"forge/prime.worker.js";if(v===-1)return Mi.util.estimateCores(function(O,P){O&&(P=2),v=P-1,A()});A();function A(){v=Math.max(1,v);for(var O=[],P=0;P<v;++P)O[P]=new Worker(x);for(var j=v,P=0;P<v;++P)O[P].addEventListener("message",se);var Q=!1;function se(re){if(!Q){--j;var k=re.data;if(k.found){for(var Ae=0;Ae<O.length;++Ae)O[Ae].terminate();return Q=!0,d(null,new e(k.prime,16))}y.bitLength()>h&&(y=l(h,p));var q=y.toString(16);re.target.postMessage({hex:q,workLoad:m}),y.dAddOffset(w,0)}}c(se,"workerMessage")}c(A,"generate")}c(u,"primeincFindPrimeWithWorkers");function l(h,p){var g=new e(h,p),d=h-1;return g.testBit(d)||g.bitwiseTo(e.ONE.shiftLeft(d),i,g),g.dAddOffset(31-g.mod(n).byteValue(),0),g}c(l,"generateRandom");function f(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}c(f,"getMillerRabinTests")})()});var wc=_((NJ,p2)=>{var ue=ve();_n();Cc();Ui();Mv();Hv();nn();qe();typeof Le>"u"&&(Le=ue.jsbn.BigInteger);var Le,$v=ue.util.isNodejs?require("crypto"):null,L=ue.asn1,on=ue.util;ue.pki=ue.pki||{};p2.exports=ue.pki.rsa=ue.rsa=ue.rsa||{};var pe=ue.pki,r7=[6,4,2,4,2,4,6,2],n7={name:"PrivateKeyInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},i7={name:"RSAPrivateKey",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},s7={name:"RSAPublicKey",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},o7=ue.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:L.Class.UNIVERSAL,type:L.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},a7={name:"DigestInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:L.Class.UNIVERSAL,type:L.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:L.Class.UNIVERSAL,type:L.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},c7=c(function(t){var e;if(t.algorithm in pe.oids)e=pe.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=L.oidToDer(e).getBytes(),i=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]),s=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]);s.value.push(L.create(L.Class.UNIVERSAL,L.Type.OID,!1,n)),s.value.push(L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,""));var o=L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(s),i.value.push(o),L.toDer(i).getBytes()},"emsaPkcs1v15encode"),h2=c(function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Le.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Le.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new Le(ue.util.bytesToHex(ue.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(Le.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(s)<0;)i=i.add(e.p);var o=i.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o},"_modPow");pe.rsa.encrypt=function(t,e,r){var n=r,i,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=d2(t,e,r)):(i=ue.util.createBuffer(),i.putBytes(t));for(var o=new Le(i.toHex(),16),a=h2(o,e,n),u=a.toString(16),l=ue.util.createBuffer(),f=s-Math.ceil(u.length/2);f>0;)l.putByte(0),--f;return l.putBytes(ue.util.hexToBytes(u)),l.getBytes()};pe.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=i,s}var o=new Le(ue.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=h2(o,e,r),u=a.toString(16),l=ue.util.createBuffer(),f=i-Math.ceil(u.length/2);f>0;)l.putByte(0),--f;return l.putBytes(ue.util.hexToBytes(u)),n!==!1?Xl(l.getBytes(),e,r):l.getBytes()};pe.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||ue.random,i={nextBytes:function(a){for(var u=n.getBytesSync(a.length),l=0;l<a.length;++l)a[l]=u.charCodeAt(l)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:i,eInt:e||65537,e:new Le(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};pe.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new Le(null);r.fromInt(30);for(var n=0,i=c(function(h,p){return h|p},"op_or"),s=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var u=t.p===null?t.pBits:t.qBits,l=u-1;t.pqState===0?(t.num=new Le(u,t.rng),t.num.testBit(l)||t.num.bitwiseTo(Le.ONE.shiftLeft(l),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>u?t.pqState=0:t.num.isProbablePrime(l7(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(r7[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(Le.ONE).gcd(t.e).compareTo(Le.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(Le.ONE),t.q1=t.q.subtract(Le.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(Le.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var f=t.e.modInverse(t.phi);t.keys={privateKey:pe.rsa.setPrivateKey(t.n,t.e,f,t.p,t.q,f.mod(t.p1),f.mod(t.q1),t.q.modInverse(t.p)),publicKey:pe.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-s,s=o}return t.keys!==null};pe.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!ue.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(c2("generateKeyPair"))return $v.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,u,l){if(a)return n(a);n(null,{privateKey:pe.privateKeyFromPem(l),publicKey:pe.publicKeyFromPem(u)})});if(u2("generateKey")&&u2("exportKey"))return on.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:f2(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return on.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var u=pe.privateKeyFromAsn1(L.fromDer(ue.util.createBuffer(a)));n(null,{privateKey:u,publicKey:pe.setRsaPublicKey(u.n,u.e)})}});if(l2("generateKey")&&l2("exportKey")){var i=on.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:f2(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var u=a.target.result,l=on.globalScope.msCrypto.subtle.exportKey("pkcs8",u.privateKey);l.oncomplete=function(f){var h=f.target.result,p=pe.privateKeyFromAsn1(L.fromDer(ue.util.createBuffer(h)));n(null,{privateKey:p,publicKey:pe.setRsaPublicKey(p.n,p.e)})},l.onerror=function(f){n(f)}},i.onerror=function(a){n(a)};return}}else if(c2("generateKeyPairSync")){var s=$v.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:pe.privateKeyFromPem(s.privateKey),publicKey:pe.publicKeyFromPem(s.publicKey)}}}var o=pe.rsa.createKeyPairGenerationState(t,e,r);if(!n)return pe.rsa.stepKeyPairGenerationState(o,0),o.keys;u7(o,r,n)};pe.setRsaPublicKey=pe.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,u,l){return d2(a,u,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,u){return ue.pkcs1.encode_rsa_oaep(u,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return pe.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s,o){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(u,l){l=Xl(l,r,!0);var f=L.fromDer(l,{parseAllBytes:o._parseAllDigestBytes}),h={},p=[];if(!L.validate(f,a7,h,p)){var g=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw g.errors=p,g}var d=L.derToOid(h.algorithmIdentifier);if(!(d===ue.oids.md2||d===ue.oids.md5||d===ue.oids.sha1||d===ue.oids.sha224||d===ue.oids.sha256||d===ue.oids.sha384||d===ue.oids.sha512||d===ue.oids["sha512-224"]||d===ue.oids["sha512-256"])){var g=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw g.oid=d,g}if((d===ue.oids.md2||d===ue.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return u===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(u,l){return l=Xl(l,r,!0),u===l}});var a=pe.rsa.decrypt(i,r,!0,!1);return s.verify(n,a,r.n.bitLength())},r};pe.setRsaPrivateKey=pe.rsa.setPrivateKey=function(t,e,r,n,i,s,o,a){var u={n:t,e,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return u.decrypt=function(l,f,h){typeof f=="string"?f=f.toUpperCase():f===void 0&&(f="RSAES-PKCS1-V1_5");var p=pe.rsa.decrypt(l,u,!1,!1);if(f==="RSAES-PKCS1-V1_5")f={decode:Xl};else if(f==="RSA-OAEP"||f==="RSAES-OAEP")f={decode:function(g,d){return ue.pkcs1.decode_rsa_oaep(d,g,h)}};else if(["RAW","NONE","NULL",null].indexOf(f)!==-1)f={decode:function(g){return g}};else throw new Error('Unsupported encryption scheme: "'+f+'".');return f.decode(p,u,!1)},u.sign=function(l,f){var h=!1;typeof f=="string"&&(f=f.toUpperCase()),f===void 0||f==="RSASSA-PKCS1-V1_5"?(f={encode:c7},h=1):(f==="NONE"||f==="NULL"||f===null)&&(f={encode:function(){return l}},h=1);var p=f.encode(l,u.n.bitLength());return pe.rsa.encrypt(p,u,h)},u};pe.wrapRsaPrivateKey=function(t){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(0).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(pe.oids.rsaEncryption).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")]),L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,L.toDer(t).getBytes())])};pe.privateKeyFromAsn1=function(t){var e={},r=[];if(L.validate(t,n7,e,r)&&(t=L.fromDer(ue.util.createBuffer(e.privateKey))),e={},r=[],!L.validate(t,i7,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,u,l,f,h;return i=ue.util.createBuffer(e.privateKeyModulus).toHex(),s=ue.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=ue.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=ue.util.createBuffer(e.privateKeyPrime1).toHex(),u=ue.util.createBuffer(e.privateKeyPrime2).toHex(),l=ue.util.createBuffer(e.privateKeyExponent1).toHex(),f=ue.util.createBuffer(e.privateKeyExponent2).toHex(),h=ue.util.createBuffer(e.privateKeyCoefficient).toHex(),pe.setRsaPrivateKey(new Le(i,16),new Le(s,16),new Le(o,16),new Le(a,16),new Le(u,16),new Le(l,16),new Le(f,16),new Le(h,16))};pe.privateKeyToAsn1=pe.privateKeyToRSAPrivateKey=function(t){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(0).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,Wn(t.n)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,Wn(t.e)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,Wn(t.d)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,Wn(t.p)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,Wn(t.q)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,Wn(t.dP)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,Wn(t.dQ)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,Wn(t.qInv))])};pe.publicKeyFromAsn1=function(t){var e={},r=[];if(L.validate(t,o7,e,r)){var n=L.derToOid(e.publicKeyOid);if(n!==pe.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!L.validate(t,s7,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=ue.util.createBuffer(e.publicKeyModulus).toHex(),o=ue.util.createBuffer(e.publicKeyExponent).toHex();return pe.setRsaPublicKey(new Le(s,16),new Le(o,16))};pe.publicKeyToAsn1=pe.publicKeyToSubjectPublicKeyInfo=function(t){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(pe.oids.rsaEncryption).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")]),L.create(L.Class.UNIVERSAL,L.Type.BITSTRING,!1,[pe.publicKeyToRSAPublicKey(t)])])};pe.publicKeyToRSAPublicKey=function(t){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,Wn(t.n)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,Wn(t.e))])};function d2(t,e,r){var n=ue.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var u=0;u<o;++u)n.putByte(a)}else for(;o>0;){for(var l=0,f=ue.random.getBytes(o),u=0;u<o;++u)a=f.charCodeAt(u),a===0?++l:n.putByte(a);o=l}return n.putByte(0),n.putBytes(t),n}c(d2,"_encodePkcs1_v1_5");function Xl(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),s=ue.util.createBuffer(t),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var u=0;if(a===0){u=i-3-n;for(var l=0;l<u;++l)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(u=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++u}else if(a===2)for(u=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++u}var f=s.getByte();if(f!==0||u!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}c(Xl,"_decodePkcs1_v1_5");function u7(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){s(t.pBits,function(a,u){if(a)return r(a);if(t.p=u,t.q!==null)return o(a,t.q);s(t.qBits,o)})}c(i,"generate");function s(a,u){ue.prime.generateProbablePrime(a,n,u)}c(s,"getPrime");function o(a,u){if(a)return r(a);if(t.q=u,t.p.compareTo(t.q)<0){var l=t.p;t.p=t.q,t.q=l}if(t.p.subtract(Le.ONE).gcd(t.e).compareTo(Le.ONE)!==0){t.p=null,i();return}if(t.q.subtract(Le.ONE).gcd(t.e).compareTo(Le.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(Le.ONE),t.q1=t.q.subtract(Le.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(Le.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var f=t.e.modInverse(t.phi);t.keys={privateKey:pe.rsa.setPrivateKey(t.n,t.e,f,t.p,t.q,f.mod(t.p1),f.mod(t.q1),t.q.modInverse(t.p)),publicKey:pe.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}c(o,"finish")}c(u7,"_generateKeyPair");function Wn(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=ue.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}c(Wn,"_bnToBytes");function l7(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}c(l7,"_getMillerRabinTests");function c2(t){return ue.util.isNodejs&&typeof $v[t]=="function"}c(c2,"_detectNodeCrypto");function u2(t){return typeof on.globalScope<"u"&&typeof on.globalScope.crypto=="object"&&typeof on.globalScope.crypto.subtle=="object"&&typeof on.globalScope.crypto.subtle[t]=="function"}c(u2,"_detectSubtleCrypto");function l2(t){return typeof on.globalScope<"u"&&typeof on.globalScope.msCrypto=="object"&&typeof on.globalScope.msCrypto.subtle=="object"&&typeof on.globalScope.msCrypto.subtle[t]=="function"}c(l2,"_detectSubtleMsCrypto");function f2(t){for(var e=ue.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}c(f2,"_intToUint8Array")});var Gv=_((RJ,E2)=>{var ne=ve();qi();_n();Ec();Mn();Ui();zl();Ds();nn();kv();wc();qe();typeof g2>"u"&&(g2=ne.jsbn.BigInteger);var g2,F=ne.asn1,ye=ne.pki=ne.pki||{};E2.exports=ye.pbe=ne.pbe=ne.pbe||{};var ks=ye.oids,f7={name:"EncryptedPrivateKeyInfo",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:F.Class.UNIVERSAL,type:F.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:F.Class.UNIVERSAL,type:F.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},h7={name:"PBES2Algorithms",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:F.Class.UNIVERSAL,type:F.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:F.Class.UNIVERSAL,type:F.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:F.Class.UNIVERSAL,type:F.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:F.Class.UNIVERSAL,type:F.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:F.Class.UNIVERSAL,type:F.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:F.Class.UNIVERSAL,type:F.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:F.Class.UNIVERSAL,type:F.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},d7={name:"pkcs-12PbeParams",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:F.Class.UNIVERSAL,type:F.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:F.Class.UNIVERSAL,type:F.Type.INTEGER,constructed:!1,capture:"iterations"}]};ye.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=ne.random.getBytesSync(r.saltSize),i=r.count,s=F.integerToDer(i),o,a,u;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var l,f,h;switch(r.algorithm){case"aes128":o=16,l=16,f=ks["aes128-CBC"],h=ne.aes.createEncryptionCipher;break;case"aes192":o=24,l=16,f=ks["aes192-CBC"],h=ne.aes.createEncryptionCipher;break;case"aes256":o=32,l=16,f=ks["aes256-CBC"],h=ne.aes.createEncryptionCipher;break;case"des":o=8,l=8,f=ks.desCBC,h=ne.des.createEncryptionCipher;break;default:var p=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw p.algorithm=r.algorithm,p}var g="hmacWith"+r.prfAlgorithm.toUpperCase(),d=v2(g),y=ne.pkcs5.pbkdf2(e,n,i,o,d),v=ne.random.getBytesSync(l),m=h(y);m.start(v),m.update(F.toDer(t)),m.finish(),u=m.output.getBytes();var w=p7(n,s,o,g);a=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(ks.pkcs5PBES2).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(ks.pkcs5PBKDF2).getBytes()),w]),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(f).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){o=24;var x=new ne.util.ByteBuffer(n),y=ye.pbe.generatePkcs12Key(e,x,1,i,o),v=ye.pbe.generatePkcs12Key(e,x,2,i,o),m=ne.des.createEncryptionCipher(y);m.start(v),m.update(F.toDer(t)),m.finish(),u=m.output.getBytes(),a=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(ks["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,n),F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,s.getBytes())])])}else{var p=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw p.algorithm=r.algorithm,p}var A=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[a,F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,u)]);return A};ye.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!F.validate(t,f7,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=F.derToOid(n.encryptionOid),a=ye.pbe.getCipher(o,n.encryptionParams,e),u=ne.util.createBuffer(n.encryptedData);return a.update(u),a.finish()&&(r=F.fromDer(a.output)),r};ye.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:F.toDer(t).getBytes()};return ne.pem.encode(r,{maxline:e})};ye.encryptedPrivateKeyFromPem=function(t){var e=ne.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return F.fromDer(e.body)};ye.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=ye.wrapRsaPrivateKey(ye.privateKeyToAsn1(t));return n=ye.encryptPrivateKeyInfo(n,e,r),ye.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=ne.random.getBytesSync(16),a=ne.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=ne.random.getBytesSync(16),a=ne.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=ne.random.getBytesSync(16),a=ne.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=ne.random.getBytesSync(8),a=ne.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=ne.random.getBytesSync(8),a=ne.des.createEncryptionCipher;break;default:var u=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw u.algorithm=r.algorithm,u}var l=ne.pbe.opensslDeriveBytes(e,s.substr(0,8),o),f=a(l);f.start(s),f.update(F.toDer(ye.privateKeyToAsn1(t))),f.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:ne.util.bytesToHex(s).toUpperCase()},body:f.output.getBytes()};return ne.pem.encode(h)};ye.decryptRsaPrivateKey=function(t,e){var r=null,n=ne.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=ne.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=ne.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=ne.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=ne.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=ne.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=c(function(h){return ne.rc2.createDecryptionCipher(h,40)},"cipherFn");break;case"RC2-64-CBC":s=8,o=c(function(h){return ne.rc2.createDecryptionCipher(h,64)},"cipherFn");break;case"RC2-128-CBC":s=16,o=c(function(h){return ne.rc2.createDecryptionCipher(h,128)},"cipherFn");break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=ne.util.hexToBytes(n.dekInfo.parameters),u=ne.pbe.opensslDeriveBytes(e,a.substr(0,8),s),l=o(u);if(l.start(a),l.update(ne.util.createBuffer(n.body)),l.finish())r=l.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=ye.decryptPrivateKeyInfo(F.fromDer(r),e):r=F.fromDer(r),r!==null&&(r=ye.privateKeyFromAsn1(r)),r};ye.pbe.generatePkcs12Key=function(t,e,r,n,i,s){var o,a;if(typeof s>"u"||s===null){if(!("sha1"in ne.md))throw new Error('"sha1" hash algorithm unavailable.');s=ne.md.sha1.create()}var u=s.digestLength,l=s.blockLength,f=new ne.util.ByteBuffer,h=new ne.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var p=h.length(),g=e.length(),d=new ne.util.ByteBuffer;d.fillWithByte(r,l);var y=l*Math.ceil(g/l),v=new ne.util.ByteBuffer;for(a=0;a<y;a++)v.putByte(e.at(a%g));var m=l*Math.ceil(p/l),w=new ne.util.ByteBuffer;for(a=0;a<m;a++)w.putByte(h.at(a%p));var x=v;x.putBuffer(w);for(var A=Math.ceil(i/u),O=1;O<=A;O++){var P=new ne.util.ByteBuffer;P.putBytes(d.bytes()),P.putBytes(x.bytes());for(var j=0;j<n;j++)s.start(),s.update(P.getBytes()),P=s.digest();var Q=new ne.util.ByteBuffer;for(a=0;a<l;a++)Q.putByte(P.at(a%u));var se=Math.ceil(g/l)+Math.ceil(p/l),re=new ne.util.ByteBuffer;for(o=0;o<se;o++){var k=new ne.util.ByteBuffer(x.getBytes(l)),Ae=511;for(a=Q.length()-1;a>=0;a--)Ae=Ae>>8,Ae+=Q.at(a)+k.at(a),k.setAt(a,Ae&255);re.putBuffer(k)}x=re,f.putBuffer(P)}return f.truncate(f.length()-i),f};ye.pbe.getCipher=function(t,e,r){switch(t){case ye.oids.pkcs5PBES2:return ye.pbe.getCipherForPBES2(t,e,r);case ye.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case ye.oids["pbewithSHAAnd40BitRC2-CBC"]:return ye.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};ye.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!F.validate(e,h7,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(t=F.derToOid(n.kdfOid),t!==ye.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=F.derToOid(n.encOid),t!==ye.oids["aes128-CBC"]&&t!==ye.oids["aes192-CBC"]&&t!==ye.oids["aes256-CBC"]&&t!==ye.oids["des-EDE3-CBC"]&&t!==ye.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=ne.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var u,l;switch(ye.oids[t]){case"aes128-CBC":u=16,l=ne.aes.createDecryptionCipher;break;case"aes192-CBC":u=24,l=ne.aes.createDecryptionCipher;break;case"aes256-CBC":u=32,l=ne.aes.createDecryptionCipher;break;case"des-EDE3-CBC":u=24,l=ne.des.createDecryptionCipher;break;case"desCBC":u=8,l=ne.des.createDecryptionCipher;break}var f=m2(n.prfOid),h=ne.pkcs5.pbkdf2(r,o,a,u,f),p=n.encIv,g=l(h);return g.start(p),g};ye.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!F.validate(e,d7,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=ne.util.createBuffer(n.salt),a=ne.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var u,l,f;switch(t){case ye.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:u=24,l=8,f=ne.des.startDecrypting;break;case ye.oids["pbewithSHAAnd40BitRC2-CBC"]:u=5,l=8,f=c(function(y,v){var m=ne.rc2.createDecryptionCipher(y,40);return m.start(v,null),m},"cipherFn");break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var h=m2(n.prfOid),p=ye.pbe.generatePkcs12Key(r,o,1,a,u,h);h.start();var g=ye.pbe.generatePkcs12Key(r,o,2,a,l,h);return f(p,g)};ye.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in ne.md))throw new Error('"md5" hash algorithm unavailable.');n=ne.md.md5.create()}e===null&&(e="");for(var i=[y2(n,t+e)],s=16,o=1;s<r;++o,s+=16)i.push(y2(n,i[o-1]+t+e));return i.join("").substr(0,r)};function y2(t,e){return t.start().update(e).digest().getBytes()}c(y2,"hash");function m2(t){var e;if(!t)e="hmacWithSHA1";else if(e=ye.oids[F.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return v2(e)}c(m2,"prfOidToMessageDigest");function v2(t){var e=ne.md;switch(t){case"hmacWithSHA224":e=ne.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}c(v2,"prfAlgorithmToMessageDigest");function p7(t,e,r,n){var i=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,t),F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,ne.util.hexToBytes(r.toString(16))),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(ye.oids[n]).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.NULL,!1,"")])),i}c(p7,"createPbkdf2Params")});var jv=_((DJ,w2)=>{var ko=ve();_n();qe();var te=ko.asn1,Fo=w2.exports=ko.pkcs7asn1=ko.pkcs7asn1||{};ko.pkcs7=ko.pkcs7||{};ko.pkcs7.asn1=Fo;var S2={name:"ContentInfo",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:te.Class.UNIVERSAL,type:te.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:te.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};Fo.contentInfoValidator=S2;var C2={name:"EncryptedContentInfo",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:te.Class.UNIVERSAL,type:te.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:te.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:te.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};Fo.envelopedDataValidator={name:"EnvelopedData",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:te.Class.UNIVERSAL,type:te.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(C2)};Fo.encryptedDataValidator={name:"EncryptedData",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"version"}].concat(C2)};var g7={name:"SignerInfo",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:te.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:te.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:te.Class.UNIVERSAL,type:te.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:te.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};Fo.signedDataValidator={name:"SignedData",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:te.Class.UNIVERSAL,type:te.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},S2,{name:"SignedData.Certificates",tagClass:te.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:te.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:te.Class.UNIVERSAL,type:te.Type.SET,capture:"signerInfos",optional:!0,value:[g7]}]};Fo.recipientInfoValidator={name:"RecipientInfo",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:te.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:te.Class.UNIVERSAL,type:te.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var zv=_((LJ,x2)=>{var Fs=ve();qe();Fs.mgf=Fs.mgf||{};var y7=x2.exports=Fs.mgf.mgf1=Fs.mgf1=Fs.mgf1||{};y7.create=function(t){var e={generate:function(r,n){for(var i=new Fs.util.ByteBuffer,s=Math.ceil(n/t.digestLength),o=0;o<s;o++){var a=new Fs.util.ByteBuffer;a.putInt32(o),t.start(),t.update(r+a.getBytes()),i.putBuffer(t.digest())}return i.truncate(i.length()-n),i.getBytes()}};return e}});var _2=_((PJ,T2)=>{var Jl=ve();zv();T2.exports=Jl.mgf=Jl.mgf||{};Jl.mgf.mgf1=Jl.mgf1});var ef=_((kJ,b2)=>{var qs=ve();nn();qe();var m7=b2.exports=qs.pss=qs.pss||{};m7.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,n=e.digestLength,i=t.salt||null;typeof i=="string"&&(i=qs.util.createBuffer(i));var s;if("saltLength"in t)s=t.saltLength;else if(i!==null)s=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=t.prng||qs.random,a={};return a.encode=function(u,l){var f,h=l-1,p=Math.ceil(h/8),g=u.digest().getBytes();if(p<n+s+2)throw new Error("Message is too long to encrypt.");var d;i===null?d=o.getBytesSync(s):d=i.bytes();var y=new qs.util.ByteBuffer;y.fillWithByte(0,8),y.putBytes(g),y.putBytes(d),e.start(),e.update(y.getBytes());var v=e.digest().getBytes(),m=new qs.util.ByteBuffer;m.fillWithByte(0,p-s-n-2),m.putByte(1),m.putBytes(d);var w=m.getBytes(),x=p-n-1,A=r.generate(v,x),O="";for(f=0;f<x;f++)O+=String.fromCharCode(w.charCodeAt(f)^A.charCodeAt(f));var P=65280>>8*p-h&255;return O=String.fromCharCode(O.charCodeAt(0)&~P)+O.substr(1),O+v+"\xBC"},a.verify=function(u,l,f){var h,p=f-1,g=Math.ceil(p/8);if(l=l.substr(-g),g<n+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(l.charCodeAt(g-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var d=g-n-1,y=l.substr(0,d),v=l.substr(d,n),m=65280>>8*g-p&255;if(y.charCodeAt(0)&m)throw new Error("Bits beyond keysize not zero as expected.");var w=r.generate(v,d),x="";for(h=0;h<d;h++)x+=String.fromCharCode(y.charCodeAt(h)^w.charCodeAt(h));x=String.fromCharCode(x.charCodeAt(0)&~m)+x.substr(1);var A=g-n-s-2;for(h=0;h<A;h++)if(x.charCodeAt(h)!==0)throw new Error("Leftmost octets not zero as expected");if(x.charCodeAt(A)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var O=x.substr(-s),P=new qs.util.ByteBuffer;P.fillWithByte(0,8),P.putBytes(u),P.putBytes(O),e.start(),e.update(P.getBytes());var j=e.digest().getBytes();return v===j},a}});var nf=_((FJ,R2)=>{var le=ve();qi();_n();Ec();Mn();_2();Ui();Ds();ef();wc();qe();var E=le.asn1,Z=R2.exports=le.pki=le.pki||{},Pe=Z.oids,Et={};Et.CN=Pe.commonName;Et.commonName="CN";Et.C=Pe.countryName;Et.countryName="C";Et.L=Pe.localityName;Et.localityName="L";Et.ST=Pe.stateOrProvinceName;Et.stateOrProvinceName="ST";Et.O=Pe.organizationName;Et.organizationName="O";Et.OU=Pe.organizationalUnitName;Et.organizationalUnitName="OU";Et.E=Pe.emailAddress;Et.emailAddress="E";var A2=le.pki.rsa.publicKeyValidator,v7={name:"Certificate",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:E.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:E.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:E.Class.UNIVERSAL,type:E.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:E.Class.UNIVERSAL,type:E.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:E.Class.UNIVERSAL,type:E.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:E.Class.UNIVERSAL,type:E.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},A2,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:E.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:E.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:E.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:E.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},E7={name:"rsapss",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:E.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:E.Class.UNIVERSAL,type:E.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:E.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:E.Class.UNIVERSAL,type:E.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:E.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:E.Class.UNIVERSAL,type:E.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:E.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:E.Class.UNIVERSAL,type:E.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},S7={name:"CertificationRequestInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},A2,{name:"CertificationRequestInfo.attributes",tagClass:E.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:E.Class.UNIVERSAL,type:E.Type.SET,constructed:!0}]}]}]},C7={name:"CertificationRequest",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[S7,{name:"CertificationRequest.signatureAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:E.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};Z.RDNAttributesAsArray=function(t,e){for(var r=[],n,i,s,o=0;o<t.value.length;++o){n=t.value[o];for(var a=0;a<n.value.length;++a)s={},i=n.value[a],s.type=E.derToOid(i.value[0].value),s.value=i.value[1].value,s.valueTagClass=i.value[1].type,s.type in Pe&&(s.name=Pe[s.type],s.name in Et&&(s.shortName=Et[s.name])),e&&(e.update(s.type),e.update(s.value)),r.push(s)}return r};Z.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var n=t[r],i=E.derToOid(n.value[0].value),s=n.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=i,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in Pe&&(a.name=Pe[a.type],a.name in Et&&(a.shortName=Et[a.name])),a.type===Pe.extensionRequest){a.extensions=[];for(var u=0;u<a.value.length;++u)a.extensions.push(Z.certificateExtensionFromAsn1(a.value[u]))}e.push(a)}return e};function Ki(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,n,i=0;r===null&&i<t.attributes.length;++i)n=t.attributes[i],(e.type&&e.type===n.type||e.name&&e.name===n.name||e.shortName&&e.shortName===n.shortName)&&(r=n);return r}c(Ki,"_getAttribute");var tf=c(function(t,e,r){var n={};if(t!==Pe["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:Pe.sha1},mgf:{algorithmOid:Pe.mgf1,hash:{algorithmOid:Pe.sha1}},saltLength:20});var i={},s=[];if(!E.validate(e,E7,i,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return i.hashOid!==void 0&&(n.hash=n.hash||{},n.hash.algorithmOid=E.derToOid(i.hashOid)),i.maskGenOid!==void 0&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=E.derToOid(i.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=E.derToOid(i.maskGenHashOid)),i.saltLength!==void 0&&(n.saltLength=i.saltLength.charCodeAt(0)),n},"_readSignatureParameters"),rf=c(function(t){switch(Pe[t.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return le.md.sha1.create();case"md5WithRSAEncryption":return le.md.md5.create();case"sha256WithRSAEncryption":return le.md.sha256.create();case"sha384WithRSAEncryption":return le.md.sha384.create();case"sha512WithRSAEncryption":return le.md.sha512.create();case"RSASSA-PSS":return le.md.sha256.create();default:var e=new Error("Could not compute "+t.type+" digest. Unknown signature OID.");throw e.signatureOid=t.signatureOid,e}},"_createSignatureDigest"),N2=c(function(t){var e=t.certificate,r;switch(e.signatureOid){case Pe.sha1WithRSAEncryption:case Pe.sha1WithRSASignature:break;case Pe["RSASSA-PSS"]:var n,i;if(n=Pe[e.signatureParameters.mgf.hash.algorithmOid],n===void 0||le.md[n]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=n,s}if(i=Pe[e.signatureParameters.mgf.algorithmOid],i===void 0||le.mgf[i]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=i,s}if(i=le.mgf[i].create(le.md[n].create()),n=Pe[e.signatureParameters.hash.algorithmOid],n===void 0||le.md[n]===void 0){var s=new Error("Unsupported RSASSA-PSS hash function.");throw s.oid=e.signatureParameters.hash.algorithmOid,s.name=n,s}r=le.pss.create(le.md[n].create(),i,e.signatureParameters.saltLength);break}return e.publicKey.verify(t.md.digest().getBytes(),t.signature,r)},"_verifySignature");Z.certificateFromPem=function(t,e,r){var n=le.pem.decode(t)[0];if(n.type!=="CERTIFICATE"&&n.type!=="X509 CERTIFICATE"&&n.type!=="TRUSTED CERTIFICATE"){var i=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=E.fromDer(n.body,r);return Z.certificateFromAsn1(s,e)};Z.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:E.toDer(Z.certificateToAsn1(t)).getBytes()};return le.pem.encode(r,{maxline:e})};Z.publicKeyFromPem=function(t){var e=le.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=E.fromDer(e.body);return Z.publicKeyFromAsn1(n)};Z.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:E.toDer(Z.publicKeyToAsn1(t)).getBytes()};return le.pem.encode(r,{maxline:e})};Z.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:E.toDer(Z.publicKeyToRSAPublicKey(t)).getBytes()};return le.pem.encode(r,{maxline:e})};Z.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||le.md.sha1.create(),n=e.type||"RSAPublicKey",i;switch(n){case"RSAPublicKey":i=E.toDer(Z.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":i=E.toDer(Z.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(i);var s=r.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};Z.certificationRequestFromPem=function(t,e,r){var n=le.pem.decode(t)[0];if(n.type!=="CERTIFICATE REQUEST"){var i=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=E.fromDer(n.body,r);return Z.certificationRequestFromAsn1(s,e)};Z.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:E.toDer(Z.certificationRequestToAsn1(t)).getBytes()};return le.pem.encode(r,{maxline:e})};Z.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return Ki(t.issuer,e)},t.issuer.addField=function(e){an([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return Ki(t.subject,e)},t.subject.addField=function(e){an([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){an(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){an(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)B2(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,n,i=0;r===null&&i<t.extensions.length;++i)n=t.extensions[i],(e.id&&n.id===e.id||e.name&&n.name===e.name)&&(r=n);return r},t.sign=function(e,r){t.md=r||le.md.sha1.create();var n=Pe[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.tbsCertificate=Z.getTBSCertificate(t);var s=E.toDer(t.tbsCertificate);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var n=e.issuer,i=t.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=i.attributes,s.actualIssuer=n.attributes,s}var o=e.md;if(o===null){o=rf({signatureOid:e.signatureOid,type:"certificate"});var a=e.tbsCertificate||Z.getTBSCertificate(e),u=E.toDer(a);o.update(u.getBytes())}return o!==null&&(r=N2({certificate:t,md:o,signature:e.signature})),r},t.isIssuer=function(e){var r=!1,n=t.issuer,i=e.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){r=!0;for(var s,o,a=0;r&&a<n.attributes.length;++a)s=n.attributes[a],o=i.attributes[a],(s.type!==o.type||s.value!==o.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return Z.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=Pe.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var n=t.extensions[r];if(n.id===e){var i=t.generateSubjectKeyIdentifier().getBytes();return le.util.hexToBytes(n.subjectKeyIdentifier)===i}}return!1},t};Z.certificateFromAsn1=function(t,e){var r={},n=[];if(!E.validate(t,v7,r,n)){var i=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw i.errors=n,i}var s=E.derToOid(r.publicKeyOid);if(s!==Z.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Z.createCertificate();o.version=r.certVersion?r.certVersion.charCodeAt(0):0;var a=le.util.createBuffer(r.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=le.asn1.derToOid(r.certSignatureOid),o.signatureParameters=tf(o.signatureOid,r.certSignatureParams,!0),o.siginfo.algorithmOid=le.asn1.derToOid(r.certinfoSignatureOid),o.siginfo.parameters=tf(o.siginfo.algorithmOid,r.certinfoSignatureParams,!1),o.signature=r.certSignature;var u=[];if(r.certValidity1UTCTime!==void 0&&u.push(E.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&u.push(E.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&u.push(E.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&u.push(E.generalizedTimeToDate(r.certValidity4GeneralizedTime)),u.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(u.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=u[0],o.validity.notAfter=u[1],o.tbsCertificate=r.tbsCertificate,e){o.md=rf({signatureOid:o.signatureOid,type:"certificate"});var l=E.toDer(o.tbsCertificate);o.md.update(l.getBytes())}var f=le.md.sha1.create(),h=E.toDer(r.certIssuer);f.update(h.getBytes()),o.issuer.getField=function(d){return Ki(o.issuer,d)},o.issuer.addField=function(d){an([d]),o.issuer.attributes.push(d)},o.issuer.attributes=Z.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(o.issuer.uniqueId=r.certIssuerUniqueId),o.issuer.hash=f.digest().toHex();var p=le.md.sha1.create(),g=E.toDer(r.certSubject);return p.update(g.getBytes()),o.subject.getField=function(d){return Ki(o.subject,d)},o.subject.addField=function(d){an([d]),o.subject.attributes.push(d)},o.subject.attributes=Z.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(o.subject.uniqueId=r.certSubjectUniqueId),o.subject.hash=p.digest().toHex(),r.certExtensions?o.extensions=Z.certificateExtensionsFromAsn1(r.certExtensions):o.extensions=[],o.publicKey=Z.publicKeyFromAsn1(r.subjectPublicKeyInfo),o};Z.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var n=t.value[r],i=0;i<n.value.length;++i)e.push(Z.certificateExtensionFromAsn1(n.value[i]));return e};Z.certificateExtensionFromAsn1=function(t){var e={};if(e.id=E.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===E.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in Pe){if(e.name=Pe[e.id],e.name==="keyUsage"){var r=E.fromDer(e.value),n=0,i=0;r.value.length>1&&(n=r.value.charCodeAt(1),i=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(n&128)===128,e.nonRepudiation=(n&64)===64,e.keyEncipherment=(n&32)===32,e.dataEncipherment=(n&16)===16,e.keyAgreement=(n&8)===8,e.keyCertSign=(n&4)===4,e.cRLSign=(n&2)===2,e.encipherOnly=(n&1)===1,e.decipherOnly=(i&128)===128}else if(e.name==="basicConstraints"){var r=E.fromDer(e.value);r.value.length>0&&r.value[0].type===E.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;r.value.length>0&&r.value[0].type===E.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(e.pathLenConstraint=E.derToInteger(s))}else if(e.name==="extKeyUsage")for(var r=E.fromDer(e.value),o=0;o<r.value.length;++o){var a=E.derToOid(r.value[o].value);a in Pe?e[Pe[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var r=E.fromDer(e.value),n=0;r.value.length>1&&(n=r.value.charCodeAt(1)),e.client=(n&128)===128,e.server=(n&64)===64,e.email=(n&32)===32,e.objsign=(n&16)===16,e.reserved=(n&8)===8,e.sslCA=(n&4)===4,e.emailCA=(n&2)===2,e.objCA=(n&1)===1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var u,r=E.fromDer(e.value),l=0;l<r.value.length;++l){u=r.value[l];var f={type:u.type,value:u.value};switch(e.altNames.push(f),u.type){case 1:case 2:case 6:break;case 7:f.ip=le.util.bytesToIP(u.value);break;case 8:f.oid=E.derToOid(u.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=E.fromDer(e.value);e.subjectKeyIdentifier=le.util.bytesToHex(r.value)}}return e};Z.certificationRequestFromAsn1=function(t,e){var r={},n=[];if(!E.validate(t,C7,r,n)){var i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw i.errors=n,i}var s=E.derToOid(r.publicKeyOid);if(s!==Z.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Z.createCertificationRequest();if(o.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,o.signatureOid=le.asn1.derToOid(r.csrSignatureOid),o.signatureParameters=tf(o.signatureOid,r.csrSignatureParams,!0),o.siginfo.algorithmOid=le.asn1.derToOid(r.csrSignatureOid),o.siginfo.parameters=tf(o.siginfo.algorithmOid,r.csrSignatureParams,!1),o.signature=r.csrSignature,o.certificationRequestInfo=r.certificationRequestInfo,e){o.md=rf({signatureOid:o.signatureOid,type:"certification request"});var a=E.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var u=le.md.sha1.create();return o.subject.getField=function(l){return Ki(o.subject,l)},o.subject.addField=function(l){an([l]),o.subject.attributes.push(l)},o.subject.attributes=Z.RDNAttributesAsArray(r.certificationRequestInfoSubject,u),o.subject.hash=u.digest().toHex(),o.publicKey=Z.publicKeyFromAsn1(r.subjectPublicKeyInfo),o.getAttribute=function(l){return Ki(o,l)},o.addAttribute=function(l){an([l]),o.attributes.push(l)},o.attributes=Z.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),o};Z.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return Ki(t.subject,e)},t.subject.addField=function(e){an([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return Ki(t,e)},t.addAttribute=function(e){an([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){an(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){an(e),t.attributes=e},t.sign=function(e,r){t.md=r||le.md.sha1.create();var n=Pe[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.certificationRequestInfo=Z.getCertificationRequestInfo(t);var s=E.toDer(t.certificationRequestInfo);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){r=rf({signatureOid:t.signatureOid,type:"certification request"});var n=t.certificationRequestInfo||Z.getCertificationRequestInfo(t),i=E.toDer(n);r.update(i.getBytes())}return r!==null&&(e=N2({certificate:t,md:r,signature:t.signature})),e},t};function qo(t){for(var e=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]),r,n,i=t.attributes,s=0;s<i.length;++s){r=i[s];var o=r.value,a=E.Type.PRINTABLESTRING;"valueTagClass"in r&&(a=r.valueTagClass,a===E.Type.UTF8&&(o=le.util.encodeUtf8(o))),n=E.create(E.Class.UNIVERSAL,E.Type.SET,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(r.type).getBytes()),E.create(E.Class.UNIVERSAL,a,!1,o)])]),e.value.push(n)}return e}c(qo,"_dnToAsn1");function an(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name>"u"&&(e.type&&e.type in Z.oids?e.name=Z.oids[e.type]:e.shortName&&e.shortName in Et&&(e.name=Z.oids[Et[e.shortName]])),typeof e.type>"u")if(e.name&&e.name in Z.oids)e.type=Z.oids[e.name];else{var n=new Error("Attribute type not specified.");throw n.attribute=e,n}if(typeof e.shortName>"u"&&e.name&&e.name in Et&&(e.shortName=Et[e.name]),e.type===Pe.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=E.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var i=0;i<e.extensions.length;++i)e.value.push(Z.certificateExtensionToAsn1(B2(e.extensions[i])))}if(typeof e.value>"u"){var n=new Error("Attribute value not specified.");throw n.attribute=e,n}}}c(an,"_fillMissingFields");function B2(t,e){if(e=e||{},typeof t.name>"u"&&t.id&&t.id in Z.oids&&(t.name=Z.oids[t.id]),typeof t.id>"u")if(t.name&&t.name in Z.oids)t.id=Z.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value<"u")return t;if(t.name==="keyUsage"){var n=0,i=0,s=0;t.digitalSignature&&(i|=128,n=7),t.nonRepudiation&&(i|=64,n=6),t.keyEncipherment&&(i|=32,n=5),t.dataEncipherment&&(i|=16,n=4),t.keyAgreement&&(i|=8,n=3),t.keyCertSign&&(i|=4,n=2),t.cRLSign&&(i|=2,n=1),t.encipherOnly&&(i|=1,n=0),t.decipherOnly&&(s|=128,n=7);var o=String.fromCharCode(n);s!==0?o+=String.fromCharCode(i)+String.fromCharCode(s):i!==0&&(o+=String.fromCharCode(i)),t.value=E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,o)}else if(t.name==="basicConstraints")t.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(E.create(E.Class.UNIVERSAL,E.Type.BOOLEAN,!1,"\xFF")),"pathLenConstraint"in t&&t.value.value.push(E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);var a=t.value.value;for(var u in t)t[u]===!0&&(u in Pe?a.push(E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Pe[u]).getBytes())):u.indexOf(".")!==-1&&a.push(E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(u).getBytes())))}else if(t.name==="nsCertType"){var n=0,i=0;t.client&&(i|=128,n=7),t.server&&(i|=64,n=6),t.email&&(i|=32,n=5),t.objsign&&(i|=16,n=4),t.reserved&&(i|=8,n=3),t.sslCA&&(i|=4,n=2),t.emailCA&&(i|=2,n=1),t.objCA&&(i|=1,n=0);var o=String.fromCharCode(n);i!==0&&(o+=String.fromCharCode(i)),t.value=E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,o)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);for(var l,f=0;f<t.altNames.length;++f){l=t.altNames[f];var o=l.value;if(l.type===7&&l.ip){if(o=le.util.bytesFromIP(l.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else l.type===8&&(l.oid?o=E.oidToDer(E.oidToDer(l.oid)):o=E.oidToDer(o));t.value.value.push(E.create(E.Class.CONTEXT_SPECIFIC,l.type,!1,o))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=E.create(E.Class.UNIVERSAL,E.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var h=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=h.toHex(),t.value=E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,h.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);var a=t.value.value;if(t.keyIdentifier){var p=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;a.push(E.create(E.Class.CONTEXT_SPECIFIC,0,!1,p))}if(t.authorityCertIssuer){var g=[E.create(E.Class.CONTEXT_SPECIFIC,4,!0,[qo(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];a.push(E.create(E.Class.CONTEXT_SPECIFIC,1,!0,g))}if(t.serialNumber){var d=le.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);a.push(E.create(E.Class.CONTEXT_SPECIFIC,2,!1,d))}}else if(t.name==="cRLDistributionPoints"){t.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);for(var a=t.value.value,y=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]),v=E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[]),l,f=0;f<t.altNames.length;++f){l=t.altNames[f];var o=l.value;if(l.type===7&&l.ip){if(o=le.util.bytesFromIP(l.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else l.type===8&&(l.oid?o=E.oidToDer(E.oidToDer(l.oid)):o=E.oidToDer(o));v.value.push(E.create(E.Class.CONTEXT_SPECIFIC,l.type,!1,o))}y.value.push(E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[v])),a.push(y)}if(typeof t.value>"u"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}c(B2,"_fillMissingExtensionFields");function Wv(t,e){switch(t){case Pe["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(e.hash.algorithmOid).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(E.create(E.Class.CONTEXT_SPECIFIC,1,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(e.mgf.algorithmOid).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(e.mgf.hash.algorithmOid).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(E.create(E.Class.CONTEXT_SPECIFIC,2,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(e.saltLength).getBytes())])),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,r);default:return E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")}}c(Wv,"_signatureParametersToAsn1");function w7(t){var e=E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,n=0;n<r.length;++n){var i=r[n],s=i.value,o=E.Type.UTF8;"valueTagClass"in i&&(o=i.valueTagClass),o===E.Type.UTF8&&(s=le.util.encodeUtf8(s));var a=!1;"valueConstructed"in i&&(a=i.valueConstructed);var u=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(i.type).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SET,!0,[E.create(E.Class.UNIVERSAL,o,a,s)])]);e.value.push(u)}return e}c(w7,"_CRIAttributesToAsn1");var x7=new Date("1950-01-01T00:00:00Z"),T7=new Date("2050-01-01T00:00:00Z");function I2(t){return t>=x7&&t<T7?E.create(E.Class.UNIVERSAL,E.Type.UTCTIME,!1,E.dateToUtcTime(t)):E.create(E.Class.UNIVERSAL,E.Type.GENERALIZEDTIME,!1,E.dateToGeneralizedTime(t))}c(I2,"_dateToAsn1");Z.getTBSCertificate=function(t){var e=I2(t.validity.notBefore),r=I2(t.validity.notAfter),n=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(t.version).getBytes())]),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,le.util.hexToBytes(t.serialNumber)),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(t.siginfo.algorithmOid).getBytes()),Wv(t.siginfo.algorithmOid,t.siginfo.parameters)]),qo(t.issuer),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[e,r]),qo(t.subject),Z.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&n.value.push(E.create(E.Class.CONTEXT_SPECIFIC,1,!0,[E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,"\0"+t.issuer.uniqueId)])),t.subject.uniqueId&&n.value.push(E.create(E.Class.CONTEXT_SPECIFIC,2,!0,[E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,"\0"+t.subject.uniqueId)])),t.extensions.length>0&&n.value.push(Z.certificateExtensionsToAsn1(t.extensions)),n};Z.getCertificationRequestInfo=function(t){var e=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(t.version).getBytes()),qo(t.subject),Z.publicKeyToAsn1(t.publicKey),w7(t)]);return e};Z.distinguishedNameToAsn1=function(t){return qo(t)};Z.certificateToAsn1=function(t){var e=t.tbsCertificate||Z.getTBSCertificate(t);return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[e,E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(t.signatureOid).getBytes()),Wv(t.signatureOid,t.signatureParameters)]),E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,"\0"+t.signature)])};Z.certificateExtensionsToAsn1=function(t){var e=E.create(E.Class.CONTEXT_SPECIFIC,3,!0,[]),r=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);e.value.push(r);for(var n=0;n<t.length;++n)r.value.push(Z.certificateExtensionToAsn1(t[n]));return e};Z.certificateExtensionToAsn1=function(t){var e=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);e.value.push(E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(t.id).getBytes())),t.critical&&e.value.push(E.create(E.Class.UNIVERSAL,E.Type.BOOLEAN,!1,"\xFF"));var r=t.value;return typeof t.value!="string"&&(r=E.toDer(r).getBytes()),e.value.push(E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,r)),e};Z.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||Z.getCertificationRequestInfo(t);return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[e,E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(t.signatureOid).getBytes()),Wv(t.signatureOid,t.signatureParameters)]),E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,"\0"+t.signature)])};Z.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(o){var a=r(o.issuer);return a},e.addCertificate=function(o){if(typeof o=="string"&&(o=le.pki.certificateFromPem(o)),n(o.subject),!e.hasCertificate(o))if(o.subject.hash in e.certs){var a=e.certs[o.subject.hash];le.util.isArray(a)||(a=[a]),a.push(o),e.certs[o.subject.hash]=a}else e.certs[o.subject.hash]=o},e.hasCertificate=function(o){typeof o=="string"&&(o=le.pki.certificateFromPem(o));var a=r(o.subject);if(!a)return!1;le.util.isArray(a)||(a=[a]);for(var u=E.toDer(Z.certificateToAsn1(o)).getBytes(),l=0;l<a.length;++l){var f=E.toDer(Z.certificateToAsn1(a[l])).getBytes();if(u===f)return!0}return!1},e.listAllCertificates=function(){var o=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var u=e.certs[a];if(!le.util.isArray(u))o.push(u);else for(var l=0;l<u.length;++l)o.push(u[l])}return o},e.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=le.pki.certificateFromPem(o)),n(o.subject),!e.hasCertificate(o))return null;var u=r(o.subject);if(!le.util.isArray(u))return a=e.certs[o.subject.hash],delete e.certs[o.subject.hash],a;for(var l=E.toDer(Z.certificateToAsn1(o)).getBytes(),f=0;f<u.length;++f){var h=E.toDer(Z.certificateToAsn1(u[f])).getBytes();l===h&&(a=u[f],u.splice(f,1))}return u.length===0&&delete e.certs[o.subject.hash],a};function r(o){return n(o),e.certs[o.hash]||null}c(r,"getBySubject");function n(o){if(!o.hash){var a=le.md.sha1.create();o.attributes=Z.RDNAttributesAsArray(qo(o),a),o.hash=a.digest().toHex()}}if(c(n,"ensureSubjectHasHash"),t)for(var i=0;i<t.length;++i){var s=t[i];e.addCertificate(s)}return e};Z.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};Z.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var n=e.slice(0),i=r.validityCheckDate;typeof i>"u"&&(i=new Date);var s=!0,o=null,a=0;do{var u=e.shift(),l=null,f=!1;if(i&&(i<u.validity.notBefore||i>u.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:Z.certificateError.certificate_expired,notBefore:u.validity.notBefore,notAfter:u.validity.notAfter,now:i}),o===null){if(l=e[0]||t.getIssuer(u),l===null&&u.isIssuer(u)&&(f=!0,l=u),l){var h=l;le.util.isArray(h)||(h=[h]);for(var p=!1;!p&&h.length>0;){l=h.shift();try{p=l.verify(u)}catch{}}p||(o={message:"Certificate signature is invalid.",error:Z.certificateError.bad_certificate})}o===null&&(!l||f)&&!t.hasCertificate(u)&&(o={message:"Certificate is not trusted.",error:Z.certificateError.unknown_ca})}if(o===null&&l&&!u.isIssuer(l)&&(o={message:"Certificate issuer is invalid.",error:Z.certificateError.bad_certificate}),o===null)for(var g={keyUsage:!0,basicConstraints:!0},d=0;o===null&&d<u.extensions.length;++d){var y=u.extensions[d];y.critical&&!(y.name in g)&&(o={message:"Certificate has an unsupported critical extension.",error:Z.certificateError.unsupported_certificate})}if(o===null&&(!s||e.length===0&&(!l||f))){var v=u.getExtension("basicConstraints"),m=u.getExtension("keyUsage");if(m!==null&&(!m.keyCertSign||v===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:Z.certificateError.bad_certificate}),o===null&&v!==null&&!v.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:Z.certificateError.bad_certificate}),o===null&&m!==null&&"pathLenConstraint"in v){var w=a-1;w>v.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:Z.certificateError.bad_certificate})}}var x=o===null?!0:o.error,A=r.verify?r.verify(x,a,n):x;if(A===!0)o=null;else throw x===!0&&(o={message:"The application rejected the certificate.",error:Z.certificateError.bad_certificate}),(A||A===0)&&(typeof A=="object"&&!le.util.isArray(A)?(A.message&&(o.message=A.message),A.error&&(o.error=A.error)):typeof A=="string"&&(o.error=A)),o;s=!1,++a}while(e.length>0);return!0}});var Yv=_((UJ,D2)=>{var tt=ve();_n();Ro();Ui();jv();Gv();nn();wc();Po();qe();nf();var I=tt.asn1,be=tt.pki,Tc=D2.exports=tt.pkcs12=tt.pkcs12||{},O2={name:"ContentInfo",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:I.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},_7={name:"PFX",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"version"},O2,{name:"PFX.macData",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:I.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},b7={name:"SafeBag",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:I.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:I.Class.UNIVERSAL,type:I.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},I7={name:"Attribute",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:I.Class.UNIVERSAL,type:I.Type.SET,constructed:!0,capture:"values"}]},A7={name:"CertBag",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:I.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:I.Class.UNIVERSAL,type:I.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function xc(t,e,r,n){for(var i=[],s=0;s<t.length;s++)for(var o=0;o<t[s].safeBags.length;o++){var a=t[s].safeBags[o];if(!(n!==void 0&&a.type!==n)){if(e===null){i.push(a);continue}a.attributes[e]!==void 0&&a.attributes[e].indexOf(r)>=0&&i.push(a)}}return i}c(xc,"_getBagsByAttribute");Tc.pkcs12FromAsn1=function(t,e,r){typeof e=="string"?(r=e,e=!0):e===void 0&&(e=!0);var n={},i=[];if(!I.validate(t,_7,n,i)){var s=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw s.errors=s,s}var o={version:n.version.charCodeAt(0),safeContents:[],getBags:function(v){var m={},w;return"localKeyId"in v?w=v.localKeyId:"localKeyIdHex"in v&&(w=tt.util.hexToBytes(v.localKeyIdHex)),w===void 0&&!("friendlyName"in v)&&"bagType"in v&&(m[v.bagType]=xc(o.safeContents,null,null,v.bagType)),w!==void 0&&(m.localKeyId=xc(o.safeContents,"localKeyId",w,v.bagType)),"friendlyName"in v&&(m.friendlyName=xc(o.safeContents,"friendlyName",v.friendlyName,v.bagType)),m},getBagsByFriendlyName:function(v,m){return xc(o.safeContents,"friendlyName",v,m)},getBagsByLocalKeyId:function(v,m){return xc(o.safeContents,"localKeyId",v,m)}};if(n.version.charCodeAt(0)!==3){var s=new Error("PKCS#12 PFX of version other than 3 not supported.");throw s.version=n.version.charCodeAt(0),s}if(I.derToOid(n.contentType)!==be.oids.data){var s=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw s.oid=I.derToOid(n.contentType),s}var a=n.content.value[0];if(a.tagClass!==I.Class.UNIVERSAL||a.type!==I.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(a=Qv(a),n.mac){var u=null,l=0,f=I.derToOid(n.macAlgorithm);switch(f){case be.oids.sha1:u=tt.md.sha1.create(),l=20;break;case be.oids.sha256:u=tt.md.sha256.create(),l=32;break;case be.oids.sha384:u=tt.md.sha384.create(),l=48;break;case be.oids.sha512:u=tt.md.sha512.create(),l=64;break;case be.oids.md5:u=tt.md.md5.create(),l=16;break}if(u===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+f);var h=new tt.util.ByteBuffer(n.macSalt),p="macIterations"in n?parseInt(tt.util.bytesToHex(n.macIterations),16):1,g=Tc.generateKey(r,h,3,p,l,u),d=tt.hmac.create();d.start(u,g),d.update(a.value);var y=d.getMac();if(y.getBytes()!==n.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return N7(o,a.value,e,r),o};function Qv(t){if(t.composed||t.constructed){for(var e=tt.util.createBuffer(),r=0;r<t.value.length;++r)e.putBytes(t.value[r].value);t.composed=t.constructed=!1,t.value=e.getBytes()}return t}c(Qv,"_decodePkcs7Data");function N7(t,e,r,n){if(e=I.fromDer(e,r),e.tagClass!==I.Class.UNIVERSAL||e.type!==I.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var i=0;i<e.value.length;i++){var s=e.value[i],o={},a=[];if(!I.validate(s,O2,o,a)){var u=new Error("Cannot read ContentInfo.");throw u.errors=a,u}var l={encrypted:!1},f=null,h=o.content.value[0];switch(I.derToOid(o.contentType)){case be.oids.data:if(h.tagClass!==I.Class.UNIVERSAL||h.type!==I.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");f=Qv(h).value;break;case be.oids.encryptedData:f=B7(h,n),l.encrypted=!0;break;default:var u=new Error("Unsupported PKCS#12 contentType.");throw u.contentType=I.derToOid(o.contentType),u}l.safeBags=R7(f,r,n),t.safeContents.push(l)}}c(N7,"_decodeAuthenticatedSafe");function B7(t,e){var r={},n=[];if(!I.validate(t,tt.pkcs7.asn1.encryptedDataValidator,r,n)){var i=new Error("Cannot read EncryptedContentInfo.");throw i.errors=n,i}var s=I.derToOid(r.contentType);if(s!==be.oids.data){var i=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw i.oid=s,i}s=I.derToOid(r.encAlgorithm);var o=be.pbe.getCipher(s,r.encParameter,e),a=Qv(r.encryptedContentAsn1),u=tt.util.createBuffer(a.value);if(o.update(u),!o.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return o.output.getBytes()}c(B7,"_decryptSafeContents");function R7(t,e,r){if(!e&&t.length===0)return[];if(t=I.fromDer(t,e),t.tagClass!==I.Class.UNIVERSAL||t.type!==I.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],i=0;i<t.value.length;i++){var s=t.value[i],o={},a=[];if(!I.validate(s,b7,o,a)){var u=new Error("Cannot read SafeBag.");throw u.errors=a,u}var l={type:I.derToOid(o.bagId),attributes:O7(o.bagAttributes)};n.push(l);var f,h,p=o.bagValue.value[0];switch(l.type){case be.oids.pkcs8ShroudedKeyBag:if(p=be.decryptPrivateKeyInfo(p,r),p===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case be.oids.keyBag:try{l.key=be.privateKeyFromAsn1(p)}catch{l.key=null,l.asn1=p}continue;case be.oids.certBag:f=A7,h=c(function(){if(I.derToOid(o.certId)!==be.oids.x509Certificate){var d=new Error("Unsupported certificate type, only X.509 supported.");throw d.oid=I.derToOid(o.certId),d}var y=I.fromDer(o.cert,e);try{l.cert=be.certificateFromAsn1(y,!0)}catch{l.cert=null,l.asn1=y}},"decoder");break;default:var u=new Error("Unsupported PKCS#12 SafeBag type.");throw u.oid=l.type,u}if(f!==void 0&&!I.validate(p,f,o,a)){var u=new Error("Cannot read PKCS#12 "+f.name);throw u.errors=a,u}h()}return n}c(R7,"_decodeSafeContents");function O7(t){var e={};if(t!==void 0)for(var r=0;r<t.length;++r){var n={},i=[];if(!I.validate(t[r],I7,n,i)){var s=new Error("Cannot read PKCS#12 BagAttribute.");throw s.errors=i,s}var o=I.derToOid(n.oid);if(be.oids[o]!==void 0){e[be.oids[o]]=[];for(var a=0;a<n.values.length;++a)e[be.oids[o]].push(n.values[a].value)}}return e}c(O7,"_decodeBagAttributes");Tc.toPkcs12Asn1=function(t,e,r,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var i=n.localKeyId,s;if(i!==null)i=tt.util.hexToBytes(i);else if(n.generateLocalKeyId)if(e){var o=tt.util.isArray(e)?e[0]:e;typeof o=="string"&&(o=be.certificateFromPem(o));var a=tt.md.sha1.create();a.update(I.toDer(be.certificateToAsn1(o)).getBytes()),i=a.digest().getBytes()}else i=tt.random.getBytes(20);var u=[];i!==null&&u.push(I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(be.oids.localKeyId).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SET,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,i)])])),"friendlyName"in n&&u.push(I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(be.oids.friendlyName).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SET,!0,[I.create(I.Class.UNIVERSAL,I.Type.BMPSTRING,!1,n.friendlyName)])])),u.length>0&&(s=I.create(I.Class.UNIVERSAL,I.Type.SET,!0,u));var l=[],f=[];e!==null&&(tt.util.isArray(e)?f=e:f=[e]);for(var h=[],p=0;p<f.length;++p){e=f[p],typeof e=="string"&&(e=be.certificateFromPem(e));var g=p===0?s:void 0,d=be.certificateToAsn1(e),y=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(be.oids.certBag).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(be.oids.x509Certificate).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,I.toDer(d).getBytes())])])]),g]);h.push(y)}if(h.length>0){var v=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,h),m=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(be.oids.data).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,I.toDer(v).getBytes())])]);l.push(m)}var w=null;if(t!==null){var x=be.wrapRsaPrivateKey(be.privateKeyToAsn1(t));r===null?w=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(be.oids.keyBag).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[x]),s]):w=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(be.oids.pkcs8ShroudedKeyBag).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[be.encryptPrivateKeyInfo(x,r,n)]),s]);var A=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[w]),O=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(be.oids.data).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,I.toDer(A).getBytes())])]);l.push(O)}var P=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,l),j;if(n.useMac){var a=tt.md.sha1.create(),Q=new tt.util.ByteBuffer(tt.random.getBytes(n.saltSize)),se=n.count,t=Tc.generateKey(r,Q,3,se,20),re=tt.hmac.create();re.start(a,t),re.update(I.toDer(P).getBytes());var k=re.getMac();j=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(be.oids.sha1).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")]),I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,k.getBytes())]),I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,Q.getBytes()),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(se).getBytes())])}return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(3).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(be.oids.data).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,I.toDer(P).getBytes())])]),j])};Tc.generateKey=tt.pbe.generatePkcs12Key});var Xv=_((MJ,L2)=>{var Hi=ve();_n();Ui();Gv();Ds();zl();Yv();ef();wc();qe();nf();var Zv=Hi.asn1,Uo=L2.exports=Hi.pki=Hi.pki||{};Uo.pemToDer=function(t){var e=Hi.pem.decode(t)[0];if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return Hi.util.createBuffer(e.body)};Uo.privateKeyFromPem=function(t){var e=Hi.pem.decode(t)[0];if(e.type!=="PRIVATE KEY"&&e.type!=="RSA PRIVATE KEY"){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var n=Zv.fromDer(e.body);return Uo.privateKeyFromAsn1(n)};Uo.privateKeyToPem=function(t,e){var r={type:"RSA PRIVATE KEY",body:Zv.toDer(Uo.privateKeyToAsn1(t)).getBytes()};return Hi.pem.encode(r,{maxline:e})};Uo.privateKeyInfoToPem=function(t,e){var r={type:"PRIVATE KEY",body:Zv.toDer(t).getBytes()};return Hi.pem.encode(r,{maxline:e})}});var iE=_((KJ,K2)=>{var H=ve();_n();Ro();Hl();Ds();Xv();nn();Po();qe();var cf=c(function(t,e,r,n){var i=H.util.createBuffer(),s=t.length>>1,o=s+(t.length&1),a=t.substr(0,o),u=t.substr(s,o),l=H.util.createBuffer(),f=H.hmac.create();r=e+r;var h=Math.ceil(n/16),p=Math.ceil(n/20);f.start("MD5",a);var g=H.util.createBuffer();l.putBytes(r);for(var d=0;d<h;++d)f.start(null,null),f.update(l.getBytes()),l.putBuffer(f.digest()),f.start(null,null),f.update(l.bytes()+r),g.putBuffer(f.digest());f.start("SHA1",u);var y=H.util.createBuffer();l.clear(),l.putBytes(r);for(var d=0;d<p;++d)f.start(null,null),f.update(l.getBytes()),l.putBuffer(f.digest()),f.start(null,null),f.update(l.bytes()+r),y.putBuffer(f.digest());return i.putBytes(H.util.xorBytes(g.getBytes(),y.getBytes(),n)),i},"prf_TLS1"),D7=c(function(t,e,r){var n=H.hmac.create();n.start("SHA1",t);var i=H.util.createBuffer();return i.putInt32(e[0]),i.putInt32(e[1]),i.putByte(r.type),i.putByte(r.version.major),i.putByte(r.version.minor),i.putInt16(r.length),i.putBytes(r.fragment.bytes()),n.update(i.getBytes()),n.digest().getBytes()},"hmac_sha1"),L7=c(function(t,e,r){var n=!1;try{var i=t.deflate(e.fragment.getBytes());e.fragment=H.util.createBuffer(i),e.length=i.length,n=!0}catch{}return n},"deflate"),P7=c(function(t,e,r){var n=!1;try{var i=t.inflate(e.fragment.getBytes());e.fragment=H.util.createBuffer(i),e.length=i.length,n=!0}catch{}return n},"inflate"),Kr=c(function(t,e){var r=0;switch(e){case 1:r=t.getByte();break;case 2:r=t.getInt16();break;case 3:r=t.getInt24();break;case 4:r=t.getInt32();break}return H.util.createBuffer(t.getBytes(r))},"readVector"),cn=c(function(t,e,r){t.putInt(r.length(),e<<3),t.putBuffer(r)},"writeVector"),C={};C.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};C.SupportedVersions=[C.Versions.TLS_1_1,C.Versions.TLS_1_0];C.Version=C.SupportedVersions[0];C.MaxFragment=15360;C.ConnectionEnd={server:0,client:1};C.PRFAlgorithm={tls_prf_sha256:0};C.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};C.CipherType={stream:0,block:1,aead:2};C.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};C.CompressionMethod={none:0,deflate:1};C.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};C.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};C.Alert={};C.Alert.Level={warning:1,fatal:2};C.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};C.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};C.CipherSuites={};C.getCipherSuite=function(t){var e=null;for(var r in C.CipherSuites){var n=C.CipherSuites[r];if(n.id[0]===t.charCodeAt(0)&&n.id[1]===t.charCodeAt(1)){e=n;break}}return e};C.handleUnexpected=function(t,e){var r=!t.open&&t.entity===C.ConnectionEnd.client;r||t.error(t,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.unexpected_message}})};C.handleHelloRequest=function(t,e,r){!t.handshaking&&t.handshakes>0&&(C.queue(t,C.createAlert(t,{level:C.Alert.Level.warning,description:C.Alert.Description.no_renegotiation})),C.flush(t)),t.process()};C.parseHelloMessage=function(t,e,r){var n=null,i=t.entity===C.ConnectionEnd.client;if(r<38)t.error(t,{message:i?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.illegal_parameter}});else{var s=e.fragment,o=s.length();if(n={version:{major:s.getByte(),minor:s.getByte()},random:H.util.createBuffer(s.getBytes(32)),session_id:Kr(s,1),extensions:[]},i?(n.cipher_suite=s.getBytes(2),n.compression_method=s.getByte()):(n.cipher_suites=Kr(s,2),n.compression_methods=Kr(s,1)),o=r-(o-s.length()),o>0){for(var a=Kr(s,2);a.length()>0;)n.extensions.push({type:[a.getByte(),a.getByte()],data:Kr(a,2)});if(!i)for(var u=0;u<n.extensions.length;++u){var l=n.extensions[u];if(l.type[0]===0&&l.type[1]===0)for(var f=Kr(l.data,2);f.length()>0;){var h=f.getByte();if(h!==0)break;t.session.extensions.server_name.serverNameList.push(Kr(f,2).getBytes())}}}if(t.session.version&&(n.version.major!==t.session.version.major||n.version.minor!==t.session.version.minor))return t.error(t,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.protocol_version}});if(i)t.session.cipherSuite=C.getCipherSuite(n.cipher_suite);else for(var p=H.util.createBuffer(n.cipher_suites.bytes());p.length()>0&&(t.session.cipherSuite=C.getCipherSuite(p.getBytes(2)),t.session.cipherSuite===null););if(t.session.cipherSuite===null)return t.error(t,{message:"No cipher suites in common.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.handshake_failure},cipherSuite:H.util.bytesToHex(n.cipher_suite)});i?t.session.compressionMethod=n.compression_method:t.session.compressionMethod=C.CompressionMethod.none}return n};C.createSecurityParameters=function(t,e){var r=t.entity===C.ConnectionEnd.client,n=e.random.bytes(),i=r?t.session.sp.client_random:n,s=r?n:C.createRandom().getBytes();t.session.sp={entity:t.entity,prf_algorithm:C.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:t.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:i,server_random:s}};C.handleServerHello=function(t,e,r){var n=C.parseHelloMessage(t,e,r);if(!t.fail){if(n.version.minor<=t.version.minor)t.version.minor=n.version.minor;else return t.error(t,{message:"Incompatible TLS version.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.protocol_version}});t.session.version=t.version;var i=n.session_id.bytes();i.length>0&&i===t.session.id?(t.expect=F2,t.session.resuming=!0,t.session.sp.server_random=n.random.bytes()):(t.expect=F7,t.session.resuming=!1,C.createSecurityParameters(t,n)),t.session.id=i,t.process()}};C.handleClientHello=function(t,e,r){var n=C.parseHelloMessage(t,e,r);if(!t.fail){var i=n.session_id.bytes(),s=null;if(t.sessionCache&&(s=t.sessionCache.getSession(i),s===null?i="":(s.version.major!==n.version.major||s.version.minor>n.version.minor)&&(s=null,i="")),i.length===0&&(i=H.random.getBytes(32)),t.session.id=i,t.session.clientHelloVersion=n.version,t.session.sp={},s)t.version=t.session.version=s.version,t.session.sp=s.sp;else{for(var o,a=1;a<C.SupportedVersions.length&&(o=C.SupportedVersions[a],!(o.minor<=n.version.minor));++a);t.version={major:o.major,minor:o.minor},t.session.version=t.version}s!==null?(t.expect=rE,t.session.resuming=!0,t.session.sp.client_random=n.random.bytes()):(t.expect=t.verifyClient!==!1?$7:tE,t.session.resuming=!1,C.createSecurityParameters(t,n)),t.open=!0,C.queue(t,C.createRecord(t,{type:C.ContentType.handshake,data:C.createServerHello(t)})),t.session.resuming?(C.queue(t,C.createRecord(t,{type:C.ContentType.change_cipher_spec,data:C.createChangeCipherSpec()})),t.state.pending=C.createConnectionState(t),t.state.current.write=t.state.pending.write,C.queue(t,C.createRecord(t,{type:C.ContentType.handshake,data:C.createFinished(t)}))):(C.queue(t,C.createRecord(t,{type:C.ContentType.handshake,data:C.createCertificate(t)})),t.fail||(C.queue(t,C.createRecord(t,{type:C.ContentType.handshake,data:C.createServerKeyExchange(t)})),t.verifyClient!==!1&&C.queue(t,C.createRecord(t,{type:C.ContentType.handshake,data:C.createCertificateRequest(t)})),C.queue(t,C.createRecord(t,{type:C.ContentType.handshake,data:C.createServerHelloDone(t)})))),C.flush(t),t.process()}};C.handleCertificate=function(t,e,r){if(r<3)return t.error(t,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.illegal_parameter}});var n=e.fragment,i={certificate_list:Kr(n,3)},s,o,a=[];try{for(;i.certificate_list.length()>0;)s=Kr(i.certificate_list,3),o=H.asn1.fromDer(s),s=H.pki.certificateFromAsn1(o,!0),a.push(s)}catch(l){return t.error(t,{message:"Could not parse certificate list.",cause:l,send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.bad_certificate}})}var u=t.entity===C.ConnectionEnd.client;(u||t.verifyClient===!0)&&a.length===0?t.error(t,{message:u?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.illegal_parameter}}):a.length===0?t.expect=u?P2:tE:(u?t.session.serverCertificate=a[0]:t.session.clientCertificate=a[0],C.verifyCertificateChain(t,a)&&(t.expect=u?P2:tE)),t.process()};C.handleServerKeyExchange=function(t,e,r){if(r>0)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.unsupported_certificate}});t.expect=q7,t.process()};C.handleClientKeyExchange=function(t,e,r){if(r<48)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.unsupported_certificate}});var n=e.fragment,i={enc_pre_master_secret:Kr(n,2).getBytes()},s=null;if(t.getPrivateKey)try{s=t.getPrivateKey(t,t.session.serverCertificate),s=H.pki.privateKeyFromPem(s)}catch(u){t.error(t,{message:"Could not get private key.",cause:u,send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.internal_error}})}if(s===null)return t.error(t,{message:"No private key set.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.internal_error}});try{var o=t.session.sp;o.pre_master_secret=s.decrypt(i.enc_pre_master_secret);var a=t.session.clientHelloVersion;if(a.major!==o.pre_master_secret.charCodeAt(0)||a.minor!==o.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{o.pre_master_secret=H.random.getBytes(48)}t.expect=rE,t.session.clientCertificate!==null&&(t.expect=G7),t.process()};C.handleCertificateRequest=function(t,e,r){if(r<3)return t.error(t,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.illegal_parameter}});var n=e.fragment,i={certificate_types:Kr(n,1),certificate_authorities:Kr(n,2)};t.session.certificateRequest=i,t.expect=U7,t.process()};C.handleCertificateVerify=function(t,e,r){if(r<2)return t.error(t,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.illegal_parameter}});var n=e.fragment;n.read-=4;var i=n.bytes();n.read+=4;var s={signature:Kr(n,2).getBytes()},o=H.util.createBuffer();o.putBuffer(t.session.md5.digest()),o.putBuffer(t.session.sha1.digest()),o=o.getBytes();try{var a=t.session.clientCertificate;if(!a.publicKey.verify(o,s.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");t.session.md5.update(i),t.session.sha1.update(i)}catch{return t.error(t,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.handshake_failure}})}t.expect=rE,t.process()};C.handleServerHelloDone=function(t,e,r){if(r>0)return t.error(t,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.record_overflow}});if(t.serverCertificate===null){var n={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.insufficient_security}},i=0,s=t.verify(t,n.alert.description,i,[]);if(s!==!0)return(s||s===0)&&(typeof s=="object"&&!H.util.isArray(s)?(s.message&&(n.message=s.message),s.alert&&(n.alert.description=s.alert)):typeof s=="number"&&(n.alert.description=s)),t.error(t,n)}t.session.certificateRequest!==null&&(e=C.createRecord(t,{type:C.ContentType.handshake,data:C.createCertificate(t)}),C.queue(t,e)),e=C.createRecord(t,{type:C.ContentType.handshake,data:C.createClientKeyExchange(t)}),C.queue(t,e),t.expect=K7;var o=c(function(a,u){a.session.certificateRequest!==null&&a.session.clientCertificate!==null&&C.queue(a,C.createRecord(a,{type:C.ContentType.handshake,data:C.createCertificateVerify(a,u)})),C.queue(a,C.createRecord(a,{type:C.ContentType.change_cipher_spec,data:C.createChangeCipherSpec()})),a.state.pending=C.createConnectionState(a),a.state.current.write=a.state.pending.write,C.queue(a,C.createRecord(a,{type:C.ContentType.handshake,data:C.createFinished(a)})),a.expect=F2,C.flush(a),a.process()},"callback");if(t.session.certificateRequest===null||t.session.clientCertificate===null)return o(t,null);C.getClientSignature(t,o)};C.handleChangeCipherSpec=function(t,e){if(e.fragment.getByte()!==1)return t.error(t,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.illegal_parameter}});var r=t.entity===C.ConnectionEnd.client;(t.session.resuming&&r||!t.session.resuming&&!r)&&(t.state.pending=C.createConnectionState(t)),t.state.current.read=t.state.pending.read,(!t.session.resuming&&r||t.session.resuming&&!r)&&(t.state.pending=null),t.expect=r?V7:j7,t.process()};C.handleFinished=function(t,e,r){var n=e.fragment;n.read-=4;var i=n.bytes();n.read+=4;var s=e.fragment.getBytes();n=H.util.createBuffer(),n.putBuffer(t.session.md5.digest()),n.putBuffer(t.session.sha1.digest());var o=t.entity===C.ConnectionEnd.client,a=o?"server finished":"client finished",u=t.session.sp,l=12,f=cf;if(n=f(u.master_secret,a,n.getBytes(),l),n.getBytes()!==s)return t.error(t,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.decrypt_error}});t.session.md5.update(i),t.session.sha1.update(i),(t.session.resuming&&o||!t.session.resuming&&!o)&&(C.queue(t,C.createRecord(t,{type:C.ContentType.change_cipher_spec,data:C.createChangeCipherSpec()})),t.state.current.write=t.state.pending.write,t.state.pending=null,C.queue(t,C.createRecord(t,{type:C.ContentType.handshake,data:C.createFinished(t)}))),t.expect=o?M7:z7,t.handshaking=!1,++t.handshakes,t.peerCertificate=o?t.session.serverCertificate:t.session.clientCertificate,C.flush(t),t.isConnected=!0,t.connected(t),t.process()};C.handleAlert=function(t,e){var r=e.fragment,n={level:r.getByte(),description:r.getByte()},i;switch(n.description){case C.Alert.Description.close_notify:i="Connection closed.";break;case C.Alert.Description.unexpected_message:i="Unexpected message.";break;case C.Alert.Description.bad_record_mac:i="Bad record MAC.";break;case C.Alert.Description.decryption_failed:i="Decryption failed.";break;case C.Alert.Description.record_overflow:i="Record overflow.";break;case C.Alert.Description.decompression_failure:i="Decompression failed.";break;case C.Alert.Description.handshake_failure:i="Handshake failure.";break;case C.Alert.Description.bad_certificate:i="Bad certificate.";break;case C.Alert.Description.unsupported_certificate:i="Unsupported certificate.";break;case C.Alert.Description.certificate_revoked:i="Certificate revoked.";break;case C.Alert.Description.certificate_expired:i="Certificate expired.";break;case C.Alert.Description.certificate_unknown:i="Certificate unknown.";break;case C.Alert.Description.illegal_parameter:i="Illegal parameter.";break;case C.Alert.Description.unknown_ca:i="Unknown certificate authority.";break;case C.Alert.Description.access_denied:i="Access denied.";break;case C.Alert.Description.decode_error:i="Decode error.";break;case C.Alert.Description.decrypt_error:i="Decrypt error.";break;case C.Alert.Description.export_restriction:i="Export restriction.";break;case C.Alert.Description.protocol_version:i="Unsupported protocol version.";break;case C.Alert.Description.insufficient_security:i="Insufficient security.";break;case C.Alert.Description.internal_error:i="Internal error.";break;case C.Alert.Description.user_canceled:i="User canceled.";break;case C.Alert.Description.no_renegotiation:i="Renegotiation not supported.";break;default:i="Unknown error.";break}if(n.description===C.Alert.Description.close_notify)return t.close();t.error(t,{message:i,send:!1,origin:t.entity===C.ConnectionEnd.client?"server":"client",alert:n}),t.process()};C.handleHandshake=function(t,e){var r=e.fragment,n=r.getByte(),i=r.getInt24();if(i>r.length())return t.fragmented=e,e.fragment=H.util.createBuffer(),r.read-=4,t.process();t.fragmented=null,r.read-=4;var s=r.bytes(i+4);r.read+=4,n in af[t.entity][t.expect]?(t.entity===C.ConnectionEnd.server&&!t.open&&!t.fail&&(t.handshaking=!0,t.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:H.md.md5.create(),sha1:H.md.sha1.create()}),n!==C.HandshakeType.hello_request&&n!==C.HandshakeType.certificate_verify&&n!==C.HandshakeType.finished&&(t.session.md5.update(s),t.session.sha1.update(s)),af[t.entity][t.expect][n](t,e,i)):C.handleUnexpected(t,e)};C.handleApplicationData=function(t,e){t.data.putBuffer(e.fragment),t.dataReady(t),t.process()};C.handleHeartbeat=function(t,e){var r=e.fragment,n=r.getByte(),i=r.getInt16(),s=r.getBytes(i);if(n===C.HeartbeatMessageType.heartbeat_request){if(t.handshaking||i>s.length)return t.process();C.queue(t,C.createRecord(t,{type:C.ContentType.heartbeat,data:C.createHeartbeat(C.HeartbeatMessageType.heartbeat_response,s)})),C.flush(t)}else if(n===C.HeartbeatMessageType.heartbeat_response){if(s!==t.expectedHeartbeatPayload)return t.process();t.heartbeatReceived&&t.heartbeatReceived(t,H.util.createBuffer(s))}t.process()};var k7=0,F7=1,P2=2,q7=3,U7=4,F2=5,V7=6,M7=7,K7=8,H7=0,$7=1,tE=2,G7=3,rE=4,j7=5,z7=6,S=C.handleUnexpected,q2=C.handleChangeCipherSpec,rr=C.handleAlert,Sr=C.handleHandshake,U2=C.handleApplicationData,nr=C.handleHeartbeat,nE=[];nE[C.ConnectionEnd.client]=[[S,rr,Sr,S,nr],[S,rr,Sr,S,nr],[S,rr,Sr,S,nr],[S,rr,Sr,S,nr],[S,rr,Sr,S,nr],[q2,rr,S,S,nr],[S,rr,Sr,S,nr],[S,rr,Sr,U2,nr],[S,rr,Sr,S,nr]];nE[C.ConnectionEnd.server]=[[S,rr,Sr,S,nr],[S,rr,Sr,S,nr],[S,rr,Sr,S,nr],[S,rr,Sr,S,nr],[q2,rr,S,S,nr],[S,rr,Sr,S,nr],[S,rr,Sr,U2,nr],[S,rr,Sr,S,nr]];var $i=C.handleHelloRequest,W7=C.handleServerHello,V2=C.handleCertificate,k2=C.handleServerKeyExchange,Jv=C.handleCertificateRequest,sf=C.handleServerHelloDone,M2=C.handleFinished,af=[];af[C.ConnectionEnd.client]=[[S,S,W7,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[$i,S,S,S,S,S,S,S,S,S,S,V2,k2,Jv,sf,S,S,S,S,S,S],[$i,S,S,S,S,S,S,S,S,S,S,S,k2,Jv,sf,S,S,S,S,S,S],[$i,S,S,S,S,S,S,S,S,S,S,S,S,Jv,sf,S,S,S,S,S,S],[$i,S,S,S,S,S,S,S,S,S,S,S,S,S,sf,S,S,S,S,S,S],[$i,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[$i,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,M2],[$i,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[$i,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S]];var Q7=C.handleClientHello,Y7=C.handleClientKeyExchange,Z7=C.handleCertificateVerify;af[C.ConnectionEnd.server]=[[S,Q7,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,V2,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,Y7,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,Z7,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,M2],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S]];C.generateKeys=function(t,e){var r=cf,n=e.client_random+e.server_random;t.session.resuming||(e.master_secret=r(e.pre_master_secret,"master secret",n,48).bytes(),e.pre_master_secret=null),n=e.server_random+e.client_random;var i=2*e.mac_key_length+2*e.enc_key_length,s=t.version.major===C.Versions.TLS_1_0.major&&t.version.minor===C.Versions.TLS_1_0.minor;s&&(i+=2*e.fixed_iv_length);var o=r(e.master_secret,"key expansion",n,i),a={client_write_MAC_key:o.getBytes(e.mac_key_length),server_write_MAC_key:o.getBytes(e.mac_key_length),client_write_key:o.getBytes(e.enc_key_length),server_write_key:o.getBytes(e.enc_key_length)};return s&&(a.client_write_IV=o.getBytes(e.fixed_iv_length),a.server_write_IV=o.getBytes(e.fixed_iv_length)),a};C.createConnectionState=function(t){var e=t.entity===C.ConnectionEnd.client,r=c(function(){var s={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(o){return!0},compressionState:null,compressFunction:function(o){return!0},updateSequenceNumber:function(){s.sequenceNumber[1]===4294967295?(s.sequenceNumber[1]=0,++s.sequenceNumber[0]):++s.sequenceNumber[1]}};return s},"createMode"),n={read:r(),write:r()};if(n.read.update=function(s,o){return n.read.cipherFunction(o,n.read)?n.read.compressFunction(s,o,n.read)||s.error(s,{message:"Could not decompress record.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.decompression_failure}}):s.error(s,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.bad_record_mac}}),!s.fail},n.write.update=function(s,o){return n.write.compressFunction(s,o,n.write)?n.write.cipherFunction(o,n.write)||s.error(s,{message:"Could not encrypt record.",send:!1,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.internal_error}}):s.error(s,{message:"Could not compress record.",send:!1,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.internal_error}}),!s.fail},t.session){var i=t.session.sp;switch(t.session.cipherSuite.initSecurityParameters(i),i.keys=C.generateKeys(t,i),n.read.macKey=e?i.keys.server_write_MAC_key:i.keys.client_write_MAC_key,n.write.macKey=e?i.keys.client_write_MAC_key:i.keys.server_write_MAC_key,t.session.cipherSuite.initConnectionState(n,t,i),i.compression_algorithm){case C.CompressionMethod.none:break;case C.CompressionMethod.deflate:n.read.compressFunction=P7,n.write.compressFunction=L7;break;default:throw new Error("Unsupported compression algorithm.")}}return n};C.createRandom=function(){var t=new Date,e=+t+t.getTimezoneOffset()*6e4,r=H.util.createBuffer();return r.putInt32(e),r.putBytes(H.random.getBytes(28)),r};C.createRecord=function(t,e){if(!e.data)return null;var r={type:e.type,version:{major:t.version.major,minor:t.version.minor},length:e.data.length(),fragment:e.data};return r};C.createAlert=function(t,e){var r=H.util.createBuffer();return r.putByte(e.level),r.putByte(e.description),C.createRecord(t,{type:C.ContentType.alert,data:r})};C.createClientHello=function(t){t.session.clientHelloVersion={major:t.version.major,minor:t.version.minor};for(var e=H.util.createBuffer(),r=0;r<t.cipherSuites.length;++r){var n=t.cipherSuites[r];e.putByte(n.id[0]),e.putByte(n.id[1])}var i=e.length(),s=H.util.createBuffer();s.putByte(C.CompressionMethod.none);var o=s.length(),a=H.util.createBuffer();if(t.virtualHost){var u=H.util.createBuffer();u.putByte(0),u.putByte(0);var l=H.util.createBuffer();l.putByte(0),cn(l,2,H.util.createBuffer(t.virtualHost));var f=H.util.createBuffer();cn(f,2,l),cn(u,2,f),a.putBuffer(u)}var h=a.length();h>0&&(h+=2);var p=t.session.id,g=p.length+1+2+4+28+2+i+1+o+h,d=H.util.createBuffer();return d.putByte(C.HandshakeType.client_hello),d.putInt24(g),d.putByte(t.version.major),d.putByte(t.version.minor),d.putBytes(t.session.sp.client_random),cn(d,1,H.util.createBuffer(p)),cn(d,2,e),cn(d,1,s),h>0&&cn(d,2,a),d};C.createServerHello=function(t){var e=t.session.id,r=e.length+1+2+4+28+2+1,n=H.util.createBuffer();return n.putByte(C.HandshakeType.server_hello),n.putInt24(r),n.putByte(t.version.major),n.putByte(t.version.minor),n.putBytes(t.session.sp.server_random),cn(n,1,H.util.createBuffer(e)),n.putByte(t.session.cipherSuite.id[0]),n.putByte(t.session.cipherSuite.id[1]),n.putByte(t.session.compressionMethod),n};C.createCertificate=function(t){var e=t.entity===C.ConnectionEnd.client,r=null;if(t.getCertificate){var n;e?n=t.session.certificateRequest:n=t.session.extensions.server_name.serverNameList,r=t.getCertificate(t,n)}var i=H.util.createBuffer();if(r!==null)try{H.util.isArray(r)||(r=[r]);for(var s=null,o=0;o<r.length;++o){var a=H.pem.decode(r[o])[0];if(a.type!=="CERTIFICATE"&&a.type!=="X509 CERTIFICATE"&&a.type!=="TRUSTED CERTIFICATE"){var u=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw u.headerType=a.type,u}if(a.procType&&a.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var l=H.util.createBuffer(a.body);s===null&&(s=H.asn1.fromDer(l.bytes(),!1));var f=H.util.createBuffer();cn(f,3,l),i.putBuffer(f)}r=H.pki.certificateFromAsn1(s),e?t.session.clientCertificate=r:t.session.serverCertificate=r}catch(g){return t.error(t,{message:"Could not send certificate list.",cause:g,send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.bad_certificate}})}var h=3+i.length(),p=H.util.createBuffer();return p.putByte(C.HandshakeType.certificate),p.putInt24(h),cn(p,3,i),p};C.createClientKeyExchange=function(t){var e=H.util.createBuffer();e.putByte(t.session.clientHelloVersion.major),e.putByte(t.session.clientHelloVersion.minor),e.putBytes(H.random.getBytes(46));var r=t.session.sp;r.pre_master_secret=e.getBytes();var n=t.session.serverCertificate.publicKey;e=n.encrypt(r.pre_master_secret);var i=e.length+2,s=H.util.createBuffer();return s.putByte(C.HandshakeType.client_key_exchange),s.putInt24(i),s.putInt16(e.length),s.putBytes(e),s};C.createServerKeyExchange=function(t){var e=0,r=H.util.createBuffer();return e>0&&(r.putByte(C.HandshakeType.server_key_exchange),r.putInt24(e)),r};C.getClientSignature=function(t,e){var r=H.util.createBuffer();r.putBuffer(t.session.md5.digest()),r.putBuffer(t.session.sha1.digest()),r=r.getBytes(),t.getSignature=t.getSignature||function(n,i,s){var o=null;if(n.getPrivateKey)try{o=n.getPrivateKey(n,n.session.clientCertificate),o=H.pki.privateKeyFromPem(o)}catch(a){n.error(n,{message:"Could not get private key.",cause:a,send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.internal_error}})}o===null?n.error(n,{message:"No private key set.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.internal_error}}):i=o.sign(i,null),s(n,i)},t.getSignature(t,r,e)};C.createCertificateVerify=function(t,e){var r=e.length+2,n=H.util.createBuffer();return n.putByte(C.HandshakeType.certificate_verify),n.putInt24(r),n.putInt16(e.length),n.putBytes(e),n};C.createCertificateRequest=function(t){var e=H.util.createBuffer();e.putByte(1);var r=H.util.createBuffer();for(var n in t.caStore.certs){var i=t.caStore.certs[n],s=H.pki.distinguishedNameToAsn1(i.subject),o=H.asn1.toDer(s);r.putInt16(o.length()),r.putBuffer(o)}var a=1+e.length()+2+r.length(),u=H.util.createBuffer();return u.putByte(C.HandshakeType.certificate_request),u.putInt24(a),cn(u,1,e),cn(u,2,r),u};C.createServerHelloDone=function(t){var e=H.util.createBuffer();return e.putByte(C.HandshakeType.server_hello_done),e.putInt24(0),e};C.createChangeCipherSpec=function(){var t=H.util.createBuffer();return t.putByte(1),t};C.createFinished=function(t){var e=H.util.createBuffer();e.putBuffer(t.session.md5.digest()),e.putBuffer(t.session.sha1.digest());var r=t.entity===C.ConnectionEnd.client,n=t.session.sp,i=12,s=cf,o=r?"client finished":"server finished";e=s(n.master_secret,o,e.getBytes(),i);var a=H.util.createBuffer();return a.putByte(C.HandshakeType.finished),a.putInt24(e.length()),a.putBuffer(e),a};C.createHeartbeat=function(t,e,r){typeof r>"u"&&(r=e.length);var n=H.util.createBuffer();n.putByte(t),n.putInt16(r),n.putBytes(e);var i=n.length(),s=Math.max(16,i-r-3);return n.putBytes(H.random.getBytes(s)),n};C.queue=function(t,e){if(e&&!(e.fragment.length()===0&&(e.type===C.ContentType.handshake||e.type===C.ContentType.alert||e.type===C.ContentType.change_cipher_spec))){if(e.type===C.ContentType.handshake){var r=e.fragment.bytes();t.session.md5.update(r),t.session.sha1.update(r),r=null}var n;if(e.fragment.length()<=C.MaxFragment)n=[e];else{n=[];for(var i=e.fragment.bytes();i.length>C.MaxFragment;)n.push(C.createRecord(t,{type:e.type,data:H.util.createBuffer(i.slice(0,C.MaxFragment))})),i=i.slice(C.MaxFragment);i.length>0&&n.push(C.createRecord(t,{type:e.type,data:H.util.createBuffer(i)}))}for(var s=0;s<n.length&&!t.fail;++s){var o=n[s],a=t.state.current.write;a.update(t,o)&&t.records.push(o)}}};C.flush=function(t){for(var e=0;e<t.records.length;++e){var r=t.records[e];t.tlsData.putByte(r.type),t.tlsData.putByte(r.version.major),t.tlsData.putByte(r.version.minor),t.tlsData.putInt16(r.fragment.length()),t.tlsData.putBuffer(t.records[e].fragment)}return t.records=[],t.tlsDataReady(t)};var eE=c(function(t){switch(t){case!0:return!0;case H.pki.certificateError.bad_certificate:return C.Alert.Description.bad_certificate;case H.pki.certificateError.unsupported_certificate:return C.Alert.Description.unsupported_certificate;case H.pki.certificateError.certificate_revoked:return C.Alert.Description.certificate_revoked;case H.pki.certificateError.certificate_expired:return C.Alert.Description.certificate_expired;case H.pki.certificateError.certificate_unknown:return C.Alert.Description.certificate_unknown;case H.pki.certificateError.unknown_ca:return C.Alert.Description.unknown_ca;default:return C.Alert.Description.bad_certificate}},"_certErrorToAlertDesc"),X7=c(function(t){switch(t){case!0:return!0;case C.Alert.Description.bad_certificate:return H.pki.certificateError.bad_certificate;case C.Alert.Description.unsupported_certificate:return H.pki.certificateError.unsupported_certificate;case C.Alert.Description.certificate_revoked:return H.pki.certificateError.certificate_revoked;case C.Alert.Description.certificate_expired:return H.pki.certificateError.certificate_expired;case C.Alert.Description.certificate_unknown:return H.pki.certificateError.certificate_unknown;case C.Alert.Description.unknown_ca:return H.pki.certificateError.unknown_ca;default:return H.pki.certificateError.bad_certificate}},"_alertDescToCertError");C.verifyCertificateChain=function(t,e){try{var r={};for(var n in t.verifyOptions)r[n]=t.verifyOptions[n];r.verify=function(s,o,a){var u=eE(s),l=t.verify(t,s,o,a);if(l!==!0){if(typeof l=="object"&&!H.util.isArray(l)){var f=new Error("The application rejected the certificate.");throw f.send=!0,f.alert={level:C.Alert.Level.fatal,description:C.Alert.Description.bad_certificate},l.message&&(f.message=l.message),l.alert&&(f.alert.description=l.alert),f}l!==s&&(l=X7(l))}return l},H.pki.verifyCertificateChain(t.caStore,e,r)}catch(s){var i=s;(typeof i!="object"||H.util.isArray(i))&&(i={send:!0,alert:{level:C.Alert.Level.fatal,description:eE(s)}}),"send"in i||(i.send=!0),"alert"in i||(i.alert={level:C.Alert.Level.fatal,description:eE(i.error)}),t.error(t,i)}return!t.fail};C.createSessionCache=function(t,e){var r=null;if(t&&t.getSession&&t.setSession&&t.order)r=t;else{r={},r.cache=t||{},r.capacity=Math.max(e||100,1),r.order=[];for(var n in t)r.order.length<=e?r.order.push(n):delete t[n];r.getSession=function(i){var s=null,o=null;if(i?o=H.util.bytesToHex(i):r.order.length>0&&(o=r.order[0]),o!==null&&o in r.cache){s=r.cache[o],delete r.cache[o];for(var a in r.order)if(r.order[a]===o){r.order.splice(a,1);break}}return s},r.setSession=function(i,s){if(r.order.length===r.capacity){var o=r.order.shift();delete r.cache[o]}var o=H.util.bytesToHex(i);r.order.push(o),r.cache[o]=s}}return r};C.createConnection=function(t){var e=null;t.caStore?H.util.isArray(t.caStore)?e=H.pki.createCaStore(t.caStore):e=t.caStore:e=H.pki.createCaStore();var r=t.cipherSuites||null;if(r===null){r=[];for(var n in C.CipherSuites)r.push(C.CipherSuites[n])}var i=t.server?C.ConnectionEnd.server:C.ConnectionEnd.client,s=t.sessionCache?C.createSessionCache(t.sessionCache):null,o={version:{major:C.Version.major,minor:C.Version.minor},entity:i,sessionId:t.sessionId,caStore:e,sessionCache:s,cipherSuites:r,connected:t.connected,virtualHost:t.virtualHost||null,verifyClient:t.verifyClient||!1,verify:t.verify||function(f,h,p,g){return h},verifyOptions:t.verifyOptions||{},getCertificate:t.getCertificate||null,getPrivateKey:t.getPrivateKey||null,getSignature:t.getSignature||null,input:H.util.createBuffer(),tlsData:H.util.createBuffer(),data:H.util.createBuffer(),tlsDataReady:t.tlsDataReady,dataReady:t.dataReady,heartbeatReceived:t.heartbeatReceived,closed:t.closed,error:function(f,h){h.origin=h.origin||(f.entity===C.ConnectionEnd.client?"client":"server"),h.send&&(C.queue(f,C.createAlert(f,h.alert)),C.flush(f));var p=h.fatal!==!1;p&&(f.fail=!0),t.error(f,h),p&&f.close(!1)},deflate:t.deflate||null,inflate:t.inflate||null};o.reset=function(f){o.version={major:C.Version.major,minor:C.Version.minor},o.record=null,o.session=null,o.peerCertificate=null,o.state={pending:null,current:null},o.expect=o.entity===C.ConnectionEnd.client?k7:H7,o.fragmented=null,o.records=[],o.open=!1,o.handshakes=0,o.handshaking=!1,o.isConnected=!1,o.fail=!(f||typeof f>"u"),o.input.clear(),o.tlsData.clear(),o.data.clear(),o.state.current=C.createConnectionState(o)},o.reset();var a=c(function(f,h){var p=h.type-C.ContentType.change_cipher_spec,g=nE[f.entity][f.expect];p in g?g[p](f,h):C.handleUnexpected(f,h)},"_update"),u=c(function(f){var h=0,p=f.input,g=p.length();if(g<5)h=5-g;else{f.record={type:p.getByte(),version:{major:p.getByte(),minor:p.getByte()},length:p.getInt16(),fragment:H.util.createBuffer(),ready:!1};var d=f.record.version.major===f.version.major;d&&f.session&&f.session.version&&(d=f.record.version.minor===f.version.minor),d||f.error(f,{message:"Incompatible TLS version.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.protocol_version}})}return h},"_readRecordHeader"),l=c(function(f){var h=0,p=f.input,g=p.length();if(g<f.record.length)h=f.record.length-g;else{f.record.fragment.putBytes(p.getBytes(f.record.length)),p.compact();var d=f.state.current.read;d.update(f,f.record)&&(f.fragmented!==null&&(f.fragmented.type===f.record.type?(f.fragmented.fragment.putBuffer(f.record.fragment),f.record=f.fragmented):f.error(f,{message:"Invalid fragmented record.",send:!0,alert:{level:C.Alert.Level.fatal,description:C.Alert.Description.unexpected_message}})),f.record.ready=!0)}return h},"_readRecord");return o.handshake=function(f){if(o.entity!==C.ConnectionEnd.client)o.error(o,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(o.handshaking)o.error(o,{message:"Handshake already in progress.",fatal:!1});else{o.fail&&!o.open&&o.handshakes===0&&(o.fail=!1),o.handshaking=!0,f=f||"";var h=null;f.length>0&&(o.sessionCache&&(h=o.sessionCache.getSession(f)),h===null&&(f="")),f.length===0&&o.sessionCache&&(h=o.sessionCache.getSession(),h!==null&&(f=h.id)),o.session={id:f,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:H.md.md5.create(),sha1:H.md.sha1.create()},h&&(o.version=h.version,o.session.sp=h.sp),o.session.sp.client_random=C.createRandom().getBytes(),o.open=!0,C.queue(o,C.createRecord(o,{type:C.ContentType.handshake,data:C.createClientHello(o)})),C.flush(o)}},o.process=function(f){var h=0;return f&&o.input.putBytes(f),o.fail||(o.record!==null&&o.record.ready&&o.record.fragment.isEmpty()&&(o.record=null),o.record===null&&(h=u(o)),!o.fail&&o.record!==null&&!o.record.ready&&(h=l(o)),!o.fail&&o.record!==null&&o.record.ready&&a(o,o.record)),h},o.prepare=function(f){return C.queue(o,C.createRecord(o,{type:C.ContentType.application_data,data:H.util.createBuffer(f)})),C.flush(o)},o.prepareHeartbeatRequest=function(f,h){return f instanceof H.util.ByteBuffer&&(f=f.bytes()),typeof h>"u"&&(h=f.length),o.expectedHeartbeatPayload=f,C.queue(o,C.createRecord(o,{type:C.ContentType.heartbeat,data:C.createHeartbeat(C.HeartbeatMessageType.heartbeat_request,f,h)})),C.flush(o)},o.close=function(f){if(!o.fail&&o.sessionCache&&o.session){var h={id:o.session.id,version:o.session.version,sp:o.session.sp};h.sp.keys=null,o.sessionCache.setSession(h.id,h)}o.open&&(o.open=!1,o.input.clear(),(o.isConnected||o.handshaking)&&(o.isConnected=o.handshaking=!1,C.queue(o,C.createAlert(o,{level:C.Alert.Level.warning,description:C.Alert.Description.close_notify})),C.flush(o)),o.closed(o)),o.reset(f)},o};K2.exports=H.tls=H.tls||{};for(of in C)typeof C[of]!="function"&&(H.tls[of]=C[of]);var of;H.tls.prf_tls1=cf;H.tls.hmac_sha1=D7;H.tls.createSessionCache=C.createSessionCache;H.tls.createConnection=C.createConnection});var G2=_(($J,$2)=>{var Gi=ve();qi();iE();var un=$2.exports=Gi.tls;un.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=un.BulkCipherAlgorithm.aes,t.cipher_type=un.CipherType.block,t.enc_key_length=16,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=un.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:H2};un.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=un.BulkCipherAlgorithm.aes,t.cipher_type=un.CipherType.block,t.enc_key_length=32,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=un.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:H2};function H2(t,e,r){var n=e.entity===Gi.tls.ConnectionEnd.client;t.read.cipherState={init:!1,cipher:Gi.cipher.createDecipher("AES-CBC",n?r.keys.server_write_key:r.keys.client_write_key),iv:n?r.keys.server_write_IV:r.keys.client_write_IV},t.write.cipherState={init:!1,cipher:Gi.cipher.createCipher("AES-CBC",n?r.keys.client_write_key:r.keys.server_write_key),iv:n?r.keys.client_write_IV:r.keys.server_write_IV},t.read.cipherFunction=rH,t.write.cipherFunction=J7,t.read.macLength=t.write.macLength=r.mac_length,t.read.macFunction=t.write.macFunction=un.hmac_sha1}c(H2,"initConnectionState");function J7(t,e){var r=!1,n=e.macFunction(e.macKey,e.sequenceNumber,t);t.fragment.putBytes(n),e.updateSequenceNumber();var i;t.version.minor===un.Versions.TLS_1_0.minor?i=e.cipherState.init?null:e.cipherState.iv:i=Gi.random.getBytesSync(16),e.cipherState.init=!0;var s=e.cipherState.cipher;return s.start({iv:i}),t.version.minor>=un.Versions.TLS_1_1.minor&&s.output.putBytes(i),s.update(t.fragment),s.finish(eH)&&(t.fragment=s.output,t.length=t.fragment.length(),r=!0),r}c(J7,"encrypt_aes_cbc_sha1");function eH(t,e,r){if(!r){var n=t-e.length()%t;e.fillWithByte(n-1,n)}return!0}c(eH,"encrypt_aes_cbc_sha1_padding");function tH(t,e,r){var n=!0;if(r){for(var i=e.length(),s=e.last(),o=i-1-s;o<i-1;++o)n=n&&e.at(o)==s;n&&e.truncate(s+1)}return n}c(tH,"decrypt_aes_cbc_sha1_padding");function rH(t,e){var r=!1,n;t.version.minor===un.Versions.TLS_1_0.minor?n=e.cipherState.init?null:e.cipherState.iv:n=t.fragment.getBytes(16),e.cipherState.init=!0;var i=e.cipherState.cipher;i.start({iv:n}),i.update(t.fragment),r=i.finish(tH);var s=e.macLength,o=Gi.random.getBytesSync(s),a=i.output.length();a>=s?(t.fragment=i.output.getBytes(a-s),o=i.output.getBytes(s)):t.fragment=i.output.getBytes(),t.fragment=Gi.util.createBuffer(t.fragment),t.length=t.fragment.length();var u=e.macFunction(e.macKey,e.sequenceNumber,t);return e.updateSequenceNumber(),r=nH(e.macKey,o,u)&&r,r}c(rH,"decrypt_aes_cbc_sha1");function nH(t,e,r){var n=Gi.hmac.create();return n.start("SHA1",t),n.update(e),e=n.digest().getBytes(),n.start(null,null),n.update(r),r=n.digest().getBytes(),e===r}c(nH,"compareMacs")});var aE=_((jJ,Q2)=>{var at=ve();Mn();qe();var _c=Q2.exports=at.sha512=at.sha512||{};at.md.sha512=at.md.algorithms.sha512=_c;var z2=at.sha384=at.sha512.sha384=at.sha512.sha384||{};z2.create=function(){return _c.create("SHA-384")};at.md.sha384=at.md.algorithms.sha384=z2;at.sha512.sha256=at.sha512.sha256||{create:function(){return _c.create("SHA-512/256")}};at.md["sha512/256"]=at.md.algorithms["sha512/256"]=at.sha512.sha256;at.sha512.sha224=at.sha512.sha224||{create:function(){return _c.create("SHA-512/224")}};at.md["sha512/224"]=at.md.algorithms["sha512/224"]=at.sha512.sha224;_c.create=function(t){if(W2||iH(),typeof t>"u"&&(t="SHA-512"),!(t in Us))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Us[t],r=null,n=at.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var u=a.messageLengthSize/4,l=0;l<u;++l)a.fullMessageLength.push(0);n=at.util.createBuffer(),r=new Array(e.length);for(var l=0;l<e.length;++l)r[l]=e[l].slice(0);return a},a.start(),a.update=function(u,l){l==="utf8"&&(u=at.util.encodeUtf8(u));var f=u.length;a.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=f[1],f[1]=f[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,f[0]=f[1]/4294967296>>>0;return n.putBytes(u),j2(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var u=at.util.createBuffer();u.putBytes(n.bytes());var l=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,f=l&a.blockLength-1;u.putBytes(sE.substr(0,a.blockLength-f));for(var h,p,g=a.fullMessageLength[0]*8,d=0;d<a.fullMessageLength.length-1;++d)h=a.fullMessageLength[d+1]*8,p=h/4294967296>>>0,g+=p,u.putInt32(g>>>0),g=h>>>0;u.putInt32(g);for(var y=new Array(r.length),d=0;d<r.length;++d)y[d]=r[d].slice(0);j2(y,i,u);var v=at.util.createBuffer(),m;t==="SHA-512"?m=y.length:t==="SHA-384"?m=y.length-2:m=y.length-4;for(var d=0;d<m;++d)v.putInt32(y[d][0]),(d!==m-1||t!=="SHA-512/224")&&v.putInt32(y[d][1]);return v},a};var sE=null,W2=!1,oE=null,Us=null;function iH(){sE="\x80",sE+=at.util.fillString("\0",128),oE=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Us={},Us["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Us["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Us["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Us["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],W2=!0}c(iH,"_init");function j2(t,e,r){for(var n,i,s,o,a,u,l,f,h,p,g,d,y,v,m,w,x,A,O,P,j,Q,se,re,k,Ae,q,T,G,ae,X,Re,je,Se,Oe,Ce=r.length();Ce>=128;){for(G=0;G<16;++G)e[G][0]=r.getInt32()>>>0,e[G][1]=r.getInt32()>>>0;for(;G<80;++G)Re=e[G-2],ae=Re[0],X=Re[1],n=((ae>>>19|X<<13)^(X>>>29|ae<<3)^ae>>>6)>>>0,i=((ae<<13|X>>>19)^(X<<3|ae>>>29)^(ae<<26|X>>>6))>>>0,Se=e[G-15],ae=Se[0],X=Se[1],s=((ae>>>1|X<<31)^(ae>>>8|X<<24)^ae>>>7)>>>0,o=((ae<<31|X>>>1)^(ae<<24|X>>>8)^(ae<<25|X>>>7))>>>0,je=e[G-7],Oe=e[G-16],X=i+je[1]+o+Oe[1],e[G][0]=n+je[0]+s+Oe[0]+(X/4294967296>>>0)>>>0,e[G][1]=X>>>0;for(y=t[0][0],v=t[0][1],m=t[1][0],w=t[1][1],x=t[2][0],A=t[2][1],O=t[3][0],P=t[3][1],j=t[4][0],Q=t[4][1],se=t[5][0],re=t[5][1],k=t[6][0],Ae=t[6][1],q=t[7][0],T=t[7][1],G=0;G<80;++G)l=((j>>>14|Q<<18)^(j>>>18|Q<<14)^(Q>>>9|j<<23))>>>0,f=((j<<18|Q>>>14)^(j<<14|Q>>>18)^(Q<<23|j>>>9))>>>0,h=(k^j&(se^k))>>>0,p=(Ae^Q&(re^Ae))>>>0,a=((y>>>28|v<<4)^(v>>>2|y<<30)^(v>>>7|y<<25))>>>0,u=((y<<4|v>>>28)^(v<<30|y>>>2)^(v<<25|y>>>7))>>>0,g=(y&m|x&(y^m))>>>0,d=(v&w|A&(v^w))>>>0,X=T+f+p+oE[G][1]+e[G][1],n=q+l+h+oE[G][0]+e[G][0]+(X/4294967296>>>0)>>>0,i=X>>>0,X=u+d,s=a+g+(X/4294967296>>>0)>>>0,o=X>>>0,q=k,T=Ae,k=se,Ae=re,se=j,re=Q,X=P+i,j=O+n+(X/4294967296>>>0)>>>0,Q=X>>>0,O=x,P=A,x=m,A=w,m=y,w=v,X=i+o,y=n+s+(X/4294967296>>>0)>>>0,v=X>>>0;X=t[0][1]+v,t[0][0]=t[0][0]+y+(X/4294967296>>>0)>>>0,t[0][1]=X>>>0,X=t[1][1]+w,t[1][0]=t[1][0]+m+(X/4294967296>>>0)>>>0,t[1][1]=X>>>0,X=t[2][1]+A,t[2][0]=t[2][0]+x+(X/4294967296>>>0)>>>0,t[2][1]=X>>>0,X=t[3][1]+P,t[3][0]=t[3][0]+O+(X/4294967296>>>0)>>>0,t[3][1]=X>>>0,X=t[4][1]+Q,t[4][0]=t[4][0]+j+(X/4294967296>>>0)>>>0,t[4][1]=X>>>0,X=t[5][1]+re,t[5][0]=t[5][0]+se+(X/4294967296>>>0)>>>0,t[5][1]=X>>>0,X=t[6][1]+Ae,t[6][0]=t[6][0]+k+(X/4294967296>>>0)>>>0,t[6][1]=X>>>0,X=t[7][1]+T,t[7][0]=t[7][0]+q+(X/4294967296>>>0)>>>0,t[7][1]=X>>>0,Ce-=128}}c(j2,"_update")});var Y2=_(cE=>{var sH=ve();_n();var Wt=sH.asn1;cE.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Wt.Class.UNIVERSAL,type:Wt.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Wt.Class.UNIVERSAL,type:Wt.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Wt.Class.UNIVERSAL,type:Wt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Wt.Class.UNIVERSAL,type:Wt.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Wt.Class.UNIVERSAL,type:Wt.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};cE.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Wt.Class.UNIVERSAL,type:Wt.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Wt.Class.UNIVERSAL,type:Wt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Wt.Class.UNIVERSAL,type:Wt.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Wt.Class.UNIVERSAL,type:Wt.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var uN=_((QJ,cN)=>{var ir=ve();Cc();nn();aE();qe();var rN=Y2(),oH=rN.publicKeyValidator,aH=rN.privateKeyValidator;typeof Z2>"u"&&(Z2=ir.jsbn.BigInteger);var Z2,fE=ir.util.ByteBuffer,Pr=typeof Buffer>"u"?Uint8Array:Buffer;ir.pki=ir.pki||{};cN.exports=ir.pki.ed25519=ir.ed25519=ir.ed25519||{};var Ie=ir.ed25519;Ie.constants={};Ie.constants.PUBLIC_KEY_BYTE_LENGTH=32;Ie.constants.PRIVATE_KEY_BYTE_LENGTH=64;Ie.constants.SEED_BYTE_LENGTH=32;Ie.constants.SIGN_BYTE_LENGTH=64;Ie.constants.HASH_BYTE_LENGTH=64;Ie.generateKeyPair=function(t){t=t||{};var e=t.seed;if(e===void 0)e=ir.random.getBytesSync(Ie.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==Ie.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+Ie.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=hi({message:e,encoding:"binary"});for(var r=new Pr(Ie.constants.PUBLIC_KEY_BYTE_LENGTH),n=new Pr(Ie.constants.PRIVATE_KEY_BYTE_LENGTH),i=0;i<32;++i)n[i]=e[i];return fH(r,n),{publicKey:r,privateKey:n}};Ie.privateKeyFromAsn1=function(t){var e={},r=[],n=ir.asn1.validate(t,aH,e,r);if(!n){var i=new Error("Invalid Key.");throw i.errors=r,i}var s=ir.asn1.derToOid(e.privateKeyOid),o=ir.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.privateKey,u=hi({message:ir.asn1.fromDer(a).value,encoding:"binary"});return{privateKeyBytes:u}};Ie.publicKeyFromAsn1=function(t){var e={},r=[],n=ir.asn1.validate(t,oH,e,r);if(!n){var i=new Error("Invalid Key.");throw i.errors=r,i}var s=ir.asn1.derToOid(e.publicKeyOid),o=ir.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.ed25519PublicKey;if(a.length!==Ie.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return hi({message:a,encoding:"binary"})};Ie.publicKeyFromPrivateKey=function(t){t=t||{};var e=hi({message:t.privateKey,encoding:"binary"});if(e.length!==Ie.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Ie.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new Pr(Ie.constants.PUBLIC_KEY_BYTE_LENGTH),n=0;n<r.length;++n)r[n]=e[32+n];return r};Ie.sign=function(t){t=t||{};var e=hi(t),r=hi({message:t.privateKey,encoding:"binary"});if(r.length===Ie.constants.SEED_BYTE_LENGTH){var n=Ie.generateKeyPair({seed:r});r=n.privateKey}else if(r.length!==Ie.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Ie.constants.SEED_BYTE_LENGTH+" or "+Ie.constants.PRIVATE_KEY_BYTE_LENGTH);var i=new Pr(Ie.constants.SIGN_BYTE_LENGTH+e.length);hH(i,e,e.length,r);for(var s=new Pr(Ie.constants.SIGN_BYTE_LENGTH),o=0;o<s.length;++o)s[o]=i[o];return s};Ie.verify=function(t){t=t||{};var e=hi(t);if(t.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=hi({message:t.signature,encoding:"binary"});if(r.length!==Ie.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+Ie.constants.SIGN_BYTE_LENGTH);var n=hi({message:t.publicKey,encoding:"binary"});if(n.length!==Ie.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+Ie.constants.PUBLIC_KEY_BYTE_LENGTH);var i=new Pr(Ie.constants.SIGN_BYTE_LENGTH+e.length),s=new Pr(Ie.constants.SIGN_BYTE_LENGTH+e.length),o;for(o=0;o<Ie.constants.SIGN_BYTE_LENGTH;++o)i[o]=r[o];for(o=0;o<e.length;++o)i[o+Ie.constants.SIGN_BYTE_LENGTH]=e[o];return dH(s,i,i.length,n)>=0};function hi(t){var e=t.message;if(e instanceof Uint8Array||e instanceof Pr)return e;var r=t.encoding;if(e===void 0)if(t.md)e=t.md.digest().getBytes(),r="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.from(e,r);e=new fE(e,r)}else if(!(e instanceof fE))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var n=new Pr(e.length()),i=0;i<n.length;++i)n[i]=e.at(i);return n}c(hi,"messageToNativeBuffer");var hE=fe(),uf=fe([1]),cH=fe([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),uH=fe([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),X2=fe([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),J2=fe([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),uE=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),lH=fe([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function bc(t,e){var r=ir.md.sha512.create(),n=new fE(t);r.update(n.getBytes(e),"binary");var i=r.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(i,"binary");for(var s=new Pr(Ie.constants.HASH_BYTE_LENGTH),o=0;o<64;++o)s[o]=i.charCodeAt(o);return s}c(bc,"sha512");function fH(t,e){var r=[fe(),fe(),fe(),fe()],n,i=bc(e,32);for(i[0]&=248,i[31]&=127,i[31]|=64,yE(r,i),gE(t,r),n=0;n<32;++n)e[n+32]=t[n];return 0}c(fH,"crypto_sign_keypair");function hH(t,e,r,n){var i,s,o=new Float64Array(64),a=[fe(),fe(),fe(),fe()],u=bc(n,32);u[0]&=248,u[31]&=127,u[31]|=64;var l=r+64;for(i=0;i<r;++i)t[64+i]=e[i];for(i=0;i<32;++i)t[32+i]=u[32+i];var f=bc(t.subarray(32),r+32);for(dE(f),yE(a,f),gE(t,a),i=32;i<64;++i)t[i]=n[i];var h=bc(t,r+64);for(dE(h),i=32;i<64;++i)o[i]=0;for(i=0;i<32;++i)o[i]=f[i];for(i=0;i<32;++i)for(s=0;s<32;s++)o[i+s]+=h[i]*u[s];return nN(t.subarray(32),o),l}c(hH,"crypto_sign");function dH(t,e,r,n){var i,s,o=new Pr(32),a=[fe(),fe(),fe(),fe()],u=[fe(),fe(),fe(),fe()];if(s=-1,r<64||pH(u,n))return-1;for(i=0;i<r;++i)t[i]=e[i];for(i=0;i<32;++i)t[i+32]=n[i];var l=bc(t,r);if(dE(l),oN(a,u,l),yE(u,e.subarray(32)),pE(a,u),gE(o,a),r-=64,iN(e,0,o,0)){for(i=0;i<r;++i)t[i]=0;return-1}for(i=0;i<r;++i)t[i]=e[i+64];return s=r,s}c(dH,"crypto_sign_open");function nN(t,e){var r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)e[i]+=r-16*e[n]*uE[i-(n-32)],r=e[i]+128>>8,e[i]-=r*256;e[i]+=r,e[n]=0}for(r=0,i=0;i<32;++i)e[i]+=r-(e[31]>>4)*uE[i],r=e[i]>>8,e[i]&=255;for(i=0;i<32;++i)e[i]-=r*uE[i];for(n=0;n<32;++n)e[n+1]+=e[n]>>8,t[n]=e[n]&255}c(nN,"modL");function dE(t){for(var e=new Float64Array(64),r=0;r<64;++r)e[r]=t[r],t[r]=0;nN(t,e)}c(dE,"reduce");function pE(t,e){var r=fe(),n=fe(),i=fe(),s=fe(),o=fe(),a=fe(),u=fe(),l=fe(),f=fe();Mo(r,t[1],t[0]),Mo(f,e[1],e[0]),Xe(r,r,f),Vo(n,t[0],t[1]),Vo(f,e[0],e[1]),Xe(n,n,f),Xe(i,t[3],e[3]),Xe(i,i,uH),Xe(s,t[2],e[2]),Vo(s,s,s),Mo(o,n,r),Mo(a,s,i),Vo(u,s,i),Vo(l,n,r),Xe(t[0],o,a),Xe(t[1],l,u),Xe(t[2],u,a),Xe(t[3],o,l)}c(pE,"add");function eN(t,e,r){for(var n=0;n<4;++n)aN(t[n],e[n],r)}c(eN,"cswap");function gE(t,e){var r=fe(),n=fe(),i=fe();vH(i,e[2]),Xe(r,e[0],i),Xe(n,e[1],i),lf(t,n),t[31]^=sN(r)<<7}c(gE,"pack");function lf(t,e){var r,n,i,s=fe(),o=fe();for(r=0;r<16;++r)o[r]=e[r];for(lE(o),lE(o),lE(o),n=0;n<2;++n){for(s[0]=o[0]-65517,r=1;r<15;++r)s[r]=o[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=o[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,aN(o,s,1-i)}for(r=0;r<16;r++)t[2*r]=o[r]&255,t[2*r+1]=o[r]>>8}c(lf,"pack25519");function pH(t,e){var r=fe(),n=fe(),i=fe(),s=fe(),o=fe(),a=fe(),u=fe();return ji(t[2],uf),gH(t[1],e),Vs(i,t[1]),Xe(s,i,cH),Mo(i,i,t[2]),Vo(s,t[2],s),Vs(o,s),Vs(a,o),Xe(u,a,o),Xe(r,u,i),Xe(r,r,s),yH(r,r),Xe(r,r,i),Xe(r,r,s),Xe(r,r,s),Xe(t[0],r,s),Vs(n,t[0]),Xe(n,n,s),tN(n,i)&&Xe(t[0],t[0],lH),Vs(n,t[0]),Xe(n,n,s),tN(n,i)?-1:(sN(t[0])===e[31]>>7&&Mo(t[0],hE,t[0]),Xe(t[3],t[0],t[1]),0)}c(pH,"unpackneg");function gH(t,e){var r;for(r=0;r<16;++r)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}c(gH,"unpack25519");function yH(t,e){var r=fe(),n;for(n=0;n<16;++n)r[n]=e[n];for(n=250;n>=0;--n)Vs(r,r),n!==1&&Xe(r,r,e);for(n=0;n<16;++n)t[n]=r[n]}c(yH,"pow2523");function tN(t,e){var r=new Pr(32),n=new Pr(32);return lf(r,t),lf(n,e),iN(r,0,n,0)}c(tN,"neq25519");function iN(t,e,r,n){return mH(t,e,r,n,32)}c(iN,"crypto_verify_32");function mH(t,e,r,n,i){var s,o=0;for(s=0;s<i;++s)o|=t[e+s]^r[n+s];return(1&o-1>>>8)-1}c(mH,"vn");function sN(t){var e=new Pr(32);return lf(e,t),e[0]&1}c(sN,"par25519");function oN(t,e,r){var n,i;for(ji(t[0],hE),ji(t[1],uf),ji(t[2],uf),ji(t[3],hE),i=255;i>=0;--i)n=r[i/8|0]>>(i&7)&1,eN(t,e,n),pE(e,t),pE(t,t),eN(t,e,n)}c(oN,"scalarmult");function yE(t,e){var r=[fe(),fe(),fe(),fe()];ji(r[0],X2),ji(r[1],J2),ji(r[2],uf),Xe(r[3],X2,J2),oN(t,r,e)}c(yE,"scalarbase");function ji(t,e){var r;for(r=0;r<16;r++)t[r]=e[r]|0}c(ji,"set25519");function vH(t,e){var r=fe(),n;for(n=0;n<16;++n)r[n]=e[n];for(n=253;n>=0;--n)Vs(r,r),n!==2&&n!==4&&Xe(r,r,e);for(n=0;n<16;++n)t[n]=r[n]}c(vH,"inv25519");function lE(t){var e,r,n=1;for(e=0;e<16;++e)r=t[e]+n+65535,n=Math.floor(r/65536),t[e]=r-n*65536;t[0]+=n-1+37*(n-1)}c(lE,"car25519");function aN(t,e,r){for(var n,i=~(r-1),s=0;s<16;++s)n=i&(t[s]^e[s]),t[s]^=n,e[s]^=n}c(aN,"sel25519");function fe(t){var e,r=new Float64Array(16);if(t)for(e=0;e<t.length;++e)r[e]=t[e];return r}c(fe,"gf");function Vo(t,e,r){for(var n=0;n<16;++n)t[n]=e[n]+r[n]}c(Vo,"A");function Mo(t,e,r){for(var n=0;n<16;++n)t[n]=e[n]-r[n]}c(Mo,"Z");function Vs(t,e){Xe(t,e,e)}c(Vs,"S");function Xe(t,e,r){var n,i,s=0,o=0,a=0,u=0,l=0,f=0,h=0,p=0,g=0,d=0,y=0,v=0,m=0,w=0,x=0,A=0,O=0,P=0,j=0,Q=0,se=0,re=0,k=0,Ae=0,q=0,T=0,G=0,ae=0,X=0,Re=0,je=0,Se=r[0],Oe=r[1],Ce=r[2],Ee=r[3],ke=r[4],we=r[5],Ve=r[6],lt=r[7],wt=r[8],Qt=r[9],Lt=r[10],Pt=r[11],St=r[12],kt=r[13],Ft=r[14],qt=r[15];n=e[0],s+=n*Se,o+=n*Oe,a+=n*Ce,u+=n*Ee,l+=n*ke,f+=n*we,h+=n*Ve,p+=n*lt,g+=n*wt,d+=n*Qt,y+=n*Lt,v+=n*Pt,m+=n*St,w+=n*kt,x+=n*Ft,A+=n*qt,n=e[1],o+=n*Se,a+=n*Oe,u+=n*Ce,l+=n*Ee,f+=n*ke,h+=n*we,p+=n*Ve,g+=n*lt,d+=n*wt,y+=n*Qt,v+=n*Lt,m+=n*Pt,w+=n*St,x+=n*kt,A+=n*Ft,O+=n*qt,n=e[2],a+=n*Se,u+=n*Oe,l+=n*Ce,f+=n*Ee,h+=n*ke,p+=n*we,g+=n*Ve,d+=n*lt,y+=n*wt,v+=n*Qt,m+=n*Lt,w+=n*Pt,x+=n*St,A+=n*kt,O+=n*Ft,P+=n*qt,n=e[3],u+=n*Se,l+=n*Oe,f+=n*Ce,h+=n*Ee,p+=n*ke,g+=n*we,d+=n*Ve,y+=n*lt,v+=n*wt,m+=n*Qt,w+=n*Lt,x+=n*Pt,A+=n*St,O+=n*kt,P+=n*Ft,j+=n*qt,n=e[4],l+=n*Se,f+=n*Oe,h+=n*Ce,p+=n*Ee,g+=n*ke,d+=n*we,y+=n*Ve,v+=n*lt,m+=n*wt,w+=n*Qt,x+=n*Lt,A+=n*Pt,O+=n*St,P+=n*kt,j+=n*Ft,Q+=n*qt,n=e[5],f+=n*Se,h+=n*Oe,p+=n*Ce,g+=n*Ee,d+=n*ke,y+=n*we,v+=n*Ve,m+=n*lt,w+=n*wt,x+=n*Qt,A+=n*Lt,O+=n*Pt,P+=n*St,j+=n*kt,Q+=n*Ft,se+=n*qt,n=e[6],h+=n*Se,p+=n*Oe,g+=n*Ce,d+=n*Ee,y+=n*ke,v+=n*we,m+=n*Ve,w+=n*lt,x+=n*wt,A+=n*Qt,O+=n*Lt,P+=n*Pt,j+=n*St,Q+=n*kt,se+=n*Ft,re+=n*qt,n=e[7],p+=n*Se,g+=n*Oe,d+=n*Ce,y+=n*Ee,v+=n*ke,m+=n*we,w+=n*Ve,x+=n*lt,A+=n*wt,O+=n*Qt,P+=n*Lt,j+=n*Pt,Q+=n*St,se+=n*kt,re+=n*Ft,k+=n*qt,n=e[8],g+=n*Se,d+=n*Oe,y+=n*Ce,v+=n*Ee,m+=n*ke,w+=n*we,x+=n*Ve,A+=n*lt,O+=n*wt,P+=n*Qt,j+=n*Lt,Q+=n*Pt,se+=n*St,re+=n*kt,k+=n*Ft,Ae+=n*qt,n=e[9],d+=n*Se,y+=n*Oe,v+=n*Ce,m+=n*Ee,w+=n*ke,x+=n*we,A+=n*Ve,O+=n*lt,P+=n*wt,j+=n*Qt,Q+=n*Lt,se+=n*Pt,re+=n*St,k+=n*kt,Ae+=n*Ft,q+=n*qt,n=e[10],y+=n*Se,v+=n*Oe,m+=n*Ce,w+=n*Ee,x+=n*ke,A+=n*we,O+=n*Ve,P+=n*lt,j+=n*wt,Q+=n*Qt,se+=n*Lt,re+=n*Pt,k+=n*St,Ae+=n*kt,q+=n*Ft,T+=n*qt,n=e[11],v+=n*Se,m+=n*Oe,w+=n*Ce,x+=n*Ee,A+=n*ke,O+=n*we,P+=n*Ve,j+=n*lt,Q+=n*wt,se+=n*Qt,re+=n*Lt,k+=n*Pt,Ae+=n*St,q+=n*kt,T+=n*Ft,G+=n*qt,n=e[12],m+=n*Se,w+=n*Oe,x+=n*Ce,A+=n*Ee,O+=n*ke,P+=n*we,j+=n*Ve,Q+=n*lt,se+=n*wt,re+=n*Qt,k+=n*Lt,Ae+=n*Pt,q+=n*St,T+=n*kt,G+=n*Ft,ae+=n*qt,n=e[13],w+=n*Se,x+=n*Oe,A+=n*Ce,O+=n*Ee,P+=n*ke,j+=n*we,Q+=n*Ve,se+=n*lt,re+=n*wt,k+=n*Qt,Ae+=n*Lt,q+=n*Pt,T+=n*St,G+=n*kt,ae+=n*Ft,X+=n*qt,n=e[14],x+=n*Se,A+=n*Oe,O+=n*Ce,P+=n*Ee,j+=n*ke,Q+=n*we,se+=n*Ve,re+=n*lt,k+=n*wt,Ae+=n*Qt,q+=n*Lt,T+=n*Pt,G+=n*St,ae+=n*kt,X+=n*Ft,Re+=n*qt,n=e[15],A+=n*Se,O+=n*Oe,P+=n*Ce,j+=n*Ee,Q+=n*ke,se+=n*we,re+=n*Ve,k+=n*lt,Ae+=n*wt,q+=n*Qt,T+=n*Lt,G+=n*Pt,ae+=n*St,X+=n*kt,Re+=n*Ft,je+=n*qt,s+=38*O,o+=38*P,a+=38*j,u+=38*Q,l+=38*se,f+=38*re,h+=38*k,p+=38*Ae,g+=38*q,d+=38*T,y+=38*G,v+=38*ae,m+=38*X,w+=38*Re,x+=38*je,i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=v+i+65535,i=Math.floor(n/65536),v=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=w+i+65535,i=Math.floor(n/65536),w=n-i*65536,n=x+i+65535,i=Math.floor(n/65536),x=n-i*65536,n=A+i+65535,i=Math.floor(n/65536),A=n-i*65536,s+=i-1+37*(i-1),i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=v+i+65535,i=Math.floor(n/65536),v=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=w+i+65535,i=Math.floor(n/65536),w=n-i*65536,n=x+i+65535,i=Math.floor(n/65536),x=n-i*65536,n=A+i+65535,i=Math.floor(n/65536),A=n-i*65536,s+=i-1+37*(i-1),t[0]=s,t[1]=o,t[2]=a,t[3]=u,t[4]=l,t[5]=f,t[6]=h,t[7]=p,t[8]=g,t[9]=d,t[10]=y,t[11]=v,t[12]=m,t[13]=w,t[14]=x,t[15]=A}c(Xe,"M")});var dN=_((ZJ,hN)=>{var Hr=ve();qe();nn();Cc();hN.exports=Hr.kem=Hr.kem||{};var lN=Hr.jsbn.BigInteger;Hr.kem.rsa={};Hr.kem.rsa.create=function(t,e){e=e||{};var r=e.prng||Hr.random,n={};return n.encrypt=function(i,s){var o=Math.ceil(i.n.bitLength()/8),a;do a=new lN(Hr.util.bytesToHex(r.getBytesSync(o)),16).mod(i.n);while(a.compareTo(lN.ONE)<=0);a=Hr.util.hexToBytes(a.toString(16));var u=o-a.length;u>0&&(a=Hr.util.fillString("\0",u)+a);var l=i.encrypt(a,"NONE"),f=t.generate(a,s);return{encapsulation:l,key:f}},n.decrypt=function(i,s,o){var a=i.decrypt(s,"NONE");return t.generate(a,o)},n};Hr.kem.kdf1=function(t,e){fN(this,t,0,e||t.digestLength)};Hr.kem.kdf2=function(t,e){fN(this,t,1,e||t.digestLength)};function fN(t,e,r,n){t.generate=function(i,s){for(var o=new Hr.util.ByteBuffer,a=Math.ceil(s/n)+r,u=new Hr.util.ByteBuffer,l=r;l<a;++l){u.putInt32(l),e.start(),e.update(i+u.getBytes());var f=e.digest();o.putBytes(f.getBytes(n))}return o.truncate(o.length()-s),o.getBytes()}}c(fN,"_createKDF")});var mN=_((JJ,yN)=>{var Be=ve();qe();yN.exports=Be.log=Be.log||{};Be.log.levels=["none","error","warning","info","debug","verbose","max"];var ff={},EE=[],Ac=null;Be.log.LEVEL_LOCKED=2;Be.log.NO_LEVEL_CHECK=4;Be.log.INTERPOLATE=8;for(Qn=0;Qn<Be.log.levels.length;++Qn)mE=Be.log.levels[Qn],ff[mE]={index:Qn,name:mE.toUpperCase()};var mE,Qn;Be.log.logMessage=function(t){for(var e=ff[t.level].index,r=0;r<EE.length;++r){var n=EE[r];if(n.flags&Be.log.NO_LEVEL_CHECK)n.f(t);else{var i=ff[n.level].index;e<=i&&n.f(n,t)}}};Be.log.prepareStandard=function(t){"standard"in t||(t.standard=ff[t.level].name+" ["+t.category+"] "+t.message)};Be.log.prepareFull=function(t){if(!("full"in t)){var e=[t.message];e=e.concat([]),t.full=Be.util.format.apply(this,e)}};Be.log.prepareStandardFull=function(t){"standardFull"in t||(Be.log.prepareStandard(t),t.standardFull=t.standard)};for(vE=["error","warning","info","debug","verbose"],Qn=0;Qn<vE.length;++Qn)(function(e){Be.log[e]=function(r,n){var i=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:e,category:r,message:n,arguments:i};Be.log.logMessage(s)}})(vE[Qn]);var vE,Qn;Be.log.makeLogger=function(t){var e={flags:0,f:t};return Be.log.setLevel(e,"none"),e};Be.log.setLevel=function(t,e){var r=!1;if(t&&!(t.flags&Be.log.LEVEL_LOCKED))for(var n=0;n<Be.log.levels.length;++n){var i=Be.log.levels[n];if(e==i){t.level=e,r=!0;break}}return r};Be.log.lock=function(t,e){typeof e>"u"||e?t.flags|=Be.log.LEVEL_LOCKED:t.flags&=~Be.log.LEVEL_LOCKED};Be.log.addLogger=function(t){EE.push(t)};typeof console<"u"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(pN={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},Nc=c(function(t,e){Be.log.prepareStandard(e);var r=pN[e.level],n=[e.standard];n=n.concat(e.arguments.slice()),r.apply(console,n)},"f"),Ko=Be.log.makeLogger(Nc)):(Nc=c(function(e,r){Be.log.prepareStandardFull(r),console.log(r.standardFull)},"f"),Ko=Be.log.makeLogger(Nc)),Be.log.setLevel(Ko,"debug"),Be.log.addLogger(Ko),Ac=Ko):console={log:function(){}};var Ko,pN,Nc;Ac!==null&&typeof window<"u"&&window.location&&(Ic=new URL(window.location.href).searchParams,Ic.has("console.level")&&Be.log.setLevel(Ac,Ic.get("console.level").slice(-1)[0]),Ic.has("console.lock")&&(gN=Ic.get("console.lock").slice(-1)[0],gN=="true"&&Be.log.lock(Ac)));var Ic,gN;Be.log.consoleLogger=Ac});var EN=_((tee,vN)=>{vN.exports=Mn();Hl();Po();Ov();aE()});var wN=_((ree,CN)=>{var J=ve();qi();_n();Ec();Ui();Ds();jv();nn();qe();nf();var N=J.asn1,Cr=CN.exports=J.pkcs7=J.pkcs7||{};Cr.messageFromPem=function(t){var e=J.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=N.fromDer(e.body);return Cr.messageFromAsn1(n)};Cr.messageToPem=function(t,e){var r={type:"PKCS7",body:N.toDer(t.toAsn1()).getBytes()};return J.pem.encode(r,{maxline:e})};Cr.messageFromAsn1=function(t){var e={},r=[];if(!N.validate(t,Cr.asn1.contentInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var i=N.derToOid(e.contentType),s;switch(i){case J.pki.oids.envelopedData:s=Cr.createEnvelopedData();break;case J.pki.oids.encryptedData:s=Cr.createEncryptedData();break;case J.pki.oids.signedData:s=Cr.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};Cr.createSignedData=function(){var t=null;return t={type:J.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(n){if(CE(t,n,Cr.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var i=t.rawCapture.certificates.value,s=0;s<i.length;++s)t.certificates.push(J.pki.certificateFromAsn1(i[s]))},toAsn1:function(){t.contentInfo||t.sign();for(var n=[],i=0;i<t.certificates.length;++i)n.push(J.pki.certificateToAsn1(t.certificates[i]));var s=[],o=N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(t.version).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return n.length>0&&o.value[0].value.push(N.create(N.Class.CONTEXT_SPECIFIC,0,!0,n)),s.length>0&&o.value[0].value.push(N.create(N.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(N.create(N.Class.UNIVERSAL,N.Type.SET,!0,t.signerInfos)),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.type).getBytes()),o])},addSigner:function(n){var i=n.issuer,s=n.serialNumber;if(n.certificate){var o=n.certificate;typeof o=="string"&&(o=J.pki.certificateFromPem(o)),i=o.issuer.attributes,s=o.serialNumber}var a=n.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=J.pki.privateKeyFromPem(a));var u=n.digestAlgorithm||J.pki.oids.sha1;switch(u){case J.pki.oids.sha1:case J.pki.oids.sha256:case J.pki.oids.sha384:case J.pki.oids.sha512:case J.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+u)}var l=n.authenticatedAttributes||[];if(l.length>0){for(var f=!1,h=!1,p=0;p<l.length;++p){var g=l[p];if(!f&&g.type===J.pki.oids.contentType){if(f=!0,h)break;continue}if(!h&&g.type===J.pki.oids.messageDigest){if(h=!0,f)break;continue}}if(!f||!h)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:a,version:1,issuer:i,serialNumber:s,digestAlgorithm:u,signatureAlgorithm:J.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:l,unauthenticatedAttributes:[]})},sign:function(n){if(n=n||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(J.pki.oids.data).getBytes())]),"content"in t)){var i;t.content instanceof J.util.ByteBuffer?i=t.content.bytes():typeof t.content=="string"&&(i=J.util.encodeUtf8(t.content)),n.detached?t.detachedContent=N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,i):t.contentInfo.value.push(N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,i)]))}if(t.signers.length!==0){var s=e();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(n){typeof n=="string"&&(n=J.pki.certificateFromPem(n)),t.certificates.push(n)},addCertificateRevokationList:function(n){throw new Error("PKCS#7 CRL support not yet implemented.")}},t;function e(){for(var n={},i=0;i<t.signers.length;++i){var s=t.signers[i],o=s.digestAlgorithm;o in n||(n[o]=J.md[J.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=n[o]:s.md=J.md[J.pki.oids[o]].create()}t.digestAlgorithmIdentifiers=[];for(var o in n)t.digestAlgorithmIdentifiers.push(N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(o).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")]));return n}c(e,"addDigestAlgorithmIds");function r(n){var i;if(t.detachedContent?i=t.detachedContent:(i=t.contentInfo.value[1],i=i.value[0]),!i)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=N.derToOid(t.contentInfo.value[0].value),o=N.toDer(i);o.getByte(),N.getBerValueLength(o),o=o.getBytes();for(var a in n)n[a].start().update(o);for(var u=new Date,l=0;l<t.signers.length;++l){var f=t.signers[l];if(f.authenticatedAttributes.length===0){if(s!==J.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{f.authenticatedAttributesAsn1=N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var h=N.create(N.Class.UNIVERSAL,N.Type.SET,!0,[]),p=0;p<f.authenticatedAttributes.length;++p){var g=f.authenticatedAttributes[p];g.type===J.pki.oids.messageDigest?g.value=n[f.digestAlgorithm].digest():g.type===J.pki.oids.signingTime&&(g.value||(g.value=u)),h.value.push(SE(g)),f.authenticatedAttributesAsn1.value.push(SE(g))}o=N.toDer(h).getBytes(),f.md.start().update(o)}f.signature=f.key.sign(f.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=TH(t.signers)}c(r,"addSignerInfos")};Cr.createEncryptedData=function(){var t=null;return t={type:J.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:J.pki.oids["aes256-CBC"]},fromAsn1:function(e){CE(t,e,Cr.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(t.encryptedContent.key=e),SN(t)}},t};Cr.createEnvelopedData=function(){var t=null;return t={type:J.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:J.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=CE(t,e,Cr.asn1.envelopedDataValidator);t.recipients=CH(r.recipientInfos.value)},toAsn1:function(){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.type).getBytes()),N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(t.version).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SET,!0,wH(t.recipients)),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,_H(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,n=0;n<t.recipients.length;++n){var i=t.recipients[n],s=i.issuer;if(i.serialNumber===e.serialNumber&&s.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(s[a].type!==r[a].type||s[a].value!==r[a].value){o=!1;break}if(o)return i}}return null},decrypt:function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case J.pki.oids.rsaEncryption:case J.pki.oids.desCBC:var n=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=J.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}SN(t)},addRecipient:function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:J.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var n,i,s;switch(r){case J.pki.oids["aes128-CBC"]:n=16,i=16,s=J.aes.createEncryptionCipher;break;case J.pki.oids["aes192-CBC"]:n=24,i=16,s=J.aes.createEncryptionCipher;break;case J.pki.oids["aes256-CBC"]:n=32,i=16,s=J.aes.createEncryptionCipher;break;case J.pki.oids["des-EDE3-CBC"]:n=24,i=8,s=J.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=J.util.createBuffer(J.random.getBytes(n));else if(e.length()!=n)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+n+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=J.util.createBuffer(J.random.getBytes(i));var o=s(e);if(o.start(t.encryptedContent.parameter.copy()),o.update(t.content),!o.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=o.output}for(var a=0;a<t.recipients.length;++a){var u=t.recipients[a];if(u.encryptedContent.content===void 0)switch(u.encryptedContent.algorithm){case J.pki.oids.rsaEncryption:u.encryptedContent.content=u.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm)}}}},t};function EH(t){var e={},r=[];if(!N.validate(t,Cr.asn1.recipientInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:e.version.charCodeAt(0),issuer:J.pki.RDNAttributesAsArray(e.issuer),serialNumber:J.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:N.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}c(EH,"_recipientFromAsn1");function SH(t){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(t.version).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[J.pki.distinguishedNameToAsn1({attributes:t.issuer}),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,J.util.hexToBytes(t.serialNumber))]),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.encryptedContent.algorithm).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")]),N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,t.encryptedContent.content)])}c(SH,"_recipientToAsn1");function CH(t){for(var e=[],r=0;r<t.length;++r)e.push(EH(t[r]));return e}c(CH,"_recipientsFromAsn1");function wH(t){for(var e=[],r=0;r<t.length;++r)e.push(SH(t[r]));return e}c(wH,"_recipientsToAsn1");function xH(t){var e=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(t.version).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[J.pki.distinguishedNameToAsn1({attributes:t.issuer}),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,J.util.hexToBytes(t.serialNumber))]),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.digestAlgorithm).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.signatureAlgorithm).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")])),e.value.push(N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=N.create(N.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<t.unauthenticatedAttributes.length;++n){var i=t.unauthenticatedAttributes[n];r.values.push(SE(i))}e.value.push(r)}return e}c(xH,"_signerToAsn1");function TH(t){for(var e=[],r=0;r<t.length;++r)e.push(xH(t[r]));return e}c(TH,"_signersToAsn1");function SE(t){var e;if(t.type===J.pki.oids.contentType)e=N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.value).getBytes());else if(t.type===J.pki.oids.messageDigest)e=N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===J.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),i=t.value;if(typeof i=="string"){var s=Date.parse(i);isNaN(s)?i.length===13?i=N.utcTimeToDate(i):i=N.generalizedTimeToDate(i):i=new Date(s)}i>=r&&i<n?e=N.create(N.Class.UNIVERSAL,N.Type.UTCTIME,!1,N.dateToUtcTime(i)):e=N.create(N.Class.UNIVERSAL,N.Type.GENERALIZEDTIME,!1,N.dateToGeneralizedTime(i))}return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.type).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SET,!0,[e])])}c(SE,"_attributeToAsn1");function _H(t){return[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(J.pki.oids.data).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.algorithm).getBytes()),t.parameter?N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,t.content.getBytes())])]}c(_H,"_encryptedContentToAsn1");function CE(t,e,r){var n={},i=[];if(!N.validate(e,r,n,i)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=N.derToOid(n.contentType);if(o!==J.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var a="";if(J.util.isArray(n.encryptedContent))for(var u=0;u<n.encryptedContent.length;++u){if(n.encryptedContent[u].type!==N.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=n.encryptedContent[u].value}else a=n.encryptedContent;t.encryptedContent={algorithm:N.derToOid(n.encAlgorithm),parameter:J.util.createBuffer(n.encParameter.value),content:J.util.createBuffer(a)}}if(n.content){var a="";if(J.util.isArray(n.content))for(var u=0;u<n.content.length;++u){if(n.content[u].type!==N.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=n.content[u].value}else a=n.content;t.content=J.util.createBuffer(a)}return t.version=n.version.charCodeAt(0),t.rawCapture=n,n}c(CE,"_fromAsn1");function SN(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case J.pki.oids["aes128-CBC"]:case J.pki.oids["aes192-CBC"]:case J.pki.oids["aes256-CBC"]:e=J.aes.createDecryptionCipher(t.encryptedContent.key);break;case J.pki.oids.desCBC:case J.pki.oids["des-EDE3-CBC"]:e=J.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}c(SN,"_decryptContent")});var TN=_((iee,xN)=>{var _t=ve();qi();Ro();Hl();Po();qe();var df=xN.exports=_t.ssh=_t.ssh||{};df.privateKeyToPutty=function(t,e,r){r=r||"",e=e||"";var n="ssh-rsa",i=e===""?"none":"aes256-cbc",s="PuTTY-User-Key-File-2: "+n+`\r
`;s+="Encryption: "+i+`\r
`,s+="Comment: "+r+`\r
`;var o=_t.util.createBuffer();Ho(o,n),Yn(o,t.e),Yn(o,t.n);var a=_t.util.encode64(o.bytes(),64),u=Math.floor(a.length/66)+1;s+="Public-Lines: "+u+`\r
`,s+=a;var l=_t.util.createBuffer();Yn(l,t.d),Yn(l,t.p),Yn(l,t.q),Yn(l,t.qInv);var f;if(!e)f=_t.util.encode64(l.bytes(),64);else{var h=l.length()+16-1;h-=h%16;var p=hf(l.bytes());p.truncate(p.length()-h+l.length()),l.putBuffer(p);var g=_t.util.createBuffer();g.putBuffer(hf("\0\0\0\0",e)),g.putBuffer(hf("\0\0\0",e));var d=_t.aes.createEncryptionCipher(g.truncate(8),"CBC");d.start(_t.util.createBuffer().fillWithByte(0,16)),d.update(l.copy()),d.finish();var y=d.output;y.truncate(16),f=_t.util.encode64(y.bytes(),64)}u=Math.floor(f.length/66)+1,s+=`\r
Private-Lines: `+u+`\r
`,s+=f;var v=hf("putty-private-key-file-mac-key",e),m=_t.util.createBuffer();Ho(m,n),Ho(m,i),Ho(m,r),m.putInt32(o.length()),m.putBuffer(o),m.putInt32(l.length()),m.putBuffer(l);var w=_t.hmac.create();return w.start("sha1",v),w.update(m.bytes()),s+=`\r
Private-MAC: `+w.digest().toHex()+`\r
`,s};df.publicKeyToOpenSSH=function(t,e){var r="ssh-rsa";e=e||"";var n=_t.util.createBuffer();return Ho(n,r),Yn(n,t.e),Yn(n,t.n),r+" "+_t.util.encode64(n.bytes())+" "+e};df.privateKeyToOpenSSH=function(t,e){return e?_t.pki.encryptRsaPrivateKey(t,e,{legacy:!0,algorithm:"aes128"}):_t.pki.privateKeyToPem(t)};df.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||_t.md.md5.create(),n="ssh-rsa",i=_t.util.createBuffer();Ho(i,n),Yn(i,t.e),Yn(i,t.n),r.start(),r.update(i.getBytes());var s=r.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};function Yn(t,e){var r=e.toString(16);r[0]>="8"&&(r="00"+r);var n=_t.util.hexToBytes(r);t.putInt32(n.length),t.putBytes(n)}c(Yn,"_addBigIntegerToBuffer");function Ho(t,e){t.putInt32(e.length),t.putString(e)}c(Ho,"_addStringToBuffer");function hf(){for(var t=_t.md.sha1.create(),e=arguments.length,r=0;r<e;++r)t.update(arguments[r]);return t.digest()}c(hf,"_sha1")});var bN=_((oee,_N)=>{_N.exports=ve();qi();G2();_n();kl();Ec();uN();Ro();dN();mN();EN();zv();zl();Ds();Mv();Yv();wN();Xv();Hv();Dv();ef();nn();kv();TN();iE();qe()});var RN=_((aee,BN)=>{var IN=Rs(),Zn=bN(),AN=[[813826048,33620784,2181038086,153781832,2264337665,117547136],[805306881,53477382,153781832,2264337665,117547008,67108864],[813760514,16986241,395562,2252900087,218171137,2692808708],[813826048,33620784,2164262409,713443462,4144824583,27296e3],[813891584,131331,813826048,101264006,1216804621,17236384],[813891584,131331,813891584,395562,2252900087,218171137],[813957120,513,53510912,1545,713443462,4144824583],[813957120,513,53511168,6,153781832,2264337665]],bH=[[4294901760,4294967295,4278190335,4294967295,4294967295,4294967280],[4278255615,4294902015,4294967295,4294967295,4294967040,4278190080],[4294902015,4294967295,16777215,4294967295,4294967295,4294902015],[4294901760,4294967295,4278255615,4294967295,4294967295,4294967040],[4294901760,16777215,4294901760,4294967295,4294967295,4294967295],[4294901760,16777215,4294901760,16777215,4294967295,4294967295],[4294901760,65535,4294967040,65535,4294967295,4294967295],[4294901760,65535,4294967040,255,4294967295,4294967295]],xE=class xE{constructor(e,r){this.keystore=e,this.password=r}static probe(e){let n=new IN(e).read(24);for(let i=0;i<AN.length;i++){let s=new IN(n),o=AN[i];if(bH[i].map(l=>(s.readInt()&l)>>>0).every((l,f)=>l===o[f]))return!0}return!1}parse(){let e=this.keystore.toString("base64"),r=Zn.util.decode64(e),n=Zn.asn1.fromDer(r);return Zn.pkcs12.pkcs12FromAsn1(n,this.password||"").safeContents.reduce((s,o)=>Array.isArray(o.safeBags)?s.concat(o.safeBags):s,[])}toPem(e){return e.reduce((r,n)=>{let i=n.attributes.friendlyName[0],s=!!n.attributes.localKeyId,o=r[i]||{};if(n.type===Zn.pki.oids.certBag){let a=s?"cert":"ca";n.cert?o={...o,[a]:Zn.pki.certificateToPem(n.cert).replace(/\r\n/g,`
`)}:n.asn1&&(o={...o,[a]:NN(n.asn1,"CERTIFICATE").replace(/\r\n/g,`
`)})}return n.key?o={...o,key:IH(n.key).replace(/\r\n/g,`
`)}:n.asn1&&n.hasOwnProperty("key")&&(o={...o,key:NN(n.asn1,"PRIVATE KEY").replace(/\r\n/g,`
`)}),{...r,[i]:o}},{})}};c(xE,"PKCS12Parser");var wE=xE,IH=c((t,e)=>Zn.pki.privateKeyInfoToPem(Zn.pki.wrapRsaPrivateKey(Zn.pki.privateKeyToAsn1(t))),"privateKeyToPem"),NN=c((t,e)=>{let r={type:e,body:Zn.asn1.toDer(t).getBytes()};return Zn.pem.encode(r)},"derToPem");BN.exports=wE});var Bc=_((uee,DN)=>{var ON=Rs(),AH=Io(),In=class In{constructor(e){this.tag=null,this.length=0,this.data=null,this.buffer=null,this.buffer=AH(e.buffer,e.offset),this.init(e)}init(e){this.tag=e.readByte();let r=e.buffer.readUInt8(e.offset);if(this.length=In.getLength(e),this.length===-1){let n=e.available(),i=2,s=new OutputStream(Buffer.alloc(n+i));throw s.write(this.tag),s.write(r),s.write(e.read(n)),new Error("Length is not defined. The DerIndefLenConverter.convert() has not been implemented yet")}this.data=new ON(e.read(this.length))}isConstructed(e){return(this.tag&32)==32?e?(tag&31)==e:!0:!1}static getLength(e){let r=e.readByte();if(!(r&128))return r;let n=r&127;if(n===0)return-1;if(n<0)throw new Error("Incorrect DER encodding");if(n>4)throw new Error("DER length too big");let i;for(i=0;n>0;n--)i<<=8,i+=255&e.readByte();if(i<0)throw new Error("Invalid length byte");return i}getBigInteger(){let e=this.data;if(e.readByte()!=In.tag_Integer)throw new Error("DER input, Integer tag error");let r=In.getLength(e);return r<=1?e.readByte():r===2?e.readShort():r<=4?e.readInt():e.readLong()}getOctetString(){if(this.tag!==In.tag_OctetString&&!this.isConstructed(In.tag_OctetString))throw new Error("DerValue.getOctetString, not an Octet String: "+derValue.tag);let e=new ON(this.buffer),r=Buffer.from([]);for(;e.available();){let n=e.readByte();if(n!==In.tag_OctetString)throw new Error("DER input not an octet string: "+n);let i=In.getLength(e),s=e.read(i);r=Buffer.concat([r,s])}return r}getDerValue(){return new In(this.data)}};c(In,"DerValue");var Ms=In;Ms.tag_ObjectId=6;Ms.tag_Sequence=48;Ms.tag_OctetString=4;Ms.tag_Integer=2;DN.exports=Ms});var bE=_((fee,PN)=>{var LN=Bc(),_E=class _E{constructor(e){let r=e.readByte();if(r!==LN.tag_ObjectId)throw new Error("data isn't an object ID ( tag = "+r+")");let n=LN.getLength(e);this.encoding=e.read(n)}toString(){let e=this.encoding.length,r="",n=0;for(let i=0;i<e;i++)if(!(this.encoding[i]&128)){n!==0&&(r+=".");let s=0;for(let o=n;o<=i;o++){s<<=7;let a=this.encoding[o];s|=a&127}n===0?s<80?(r+=Math.floor(s/40),r+=".",r+=s%40):(r+="2.",r+=s-80):r+=s,n=i+1}return r}};c(_E,"ObjectIdentifier");var TE=_E;PN.exports=TE});var FN=_((dee,kN)=>{var NH=Rs(),BH=bE(),IE=Bc(),NE=class NE{constructor(e){let r=new IE(new NH(e)),n=new IE(r.data),i=new IE(r.data);this.alghorithmId=this.createAlghorithmId(n),this.octetString=i.getOctetString()}createAlghorithmId(e){return new BH(e.data).toString()}getAlgorithm(){return this.alghorithmId}getEncryptedData(){return this.octetString}};c(NE,"EncryptedPrivateKeyInfo");var AE=NE;kN.exports=AE});var wr=_((yee,$o)=>{var gee=require("crypto");$o.exports.linebrk=function(t,e){for(var r="",n=0;n+e<t.length;)r+=t.substring(n,n+e)+`
`,n+=e;return r+t.substring(n,t.length)};$o.exports.detectEnvironment=function(){return typeof window<"u"&&window&&!(process&&process.title==="node")?"browser":"node"};$o.exports.get32IntFromBuffer=function(t,e){e=e||0;var r=0;if((r=t.length-e)>0){if(r>=4)return t.readUIntBE(e,r);for(var n=0,i=e+r,s=0;i>e;i--,s+=2)n+=t[i-1]*Math.pow(16,s);return n}else return NaN};$o.exports._={isObject:function(t){var e=typeof t;return!!t&&(e=="object"||e=="function")},isString:function(t){return typeof t=="string"||t instanceof String},isNumber:function(t){return typeof t=="number"||!isNaN(parseFloat(t))&&isFinite(t)},omit:function(t,e){var r={};for(var n in t)!t.hasOwnProperty(n)||n===e||(r[n]=t[n]);return r}};$o.exports.trimSurroundingText=function(t,e,r){var n=0,i=t.length,s=t.indexOf(e);s>=0&&(n=s+e.length);var o=t.indexOf(r,s);return o>=0&&(i=o),t.substring(n,i)}});var $s=_((vee,KN)=>{var RH=require("crypto"),OH=wr()._,Go,DH=0xdeadbeefcafe,mee=(DH&16777215)==15715070;function $(t,e){t!=null&&(typeof t=="number"?this.fromNumber(t,e):Buffer.isBuffer(t)?this.fromBuffer(t):e==null&&typeof t!="string"?this.fromByteArray(t):this.fromString(t,e))}c($,"BigInteger");function De(){return new $(null)}c(De,"nbi");function LH(t,e,r,n,i,s){for(var o=e&16383,a=e>>14;--s>=0;){var u=this[t]&16383,l=this[t++]>>14,f=a*u+l*o;u=o*u+((f&16383)<<14)+r[n]+i,i=(u>>28)+(f>>14)+a*l,r[n++]=u&268435455}return i}c(LH,"am3");$.prototype.am=LH;Go=28;$.prototype.DB=Go;$.prototype.DM=(1<<Go)-1;$.prototype.DV=1<<Go;var RE=52;$.prototype.FV=Math.pow(2,RE);$.prototype.F1=RE-Go;$.prototype.F2=2*Go-RE;var PH="0123456789abcdefghijklmnopqrstuvwxyz",pf=new Array,jo,ln;jo=48;for(ln=0;ln<=9;++ln)pf[jo++]=ln;jo=97;for(ln=10;ln<36;++ln)pf[jo++]=ln;jo=65;for(ln=10;ln<36;++ln)pf[jo++]=ln;function BE(t){return PH.charAt(t)}c(BE,"int2char");function qN(t,e){var r=pf[t.charCodeAt(e)];return r??-1}c(qN,"intAt");function kH(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}c(kH,"bnpCopyTo");function FH(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+DV:this.t=0}c(FH,"bnpFromInt");function zi(t){var e=De();return e.fromInt(t),e}c(zi,"nbv");function qH(t,e,r){var n;switch(e){case 2:n=1;break;case 4:n=2;break;case 8:n=3;break;case 16:n=4;break;case 32:n=5;break;case 256:n=8;break;default:this.fromRadix(t,e);return}this.t=0,this.s=0;for(var i=t.length,s=!1,o=0;--i>=0;){var a=n==8?t[i]&255:qN(t,i);if(a<0){t.charAt(i)=="-"&&(s=!0);continue}s=!1,o===0?this[this.t++]=a:o+n>this.DB?(this[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this[this.t++]=a>>this.DB-o):this[this.t-1]|=a<<o,o+=n,o>=this.DB&&(o-=this.DB)}!r&&n==8&&t[0]&128&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),s&&$.ZERO.subTo(this,this)}c(qH,"bnpFromString");function UH(t,e){this.fromString(t,256,e)}c(UH,"bnpFromByteArray");function VH(t){this.fromString(t,256,!0)}c(VH,"bnpFromBuffer");function MH(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}c(MH,"bnpClamp");function KH(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this[o]>>a)>0&&(i=!0,s=BE(n));o>=0;)a<e?(n=(this[o]&(1<<a)-1)<<e-a,n|=this[--o]>>(a+=this.DB-e)):(n=this[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=BE(n));return i?s:"0"}c(KH,"bnToString");function HH(){var t=De();return $.ZERO.subTo(this,t),t}c(HH,"bnNegate");function $H(){return this.s<0?this.negate():this}c($H,"bnAbs");function GH(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this[r]-t[r])!=0)return e;return 0}c(GH,"bnCompareTo");function gf(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}c(gf,"nbits");function jH(){return this.t<=0?0:this.DB*(this.t-1)+gf(this[this.t-1]^this.s&this.DM)}c(jH,"bnBitLength");function zH(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s}c(zH,"bnpDLShiftTo");function WH(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s}c(WH,"bnpDRShiftTo");function QH(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e[a+s+1]=this[a]>>n|o,o=(this[a]&i)<<r;for(a=s-1;a>=0;--a)e[a]=0;e[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}c(QH,"bnpLShiftTo");function YH(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e[0]=this[r]>>n;for(var o=r+1;o<this.t;++o)e[o-r-1]|=(this[o]&s)<<i,e[o-r]=this[o]>>n;n>0&&(e[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}c(YH,"bnpRShiftTo");function ZH(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this[r]-t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t[r],e[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e[r++]=this.DV+n:n>0&&(e[r++]=n),e.t=r,e.clamp()}c(ZH,"bnpSubTo");function XH(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e[i]=0;for(i=0;i<n.t;++i)e[i+r.t]=r.am(0,n[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&$.ZERO.subTo(e,e)}c(XH,"bnpMultiplyTo");function JH(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()}c(JH,"bnpSquareTo");function e9(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=De());var s=De(),o=this.s,a=t.s,u=this.DB-gf(n[n.t-1]);u>0?(n.lShiftTo(u,s),i.lShiftTo(u,r)):(n.copyTo(s),i.copyTo(r));var l=s.t,f=s[l-1];if(f!==0){var h=f*(1<<this.F1)+(l>1?s[l-2]>>this.F2:0),p=this.FV/h,g=(1<<this.F1)/h,d=1<<this.F2,y=r.t,v=y-l,m=e??De();for(s.dlShiftTo(v,m),r.compareTo(m)>=0&&(r[r.t++]=1,r.subTo(m,r)),$.ONE.dlShiftTo(l,m),m.subTo(s,s);s.t<l;)s[s.t++]=0;for(;--v>=0;){var w=r[--y]==f?this.DM:Math.floor(r[y]*p+(r[y-1]+d)*g);if((r[y]+=s.am(0,w,r,v,0,l))<w)for(s.dlShiftTo(v,m),r.subTo(m,r);r[y]<--w;)r.subTo(m,r)}e!=null&&(r.drShiftTo(l,e),o!=a&&$.ZERO.subTo(e,e)),r.t=l,r.clamp(),u>0&&r.rShiftTo(u,r),o<0&&$.ZERO.subTo(r,r)}}}c(e9,"bnpDivRemTo");function t9(t){var e=De();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo($.ZERO)>0&&t.subTo(e,e),e}c(t9,"bnMod");function Ks(t){this.m=t}c(Ks,"Classic");function r9(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}c(r9,"cConvert");function n9(t){return t}c(n9,"cRevert");function i9(t){t.divRemTo(this.m,null,t)}c(i9,"cReduce");function s9(t,e,r){t.multiplyTo(e,r),this.reduce(r)}c(s9,"cMulTo");function o9(t,e){t.squareTo(e),this.reduce(e)}c(o9,"cSqrTo");Ks.prototype.convert=r9;Ks.prototype.revert=n9;Ks.prototype.reduce=i9;Ks.prototype.mulTo=s9;Ks.prototype.sqrTo=o9;function a9(){if(this.t<1)return 0;var t=this[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}c(a9,"bnpInvDigit");function Hs(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}c(Hs,"Montgomery");function c9(t){var e=De();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo($.ZERO)>0&&this.m.subTo(e,e),e}c(c9,"montConvert");function u9(t){var e=De();return t.copyTo(e),this.reduce(e),e}c(u9,"montRevert");function l9(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t[e]&32767,n=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t[r]+=this.m.am(0,n,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}c(l9,"montReduce");function f9(t,e){t.squareTo(e),this.reduce(e)}c(f9,"montSqrTo");function h9(t,e,r){t.multiplyTo(e,r),this.reduce(r)}c(h9,"montMulTo");Hs.prototype.convert=c9;Hs.prototype.revert=u9;Hs.prototype.reduce=l9;Hs.prototype.mulTo=h9;Hs.prototype.sqrTo=f9;function d9(){return(this.t>0?this[0]&1:this.s)===0}c(d9,"bnpIsEven");function p9(t,e){if(t>4294967295||t<1)return $.ONE;var r=De(),n=De(),i=e.convert(this),s=gf(t)-1;for(i.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,i,r);else{var o=r;r=n,n=o}return e.revert(r)}c(p9,"bnpExp");function g9(t,e){var r;return t<256||e.isEven()?r=new Ks(e):r=new Hs(e),this.exp(t,r)}c(g9,"bnModPowInt");function y9(){var t=De();return this.copyTo(t),t}c(y9,"bnClone");function m9(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t===0)return-1}else{if(this.t==1)return this[0];if(this.t===0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}c(m9,"bnIntValue");function v9(){return this.t==0?this.s:this[0]<<24>>24}c(v9,"bnByteValue");function E9(){return this.t==0?this.s:this[0]<<16>>16}c(E9,"bnShortValue");function S9(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}c(S9,"bnpChunkSize");function C9(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}c(C9,"bnSigNum");function w9(t){if(t==null&&(t=10),this.signum()===0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=zi(r),i=De(),s=De(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(t)+o}c(w9,"bnpToRadix");function x9(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,s=0,o=0,a=0;a<t.length;++a){var u=qN(t,a);if(u<0){t.charAt(a)=="-"&&this.signum()===0&&(i=!0);continue}o=e*o+u,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),i&&$.ZERO.subTo(this,this)}c(x9,"bnpFromRadix");function T9(t,e){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t),this.testBit(t-1)||this.bitwiseTo($.ONE.shiftLeft(t-1),OE,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo($.ONE.shiftLeft(t-1),this);else{var r=RH.randomBytes((t>>3)+1),n=t&7;n>0?r[0]&=(1<<n)-1:r[0]=0,this.fromByteArray(r)}}c(T9,"bnpFromNumber");function _9(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this[t]&(1<<r)-1)<<8-r,n|=this[--t]>>(r+=this.DB-8)):(n=this[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i===0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}c(_9,"bnToByteArray");function b9(t){var e=Buffer.from(this.toByteArray());if(t===!0&&e[0]===0)e=e.slice(1);else if(OH.isNumber(t)){if(e.length>t){for(var r=0;r<e.length-t;r++)if(e[r]!==0)return null;return e.slice(e.length-t)}else if(e.length<t){var n=Buffer.alloc(t);return n.fill(0,0,t-e.length),e.copy(n,t-e.length),n}}return e}c(b9,"bnToBuffer");function I9(t){return this.compareTo(t)==0}c(I9,"bnEquals");function A9(t){return this.compareTo(t)<0?this:t}c(A9,"bnMin");function N9(t){return this.compareTo(t)>0?this:t}c(N9,"bnMax");function B9(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r[n]=e(this[n],t[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r[n]=e(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r[n]=e(i,t[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}c(B9,"bnpBitwiseTo");function R9(t,e){return t&e}c(R9,"op_and");function O9(t){var e=De();return this.bitwiseTo(t,R9,e),e}c(O9,"bnAnd");function OE(t,e){return t|e}c(OE,"op_or");function D9(t){var e=De();return this.bitwiseTo(t,OE,e),e}c(D9,"bnOr");function UN(t,e){return t^e}c(UN,"op_xor");function L9(t){var e=De();return this.bitwiseTo(t,UN,e),e}c(L9,"bnXor");function VN(t,e){return t&~e}c(VN,"op_andnot");function P9(t){var e=De();return this.bitwiseTo(t,VN,e),e}c(P9,"bnAndNot");function k9(){for(var t=De(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}c(k9,"bnNot");function F9(t){var e=De();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}c(F9,"bnShiftLeft");function q9(t){var e=De();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}c(q9,"bnShiftRight");function U9(t){if(t===0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}c(U9,"lbit");function V9(){for(var t=0;t<this.t;++t)if(this[t]!=0)return t*this.DB+U9(this[t]);return this.s<0?this.t*this.DB:-1}c(V9,"bnGetLowestSetBit");function M9(t){for(var e=0;t!=0;)t&=t-1,++e;return e}c(M9,"cbit");function K9(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=M9(this[r]^e);return t}c(K9,"bnBitCount");function H9(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this[e]&1<<t%this.DB)!=0}c(H9,"bnTestBit");function $9(t,e){var r=$.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}c($9,"bnpChangeBit");function G9(t){return this.changeBit(t,OE)}c(G9,"bnSetBit");function j9(t){return this.changeBit(t,VN)}c(j9,"bnClearBit");function z9(t){return this.changeBit(t,UN)}c(z9,"bnFlipBit");function W9(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this[r]+t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t[r],e[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e[r++]=n:n<-1&&(e[r++]=this.DV+n),e.t=r,e.clamp()}c(W9,"bnpAddTo");function Q9(t){var e=De();return this.addTo(t,e),e}c(Q9,"bnAdd");function Y9(t){var e=De();return this.subTo(t,e),e}c(Y9,"bnSubtract");function Z9(t){var e=De();return this.multiplyTo(t,e),e}c(Z9,"bnMultiply");function X9(){var t=De();return this.squareTo(t),t}c(X9,"bnSquare");function J9(t){var e=De();return this.divRemTo(t,e,null),e}c(J9,"bnDivide");function e$(t){var e=De();return this.divRemTo(t,null,e),e}c(e$,"bnRemainder");function t$(t){var e=De(),r=De();return this.divRemTo(t,e,r),new Array(e,r)}c(t$,"bnDivideAndRemainder");function r$(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}c(r$,"bnpDMultiply");function n$(t,e){if(t!==0){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}c(n$,"bnpDAddOffset");function Rc(){}c(Rc,"NullExp");function MN(t){return t}c(MN,"nNop");function i$(t,e,r){t.multiplyTo(e,r)}c(i$,"nMulTo");function s$(t,e){t.squareTo(e)}c(s$,"nSqrTo");Rc.prototype.convert=MN;Rc.prototype.revert=MN;Rc.prototype.mulTo=i$;Rc.prototype.sqrTo=s$;function o$(t){return this.exp(t,new Rc)}c(o$,"bnPow");function a$(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,t[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t[n],r,n,0,e-n);r.clamp()}c(a$,"bnpMultiplyLowerTo");function c$(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r[this.t+n-e]=this.am(e-n,t[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}c(c$,"bnpMultiplyUpperTo");function zo(t){this.r2=De(),this.q3=De(),$.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}c(zo,"Barrett");function u$(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=De();return t.copyTo(e),this.reduce(e),e}c(u$,"barrettConvert");function l$(t){return t}c(l$,"barrettRevert");function f$(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}c(f$,"barrettReduce");function h$(t,e){t.squareTo(e),this.reduce(e)}c(h$,"barrettSqrTo");function d$(t,e,r){t.multiplyTo(e,r),this.reduce(r)}c(d$,"barrettMulTo");zo.prototype.convert=u$;zo.prototype.revert=l$;zo.prototype.reduce=f$;zo.prototype.mulTo=d$;zo.prototype.sqrTo=h$;function p$(t,e){var r=t.bitLength(),n,i=zi(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Ks(e):e.isEven()?s=new zo(e):s=new Hs(e);var o=new Array,a=3,u=n-1,l=(1<<n)-1;if(o[1]=s.convert(this),n>1){var f=De();for(s.sqrTo(o[1],f);a<=l;)o[a]=De(),s.mulTo(f,o[a-2],o[a]),a+=2}var h=t.t-1,p,g=!0,d=De(),y;for(r=gf(t[h])-1;h>=0;){for(r>=u?p=t[h]>>r-u&l:(p=(t[h]&(1<<r+1)-1)<<u-r,h>0&&(p|=t[h-1]>>this.DB+r-u)),a=n;!(p&1);)p>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),g)o[p].copyTo(i),g=!1;else{for(;a>1;)s.sqrTo(i,d),s.sqrTo(d,i),a-=2;a>0?s.sqrTo(i,d):(y=i,i=d,d=y),s.mulTo(d,o[p],i)}for(;h>=0&&!(t[h]&1<<r);)s.sqrTo(i,d),y=i,i=d,d=y,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}c(p$,"bnModPow");function g$(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}c(g$,"bnGCD");function y$(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e===0)r=this[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this[n])%t;return r}c(y$,"bnpModInt");function m$(t){var e=t.isEven();if(this.isEven()&&e||t.signum()===0)return $.ZERO;for(var r=t.clone(),n=this.clone(),i=zi(1),s=zi(0),o=zi(0),a=zi(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),e&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo($.ONE)!=0)return $.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}c(m$,"bnModInverse");var xr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],v$=(1<<26)/xr[xr.length-1];function E$(t){var e,r=this.abs();if(r.t==1&&r[0]<=xr[xr.length-1]){for(e=0;e<xr.length;++e)if(r[0]==xr[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<xr.length;){for(var n=xr[e],i=e+1;i<xr.length&&n<v$;)n*=xr[i++];for(n=r.modInt(n);e<i;)if(n%xr[e++]===0)return!1}return r.millerRabin(t)}c(E$,"bnIsProbablePrime");function S$(t){var e=this.subtract($.ONE),r=e.getLowestSetBit();if(r<=0)return!1;var n=e.shiftRight(r);t=t+1>>1,t>xr.length&&(t=xr.length);for(var i=De(),s=0;s<t;++s){i.fromInt(xr[Math.floor(Math.random()*xr.length)]);var o=i.modPow(n,this);if(o.compareTo($.ONE)!=0&&o.compareTo(e)!=0){for(var a=1;a++<r&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo($.ONE)===0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}c(S$,"bnpMillerRabin");$.prototype.copyTo=kH;$.prototype.fromInt=FH;$.prototype.fromString=qH;$.prototype.fromByteArray=UH;$.prototype.fromBuffer=VH;$.prototype.clamp=MH;$.prototype.dlShiftTo=zH;$.prototype.drShiftTo=WH;$.prototype.lShiftTo=QH;$.prototype.rShiftTo=YH;$.prototype.subTo=ZH;$.prototype.multiplyTo=XH;$.prototype.squareTo=JH;$.prototype.divRemTo=e9;$.prototype.invDigit=a9;$.prototype.isEven=d9;$.prototype.exp=p9;$.prototype.chunkSize=S9;$.prototype.toRadix=w9;$.prototype.fromRadix=x9;$.prototype.fromNumber=T9;$.prototype.bitwiseTo=B9;$.prototype.changeBit=$9;$.prototype.addTo=W9;$.prototype.dMultiply=r$;$.prototype.dAddOffset=n$;$.prototype.multiplyLowerTo=a$;$.prototype.multiplyUpperTo=c$;$.prototype.modInt=y$;$.prototype.millerRabin=S$;$.prototype.toString=KH;$.prototype.negate=HH;$.prototype.abs=$H;$.prototype.compareTo=GH;$.prototype.bitLength=jH;$.prototype.mod=t9;$.prototype.modPowInt=g9;$.prototype.clone=y9;$.prototype.intValue=m9;$.prototype.byteValue=v9;$.prototype.shortValue=E9;$.prototype.signum=C9;$.prototype.toByteArray=_9;$.prototype.toBuffer=b9;$.prototype.equals=I9;$.prototype.min=A9;$.prototype.max=N9;$.prototype.and=O9;$.prototype.or=D9;$.prototype.xor=L9;$.prototype.andNot=P9;$.prototype.not=k9;$.prototype.shiftLeft=F9;$.prototype.shiftRight=q9;$.prototype.getLowestSetBit=V9;$.prototype.bitCount=K9;$.prototype.testBit=H9;$.prototype.setBit=G9;$.prototype.clearBit=j9;$.prototype.flipBit=z9;$.prototype.add=Q9;$.prototype.subtract=Y9;$.prototype.multiply=Z9;$.prototype.divide=J9;$.prototype.remainder=e$;$.prototype.divideAndRemainder=t$;$.prototype.modPow=p$;$.prototype.modInverse=m$;$.prototype.pow=o$;$.prototype.gcd=g$;$.prototype.isProbablePrime=E$;$.int2char=BE;$.ZERO=zi(0);$.ONE=zi(1);$.prototype.square=X9;KN.exports=$});var jN=_((See,DE)=>{var HN=$s(),Wo=require("crypto"),yf=require("constants"),C$={md2:Buffer.from("3020300c06082a864886f70d020205000410","hex"),md5:Buffer.from("3020300c06082a864886f70d020505000410","hex"),sha1:Buffer.from("3021300906052b0e03021a05000414","hex"),sha224:Buffer.from("302d300d06096086480165030402040500041c","hex"),sha256:Buffer.from("3031300d060960864801650304020105000420","hex"),sha384:Buffer.from("3041300d060960864801650304020205000430","hex"),sha512:Buffer.from("3051300d060960864801650304020305000440","hex"),ripemd160:Buffer.from("3021300906052b2403020105000414","hex"),rmd160:Buffer.from("3021300906052b2403020105000414","hex")},$N={ripemd160:"rmd160"},GN="sha256";DE.exports={isEncryption:!0,isSignature:!0};DE.exports.makeScheme=function(t,e){function r(n,i){this.key=n,this.options=i}return c(r,"Scheme"),r.prototype.maxMessageLength=function(){return this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==yf.RSA_NO_PADDING?this.key.encryptedDataLength:this.key.encryptedDataLength-11},r.prototype.encPad=function(n,i){i=i||{};var s;if(n.length>this.key.maxMessageLength)throw new Error("Message too long for RSA (n="+this.key.encryptedDataLength+", l="+n.length+")");if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==yf.RSA_NO_PADDING)return s=Buffer.alloc(this.key.maxMessageLength-n.length),s.fill(0),Buffer.concat([s,n]);if(i.type===1)return s=Buffer.alloc(this.key.encryptedDataLength-n.length-1),s.fill(255,0,s.length-1),s[0]=1,s[s.length-1]=0,Buffer.concat([s,n]);s=Buffer.alloc(this.key.encryptedDataLength-n.length),s[0]=0,s[1]=2;for(var o=Wo.randomBytes(s.length-3),a=0;a<o.length;a++){for(var u=o[a];u===0;)u=Wo.randomBytes(1)[0];s[a+2]=u}return s[s.length-1]=0,Buffer.concat([s,n])},r.prototype.encUnPad=function(n,i){i=i||{};var s=0;if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==yf.RSA_NO_PADDING){var o;return typeof n.lastIndexOf=="function"?o=n.slice(n.lastIndexOf("\0")+1,n.length):o=n.slice(String.prototype.lastIndexOf.call(n,"\0")+1,n.length),o}if(n.length<4)return null;if(i.type===1){if(n[0]!==0||n[1]!==1)return null;for(s=3;n[s]!==0;)if(n[s]!=255||++s>=n.length)return null}else{if(n[0]!==0||n[1]!==2)return null;for(s=3;n[s]!==0;)if(++s>=n.length)return null}return n.slice(s+1,n.length)},r.prototype.sign=function(n){var i=this.options.signingSchemeOptions.hash||GN;if(this.options.environment==="browser"){i=$N[i]||i;var s=Wo.createHash(i);s.update(n);var o=this.pkcs1pad(s.digest(),i),a=this.key.$doPrivate(new HN(o)).toBuffer(this.key.encryptedDataLength);return a}else{var u=Wo.createSign("RSA-"+i.toUpperCase());return u.update(n),u.sign(this.options.rsaUtils.exportKey("private"))}},r.prototype.verify=function(n,i,s){if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==yf.RSA_NO_PADDING)return!1;var o=this.options.signingSchemeOptions.hash||GN;if(this.options.environment==="browser"){o=$N[o]||o,s&&(i=Buffer.from(i,s));var a=Wo.createHash(o);a.update(n);var u=this.pkcs1pad(a.digest(),o),l=this.key.$doPublic(new HN(i));return l.toBuffer().toString("hex")==u.toString("hex")}else{var f=Wo.createVerify("RSA-"+o.toUpperCase());return f.update(n),f.verify(this.options.rsaUtils.exportKey("public"),i,s)}},r.prototype.pkcs0pad=function(n){var i=Buffer.alloc(this.key.maxMessageLength-n.length);return i.fill(0),Buffer.concat([i,n])},r.prototype.pkcs0unpad=function(n){var i;return typeof n.lastIndexOf=="function"?i=n.slice(n.lastIndexOf("\0")+1,n.length):i=n.slice(String.prototype.lastIndexOf.call(n,"\0")+1,n.length),i},r.prototype.pkcs1pad=function(n,i){var s=C$[i];if(!s)throw Error("Unsupported hash algorithm");var o=Buffer.concat([s,n]);if(o.length+10>this.key.encryptedDataLength)throw Error("Key is too short for signing algorithm ("+i+")");var a=Buffer.alloc(this.key.encryptedDataLength-o.length-1);a.fill(255,0,a.length-1),a[0]=1,a[a.length-1]=0;var u=Buffer.concat([a,o]);return u},new r(t,e)}});var zN=_((xee,An)=>{var wee=$s(),mf=require("crypto");An.exports={isEncryption:!0,isSignature:!1};An.exports.digestLength={md4:16,md5:16,ripemd160:20,rmd160:20,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64};var vf="sha1";An.exports.eme_oaep_mgf1=function(t,e,r){r=r||vf;for(var n=An.exports.digestLength[r],i=Math.ceil(e/n),s=Buffer.alloc(n*i),o=Buffer.alloc(4),a=0;a<i;++a){var u=mf.createHash(r);u.update(t),o.writeUInt32BE(a,0),u.update(o),u.digest().copy(s,a*n)}return s.slice(0,e)};An.exports.makeScheme=function(t,e){function r(n,i){this.key=n,this.options=i}return c(r,"Scheme"),r.prototype.maxMessageLength=function(){return this.key.encryptedDataLength-2*An.exports.digestLength[this.options.encryptionSchemeOptions.hash||vf]-2},r.prototype.encPad=function(n){var i=this.options.encryptionSchemeOptions.hash||vf,s=this.options.encryptionSchemeOptions.mgf||An.exports.eme_oaep_mgf1,o=this.options.encryptionSchemeOptions.label||Buffer.alloc(0),a=this.key.encryptedDataLength,u=An.exports.digestLength[i];if(n.length>a-2*u-2)throw new Error("Message is too long to encode into an encoded message with a length of "+a+" bytes, increaseemLen to fix this error (minimum value for given parameters and options: "+(a-2*u-2)+")");var l=mf.createHash(i);l.update(o),l=l.digest();var f=Buffer.alloc(a-n.length-2*u-1);f.fill(0),f[f.length-1]=1;for(var h=Buffer.concat([l,f,n]),p=mf.randomBytes(u),g=s(p,h.length,i),d=0;d<h.length;d++)h[d]^=g[d];for(g=s(h,u,i),d=0;d<p.length;d++)p[d]^=g[d];var y=Buffer.alloc(1+p.length+h.length);return y[0]=0,p.copy(y,1),h.copy(y,1+p.length),y},r.prototype.encUnPad=function(n){var i=this.options.encryptionSchemeOptions.hash||vf,s=this.options.encryptionSchemeOptions.mgf||An.exports.eme_oaep_mgf1,o=this.options.encryptionSchemeOptions.label||Buffer.alloc(0),a=An.exports.digestLength[i];if(n.length<2*a+2)throw new Error("Error decoding message, the supplied message is not long enough to be a valid OAEP encoded message");for(var u=n.slice(1,a+1),l=n.slice(1+a),f=s(l,a,i),h=0;h<u.length;h++)u[h]^=f[h];for(f=s(u,l.length,i),h=0;h<l.length;h++)l[h]^=f[h];var p=mf.createHash(i);p.update(o),p=p.digest();var g=l.slice(0,a);if(g.toString("hex")!=p.toString("hex"))throw new Error("Error decoding message, the lHash calculated from the label provided and the lHash in the encrypted data do not match.");for(h=a;l[h++]===0&&h<l.length;);if(l[h-1]!=1)throw new Error("Error decoding message, there is no padding message separator byte");return l.slice(h)},new r(t,e)}});var YN=_((_ee,LE)=>{var WN=$s(),Oc=require("crypto");LE.exports={isEncryption:!1,isSignature:!0};var Ef="sha1",QN=20;LE.exports.makeScheme=function(t,e){var r=Gs().pkcs1_oaep;function n(i,s){this.key=i,this.options=s}return c(n,"Scheme"),n.prototype.sign=function(i){var s=Oc.createHash(this.options.signingSchemeOptions.hash||Ef);s.update(i);var o=this.emsa_pss_encode(s.digest(),this.key.keySize-1);return this.key.$doPrivate(new WN(o)).toBuffer(this.key.encryptedDataLength)},n.prototype.verify=function(i,s,o){o&&(s=Buffer.from(s,o)),s=new WN(s);var a=Math.ceil((this.key.keySize-1)/8),u=this.key.$doPublic(s).toBuffer(a),l=Oc.createHash(this.options.signingSchemeOptions.hash||Ef);return l.update(i),this.emsa_pss_verify(l.digest(),u,this.key.keySize-1)},n.prototype.emsa_pss_encode=function(i,s){var o=this.options.signingSchemeOptions.hash||Ef,a=this.options.signingSchemeOptions.mgf||r.eme_oaep_mgf1,u=this.options.signingSchemeOptions.saltLength||QN,l=r.digestLength[o],f=Math.ceil(s/8);if(f<l+u+2)throw new Error("Output length passed to emBits("+s+") is too small for the options specified("+o+", "+u+"). To fix this issue increase the value of emBits. (minimum size: "+(8*l+8*u+9)+")");var h=Oc.randomBytes(u),p=Buffer.alloc(8+l+u);p.fill(0,0,8),i.copy(p,8),h.copy(p,8+i.length);var g=Oc.createHash(o);g.update(p),g=g.digest();var d=Buffer.alloc(f-h.length-l-2);d.fill(0);var y=Buffer.alloc(d.length+1+h.length);d.copy(y),y[d.length]=1,h.copy(y,d.length+1);for(var v=a(g,y.length,o),m=Buffer.alloc(y.length),w=0;w<v.length;w++)m[w]=y[w]^v[w];var x=8*f-s,A=255^255>>8-x<<8-x;m[0]=m[0]&A;var O=Buffer.alloc(m.length+g.length+1);return m.copy(O,0),g.copy(O,m.length),O[O.length-1]=188,O},n.prototype.emsa_pss_verify=function(i,s,o){var a=this.options.signingSchemeOptions.hash||Ef,u=this.options.signingSchemeOptions.mgf||r.eme_oaep_mgf1,l=this.options.signingSchemeOptions.saltLength||QN,f=r.digestLength[a],h=Math.ceil(o/8);if(h<f+l+2||s[s.length-1]!=188)return!1;var p=Buffer.alloc(h-f-1);s.copy(p,0,0,h-f-1);for(var g=0,d=0,y=8*h-o;d<y;d++)g|=1<<7-d;if(p[0]&g)return!1;var v=s.slice(h-f-1,h-1),m=u(v,p.length,a);for(d=0;d<p.length;d++)p[d]^=m[d];for(y=8*h-o,g=255^255>>8-y<<8-y,p[0]=p[0]&g,d=0;p[d]===0&&d<p.length;d++);if(p[d]!=1)return!1;var w=p.slice(p.length-l),x=Buffer.alloc(8+f+l);x.fill(0,0,8),i.copy(x,8),w.copy(x,8+i.length);var A=Oc.createHash(a);return A.update(x),A=A.digest(),v.toString("hex")===A.toString("hex")},new n(t,e)}});var Gs=_((Iee,Qo)=>{Qo.exports={pkcs1:jN(),pkcs1_oaep:zN(),pss:YN(),isEncryption:function(t){return Qo.exports[t]&&Qo.exports[t].isEncryption},isSignature:function(t){return Qo.exports[t]&&Qo.exports[t].isSignature}}});var kE=_((Aee,ZN)=>{var PE=$s(),w$=Gs();ZN.exports=function(t,e){var r=w$.pkcs1.makeScheme(t,e);return{encrypt:function(n,i){var s,o;return i?(s=new PE(r.encPad(n,{type:1})),o=t.$doPrivate(s)):(s=new PE(t.encryptionScheme.encPad(n)),o=t.$doPublic(s)),o.toBuffer(t.encryptedDataLength)},decrypt:function(n,i){var s,o=new PE(n);return i?(s=t.$doPublic(o),r.encUnPad(s.toBuffer(t.encryptedDataLength),{type:1})):(s=t.$doPrivate(o),t.encryptionScheme.encUnPad(s.toBuffer(t.encryptedDataLength)))}}}});var JN=_((Nee,XN)=>{var Sf=require("crypto"),Wi=require("constants"),x$=Gs();XN.exports=function(t,e){var r=x$.pkcs1.makeScheme(t,e);return{encrypt:function(n,i){var s;if(i)return s=Wi.RSA_PKCS1_PADDING,e.encryptionSchemeOptions&&e.encryptionSchemeOptions.padding&&(s=e.encryptionSchemeOptions.padding),Sf.privateEncrypt({key:e.rsaUtils.exportKey("private"),padding:s},n);s=Wi.RSA_PKCS1_OAEP_PADDING,e.encryptionScheme==="pkcs1"&&(s=Wi.RSA_PKCS1_PADDING),e.encryptionSchemeOptions&&e.encryptionSchemeOptions.padding&&(s=e.encryptionSchemeOptions.padding);var o=n;return s===Wi.RSA_NO_PADDING&&(o=r.pkcs0pad(n)),Sf.publicEncrypt({key:e.rsaUtils.exportKey("public"),padding:s},o)},decrypt:function(n,i){var s;if(i)return s=Wi.RSA_PKCS1_PADDING,e.encryptionSchemeOptions&&e.encryptionSchemeOptions.padding&&(s=e.encryptionSchemeOptions.padding),Sf.publicDecrypt({key:e.rsaUtils.exportKey("public"),padding:s},n);s=Wi.RSA_PKCS1_OAEP_PADDING,e.encryptionScheme==="pkcs1"&&(s=Wi.RSA_PKCS1_PADDING),e.encryptionSchemeOptions&&e.encryptionSchemeOptions.padding&&(s=e.encryptionSchemeOptions.padding);var o=Sf.privateDecrypt({key:e.rsaUtils.exportKey("private"),padding:s},n);return s===Wi.RSA_NO_PADDING?r.pkcs0unpad(o):o}}}});var rB=_((Bee,tB)=>{var eB=require("crypto"),Yo=require("constants"),T$=Gs();tB.exports=function(t,e){var r=kE()(t,e),n=T$.pkcs1.makeScheme(t,e);return{encrypt:function(i,s){if(s)return r.encrypt(i,s);var o=Yo.RSA_PKCS1_OAEP_PADDING;e.encryptionScheme==="pkcs1"&&(o=Yo.RSA_PKCS1_PADDING),e.encryptionSchemeOptions&&e.encryptionSchemeOptions.padding&&(o=e.encryptionSchemeOptions.padding);var a=i;return o===Yo.RSA_NO_PADDING&&(a=n.pkcs0pad(i)),eB.publicEncrypt({key:e.rsaUtils.exportKey("public"),padding:o},a)},decrypt:function(i,s){if(s)return r.decrypt(i,s);var o=Yo.RSA_PKCS1_OAEP_PADDING;e.encryptionScheme==="pkcs1"&&(o=Yo.RSA_PKCS1_PADDING),e.encryptionSchemeOptions&&e.encryptionSchemeOptions.padding&&(o=e.encryptionSchemeOptions.padding);var a=eB.privateDecrypt({key:e.rsaUtils.exportKey("private"),padding:o},i);return o===Yo.RSA_NO_PADDING?n.pkcs0unpad(a):a}}}});var iB=_((Ree,nB)=>{var Cf=require("crypto");nB.exports={getEngine:function(t,e){var r=kE();return e.environment==="node"&&typeof Cf.publicEncrypt=="function"&&typeof Cf.privateDecrypt=="function"&&(typeof Cf.privateEncrypt=="function"&&typeof Cf.publicDecrypt=="function"?r=JN():r=rB()),r(t,e)}}});var uB=_((aB,cB)=>{var wf=wr()._,Oee=require("crypto"),Rt=$s(),sB=wr(),oB=Gs(),_$=iB();aB.BigInteger=Rt;cB.exports.Key=function(){function t(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return c(t,"RSAKey"),t.prototype.setOptions=function(e){var r=oB[e.signingScheme],n=oB[e.encryptionScheme];r===n?this.signingScheme=this.encryptionScheme=n.makeScheme(this,e):(this.encryptionScheme=n.makeScheme(this,e),this.signingScheme=r.makeScheme(this,e)),this.encryptEngine=_$.getEngine(this,e)},t.prototype.generate=function(e,r){var n=e>>1;this.e=parseInt(r,16);for(var i=new Rt(r,16);;){for(;this.p=new Rt(e-n,1),!(this.p.subtract(Rt.ONE).gcd(i).compareTo(Rt.ONE)===0&&this.p.isProbablePrime(10)););for(;this.q=new Rt(n,1),!(this.q.subtract(Rt.ONE).gcd(i).compareTo(Rt.ONE)===0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var o=this.p.subtract(Rt.ONE),a=this.q.subtract(Rt.ONE),u=o.multiply(a);if(u.gcd(i).compareTo(Rt.ONE)===0){if(this.n=this.p.multiply(this.q),this.n.bitLength()<e)continue;this.d=i.modInverse(u),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}this.$$recalculateCache()},t.prototype.setPrivate=function(e,r,n,i,s,o,a,u){if(e&&r&&n&&e.length>0&&(wf.isNumber(r)||r.length>0)&&n.length>0)this.n=new Rt(e),this.e=wf.isNumber(r)?r:sB.get32IntFromBuffer(r,0),this.d=new Rt(n),i&&s&&o&&a&&u&&(this.p=new Rt(i),this.q=new Rt(s),this.dmp1=new Rt(o),this.dmq1=new Rt(a),this.coeff=new Rt(u)),this.$$recalculateCache();else throw Error("Invalid RSA private key")},t.prototype.setPublic=function(e,r){if(e&&r&&e.length>0&&(wf.isNumber(r)||r.length>0))this.n=new Rt(e),this.e=wf.isNumber(r)?r:sB.get32IntFromBuffer(r,0),this.$$recalculateCache();else throw Error("Invalid RSA public key")},t.prototype.$doPrivate=function(e){if(this.p||this.q)return e.modPow(this.d,this.n);for(var r=e.mod(this.p).modPow(this.dmp1,this.p),n=e.mod(this.q).modPow(this.dmq1,this.q);r.compareTo(n)<0;)r=r.add(this.p);return r.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)},t.prototype.$doPublic=function(e){return e.modPowInt(this.e,this.n)},t.prototype.encrypt=function(e,r){var n=[],i=[],s=e.length,o=Math.ceil(s/this.maxMessageLength)||1,a=Math.ceil(s/o||1);if(o==1)n.push(e);else for(var u=0;u<o;u++)n.push(e.slice(u*a,(u+1)*a));for(var l=0;l<n.length;l++)i.push(this.encryptEngine.encrypt(n[l],r));return Buffer.concat(i)},t.prototype.decrypt=function(e,r){if(e.length%this.encryptedDataLength>0)throw Error("Incorrect data or key");for(var n=[],i=0,s=0,o=e.length/this.encryptedDataLength,a=0;a<o;a++)i=a*this.encryptedDataLength,s=i+this.encryptedDataLength,n.push(this.encryptEngine.decrypt(e.slice(i,Math.min(s,e.length)),r));return Buffer.concat(n)},t.prototype.sign=function(e){return this.signingScheme.sign.apply(this.signingScheme,arguments)},t.prototype.verify=function(e,r,n){return this.signingScheme.verify.apply(this.signingScheme,arguments)},t.prototype.isPrivate=function(){return this.n&&this.e&&this.d&&!0||!1},t.prototype.isPublic=function(e){return this.n&&this.e&&!(e&&this.d)||!1},Object.defineProperty(t.prototype,"keySize",{get:function(){return this.cache.keyBitLength}}),Object.defineProperty(t.prototype,"encryptedDataLength",{get:function(){return this.cache.keyByteLength}}),Object.defineProperty(t.prototype,"maxMessageLength",{get:function(){return this.encryptionScheme.maxMessageLength()}}),t.prototype.$$recalculateCache=function(){this.cache=this.cache||{},this.cache.keyBitLength=this.n.bitLength(),this.cache.keyByteLength=this.cache.keyBitLength+6>>3},t}()});var xf=_((Lee,lB)=>{lB.exports={newInvalidAsn1Error:function(t){var e=new Error;return e.name="InvalidAsn1Error",e.message=t||"",e}}});var Tf=_((Pee,fB)=>{fB.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}});var FE=_((kee,hB)=>{"use strict";var _f=require("buffer"),Zo=_f.Buffer,fn={},hn;for(hn in _f)_f.hasOwnProperty(hn)&&(hn==="SlowBuffer"||hn==="Buffer"||(fn[hn]=_f[hn]));var Xo=fn.Buffer={};for(hn in Zo)Zo.hasOwnProperty(hn)&&(hn==="allocUnsafe"||hn==="allocUnsafeSlow"||(Xo[hn]=Zo[hn]));fn.Buffer.prototype=Zo.prototype;(!Xo.from||Xo.from===Uint8Array.from)&&(Xo.from=function(t,e,r){if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof t);if(t&&typeof t.length>"u")throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);return Zo(t,e,r)});Xo.alloc||(Xo.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof t);if(t<0||t>=2*(1<<30))throw new RangeError('The value "'+t+'" is invalid for option "size"');var n=Zo(t);return!e||e.length===0?n.fill(0):typeof r=="string"?n.fill(e,r):n.fill(e),n});if(!fn.kStringMaxLength)try{fn.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch{}fn.constants||(fn.constants={MAX_LENGTH:fn.kMaxLength},fn.kStringMaxLength&&(fn.constants.MAX_STRING_LENGTH=fn.kStringMaxLength));hB.exports=fn});var gB=_((Fee,pB)=>{var b$=require("assert"),dB=FE().Buffer,Dc=Tf(),I$=xf(),Jo=I$.newInvalidAsn1Error;function Tr(t){if(!t||!dB.isBuffer(t))throw new TypeError("data must be a node Buffer");this._buf=t,this._size=t.length,this._len=0,this._offset=0}c(Tr,"Reader");Object.defineProperty(Tr.prototype,"length",{enumerable:!0,get:function(){return this._len}});Object.defineProperty(Tr.prototype,"offset",{enumerable:!0,get:function(){return this._offset}});Object.defineProperty(Tr.prototype,"remain",{get:function(){return this._size-this._offset}});Object.defineProperty(Tr.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}});Tr.prototype.readByte=function(t){if(this._size-this._offset<1)return null;var e=this._buf[this._offset]&255;return t||(this._offset+=1),e};Tr.prototype.peek=function(){return this.readByte(!0)};Tr.prototype.readLength=function(t){if(t===void 0&&(t=this._offset),t>=this._size)return null;var e=this._buf[t++]&255;if(e===null)return null;if((e&128)===128){if(e&=127,e===0)throw Jo("Indefinite length not supported");if(e>4)throw Jo("encoding too long");if(this._size-t<e)return null;this._len=0;for(var r=0;r<e;r++)this._len=(this._len<<8)+(this._buf[t++]&255)}else this._len=e;return t};Tr.prototype.readSequence=function(t){var e=this.peek();if(e===null)return null;if(t!==void 0&&t!==e)throw Jo("Expected 0x"+t.toString(16)+": got 0x"+e.toString(16));var r=this.readLength(this._offset+1);return r===null?null:(this._offset=r,e)};Tr.prototype.readInt=function(){return this._readTag(Dc.Integer)};Tr.prototype.readBoolean=function(){return this._readTag(Dc.Boolean)!==0};Tr.prototype.readEnumeration=function(){return this._readTag(Dc.Enumeration)};Tr.prototype.readString=function(t,e){t||(t=Dc.OctetString);var r=this.peek();if(r===null)return null;if(r!==t)throw Jo("Expected 0x"+t.toString(16)+": got 0x"+r.toString(16));var n=this.readLength(this._offset+1);if(n===null||this.length>this._size-n)return null;if(this._offset=n,this.length===0)return e?dB.alloc(0):"";var i=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,e?i:i.toString("utf8")};Tr.prototype.readOID=function(t){t||(t=Dc.OID);var e=this.readString(t,!0);if(e===null)return null;for(var r=[],n=0,i=0;i<e.length;i++){var s=e[i]&255;n<<=7,n+=s&127,s&128||(r.push(n),n=0)}return n=r.shift(),r.unshift(n%40),r.unshift(n/40>>0),r.join(".")};Tr.prototype._readTag=function(t){b$.ok(t!==void 0);var e=this.peek();if(e===null)return null;if(e!==t)throw Jo("Expected 0x"+t.toString(16)+": got 0x"+e.toString(16));var r=this.readLength(this._offset+1);if(r===null)return null;if(this.length>4)throw Jo("Integer too long: "+this.length);if(this.length>this._size-r)return null;this._offset=r;for(var n=this._buf[this._offset],i=0,s=0;s<this.length;s++)i<<=8,i|=this._buf[this._offset++]&255;return(n&128)===128&&s!==4&&(i-=1<<s*8),i>>0};pB.exports=Tr});var mB=_((Uee,yB)=>{var Qi=require("assert"),bf=FE().Buffer,Yi=Tf(),A$=xf(),If=A$.newInvalidAsn1Error,N$={size:1024,growthFactor:8};function B$(t,e){Qi.ok(t),Qi.equal(typeof t,"object"),Qi.ok(e),Qi.equal(typeof e,"object");var r=Object.getOwnPropertyNames(t);return r.forEach(function(n){if(!e[n]){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i)}}),e}c(B$,"merge");function lr(t){t=B$(N$,t||{}),this._buf=bf.alloc(t.size||1024),this._size=this._buf.length,this._offset=0,this._options=t,this._seq=[]}c(lr,"Writer");Object.defineProperty(lr.prototype,"buffer",{get:function(){if(this._seq.length)throw If(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}});lr.prototype.writeByte=function(t){if(typeof t!="number")throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=t};lr.prototype.writeInt=function(t,e){if(typeof t!="number")throw new TypeError("argument must be a Number");typeof e!="number"&&(e=Yi.Integer);for(var r=4;(!(t&4286578688)||(t&4286578688)===-8388608)&&r>1;)r--,t<<=8;if(r>4)throw If("BER ints cannot be > 0xffffffff");for(this._ensure(2+r),this._buf[this._offset++]=e,this._buf[this._offset++]=r;r-- >0;)this._buf[this._offset++]=(t&4278190080)>>>24,t<<=8};lr.prototype.writeNull=function(){this.writeByte(Yi.Null),this.writeByte(0)};lr.prototype.writeEnumeration=function(t,e){if(typeof t!="number")throw new TypeError("argument must be a Number");return typeof e!="number"&&(e=Yi.Enumeration),this.writeInt(t,e)};lr.prototype.writeBoolean=function(t,e){if(typeof t!="boolean")throw new TypeError("argument must be a Boolean");typeof e!="number"&&(e=Yi.Boolean),this._ensure(3),this._buf[this._offset++]=e,this._buf[this._offset++]=1,this._buf[this._offset++]=t?255:0};lr.prototype.writeString=function(t,e){if(typeof t!="string")throw new TypeError("argument must be a string (was: "+typeof t+")");typeof e!="number"&&(e=Yi.OctetString);var r=bf.byteLength(t);this.writeByte(e),this.writeLength(r),r&&(this._ensure(r),this._buf.write(t,this._offset),this._offset+=r)};lr.prototype.writeBuffer=function(t,e){if(typeof e!="number")throw new TypeError("tag must be a number");if(!bf.isBuffer(t))throw new TypeError("argument must be a buffer");this.writeByte(e),this.writeLength(t.length),this._ensure(t.length),t.copy(this._buf,this._offset,0,t.length),this._offset+=t.length};lr.prototype.writeStringArray=function(t){if(!t instanceof Array)throw new TypeError("argument must be an Array[String]");var e=this;t.forEach(function(r){e.writeString(r)})};lr.prototype.writeOID=function(t,e){if(typeof t!="string")throw new TypeError("argument must be a string");if(typeof e!="number"&&(e=Yi.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(t))throw new Error("argument is not a valid OID string");function r(o,a){a<128?o.push(a):a<16384?(o.push(a>>>7|128),o.push(a&127)):a<2097152?(o.push(a>>>14|128),o.push((a>>>7|128)&255),o.push(a&127)):a<268435456?(o.push(a>>>21|128),o.push((a>>>14|128)&255),o.push((a>>>7|128)&255),o.push(a&127)):(o.push((a>>>28|128)&255),o.push((a>>>21|128)&255),o.push((a>>>14|128)&255),o.push((a>>>7|128)&255),o.push(a&127))}c(r,"encodeOctet");var n=t.split("."),i=[];i.push(parseInt(n[0],10)*40+parseInt(n[1],10)),n.slice(2).forEach(function(o){r(i,parseInt(o,10))});var s=this;this._ensure(2+i.length),this.writeByte(e),this.writeLength(i.length),i.forEach(function(o){s.writeByte(o)})};lr.prototype.writeLength=function(t){if(typeof t!="number")throw new TypeError("argument must be a Number");if(this._ensure(4),t<=127)this._buf[this._offset++]=t;else if(t<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=t;else if(t<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=t>>8,this._buf[this._offset++]=t;else if(t<=16777215)this._buf[this._offset++]=131,this._buf[this._offset++]=t>>16,this._buf[this._offset++]=t>>8,this._buf[this._offset++]=t;else throw If("Length too long (> 4 bytes)")};lr.prototype.startSequence=function(t){typeof t!="number"&&(t=Yi.Sequence|Yi.Constructor),this.writeByte(t),this._seq.push(this._offset),this._ensure(3),this._offset+=3};lr.prototype.endSequence=function(){var t=this._seq.pop(),e=t+3,r=this._offset-e;if(r<=127)this._shift(e,r,-2),this._buf[t]=r;else if(r<=255)this._shift(e,r,-1),this._buf[t]=129,this._buf[t+1]=r;else if(r<=65535)this._buf[t]=130,this._buf[t+1]=r>>8,this._buf[t+2]=r;else if(r<=16777215)this._shift(e,r,1),this._buf[t]=131,this._buf[t+1]=r>>16,this._buf[t+2]=r>>8,this._buf[t+3]=r;else throw If("Sequence too long")};lr.prototype._shift=function(t,e,r){Qi.ok(t!==void 0),Qi.ok(e!==void 0),Qi.ok(r),this._buf.copy(this._buf,t+r,t,t+e),this._offset+=r};lr.prototype._ensure=function(t){if(Qi.ok(t),this._size-this._offset<t){var e=this._size*this._options.growthFactor;e-this._offset<t&&(e+=t);var r=bf.alloc(e);this._buf.copy(r,0,0,this._offset),this._buf=r,this._size=e}};yB.exports=lr});var vB=_((Mee,Bf)=>{var qE=xf(),UE=Tf(),R$=gB(),O$=mB();Bf.exports={Reader:R$,Writer:O$};for(Af in UE)UE.hasOwnProperty(Af)&&(Bf.exports[Af]=UE[Af]);var Af;for(Nf in qE)qE.hasOwnProperty(Nf)&&(Bf.exports[Nf]=qE[Nf]);var Nf});var Rf=_((Kee,EB)=>{var VE=vB();EB.exports={Ber:VE,BerReader:VE.Reader,BerWriter:VE.Writer}});var _B=_((Hee,Lf)=>{var Of=Rf().Ber,SB=wr()._,Df=wr(),CB="-----BEGIN RSA PRIVATE KEY-----",wB="-----END RSA PRIVATE KEY-----",xB="-----BEGIN RSA PUBLIC KEY-----",TB="-----END RSA PUBLIC KEY-----";Lf.exports={privateExport:function(t,e){e=e||{};var r=t.n.toBuffer(),n=t.d.toBuffer(),i=t.p.toBuffer(),s=t.q.toBuffer(),o=t.dmp1.toBuffer(),a=t.dmq1.toBuffer(),u=t.coeff.toBuffer(),l=r.length+n.length+i.length+s.length+o.length+a.length+u.length+512,f=new Of.Writer({size:l});return f.startSequence(),f.writeInt(0),f.writeBuffer(r,2),f.writeInt(t.e),f.writeBuffer(n,2),f.writeBuffer(i,2),f.writeBuffer(s,2),f.writeBuffer(o,2),f.writeBuffer(a,2),f.writeBuffer(u,2),f.endSequence(),e.type==="der"?f.buffer:CB+`
`+Df.linebrk(f.buffer.toString("base64"),64)+`
`+wB},privateImport:function(t,e,r){r=r||{};var n;if(r.type!=="der")if(Buffer.isBuffer(e)&&(e=e.toString("utf8")),SB.isString(e)){var i=Df.trimSurroundingText(e,CB,wB).replace(/\s+|\n\r|\n|\r$/gm,"");n=Buffer.from(i,"base64")}else throw Error("Unsupported key format");else if(Buffer.isBuffer(e))n=e;else throw Error("Unsupported key format");var s=new Of.Reader(n);s.readSequence(),s.readString(2,!0),t.setPrivate(s.readString(2,!0),s.readString(2,!0),s.readString(2,!0),s.readString(2,!0),s.readString(2,!0),s.readString(2,!0),s.readString(2,!0),s.readString(2,!0))},publicExport:function(t,e){e=e||{};var r=t.n.toBuffer(),n=r.length+512,i=new Of.Writer({size:n});return i.startSequence(),i.writeBuffer(r,2),i.writeInt(t.e),i.endSequence(),e.type==="der"?i.buffer:xB+`
`+Df.linebrk(i.buffer.toString("base64"),64)+`
`+TB},publicImport:function(t,e,r){r=r||{};var n;if(r.type!=="der"){if(Buffer.isBuffer(e)&&(e=e.toString("utf8")),SB.isString(e)){var i=Df.trimSurroundingText(e,xB,TB).replace(/\s+|\n\r|\n|\r$/gm,"");n=Buffer.from(i,"base64")}}else if(Buffer.isBuffer(e))n=e;else throw Error("Unsupported key format");var s=new Of.Reader(n);s.readSequence(),t.setPublic(s.readString(2,!0),s.readString(2,!0))},autoImport:function(t,e){return/^[\S\s]*-----BEGIN RSA PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PRIVATE KEY-----[\S\s]*$/g.test(e)?(Lf.exports.privateImport(t,e),!0):/^[\S\s]*-----BEGIN RSA PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PUBLIC KEY-----[\S\s]*$/g.test(e)?(Lf.exports.publicImport(t,e),!0):!1}}});var RB=_(($ee,Ff)=>{var Xn=Rf().Ber,bB=wr()._,Pf="1.2.840.113549.1.1.1",kf=wr(),IB="-----BEGIN PRIVATE KEY-----",AB="-----END PRIVATE KEY-----",NB="-----BEGIN PUBLIC KEY-----",BB="-----END PUBLIC KEY-----";Ff.exports={privateExport:function(t,e){e=e||{};var r=t.n.toBuffer(),n=t.d.toBuffer(),i=t.p.toBuffer(),s=t.q.toBuffer(),o=t.dmp1.toBuffer(),a=t.dmq1.toBuffer(),u=t.coeff.toBuffer(),l=r.length+n.length+i.length+s.length+o.length+a.length+u.length+512,f=new Xn.Writer({size:l});f.startSequence(),f.writeInt(0),f.writeBuffer(r,2),f.writeInt(t.e),f.writeBuffer(n,2),f.writeBuffer(i,2),f.writeBuffer(s,2),f.writeBuffer(o,2),f.writeBuffer(a,2),f.writeBuffer(u,2),f.endSequence();var h=new Xn.Writer({size:l});return h.startSequence(),h.writeInt(0),h.startSequence(),h.writeOID(Pf),h.writeNull(),h.endSequence(),h.writeBuffer(f.buffer,4),h.endSequence(),e.type==="der"?h.buffer:IB+`
`+kf.linebrk(h.buffer.toString("base64"),64)+`
`+AB},privateImport:function(t,e,r){r=r||{};var n;if(r.type!=="der")if(Buffer.isBuffer(e)&&(e=e.toString("utf8")),bB.isString(e)){var i=kf.trimSurroundingText(e,IB,AB).replace("-----END PRIVATE KEY-----","").replace(/\s+|\n\r|\n|\r$/gm,"");n=Buffer.from(i,"base64")}else throw Error("Unsupported key format");else if(Buffer.isBuffer(e))n=e;else throw Error("Unsupported key format");var s=new Xn.Reader(n);s.readSequence(),s.readInt(0);var o=new Xn.Reader(s.readString(48,!0));if(o.readOID(6,!0)!==Pf)throw Error("Invalid Public key format");var a=new Xn.Reader(s.readString(4,!0));a.readSequence(),a.readString(2,!0),t.setPrivate(a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0))},publicExport:function(t,e){e=e||{};var r=t.n.toBuffer(),n=r.length+512,i=new Xn.Writer({size:n});i.writeByte(0),i.startSequence(),i.writeBuffer(r,2),i.writeInt(t.e),i.endSequence();var s=new Xn.Writer({size:n});return s.startSequence(),s.startSequence(),s.writeOID(Pf),s.writeNull(),s.endSequence(),s.writeBuffer(i.buffer,3),s.endSequence(),e.type==="der"?s.buffer:NB+`
`+kf.linebrk(s.buffer.toString("base64"),64)+`
`+BB},publicImport:function(t,e,r){r=r||{};var n;if(r.type!=="der"){if(Buffer.isBuffer(e)&&(e=e.toString("utf8")),bB.isString(e)){var i=kf.trimSurroundingText(e,NB,BB).replace(/\s+|\n\r|\n|\r$/gm,"");n=Buffer.from(i,"base64")}}else if(Buffer.isBuffer(e))n=e;else throw Error("Unsupported key format");var s=new Xn.Reader(n);s.readSequence();var o=new Xn.Reader(s.readString(48,!0));if(o.readOID(6,!0)!==Pf)throw Error("Invalid Public key format");var a=new Xn.Reader(s.readString(3,!0));a.readByte(),a.readSequence(),t.setPublic(a.readString(2,!0),a.readString(2,!0))},autoImport:function(t,e){return/^[\S\s]*-----BEGIN PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PRIVATE KEY-----[\S\s]*$/g.test(e)?(Ff.exports.privateImport(t,e),!0):/^[\S\s]*-----BEGIN PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PUBLIC KEY-----[\S\s]*$/g.test(e)?(Ff.exports.publicImport(t,e),!0):!1}}});var OB=_((zee,qf)=>{var Gee=wr()._,jee=wr();qf.exports={privateExport:function(t,e){return{n:t.n.toBuffer(),e:t.e,d:t.d.toBuffer(),p:t.p.toBuffer(),q:t.q.toBuffer(),dmp1:t.dmp1.toBuffer(),dmq1:t.dmq1.toBuffer(),coeff:t.coeff.toBuffer()}},privateImport:function(t,e,r){if(e.n&&e.e&&e.d&&e.p&&e.q&&e.dmp1&&e.dmq1&&e.coeff)t.setPrivate(e.n,e.e,e.d,e.p,e.q,e.dmp1,e.dmq1,e.coeff);else throw Error("Invalid key data")},publicExport:function(t,e){return{n:t.n.toBuffer(),e:t.e}},publicImport:function(t,e,r){if(e.n&&e.e)t.setPublic(e.n,e.e);else throw Error("Invalid key data")},autoImport:function(t,e){return e.n&&e.e?e.d&&e.p&&e.q&&e.dmp1&&e.dmq1&&e.coeff?(qf.exports.privateImport(t,e),!0):(qf.exports.publicImport(t,e),!0):!1}}});var FB=_((Wee,Uf)=>{var DB=wr()._,LB=wr(),Lc=$s(),PB="-----BEGIN OPENSSH PRIVATE KEY-----",kB="-----END OPENSSH PRIVATE KEY-----";Uf.exports={privateExport:function(t,e){let r=t.n.toBuffer(),n=Buffer.alloc(4);for(n.writeUInt32BE(t.e,0);n[0]===0;)n=n.slice(1);let i=t.d.toBuffer(),s=t.coeff.toBuffer(),o=t.p.toBuffer(),a=t.q.toBuffer(),u;typeof t.sshcomment<"u"?u=Buffer.from(t.sshcomment):u=Buffer.from([]);let l=15+n.byteLength+4+r.byteLength,f=23+r.byteLength+4+n.byteLength+4+i.byteLength+4+s.byteLength+4+o.byteLength+4+a.byteLength+4+u.byteLength,h=43+l+4+f,p=Math.ceil(f/8)*8-f;h+=p;let g=Buffer.alloc(h),d={buf:g,off:0};g.write("openssh-key-v1","utf8"),g.writeUInt8(0,14),d.off+=15,or(d,Buffer.from("none")),or(d,Buffer.from("none")),or(d,Buffer.from("")),d.off=d.buf.writeUInt32BE(1,d.off),d.off=d.buf.writeUInt32BE(l,d.off),or(d,Buffer.from("ssh-rsa")),or(d,n),or(d,r),d.off=d.buf.writeUInt32BE(h-47-l,d.off),d.off+=8,or(d,Buffer.from("ssh-rsa")),or(d,r),or(d,n),or(d,i),or(d,s),or(d,o),or(d,a),or(d,u);let y=1;for(;d.off<h;)d.off=d.buf.writeUInt8(y++,d.off);return e.type==="der"?d.buf:PB+`
`+LB.linebrk(g.toString("base64"),70)+`
`+kB+`
`},privateImport:function(t,e,r){r=r||{};var n;if(r.type!=="der")if(Buffer.isBuffer(e)&&(e=e.toString("utf8")),DB.isString(e)){var i=LB.trimSurroundingText(e,PB,kB).replace(/\s+|\n\r|\n|\r$/gm,"");n=Buffer.from(i,"base64")}else throw Error("Unsupported key format");else if(Buffer.isBuffer(e))n=e;else throw Error("Unsupported key format");let s={buf:n,off:0};if(n.slice(0,14).toString("ascii")!=="openssh-key-v1")throw"Invalid file format.";if(s.off+=15,sr(s).toString("ascii")!=="none"||sr(s).toString("ascii")!=="none"||sr(s).toString("ascii")!==""||(s.off+=4,s.off+=4,sr(s).toString("ascii")!=="ssh-rsa")||(sr(s),sr(s),s.off+=12,sr(s).toString("ascii")!=="ssh-rsa"))throw Error("Unsupported key type");let o=sr(s),a=sr(s),u=sr(s),l=sr(s),f=sr(s),h=sr(s),p=new Lc(u),g=new Lc(h),d=new Lc(f),y=p.mod(d.subtract(Lc.ONE)),v=p.mod(g.subtract(Lc.ONE));t.setPrivate(o,a,u,f,h,y.toBuffer(),v.toBuffer(),l),t.sshcomment=sr(s).toString("ascii")},publicExport:function(t,e){let r=Buffer.alloc(4);for(r.writeUInt32BE(t.e,0);r[0]===0;)r=r.slice(1);let n=t.n.toBuffer(),i=Buffer.alloc(r.byteLength+4+n.byteLength+4+7+4),s={buf:i,off:0};or(s,Buffer.from("ssh-rsa")),or(s,r),or(s,n);let o=t.sshcomment||"";return e.type==="der"?s.buf:"ssh-rsa "+i.toString("base64")+" "+o+`
`},publicImport:function(t,e,r){r=r||{};var n;if(r.type!=="der")if(Buffer.isBuffer(e)&&(e=e.toString("utf8")),DB.isString(e)){if(e.substring(0,8)!=="ssh-rsa ")throw Error("Unsupported key format");let u=e.indexOf(" ",8);u===-1?u=e.length:t.sshcomment=e.substring(u+1).replace(/\s+|\n\r|\n|\r$/gm,"");let l=e.substring(8,u).replace(/\s+|\n\r|\n|\r$/gm,"");n=Buffer.from(l,"base64")}else throw Error("Unsupported key format");else if(Buffer.isBuffer(e))n=e;else throw Error("Unsupported key format");let i={buf:n,off:0},s=sr(i).toString("ascii");if(s!=="ssh-rsa")throw Error("Invalid key type: "+s);let o=sr(i),a=sr(i);t.setPublic(a,o)},autoImport:function(t,e){return/^[\S\s]*-----BEGIN OPENSSH PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END OPENSSH PRIVATE KEY-----[\S\s]*$/g.test(e)?(Uf.exports.privateImport(t,e),!0):/^[\S\s]*ssh-rsa \s*(?=(([A-Za-z0-9+/=]+\s*)+))\1[\S\s]*$/g.test(e)?(Uf.exports.publicImport(t,e),!0):!1}};function sr(t){let e=t.buf.readInt32BE(t.off);t.off+=4;let r=t.buf.slice(t.off,t.off+e);return t.off+=e,r}c(sr,"readOpenSSHKeyString");function or(t,e){t.buf.writeInt32BE(e.byteLength,t.off),t.off+=4,t.off+=e.copy(t.buf,t.off)}c(or,"writeOpenSSHKeyString")});var UB=_((Zee,Ot)=>{var Yee=wr()._;function qB(t){t=t.split("-");for(var e="private",r={type:"default"},n=1;n<t.length;n++)if(t[n])switch(t[n]){case"public":e=t[n];break;case"private":e=t[n];break;case"pem":r.type=t[n];break;case"der":r.type=t[n];break}return{scheme:t[0],keyType:e,keyOpt:r}}c(qB,"formatParse");Ot.exports={pkcs1:_B(),pkcs8:RB(),components:OB(),openssh:FB(),isPrivateExport:function(t){return Ot.exports[t]&&typeof Ot.exports[t].privateExport=="function"},isPrivateImport:function(t){return Ot.exports[t]&&typeof Ot.exports[t].privateImport=="function"},isPublicExport:function(t){return Ot.exports[t]&&typeof Ot.exports[t].publicExport=="function"},isPublicImport:function(t){return Ot.exports[t]&&typeof Ot.exports[t].publicImport=="function"},detectAndImport:function(t,e,r){if(r===void 0){for(var n in Ot.exports)if(typeof Ot.exports[n].autoImport=="function"&&Ot.exports[n].autoImport(t,e))return!0}else if(r){var i=qB(r);if(Ot.exports[i.scheme])i.keyType==="private"?Ot.exports[i.scheme].privateImport(t,e,i.keyOpt):Ot.exports[i.scheme].publicImport(t,e,i.keyOpt);else throw Error("Unsupported key format")}return!1},detectAndExport:function(t,e){if(e){var r=qB(e);if(Ot.exports[r.scheme])if(r.keyType==="private"){if(!t.isPrivate())throw Error("This is not private key");return Ot.exports[r.scheme].privateExport(t,r.keyOpt)}else{if(!t.isPublic())throw Error("This is not public key");return Ot.exports[r.scheme].publicExport(t,r.keyOpt)}else throw Error("Unsupported key format")}}}});var $B=_((tte,HB)=>{var VB=require("constants"),D$=uB(),Jee=require("crypto"),ete=Rf().Ber,$r=wr()._,L$=wr(),MB=Gs(),KB=UB();typeof VB.RSA_NO_PADDING>"u"&&(VB.RSA_NO_PADDING=3);HB.exports=function(){var t={node10:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],node:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],iojs:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],browser:["md5","ripemd160","sha1","sha256","sha512"]},e="pkcs1_oaep",r="pkcs1",n="private",i={private:"pkcs1-private-pem","private-der":"pkcs1-private-der",public:"pkcs8-public-pem","public-der":"pkcs8-public-der"};function s(o,a,u){if(!(this instanceof s))return new s(o,a,u);$r.isObject(a)&&(u=a,a=void 0),this.$options={signingScheme:r,signingSchemeOptions:{hash:"sha256",saltLength:null},encryptionScheme:e,encryptionSchemeOptions:{hash:"sha1",label:null},environment:L$.detectEnvironment(),rsaUtils:this},this.keyPair=new D$.Key,this.$cache={},Buffer.isBuffer(o)||$r.isString(o)?this.importKey(o,a):$r.isObject(o)&&this.generateKeyPair(o.b,o.e),this.setOptions(u)}return c(s,"NodeRSA"),s.prototype.setOptions=function(o){if(o=o||{},o.environment&&(this.$options.environment=o.environment),o.signingScheme){if($r.isString(o.signingScheme)){var a=o.signingScheme.toLowerCase().split("-");a.length==1?t.node.indexOf(a[0])>-1?(this.$options.signingSchemeOptions={hash:a[0]},this.$options.signingScheme=r):(this.$options.signingScheme=a[0],this.$options.signingSchemeOptions={hash:null}):(this.$options.signingSchemeOptions={hash:a[1]},this.$options.signingScheme=a[0])}else $r.isObject(o.signingScheme)&&(this.$options.signingScheme=o.signingScheme.scheme||r,this.$options.signingSchemeOptions=$r.omit(o.signingScheme,"scheme"));if(!MB.isSignature(this.$options.signingScheme))throw Error("Unsupported signing scheme");if(this.$options.signingSchemeOptions.hash&&t[this.$options.environment].indexOf(this.$options.signingSchemeOptions.hash)===-1)throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}if(o.encryptionScheme){if($r.isString(o.encryptionScheme)?(this.$options.encryptionScheme=o.encryptionScheme.toLowerCase(),this.$options.encryptionSchemeOptions={}):$r.isObject(o.encryptionScheme)&&(this.$options.encryptionScheme=o.encryptionScheme.scheme||e,this.$options.encryptionSchemeOptions=$r.omit(o.encryptionScheme,"scheme")),!MB.isEncryption(this.$options.encryptionScheme))throw Error("Unsupported encryption scheme");if(this.$options.encryptionSchemeOptions.hash&&t[this.$options.environment].indexOf(this.$options.encryptionSchemeOptions.hash)===-1)throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}this.keyPair.setOptions(this.$options)},s.prototype.generateKeyPair=function(o,a){if(o=o||2048,a=a||65537,o%8!==0)throw Error("Key size must be a multiple of 8.");return this.keyPair.generate(o,a.toString(16)),this.$cache={},this},s.prototype.importKey=function(o,a){if(!o)throw Error("Empty key given");if(a&&(a=i[a]||a),!KB.detectAndImport(this.keyPair,o,a)&&a===void 0)throw Error("Key format must be specified");return this.$cache={},this},s.prototype.exportKey=function(o){return o=o||n,o=i[o]||o,this.$cache[o]||(this.$cache[o]=KB.detectAndExport(this.keyPair,o)),this.$cache[o]},s.prototype.isPrivate=function(){return this.keyPair.isPrivate()},s.prototype.isPublic=function(o){return this.keyPair.isPublic(o)},s.prototype.isEmpty=function(o){return!(this.keyPair.n||this.keyPair.e||this.keyPair.d)},s.prototype.encrypt=function(o,a,u){return this.$$encryptKey(!1,o,a,u)},s.prototype.decrypt=function(o,a){return this.$$decryptKey(!1,o,a)},s.prototype.encryptPrivate=function(o,a,u){return this.$$encryptKey(!0,o,a,u)},s.prototype.decryptPublic=function(o,a){return this.$$decryptKey(!0,o,a)},s.prototype.$$encryptKey=function(o,a,u,l){try{var f=this.keyPair.encrypt(this.$getDataForEncrypt(a,l),o);return u=="buffer"||!u?f:f.toString(u)}catch(h){throw Error("Error during encryption. Original error: "+h)}},s.prototype.$$decryptKey=function(o,a,u){try{a=$r.isString(a)?Buffer.from(a,"base64"):a;var l=this.keyPair.decrypt(a,o);if(l===null)throw Error("Key decrypt method returns null.");return this.$getDecryptedData(l,u)}catch(f){throw Error("Error during decryption (probably incorrect key). Original error: "+f)}},s.prototype.sign=function(o,a,u){if(!this.isPrivate())throw Error("This is not private key");var l=this.keyPair.sign(this.$getDataForEncrypt(o,u));return a&&a!="buffer"&&(l=l.toString(a)),l},s.prototype.verify=function(o,a,u,l){if(!this.isPublic())throw Error("This is not public key");return l=!l||l=="buffer"?null:l,this.keyPair.verify(this.$getDataForEncrypt(o,u),a,l)},s.prototype.getKeySize=function(){return this.keyPair.keySize},s.prototype.getMaxMessageSize=function(){return this.keyPair.maxMessageLength},s.prototype.$getDataForEncrypt=function(o,a){if($r.isString(o)||$r.isNumber(o))return Buffer.from(""+o,a||"utf8");if(Buffer.isBuffer(o))return o;if($r.isObject(o))return Buffer.from(JSON.stringify(o));throw Error("Unexpected data type")},s.prototype.$getDecryptedData=function(o,a){return a=a||"buffer",a=="buffer"?o:a=="json"?JSON.parse(o.toString()):o.toString(a)},s}()});var zB=_((nte,jB)=>{var GB=require("crypto"),P$=bE(),k$=Bc(),Zi=class Zi{static parseKey(e){if(e.tag!==k$.tag_Sequence)throw new Error("corrupt private key");let r=e.getBigInteger();if(r!==Zi.version)throw new Error("version mismatch: (supported "+this.version+", parsed: "+r);let n=e.getDerValue(),i=e.getDerValue(),s=new P$(n.data);if(Zi.supportedTypes.dsa===s.toString()||Zi.supportedTypes.ec===s.toString())return Zi.format(e.buffer);try{let o=i.getOctetString();return Zi.export(o)}catch(o){let a=new Error("Something went wrong with algorithm "+s.toString()+". For more details see 'error.context'");throw a.context=o,a}}static export(e){if(typeof GB.createPrivateKey=="function")return GB.createPrivateKey({key:e,format:"der",type:"pkcs1"}).export({format:"pem",type:"pkcs8"});{let r=$B();return new r(e,"pkcs1-der").exportKey("pkcs8-pem")+`
`}}static format(e){return`-----BEGIN PRIVATE KEY-----
`+e.toString("base64").match(/.{1,64}/g).join(`
`)+`
-----END PRIVATE KEY-----
`}};c(Zi,"PKCS8Key");var Pc=Zi;Pc.supportedTypes={rsa:"1.2.840.113549.1.1.1","rsa-pss":"1.2.840.113549.1.1.10",dsa:"1.2.840.10040.4.1",ec:"1.2.840.10045.2.1",x25519:"1.3.101.110",x448:"1.3.101.111",ed25519:"1.3.101.112",ed448:"1.3.101.113",dh:"1.2.840.113549.1.3.1"};Pc.version=0;jB.exports=Pc});var YB=_((ste,QB)=>{var WB=require("crypto"),F$=zB(),q$=Bc(),U$=Rs(),kc=Io(),_r=class _r{constructor(e){this.messageDigest=WB.createHash(_r.DIGEST_ALG),this.passwdBytes=Buffer.alloc(e.length*2);for(let r=0,n=0;r<e.length;r++)this.passwdBytes[n++]=e[r].charCodeAt()>>8,this.passwdBytes[n++]=e[r].charCodeAt()}resetDigest(){this.messageDigest=WB.createHash(_r.DIGEST_ALG)}recover(e){let r,n,i;if(e.getAlgorithm()!==_r.KEY_PROTECTOR_OID)throw new Error("Unsupported key protection alghorithm");let o=e.getEncryptedData(),a=kc(o,0,_r.SALT_LEN);i=o.length-_r.SALT_LEN-_r.DIGEST_LEN,n=Math.floor(i/_r.DIGEST_LEN),i%_r.DIGEST_LEN!==0&&n++;let u=kc(o,_r.SALT_LEN,i+_r.SALT_LEN),l=Buffer.alloc(u.length);for(let h=0,p=0,g=a;h<n;h++,p+=_r.DIGEST_LEN)this.messageDigest.update(this.passwdBytes),this.messageDigest.update(g),g=this.messageDigest.digest(),this.resetDigest(),h<n-1?l=Buffer.concat([kc(l,0,p),g]):l=Buffer.concat([kc(l,0,p),kc(g,0,u.length-p)]);let f=Buffer.alloc(u.length);for(let h=0;h<f.length;h++)f[h]=u[h]^l[h];this.messageDigest.update(this.passwdBytes),this.messageDigest.update(f),r=this.messageDigest.digest(),this.resetDigest();for(let h=0;h<r.length;h++)if(r[h]!=o[_r.SALT_LEN+i+h])throw new Error("Cannot recover key");return F$.parseKey(new q$(new U$(f)))}};c(_r,"KeyProtector");var js=_r;js.SALT_LEN=20;js.DIGEST_ALG="sha1";js.DIGEST_LEN=20;js.KEY_PROTECTOR_OID="1.3.6.1.4.1.42.2.17.1.1";QB.exports=js});var XB=_((ate,ZB)=>{var KE=class KE{generate(e){return`-----BEGIN CERTIFICATE-----
`+e.toString("base64").match(/.{1,64}/g).join(`
`)+`
-----END CERTIFICATE-----
`}};c(KE,"X509Cert");var ME=KE;ZB.exports=ME});var tR=_((ute,eR)=>{var JB=XB(),$E=class $E{constructor(){this.algorithms={X509:JB,"X.509":JB}}get(e){if(!this.algorithms[e])throw new Error("The certificate type "+e+" is not supported");return new this.algorithms[e]}};c($E,"CertificateRegistry");var HE=$E;eR.exports=HE});var oR=_((fte,sR)=>{var V$=lA(),GE=RN(),M$=gv(),K$=vv(),H$=FN(),$$=YB(),G$=tR(),rR=c(t=>new G$().get(t.certType).generate(t.value),"serializeCert"),nR=c((t,e="")=>{let r=new H$(t);return new $$(e).recover(r)},"decrypt"),iR=c((t,e)=>new V$(t,e).parse(),"parseJks"),j$=c((t,e)=>new GE(t,e).parse(),"parsePkcs12"),z$=c((t,e)=>{let r=new GE(t,e),n=r.parse();return r.toPem(n)},"pkcs12ToPem"),W$=c((t,e,r)=>(r===void 0&&(r=e),iR(t,e).reduce((i,s)=>{if(s instanceof K$)return Object.assign({},i,{[s.alias]:{ca:rR(s.cert)}});if(s instanceof M$)return Object.assign({},i,{[s.alias]:{cert:s.chain.map(rR).join(`
`),key:nR(s.protectedPrivateKey,r)}})},{})),"jksToPem"),Q$=c(function(t,e,r){return GE.probe(t)?z$(t,e,r):W$(t,e,r)},"toPem");sR.exports={toPem:Q$,parseJks:iR,decrypt:nR,parsePkcs12:j$}});var uR=_((dte,cR)=>{"use strict";var Vf=Dl(),Y$=oI(),Fc=require("fs"),{createTableOptionsFromMeta:Z$}=hI(),{getEntityLevelConfig:X$}=Uc(),jE=gI(),aR=zI(),J$=QI(),Dt={client:null,isSshTunnel:null},eG=["solr_query"];cR.exports=t=>{let e=c(b=>new Promise((R,D)=>b.require("java-ssl",(V,M)=>{V?D(V):R(M)})),"requireKeyStore"),r=c(b=>{let R=c(D=>D?Fc.readFileSync(D):"","readFile");try{let D=R(b.sslCaFile),V=R(b.sslCertFile),M=R(b.sslKeyFile);return Promise.resolve({ca:D,cert:V,key:M})}catch(D){return Promise.reject(D)}},"getCertificatesFromFiles"),n=c((b,R,D)=>e(R).then(V=>{try{let M=V(b.keystore,b.keystorepass),Y=(M.getCert(b.alias)||"").replace(/\s*-----END CERTIFICATE-----$/,`
-----END CERTIFICATE-----`),he=M.getPrivateKey(b.alias),ce=Y;return D.log("info",{message:"[info] certificates successfully retrieved from keystore",certLength:Y.length,keyLength:he.length,pemCertValidity:Y.startsWith(`-----BEGIN CERTIFICATE-----
MII`),pemKeyValidity:he.startsWith(`-----BEGIN PRIVATE KEY-----
MII`),countOfCerts:(Y.match(/-----BEGIN CERTIFICATE-----/gi)||[]).length},"Keystore Info"),b.truststore&&(ce=(V(b.truststore,b.truststorePass||"").getCert(b.truststoreAlias||b.alias)||"").replace(/\s*-----END CERTIFICATE-----$/,`
-----END CERTIFICATE-----`),D.log("info",{message:"[info] certificates successfully retrieved from truststore",certLength:ce.length,pemCertValidity:ce.startsWith(`-----BEGIN CERTIFICATE-----
MII`),countOfCerts:(ce.match(/-----BEGIN CERTIFICATE-----/gi)||[]).length},"Keystore Info")),{cert:Y,key:he,ca:ce,...i(b,D)}}catch(M){return M.message.includes("java.lang.NullPointerException")?Promise.reject({message:"Please, check the alias name of the provided JKS certificates. Error message: "+M.message,error:M.message,stack:M.stack}):Promise.reject(M)}}).catch(V=>{D.log("error",{message:V.message,stack:V.stack},"Initialization java-ssl failed");let M=i(b,D);return Object.keys(M).length===0?Promise.reject(V):M}),"getCertificatesFromKeystore"),i=c((b,R)=>{try{let D=oR(),V;Fc.existsSync(b.keystore)?(V=D.toPem(Fc.readFileSync(b.keystore),b.keystorepass),Object.keys(V).forEach(Y=>{R.log("info",{type:"keystore",certLength:t.get(V,`[${Y}].cert.length`),keyLength:t.get(V,`[${Y}].key.length`),countOfCerts:(t.get(V,`[${Y}].cert`,"").match(/-----BEGIN CERTIFICATE-----/gi)||[]).length,alias:Y},"jks analyze")})):R.log("info",`[info] keystore file not found ${b.keystore}`,"jks analyze");let M;return Fc.existsSync(b.truststore)?(M=D.toPem(Fc.readFileSync(b.truststore),b.truststorePass),Object.keys(M).forEach(Y=>{R.log("info",{type:"truststore",certLength:t.get(M,`[${Y}].ca.length`),countOfCerts:(t.get(M,`[${Y}].ca`,"").match(/-----BEGIN CERTIFICATE-----/gi)||[]).length,alias:Y},"jks analyze")})):R.log("info",`[info] truststore file not found ${b.truststore}`,"jks analyze"),{cert:t.get(V,`[${b.alias}].cert`),key:t.get(V,`[${b.alias}].key`),ca:t.get(M,`[${b.truststoreAlias||b.alias}].ca`)||t.get(V,`[${b.alias}].cert`)}}catch(D){return R.log("info",`[info] issue with jks-js. Message: ${D.message}`,"jks analyze"),{}}},"analyzeJks"),s=c(b=>b&&b!=="false","isSsl"),o=c((b,R,D)=>{let V=c((he,ce,ge)=>ce?Object.assign({},ge,{[he]:ce}):ge,"add");if(!s(b.ssl))return Promise.resolve({});let M=t.get(b,"hosts[0].host",""),Y;return b.ssl==="jks"?Y=n(b,R,D):Y=r(b),Y.then(he=>({sslOptions:t.flow([V.bind(null,"ca",he.ca),V.bind(null,"cert",he.cert),V.bind(null,"key",he.key),V.bind(null,"host",M)])({rejectUnauthorized:!b.disableStrictSsl,host:M})}))},"getSslOptions"),a=c((b,R)=>b.localDataCenter?{localDataCenter:b.localDataCenter,policies:{retry:new jE(R)}}:{policies:{loadBalancing:new Vf.policies.loadBalancing.RoundRobinPolicy,retry:new jE(R)}},"getPolicy"),u=c((b,R)=>{let V=Number(b),M=Number(R),Y=isNaN(V)?M:V;return isNaN(Y)||Y<=0?6e4:Y},"validateRequestTimeout"),l=c((b,R,D)=>{if(!Array.isArray(R.hosts))throw new Error("Hosts were not defined");let V=R.authType==="tokenBased"?{username:"token",password:R.astraToken}:{username:R.user,password:R.password},M=new Vf.auth.PlainTextAuthProvider(V.username,V.password),Y=R.hosts.map(ce=>`${ce.host}:${ce.port}`),he=u(R.requestTimeout,R.queryRequestTimeout);return o(R,b,D).then(ce=>new Vf.Client(Object.assign({contactPoints:Y,authProvider:M,socketOptions:{readTimeout:he}},a(R,D),ce)))},"getDistributedClient"),f=c(b=>{let R=u(b.requestTimeout,b.queryRequestTimeout),D=b.authType==="tokenBased"?{username:"token",password:b.astraToken}:{username:b.user,password:b.password},V=new Vf.Client(Object.assign({cloud:{secureConnectBundle:b.secureConnectBundle},credentials:D,socketOptions:{readTimeout:R}}));return Promise.resolve(V)},"getCloudClient"),h=c((b,R,D)=>R.clusterType==="apolloCloud"?f(R):l(b,R,D),"getClient"),p=c((b,R)=>async D=>{if(Dt.client)return Dt.client.connect();if(D.ssh){let V=b.require("@hackolade/ssh-service"),M=D.hosts[0],{options:Y}=await V.openTunnel({sshAuthMethod:D.ssh_method==="privateKey"?"IDENTITY_FILE":"USER_PASSWORD",sshTunnelHostname:D.ssh_host,sshTunnelPort:D.ssh_port,sshTunnelUsername:D.ssh_user,sshTunnelPassword:D.ssh_password,sshTunnelIdentityFile:D.ssh_key_file,sshTunnelPassphrase:D.ssh_key_passphrase,host:M.host,port:M.port});Dt.isSshTunnel=!0,D={...D,hosts:[Y]}}return Dt.client=await h(b,D,R),Dt.client.on("log",(V,M,Y,he)=>{if(R){let ce="["+V+"] "+M+": "+Y+". "+he;R.log("info",{message:ce},"Cassandra Info")}}),Dt.client.connect()},"connect"),g=c(async b=>{Dt.client&&(Dt.client.shutdown(),Dt.client=null),Dt.isSshTunnel&&(await b.require("@hackolade/ssh-service").closeConsumer(),Dt.isSshTunnel=!1)},"close"),d=c(b=>Dt.client.metadata.keyspaces[b],"getKeyspaceMetaData"),y=c(b=>{let R=d(b),D=t.get(R,"strategy","").split(".").slice(-1).pop(),V={code:b,durableWrites:!!R.durableWrites,replStrategy:D};return D==="SimpleStrategy"?V.replFactor=Number(R.strategyOptions.replication_factor):D==="NetworkTopologyStrategy"&&(V.dataCenters=Object.keys(R.strategyOptions).map(M=>({dataCenterName:M,replFactorValue:Number(R.strategyOptions[M])}))),V},"getKeyspaceInfo"),v=c(()=>Object.keys(Dt.client.metadata.keyspaces),"getKeyspacesNames"),m=c(()=>{let b=t.get(Dt,"client.hosts._items");if(!b)return!1;let R=b[Object.keys(b)[0]];if(!R)return!1;let D=R.getCassandraVersion();return D.length?t.get(D,"[0]")<3:!1},"isOldVersion"),w=c(b=>{let V=m()?`SELECT columnfamily_name FROM system.schema_columnfamilies WHERE keyspace_name ='${b}'`:`SELECT table_name FROM system_schema.tables WHERE keyspace_name ='${b}'`;return A(V)},"getTablesNames"),x=c(b=>{let R=`SELECT view_name FROM system_schema.views WHERE keyspace_name ='${b}'`;return A(R).then(D=>D.rows.map(V=>V.view_name),()=>[])},"getViewsNames"),A=c(b=>Dt.client.execute(b),"execute"),O=c((b,R)=>Dt.client.metadata.getTable(b,R),"getTableMetadata"),P=c((b,R,D,V)=>Promise.all(D.map(M=>Dt.client.metadata.getMaterializedView(R,M).then(Y=>j(b,R,M,V).then(he=>({documentTemplate:he,view:Y})),()=>({documentTemplate:{},view:{}})))),"getViews"),j=c((b,R,D,V)=>q(R,D,b,V).then(t1,()=>({})),"getViewDocumentTemplate"),Q=c(async(b,R)=>{try{let D=await A(`select resource_name, resource_value from solr_admin.solr_resources where resource_name IN ('schema.xml', 'solrconfig.xml') AND core_name = '${b}.${R}';`);if(!D.rows.length)return{};let V={"schema.xml":"schema","solrconfig.xml":"config"};return D.rows.reduce((M,Y)=>({...M,[V[Y.resource_name]]:Y.resource_value.toString()}),{})}catch{return{}}},"describeSearchIndexes"),se=c(b=>{let R=t.partition(b,EO);return{views:R[0].map(D=>D.slice(0,-4)),tables:R[1]}},"splitEntityNames"),re=c((b,R)=>{let D=`SELECT * FROM system_schema.columns WHERE keyspace_name='${b}' AND table_name='${R}';`;return A(D)},"getColumnInfo"),k=c((b,R,D)=>({dbName:b,dbCollections:R,views:D}),"prepareConnectionDataItem"),Ae=c((b,R,D={})=>{let V={};return b.filter(M=>!t.includes(eG,M.name)).forEach(M=>{let Y=Y$(t).getColumnType(M,R,D?D[M.name]:void 0);V[M.name]=Y,V[M.name].code=M.name,V[M.name].static=M.isStatic,V[M.name].frozen=M.type.options.frozen}),{properties:V}},"getTableSchema"),q=c((b,R,D,V)=>T(b,R,D).then(M=>new Promise((Y,he)=>{let ce=[];if(V.log("info",{table:`${b}.${R}`,limit:M},"Scan records"),!M)return Y(ce);let ge={prepare:!0,autoPage:!0,retry:new jE(V)},Je=`SELECT * FROM "${b}"."${R}" LIMIT ${M}`;Dt.client.eachRow(Je,[],ge,function(Fe,Ut){ce.push(Ut)},(Fe,Ut)=>Fe?he(Fe):Y(ce))})),"scanRecords"),T=c((b,R,D)=>{if(D.active==="absolute")return Promise.resolve(Number(D.absolute.value));let V=SO(D),M=`SELECT COUNT(*) FROM "${b}"."${R}" LIMIT ${V}`;return A(M).then(Y=>{let he=t.get(Y,"rows[0].count.low",D.maxValue);return gO(he,D)})},"getSizeOfRows"),G=c((b,R,D)=>{let V=je(b.partitionKeys),M=Se(b);return{...Oe(b.indexes,D),code:R,compositePartitionKey:V,compositeClusteringKey:M,comments:b.comment,tableOptions:X(b)}},"getEntityLevelData"),ae=c(b=>b.structure.find(D=>D.propertyName==="Options").structure,"getOptionsFromTab"),X=c(b=>{let[R]=X$(),D=ae(R);return Z$(b,D)},"getTableOptions"),Re=c(b=>{switch(b){case"DESC":return"descending";case"ASC":default:return"ascending"}},"getKeyOrder"),je=c(b=>(b||[]).map(R=>R.name),"handlePartitionKeys"),Se=c(b=>(b.clusteringKeys||[]).map((R,D)=>{let V=b.clusteringOrder?b.clusteringOrder[D]:"";return{name:R.name,type:Re(V)}}),"handleClusteringKeys"),Oe=c((b,R)=>({SecIndxs:Ce(b),...Ve(R)}),"handleIndexes"),Ce=c(b=>b.filter(R=>!(R.options&&R.options.class_name==="com.datastax.bdp.search.solr.Cql3SolrSecondaryIndex")).map(R=>{let D=R.isCustomKind()?"custom":"secondary",V={};return R.options&&D==="custom"&&(V.case_sensitive=R.options.case_sensitive==="true",V.normalize=R.options.normalize==="true",V.ascii=R.options.ascii==="true",V.similarity_function=R.options.similarity_function||""),{name:R.name,SecIndxKey:[lt(R.target)],customOptions:V,indexType:D}}),"getGeneralIndexes"),Ee=c(b=>{let R={},D=t.get(b,"updateHandler.autoSoftCommit.maxTime"),V=t.get(b,"requestHandler",[]).find(he=>he.lst&&he.lst["@_name"]==="defaults"),M=t.get(b,"query.filterCache"),Y=t.get(b,"indexConfig.mergeScheduler.int",[]).reduce((he,ce)=>({...he,[ce["@_name"]]:ce["#text"]}),{});return R.realtime=t.get(b,"indexConfig.rt",!1),R.directoryFactoryClass=t.get(b,"directoryFactory.@_class"),R.directoryFactory="",R.directoryFactoryClass==="solr.EncryptedFSDirectoryFactory"&&(R.directoryFactory="encrypted",R.directoryFactoryClass=""),R.directoryFactoryClass==="solr.StandardDirectoryFactory"&&(R.directoryFactory="standard",R.directoryFactoryClass=""),D&&(R.autoCommitTime=D),V&&(R.defaultQueryField=V.lst.str["#text"]),M&&(R.filterCacheLowWaterMark=M["@_lowWaterMarkMB"],R.filterCacheHighWaterMark=M["@_highWaterMarkMB"]),t.isEmpty(Y)||(Y.maxThreadCount&&(R.mergeMaxThreadCount=Y.maxThreadCount),Y.maxMergeCount&&(R.mergeMaxMergeCount=Y.maxMergeCount)),R},"getSearchIndexConfig"),ke=c(b=>Array.isArray(b)?b:[b],"transformObjectToArray"),we=c(b=>{let R=ke(b.fields.field),D=ke(b.types.fieldType),V=(b.uniqueKey||"").replace(/^\(|\)$/g,"").split(","),M=R.filter(Fe=>Fe["@_name"]!=="_partitionKey"),Y=M.some(Fe=>!V.includes(Fe["@_name"])&&Fe["@_type"]==="StrField"),he=D.some(Fe=>Fe["@_precisionStep"]===0),ce=M.some(Fe=>V.includes(Fe["@_name"])&&Fe["@_type"]==="StrField"),ge=D.some(Fe=>Fe["@_name"]==="StrField"),Je={spaceSavingSlowTriePrecision:he,spaceSavingNoJoin:R.length!==M.length,spaceSavingNoTextfield:Y||!ce&&ge};return Object.entries(Je).filter(([Fe,Ut])=>Ut).map(([Fe])=>Fe)},"getSearchIndexProfile"),Ve=c(b=>{if(t.isEmpty(b))return{};let R=aR.parse(b.schema,{parseAttributeValue:!0,ignoreAttributes:!1}).schema,D=aR.parse(b.config,{parseAttributeValue:!0,ignoreAttributes:!1}).config,M=ke(R.fields.field).filter(ce=>ce["@_name"]!==R.uniqueKey&&ce["@_name"]!=="_partitionKey").map(ce=>{var ge;return{key:[ce["@_name"]],indexed:!!ce["@_indexed"],docValues:!!ce["@_docValues"],lowerCase:(ge=ce["@_type"])==null?void 0:ge.startsWith("LowerCase")}}),Y=Ee(D),he=we(R);return{searchIndex:!0,searchIndexColumns:M,searchIndexConfig:Y,searchIndexProfiles:he}},"getSearchIndex"),lt=c(b=>{let R=/^values\(([\s\S]+)\)$/i,D=/^entries\(([\s\S]+)\)$/i,V=/^keys\(([\s\S]+)\)$/i,M="",Y=b;return R.test(b)&&(M="values",Y=b.match(R)[1]),D.test(b)&&(M="entries",Y=b.match(D)[1]),V.test(b)&&(M="keys",Y=b.match(V)[1]),{type:M,name:Y}},"getIndexKey"),wt=c(b=>{if(b&&b.length){let R={},D=[];return b.forEach(({udt:V,sample:M})=>{let Y=t.get(V,"type.info",t.get(V,"info"),{}),he=Y.name||V.name,ce=Y.fields||[];R[he]={type:"udt",static:V.isStatic,properties:Ae(ce,D,M).properties}}),{...R,...wt(D)||{}}}else return null},"handleUdts"),Qt=c(b=>{let R=`SELECT * FROM system_schema.types WHERE keyspace_name='${b}'`;return A(R)},"getUDT"),Lt=c(b=>{let R=`SELECT * FROM system_schema.functions WHERE keyspace_name='${b}'`;return A(R)},"getUDF"),Pt=c(b=>{let R=`SELECT * FROM system_schema.aggregates WHERE keyspace_name='${b}'`;return A(R)},"getUDA"),St=c(b=>b.replace(/frozen\<(.*)\>/i,"$1"),"removeFrozen"),kt=c(b=>b.rows.map(D=>{let V=D.argument_names.map((ce,ge)=>`${ce} ${St(D.argument_types[ge]||"")}`).join(", "),M=D.deterministic?"DETERMINISTIC":"",Y=D.monotonic?"MONOTONIC ON"+D.monotonic_on.join(", "):"",he=`CREATE OR REPLACE FUNCTION ${D.function_name} ( ${V} )
				${D.called_on_null_input?"CALLED":"RETURNS NULL"} ON NULL INPUT
				RETURNS ${St(D.return_type)}  ${M} ${Y}
				LANGUAGE ${D.language} AS
				$$ ${D.body} $$ ;`;return{name:D.function_name,functionBody:he}}),"handleUDF"),Ft=c(b=>b.rows.map(D=>{let V=D.argument_types.map(St).join(", "),M=`CREATE OR REPLACE AGGREGATE ${D.aggregate_name} (${V})
			SFUNC ${D.state_func}
			STYPE ${St(D.state_type)}`+(D.final_func!==null?`
			FINALFUNC ${D.final_func}`:"")+`
			INITCOND ${D.initcond}${D.deterministic?`
			DETERMINISTIC`:""};`;return{name:D.aggregate_name,storedProcFunction:M}}),"handleUDA"),qt=c((b,R,D)=>b.filter(V=>t.get(V,"view.tableName")===R).map(V=>{let M=t.get(V,"view",{}),Y=Object.keys(t.get(V,"documentTemplate",{}));return{name:M.name,jsonSchema:lO(M,D),documentTemplate:Y,data:{compositePartitionKey:je(M.partitionKeys),compositeClusteringKey:Se(M),comments:M.comment,tableOptions:X(M)}}}),"getViewsData"),lO=c((b,R)=>{if(t.isEmpty(t.get(b,"columns")))return{};let D=Object.keys(b.columnsByName);return{properties:fO(R,b.tableName,D)}},"getViewData"),fO=c((b,R,D)=>D.reduce((V,M)=>t.get(b,["properties",M])?Object.assign({},V,{[M]:{$ref:`#collection/definitions/${R}/${M}`}}):V,{}),"getViewSchema"),hO=c((b,R)=>{var V,M;let D={dbName:b.keyspaceName,collectionName:b.tableName,documents:b.records};if((M=(V=b==null?void 0:b.table)==null?void 0:V.columns)!=null&&M.length){D.bucketInfo=y(b.keyspaceName),D.bucketInfo.UDFs=b.UDFs,D.bucketInfo.UDAs=b.UDAs,D.entityLevel=G(b.table,b.tableName,b.searchIndex);let Y=[],he=t1(b.records),ce=Ae(b.table.columns,Y,he);D.validation={jsonSchema:ce},D.documentTemplate=he,D.modelDefinitions={definitions:wt(Y)},t.isEmpty(b.views)||(D.views=qt(b.views,b.tableName,ce)),D={...D,documents:J$(t).filterUdts(ce.properties,b.records)}}else R||(D=null);return D},"getPackageData"),t1=c(b=>{let R=c((ge,Je)=>ge.reduce((Fe,Ut)=>Je(Ut)?[Fe[0].concat([Ut]),Fe[1]]:[Fe[0],Fe[1].concat([Ut])],[[],[]]),"split"),D=c(ge=>{let Je={};return ge.reduce((Fe,Ut)=>Je[typeof Ut]?Fe:(Je[typeof Ut]=!0,Fe.concat([Ut])),[])},"uniqByType"),V=c(ge=>{let[Je,Fe]=R(ge,Array.isArray),[Ut,CO]=R(Fe,M),wO=D(CO),n1=Ut.reduce(ce,{}),i1=wO.concat(Je.reduce(ce,[]));return Object.keys(n1).length?i1.concat([n1]):i1},"mergeByType"),M=c(ge=>ge&&typeof ge=="object"&&!Array.isArray(ge),"isObject"),Y=c((ge,Je)=>{let Fe=ge.concat(Je);return Fe.length?V(Fe):[]},"mergeArray"),he=c((ge,Je)=>Object.keys(ge).concat(Object.keys(Je)).reduce((Fe,Ut)=>Object.assign({},Fe,{[Ut]:ce(ge[Ut],Je[Ut])}),{}),"mergeObjects"),ce=c((ge,Je)=>{if(Array.isArray(ge)&&Array.isArray(Je))return Y(ge,Je);if(M(ge)&&M(Je))return he(ge,Je);if(Array.isArray(ge))return ce(ge,[]);if(Array.isArray(Je))return ce([],Je);if(M(ge))return ce(ge,{});if(M(Je))return ce({},Je);if(ge!==void 0)return ge;if(Je!==void 0)return Je},"merge");if(!Array.isArray(b)||!b.length)return{};try{return JSON.parse(JSON.stringify(b)).reduce(ce,{})}catch{return{}}},"mergeDocuments"),dO=c(b=>b instanceof Error?{message:b.message,stack:b.stack}:b,"prepareError"),pO=c((b,R)=>t.difference(b,R||[]),"filterKeyspaces"),gO=c((b,R)=>{let D=Math.ceil(b*R.relative.value/100);return Math.min(D,R.maxValue)},"getSampleDocSize"),yO=c(b=>b.replace(/\/\*([\s\S]+?)\*\//,""),"cleanOutComments"),mO=c(b=>{let R=c(Y=>(Y.match(/\$\$([\s\S]+?)\$\$/g)||[]).map(he=>he.trim().replace(/(^\$\$|\$\$$)/g,"")),"findFunctionStatements"),D=c(Y=>`$__HACKOLADE__PLACEHOLDER_${Y}__$`,"getPlaceholder");b=yO(b);let V=R(b),M=V.reduce((Y,he,ce)=>Y.replace(he,D(ce)),b).split(";").map(Y=>Y.trim()).filter(Boolean);return V.reduce((Y,he,ce)=>Y.map(ge=>ge.replace(D(ce),he)),M)},"splitScriptByQueries"),vO=c((b,R)=>{let D=mO(b),V=D.length,M=0;return r1(D.map(Y=>()=>Dt.client.execute(Y)),Y=>{let he=D[M];R(he,Y,M,V),M++}).then(Y=>Y,Y=>Promise.reject({error:Y,query:D[M]}))},"batch"),r1=c((b,R)=>b.length?b[0]().then(D=>(R(D),r1(b.slice(1),R))):Promise.resolve(),"promiseSeriesAll"),EO=c(b=>b.slice(-4)===" (v)","isView"),Wf=c(b=>{if(b!==null)return Array.isArray(b)?b.map(Wf).filter(R=>R!==void 0):typeof b=="object"?Object.keys(b).reduce((R,D)=>{let V=Wf(b[D]);return V===void 0?R:{...R,[D]:V}},{}):b},"filterNullItems"),SO=c(b=>{let R=b.relative.value,D=b.maxValue;return Math.round(D/R*100)},"getCountLimit");return{connect:p,close:g,getKeyspacesNames:v,getTablesNames:w,prepareConnectionDataItem:k,getColumnInfo:re,getTableMetadata:O,getTableSchema:Ae,scanRecords:q,getEntityLevelData:G,getKeyspaceMetaData:d,getKeyspaceInfo:y,handleUdts:wt,getUDF:Lt,getUDA:Pt,handleUDF:kt,handleUDA:Ft,getPackageData:hO,prepareError:dO,filterKeyspaces:pO,batch:vO,isOldVersion:m,getViews:P,getViewsNames:x,splitEntityNames:se,filterNullItems:Wf,describeSearchIndexes:Q}}});var fR=_((gte,lR)=>{"use strict";var tG=c(t=>(e,r,n)=>{let i=e.script;if(e.clusterType==="apolloCloud"){let o=i.indexOf("USE");i=i.substring(o)}let s=t(n.require("lodash"));return s.connect(n)(e).then(()=>(r.log("info",{message:"Applying cassandra script has been started"},"Cassandra script"),s.batch(i,(o,a,u,l)=>{r.progress({message:`Completed queries: ${u+1} / ${l}`})})),o=>{let a=s.prepareError(o);return r.log("error",a,"Cassandra script"),Promise.reject(a)}).then(o=>{r.log("info",{message:"Cassandra script has been applied successfully!"},"Cassandra script"),s.close(n)},o=>{if(!o.query)return Promise.reject(o);let{error:a,query:u}=o,l=rG(a,i,u),f=s.prepareError(l);return r.progress({message:`Query has executed with error: 
 ${u} 
 ${l.message}`}),r.log("error",{query:u,error:f,detail:l},"Cassandra script: query has been executed with error"),Promise.reject(f)}).catch(o=>(s.close(n),Promise.reject(s.prepareError(o))))},"applyToInstance"),rG=c((t,e,r)=>{let n=/^line\ (\d+)\:(\-?\d+)/i,i=e.indexOf(r);if(i===-1)return t;let s=e.slice(0,i).split(`
`).length;if(!n.test(t.message))return Object.assign({},t,{message:`query line ${s}:0 ${t.message}`});let o=t.message.match(n),a=+o[1],u=o[2],l=t.message.replace(n,`line ${s+a-1}:${u}`);return Object.assign({},t,{message:l})},"modifyLineError");lR.exports=tG});var dR=_((mte,hR)=>{"use strict";hR.exports=t=>(e,r)=>{let n=t(r.require("lodash"));return n.connect(r)(e).then(()=>{n.close(r)},i=>(n.close(r),Promise.reject(n.prepareError(i))))}});var yR=_((vte,gR)=>{"use strict";var pR=uR(),nG=fR()(pR),iG=dR()(pR);gR.exports={applyToInstance:nG,testConnection:iG}});var vR=_((Ete,mR)=>{"use strict";var sG=c(t=>{var e,r,n;return{containers:{skipModified:(n=(r=(e=t.options)==null?void 0:e.additionalOptions)==null?void 0:r.find(i=>i.id==="excludeContainerAlterStatements"))==null?void 0:n.value}}},"getScriptOptions");mR.exports={getScriptOptions:sG}});var wR=_((Cte,CR)=>{"use strict";var{dependencies:Xi}=cr(),{getReplication:oG,getDurableWrites:aG}=_h(),{retrivePropertyFromConfig:zs}=ar(),{AlterScriptDto:qc}=Ji(),cG=c(t=>t.name?`DROP FUNCTION IF EXISTS ${t.name};`:"","getDropUDFScript"),uG=c(t=>t.name?`DROP AGGREGATE IF EXISTS ${t.name};`:"","getDropUDAScript"),lG=["functionBody"],fG=["storedProcFunction"],hG={getDropScript:cG,requiredProps:lG,parser:"getUDFName",functionName:"functionBody"},dG={getDropScript:uG,requiredProps:fG,parser:"getUDAName",functionName:"storedProcFunction"},ER={regExpUDFForName:/^.+function(.+?)\(/is,regExpUDAForName:/^.+aggregate(.+?)\(/is,getResult(t,e){var n;let r=t.match(e);return(n=r==null?void 0:r[1])==null?void 0:n.trim()},getName(t,e){let r=this.getResult(t,e);return r&&r.replace(/if not exists/i,"").trim()},getUDFName(t){return this.getName(t,this.regExpUDFForName)},getUDAName(t){return this.getName(t,this.regExpUDAForName)}},pG=c((t,e,r)=>{let n=[],i=[];if(!t.length&&!e.length)return{dataForAddScript:n,dataForDropScript:i};if(!e.length)n=t;else if(!t.length)i=e;else{let s=c((a,u)=>r.every(l=>Xi.lodash.isEqual(a[l],u[l])),"difference"),o=Xi.lodash.intersectionWith(t,e,s);n=Xi.lodash.xorWith(t,o,s),i=Xi.lodash.xorWith(e,o,s)}return{dataForAddScript:n,dataForDropScript:i}},"getDataForScript"),SR=c(({new:t=[],old:e=[],udData:r})=>{t=t.map(a=>({...a,name:ER[r.parser](a[r.functionName])})),e=e.map(a=>({...a,name:ER[r.parser](a[r.functionName])}));let{dataForAddScript:n,dataForDropScript:i}=pG(t,e,r.requiredProps),s=n.filter(a=>Object.entries(a).every(([u,l])=>r.requiredProps.includes(u)?!!l:!0)).map(a=>qc.getInstance([a[r.functionName]],!0,"add","udf"));return[...i.filter(a=>!!a.name).map(a=>qc.getInstance([r.getDropScript(a)],!0,"deletion","udf")),...s]},"getModifyUDFA"),gG=["replStrategy","replFactory","dataCenters"],yG=c((t,e)=>e.some(r=>{let{new:n,old:i}=t[r]||{};return n&&i&&!Xi.lodash.isEqual(n,i)}),"getIsModifyKeysSpace"),mG=c(({child:t,mode:e})=>{let r=[t.role],n=t.role.code||t.role.name,i=zs(r,0,"replStrategy",""),s=zs(r,0,"replFactor",void 0),o=zs(r,0,"dataCenters",[]),a=zs(r,0,"durableWrites",!1),u=zs(r,0,"compMod",{}),l=oG(i,s,o),f=aG(a);if(e==="add"){let m=zs(r,0,"UDFs",[]),w=zs(r,0,"UDAs",[]);return[qc.getInstance([Xi.provider.createKeySpace(n,l,f,m,w)],!0,"add","keySpaces")]}else if(e==="delete")return[qc.getInstance([Xi.provider.dropKeySpace(n)],!0,"deletion","keySpaces")];let h=(u==null?void 0:u.UDFs)||{},p=(u==null?void 0:u.UDAs)||{},g=SR({...h,udData:hG}),d=SR({...p,udData:dG}),v=yG(u,gG)?Xi.provider.alterKeySpaceReplication(n,l,f):"";return[qc.getInstance([v],!0,"modify","keySpaces"),...d,...g]},"getKeySpaceScript");CR.exports={getKeySpaceScript:mG}});var AR=_((xte,IR)=>{"use strict";var{dependencies:ea}=cr(),Mf=["id"],vG=["SecIndxComments","SecIndxDescription"],EG={recovery:!1,reindex:!0,lenient:!1},SG={autoCommitTime:1e4,filterCacheLowWaterMark:1024,filterCacheHighWaterMark:2048,mergeFactor:10,ramBufferSize:512,realtime:!1},CG={indexIfNotExist:!1},wG={spaceSavingNoTextfield:{mode:["text","varchar"]},spaceSavingSlowTriePrecision:{childType:["timestamp","date","time","numeric","timeuuid"],type:["timestamp","date","time","numeric","timeuuid"]}},_R=c((t,e)=>!ea.lodash.isEqual(t,e),"isDiff"),bR=c((t,e)=>Object.entries(e).reduce((r,[n,i])=>Mf.includes(n)?r:!t.hasOwnProperty(n)||_R(t[n],i)?Object.assign({},r,{[n]:i}):r,{}),"getModifiedProperties"),xR=c(t=>typeof t!="boolean"&&!t,"isEmptyValue"),xG=c((t,e)=>Object.keys(t).filter(r=>!e.hasOwnProperty(r)),"getDeletedProperties"),TG=c((t,e,r)=>t.reduce((n,i)=>r.hasOwnProperty(i)&&_R(ea.lodash.get(e,i),r[i])?Object.assign({},n,{[i]:r[i]}):n,{}),"getDefaultPropertiesByName"),_G=c((t=[],e=[])=>t.reduce((r,n)=>e.includes(n)?r:[...r,n],[]),"getNotDefaultProperties"),bG=c((t,e,r={})=>_G(Object.keys(e),Object.keys(r)).reduce((i,s)=>Mf.includes(s)?i:t.hasOwnProperty(s)&&xR(e[s])&&!xR(t[s])?{...i,[s]:e[s]}:i,{}),"getDropProperties"),IG=c(t=>(e={},r={})=>{let n=bR(Object.assign({},t,e),Object.assign({},t,r)),i=xG(e,Object.assign({},t,r));return{modifyData:n,dropData:TG(i,e,t)}},"getDiffOptions"),TR=c(t=>(e={},r={})=>({modifyData:bR(Object.assign({},t,e),Object.assign({},t,r)),dropData:bG(e,r,t)}),"getDiff"),AG=c((t,e)=>(r={},n={})=>(n=Object.assign({},t,n),r=Object.assign({},t,r),ea.lodash.uniq([...ea.lodash.keys(n),...ea.lodash.keys(r)]).filter(s=>!e.includes(s)).reduce((s,o)=>s&&ea.lodash.isEqual(n[o],r[o])?s:!1,!0)),"isEqualIndex"),NG=c((t=[],e=[],r=[])=>Object.entries(wG).reduce((n,[i,s])=>!e.includes(i)||n.includes(i)||Object.entries(s).reduce((a,[u,l])=>{if(a)return a;let f=r.map(h=>h[u]).filter(Boolean);return l.some(h=>f.includes(h))},!1)?n:[...n,i],t),"prepareSearchIndexProfile");IR.exports={getDiffOptions:IG(EG),getDiffConfig:TR(SG),getDiffIndexProfiles:TR({}),isEqualIndex:AG(CG,[...Mf,...vG]),prepareSearchIndexProfile:NG,REDUNDANT_OPTIONS:Mf}});var VR=_((_te,UR)=>{"use strict";var{dependencies:$e}=cr(),{getIndexProfiles:BG,getTableNameStatement:$f,tab:zE}=ar(),{getIndexes:WE}=ca(),{getNamesByIds:RG}=sa(),{getDiffOptions:OG,getDiffConfig:DG,getDiffIndexProfiles:LG,isEqualIndex:PG,prepareSearchIndexProfile:kG}=AR(),{AlterScriptDto:di}=Ji(),Kf={dropIndexes:[],dropSearchIndexes:[],createIndexes:[],createSearchIndexes:[]},Gf=c((t,e,r)=>{let n=$f(t,e);return!!Kf[r].filter(s=>s===n).length},"checkExistsScript"),jf=c((t,e,r)=>{let n=$f(t,e);Kf={...Kf,[r]:[...Kf[r],n]}},"setNameCollectionsScript"),FG=["searchIndexProfiles","searchIndexOptions"],QE=c((t,e)=>({indexType:"search",columns:t.searchIndexColumns,config:t.searchIndexConfig,profiles:BG(t.searchIndexProfiles,e),options:t.searchIndexOptions,ifNotExist:t.searchIndexIfNotExist}),"getDataSearchIndex"),NR=c((t,e,r)=>{let n=[...FG,"searchIndexIfNotExist","searchIndexColumns","searchIndexConfig"].map(i=>{var s;return[i,(s=((t==null?void 0:t.compMod)||{})[i])==null?void 0:s[e]]}).filter(([i,s])=>!!s);return t={...t,...Object.fromEntries(n)},QE(t,r)},"getModifyDataSearchIndex"),LR=c((t,e,r=$e.lodash.isEqual)=>{let n,i;if(!t.length&&!e.length)return{};if(!t.length)i=e;else if(!e.length)n=t;else if(!$e.lodash.isEqual(t,e)){let s=$e.lodash.intersectionWith(t,e,r);i=$e.lodash.xorWith(e,s,r),n=$e.lodash.xorWith(t,s,r)}return{addData:n,dropData:i}},"getDataForScript"),qG=c((t,e,r)=>{var y,v,m,w;let{compMod:n}=t,i=$e.lodash.get(t,"compMod.oldIdToNameHashTable",{}),s=$e.lodash.get(t,"compMod.searchIndexColumns",{}),o=c(x=>(x==null?void 0:x.name)&&!(x!=null&&x.compositePartitionKey),"filterColumn"),a=(s.old||[]).map(x=>Hf({dataSources:e,column:x,allAttributes:!0,idToNameHashTable:i})).filter(o),u=QE(t,r),l=$e.lodash.get(t,"compMod.searchIndex",{}),f=(y=n==null?void 0:n.searchIndexProfiles)==null?void 0:y.new,h=kG((v=n==null?void 0:n.searchIndexProfiles)==null?void 0:v.old,f,a),p=$e.lodash.merge(OG((m=n==null?void 0:n.searchIndexOptions)==null?void 0:m.old,(w=n==null?void 0:n.searchIndexOptions)==null?void 0:w.new),LG(h,f)),g,d;return!l.old&&!l.new?{}:(l.old?l.new?(!$e.lodash.isEmpty(p.modifyData)||!$e.lodash.isEmpty(p.dropData))&&(d=NR(t,"new",r),g=u):g=u:d=NR(t,"new",r),{addData:d,dropData:g})},"getDataForSearchIndexScript"),PR=c(({dataSources:t,idToNameHashTable:e,keyId:r,allAttributes:n=!1})=>{let i=RG([r],t,n)[r]||{};return i.name?i:{name:e[r]||""}},"getFieldDataByKeyId"),Hf=c(({dataSources:t,idToNameHashTable:e,column:r={},key:n="key",allAttributes:i=!1})=>{let s=$e.lodash.get(r,`${n}[0].keyId`,""),o=PR({dataSources:t,idToNameHashTable:e,keyId:s,allAttributes:i})||{};return{...$e.lodash.omit(r,n),...o}},"getDataColumnIndex"),UG=c((t,e)=>{let r=$e.lodash.get(t,"role.compMod.oldIdToNameHashTable",{}),n=$e.lodash.get(t,"role.compMod.newIdToNameHashTable",{}),i=$e.lodash.get(t,"role.compMod.searchIndexColumns",{}),s=c(l=>l.name&&!l.compositePartitionKey,"filterColumn"),o=(i.new||[]).map(l=>Hf({dataSources:e,idToNameHashTable:n,column:l})).filter(s),a=(i.old||[]).map(l=>Hf({dataSources:e,idToNameHashTable:r,column:l})).filter(s);return LR(o,a,c((l,f)=>(l==null?void 0:l.name)===(f==null?void 0:f.name),"isEqual"))},"getDataForSearchIndexColumns"),VG=c((t,e,r)=>{let n=Object.entries(r.dropData).map(([s])=>di.getInstance([$e.provider.dropSearchIndexConfig(t,e,s)],!0,"deletion","index"));return[...Object.entries(r.modifyData).filter(([s,o])=>typeof o!="string"||!!o).map(([s,o])=>{let a=$e.lodash.isString(o)?`'${o}'`:o;return di.getInstance([$e.provider.modifySearchIndex(t,e,s,a)],!0,"modify","index")}),...n]},"getSearchConfigScript"),MG=c((t,e,r)=>{let n=$f(t,e),i=`ALTER SEARCH INDEX SCHEMA
`+zE(`ON ${n}
`),s=c((u,l,f,h)=>{let p=u+zE(`${l} "${h.name}";`);return di.getInstance([p],!0,f,"index")},"getScript"),o=(r.dropData||[]).map(s.bind(null,i,"DROP field","deletion")),a=(r.addData||[]).map(s.bind(null,i,"ADD field","modify"));return o.length&&o.push(kR(t,e,"RELOAD","deletion")),{dropSearchScripts:o,addSearchScripts:a}},"getSearchColumnsScript"),kR=c((t,e,r,n)=>{let i=$f(t,e),s=`${r} SEARCH INDEX
`+zE(`ON ${i};`);return di.getInstance([s],!0,n,"renewal")},"getRenewalScript"),FR=c((t,e,r)=>{let n=Gf(t,e,"dropSearchIndexes"),i="";return r&&!n&&(i=$e.provider.dropSearchIndex(t,e),jf(t,e,"dropSearchIndexes")),[di.getInstance([i],!0,"deletion","index")]},"getDropSearchIndexScript"),qR=c((t,e,r=[])=>r.map(n=>{let i=`${e}.${n.name}`,s=Gf(t,i,"dropIndexes"),o="";return n.name&&!s&&(o=$e.provider.dropIndex(t,n.name),jf(t,i,"dropIndexes")),di.getInstance([o],!0,"deletion","index")}),"getDropIndexScript"),KG=c(t=>{let{keyspaceName:e,tableName:r,searchIndex:n,dataSources:i,isActivated:s,dbVersion:o}=t;if(Gf(e,r,"createSearchIndexes"))return[];jf(e,r,"createSearchIndexes");let u=WE({searchIndex:n},i,r,e,s,!0,o);return[di.getInstance([u],!0,"add","index")]},"getAddSearchIndexScript"),HG=c(t=>{let{keyspaceName:e,indexes:r=[],dataSources:n,tableName:i,isActivated:s,dbVersion:o}=t,a=r.filter(l=>{let f=`${i}.${l.name}`;return Gf(e,f,"createIndexes")?!1:(jf(e,f,"createIndexes"),!0)}),u=WE({indexes:a},n,i,e,s,!0,o);return[di.getInstance([u],!0,"add","index")]},"getAddIndexScript"),BR=c(t=>{var f,h;let{item:e,dataSources:r,tableName:n,keyspaceName:i,isActivated:s,dbVersion:o}=t,a=!!((f=e.role)!=null&&f.searchIndex),u=QE(e.role||{},o),l=WE({searchIndex:a&&u,indexes:((h=e.role)==null?void 0:h.SecIndxs)||[]},r,n,i,s,!0,o);return[di.getInstance([l],!0,"add","index")]},"getCreatedIndex"),RR=c(t=>{var o,a;let{item:e,keyspaceName:r,tableName:n}=t,i=qR(r,n,(o=e.role)==null?void 0:o.SecIndxs),s=FR(r,n,(a=e.role)==null?void 0:a.searchIndex);return[...i,...s]},"getDeletedIndex"),$G=c(t=>{let{item:e,keyspaceName:r,tableName:n,dbVersion:i,isActivated:s,dataSources:o}=t,a=qG(e.role,o,i);if(a.dropData||a.addData){let v=FR(r,n,!!a.dropData),m=KG({searchIndex:a.addData,dataSources:o,tableName:n,keyspaceName:r,isActivated:s,dbVersion:i});return[...v,...m]}let u=$e.lodash.get(e,"role.compMod.searchIndexConfig",{}),l=UG(e,o),f=DG(u.old,u.new),h=VG(r,n,f),{dropSearchScripts:p,addSearchScripts:g}=MG(r,n,l),d={RELOAD:h.length||g.length,REBUILD:p.length||g.length},y=Object.entries(d).reduce((v,[m,w])=>w?[...v,kR(r,n,m,"add")]:v,[]);return[...h,...p,...g,...y]},"getUpdateSearchIndexScript"),OR=c((t,e,r=[])=>r.map(n=>{let i=$e.lodash.get(n,"SecIndxKey",[]).map(s=>{var o;return{...s,name:((o=PR({dataSources:e,idToNameHashTable:t,keyId:$e.lodash.get(s,"keyId")}))==null?void 0:o.name)||""}});return{...$e.lodash.omit(n,["SecIndxKey"]),SecIndxKey:i}}),"prepareIndexes"),DR=c((t=[])=>t.map(e=>$e.lodash.omit(e,"keyId")),"removeKeyIdFromKeys"),GG=c(t=>{let{item:e,keyspaceName:r,tableName:n,dbVersion:i,isActivated:s,dataSources:o}=t,{new:a=[],old:u=[]}=$e.lodash.get(e,"role.compMod.SecIndxs",{}),{oldIdToNameHashTable:l={},newIdToNameHashTable:f={}}=$e.lodash.get(e,"role.compMod",{}),h=OR(f,o,a),p=OR(l,o,u),d=LR(h,p,c((m={},w={})=>PG({...w,SecIndxKey:DR(w.SecIndxKey)},{...m,SecIndxKey:DR(m.SecIndxKey)}),"isEqual")),y=qR(r,n,d.dropData),v=HG({indexes:d.addData,dataSources:o,tableName:n,keyspaceName:r,isActivated:s,dbVersion:i});return[...y,...v]},"getUpdateIndexScript"),jG=c(t=>{let e=$G(t);return[...GG(t),...e]},"getUpdateIndex"),zG=c((t,e)=>[{properties:{...t.properties||{},...t.role.properties||{}},...$e.lodash.omit(t.role||{},["properties"])},e.modelDefinitions,e.externalDefinitions,e.internalDefinitions,{properties:(t==null?void 0:t.properties)||{}},{properties:$e.lodash.get(t,"role.compMod.newProperties",[])},{properties:$e.lodash.get(t,"role.compMod.oldProperties",[])}],"createDataSources"),WG=c(t=>{var e,r,n,i,s,o;return((n=(r=(e=t.role)==null?void 0:e.compMod)==null?void 0:r.collectionName)==null?void 0:n.new)??((o=(s=(i=t.role)==null?void 0:i.compMod)==null?void 0:s.collectionName)==null?void 0:o.old)},"getTableNameFromCompMod"),QG=c((t,e,r)=>{var l,f,h,p;let n=zG(t,e),i=((l=t.role)==null?void 0:l.code)||((f=t.role)==null?void 0:f.name)||WG(t),s=(h=t.role.compMod)==null?void 0:h.keyspaceName,o=e.modelData[0].dbVersion,a=(p=t.role)==null?void 0:p.isActivated,{compMod:u={}}=t.role||{};if(r){let g=BR({item:t,dataSources:n,tableName:i,keyspaceName:s,isActivated:a,dbVersion:o}),d=RR({item:t,keyspaceName:s,tableName:i});return[...g,...d]}return u.created?BR({item:t,dataSources:n,tableName:i,keyspaceName:s,isActivated:a,dbVersion:o}):u.deleted?RR({item:t,keyspaceName:s,tableName:i}):jG({item:t,keyspaceName:s,tableName:i,dataSources:n,isActivated:a,dbVersion:o})},"getIndexTable");UR.exports={getIndexTable:QG,getDataColumnIndex:Hf}});var YR=_((Ite,QR)=>{"use strict";var{getTypeByData:YG}=na(),{dependencies:dn}=cr(),{getKeySpaceScript:ZG}=wR(),{checkIsOldModel:XG,fieldTypeCompatible:JG}=Mc(),{getViewScript:ej}=Eh(),{getIndexTable:ZE,getDataColumnIndex:MR}=VR(),{getUdtScript:tj,sortAddedUdt:rj}=ph(),{getDelete:GR,hydrateColumn:nj,isTableChange:ij,addScriptToExistScripts:sj,getAdd:jR,getDeleteTableDto:zR,getAddTable:WR}=fh(),{getUdtMap:oj}=zc(),{AlterScriptDto:JE}=Ji(),aj=c(t=>[JE.getInstance([dn.provider.renameColumn(t)],!0,"modify","field")],"getRenameColumnDto"),XE=c((t,e)=>!!t[e],"objectContainsProp"),cj=c(t=>{let{collectionName:e={},code:r={}}=t;return{oldName:r.old||e.old,newName:r.new||e.new}},"getCollectionName"),KR={alterDropCreate({dataForScript:t,oldName:e,newName:r}){let n=c(o=>({...t,columnData:{...t.columnData,...o}}),"getData"),i=GR(n({name:e})),s=jR(n({name:r}));return[...i,...s]},alterNameDto(t){let{newName:e,oldName:r,dataForScript:n,property:i,isTypeChange:s}=t;return i.primaryKey&&s?[]:i.primaryKey?aj({...n,columnData:{oldName:r,newName:e}}):this.alterDropCreate(t)},alterType(t){let{isOldModel:e,oldType:r,newType:n,dataForScript:i,property:s}=t;if(!r||!n||s.primaryKey)return[];let o=JG(r,n);return e?o?[JE.getInstance([dn.provider.updateType(i)],!0,"modify","field")]:this.alterDropCreate(t):this.alterDropCreate(t)}},uj=c(t=>{let e=nj(t),{newName:r,oldName:n}=e;return!n||!r?[]:e.isNameChange?KR.alterNameDto(e):e.isTypeChange?KR.alterType(e):(sj(e.dataForScript),[])},"getUpdate"),lj=c((t,e,r)=>{let i=[{properties:t.properties||{},...dn.lodash.omit(t.role||{},["properties"])},r.modelDefinitions],s=dn.lodash.get(t,"role.SecIndxs",[]).map(a=>MR({dataSources:i,idToNameHashTable:{},column:a,key:"SecIndxKey"})).map(a=>a.name).filter(Boolean);return[...dn.lodash.get(t,"role.searchIndexColumns",[]).map(a=>MR({dataSources:i,idToNameHashTable:{},column:a})).map(a=>a.name).filter(Boolean),...s].includes(e)},"getIsColumnInIndex"),fj=c((t=[])=>{let e=Object.entries(t).map(([r,n])=>{var o,a;if(!n.compMod)return[r,n];let i=((o=n.compMod)==null?void 0:o.newField)||{},s=((a=n.compMod)==null?void 0:a.oldField)||{};return Object.entries(i).forEach(([u,l])=>{s[u]!==l&&(n[u]=l),u==="name"&&s[u]!==l&&(r=l)}),[r,n]});return Object.fromEntries(e)},"getPropertiesForUpdateTable"),HR=c(t=>{var h,p,g,d,y,v;let{item:e,propertiesScript:r=[]}=t,{oldName:n,newName:i}=cj((h=e.role)==null?void 0:h.compMod),s={...((p=e.role)==null?void 0:p.compMod)||{},name:{new:i,old:n}},o=ij({item:{...e,role:{...e.role,compMod:s}},data:t.data,dataSources:t.dataSources}),a=ZE(e,t.data,o);if(!o){let m=t.tableName||n||i;return[JE.getInstance([dn.provider.updateTableOptions(((g=e.role)==null?void 0:g.compMod)||{},m,t.isOptionScript)],!0,"modify","table"),...a,...r]}if(!n||!i)return[];let u={keyspaceName:t.keyspaceName,data:t.data,item:{...e,properties:fj(((d=e.role)==null?void 0:d.properties)||e.properties),role:{...(e==null?void 0:e.role)||{},tableOptions:((v=(y=e==null?void 0:e.role)==null?void 0:y.compMod)==null?void 0:v.tableOptions)||{}}},isKeyspaceActivated:!0,dataSources:t.dataSources},l=zR({...u,tableName:n}),f=WR({...u,tableName:i});return[...l,...f,...a]},"getUpdateTableDto"),YE=c((t,e,r,n)=>{let i=[];if(XE(t,"items")&&t.items.length){let s=t.items.reduce((o,a)=>o.concat($R(a,e,r,n)),[]);i=i.concat(s)}else XE(t,"items")&&(i=i.concat($R(t.items,e,r,n)));return i},"handleChange"),$R=c((t,e,r,n)=>{let i=[];if(!XE(t,"properties"))return i;let s=XG(dn.lodash.get(n,"modelData")),o=t.properties;return i=Object.keys(o).reduce((a,u)=>{let l=o[u].role.compMod;if(!l)return a;let f=dn.lodash.get(o,`${u}.role.code`,""),h=f.length?f:u,p=o[u].properties||{},g=l.keyspaceName;if(l.deleted){let m=ZE(o[u],n);return[...a,...zR({keyspaceName:g,tableName:h}),...m]}let d=[n.modelDefinitions,n.internalDefinitions,n.externalDefinitions,{properties:p},{properties:dn.lodash.get(o[u],"role.properties",[])},{properties:dn.lodash.get(o[u],"role.compMod.newProperties",[])},{properties:dn.lodash.get(o[u],"role.compMod.oldProperties",[])}];if(l.created){let m=ZE(o[u],n);return[...a,...WR({item:o[u],keyspaceName:g,data:n,tableName:h,dataSources:d}),...m]}if(l.modified){let m=HR({keyspaceName:g,data:n,item:o[u],isOptionScript:!0,tableName:h,dataSources:d});return[...a,...m]}let y=hj({item:o[u],generator:r,tableProperties:p,udtMap:e,itemCompModData:l,tableName:h,isOldModel:s,data:n,dataSources:d}),v=HR({item:o[u],isOptionScript:r.name==="getUpdate"||r.name==="getAdd",propertiesScript:y,keyspaceName:g,tableName:h,data:n,dataSources:d});return[...a,...v]},[]),i},"handleItem"),hj=c(({generator:t,tableProperties:e,udtMap:r,itemCompModData:n,tableName:i,isOldModel:s,data:o,item:a,dataSources:u})=>Object.keys(e).reduce((l,f)=>{let h=e[f]||{};if(t.name!=="getUpdate"&&(h.compositePartitionKey||h.compositeClusteringKey)||t.name==="getAdd"&&h.hasOwnProperty("compMod"))return l;let p=YG(h,r,f);if(h.$ref&&!p&&(p=dn.lodash.last(h.$ref.split("/"))),!p)return l;let g=n==null?void 0:n.keyspaceName,d=lj(a,f,o);return t.name==="getUpdate"&&(!h.compMod||d)?l:[...l,...t({keyspaceName:g,tableName:i,columnData:{name:f,type:p},property:h,isOldModel:s,udtMap:r,dataSources:u})]},[]),"handleProperties"),dj={views:ej,containers:ZG,udt:tj},pi=c((t,e,r,n,i)=>{if(!t)return[];let s=dj[n];if(Array.isArray(t)&&t.length)return t.reduce((l,f)=>[...l,...s({child:f.properties[Object.keys(f.properties)[0]],udtMap:e,data:r,mode:i})],[]);let o=t.properties,a=Object.keys(o)[0],u=o[a];return s({child:u,udtMap:e,data:r,mode:i})},"generateScript"),pj=c((t,e,r)=>{var l,f,h,p,g,d,y,v,m;let n=(h=(f=(l=t==null?void 0:t.properties)==null?void 0:l.entities)==null?void 0:f.properties)==null?void 0:h.added,i=(d=(g=(p=t==null?void 0:t.properties)==null?void 0:p.entities)==null?void 0:g.properties)==null?void 0:d.modified,s=(m=(v=(y=t==null?void 0:t.properties)==null?void 0:y.entities)==null?void 0:v.properties)==null?void 0:m.deleted,o=YE(n,e,jR,r),a=YE(i,e,uj,r),u=YE(s,e,GR,r);return[...a,...o,...u]},"getEntitiesDto"),gj=c((t,e,r)=>{var l,f,h,p,g,d,y,v,m,w,x;let n=(h=(f=(l=t==null?void 0:t.properties)==null?void 0:l.containers)==null?void 0:f.properties)==null?void 0:h.added,i=(d=(g=(p=t==null?void 0:t.properties)==null?void 0:p.containers)==null?void 0:g.properties)==null?void 0:d.modified,s=(m=(v=(y=t==null?void 0:t.properties)==null?void 0:y.containers)==null?void 0:v.properties)==null?void 0:m.deleted,o=[],a=[],u=[];return(x=(w=r==null?void 0:r.scriptOptions)==null?void 0:w.containers)!=null&&x.skipModified||(o=pi(n==null?void 0:n.items,e,r,"containers","add"),a=pi(i==null?void 0:i.items,e,r,"containers","update"),u=pi(s==null?void 0:s.items,e,r,"containers","delete")),[...o,...a,...u]},"getContainersDto"),yj=c((t,e,r)=>{var l,f,h,p,g,d,y,v,m;let n=(h=(f=(l=t==null?void 0:t.properties)==null?void 0:l.views)==null?void 0:f.properties)==null?void 0:h.added,i=(d=(g=(p=t==null?void 0:t.properties)==null?void 0:p.views)==null?void 0:g.properties)==null?void 0:d.modified,s=(m=(v=(y=t==null?void 0:t.properties)==null?void 0:y.views)==null?void 0:v.properties)==null?void 0:m.deleted,o=pi(n==null?void 0:n.items,e,r,"views","add"),a=pi(i==null?void 0:i.items,e,r,"views","update"),u=pi(s==null?void 0:s.items,e,r,"views","delete");return[...a,...o,...u]},"getViewsDto"),mj=c((t,e,r)=>{var h,p,g,d;let n=(h=t==null?void 0:t.properties)==null?void 0:h.modelDefinitions,i=rj(n),s=(p=i==null?void 0:i.properties)==null?void 0:p.added,o=(g=i==null?void 0:i.properties)==null?void 0:g.modified,a=(d=i==null?void 0:i.properties)==null?void 0:d.deleted,u=pi(s.items,e,r,"udt","add"),l=pi(o.items,e,r,"udt","update"),f=pi(a.items,e,r,"udt","delete");return[...u,...l,...f]},"getModelDefinitionsDto"),vj=c((t,e,r)=>{let n=Object.assign({},e,oj([t]));return[...pj(t,n,r),...gj(t,n,r),...yj(t,n,r),...mj(t,n,r)].filter(Boolean)},"getAlterScriptDtos");QR.exports={getAlterScriptDtos:vj}});var eO=_((Nte,JR)=>{"use strict";var{dependencies:ZR}=cr(),{getAlterScriptDtos:XR}=YR(),{commentDeactivatedStatement:Ej,getApplyDropStatement:Sj}=ar(),Cj=c((t,e)=>Sj(e)?t:t.map((n={})=>{var i,s,o,a;return!((s=(i=n==null?void 0:n.scripts)==null?void 0:i[0])!=null&&s.isDropScript)||!((a=(o=n==null?void 0:n.scripts)==null?void 0:o[0])!=null&&a.script)?n:{...n,scripts:n.scripts.map(u=>({...u,script:Ej(u.script,!1)}))}}),"getCommentedDropScript"),wj=c(t=>{let e=t.flatMap(o=>o.scripts),r=c((o,a,u={})=>u[o]&&u.modelLevel===a,"filterProp"),n=c((o,a,u)=>a.reduce((l,f)=>r(o,u,f)?(l.scripts.push(f),l):(l.filteredScripts.push(f),l),{scripts:[],filteredScripts:[]}),"filter"),s=[["keySpaces","isAddScript"],["keySpaces","isModifyScript"],["view","isDropScript"],["index","isDropScript"],["renewal","isDropScript"],["table","isDropScript"],["udt","isDropScript"],["udt","isAddScript"],["udt","isModifyScript"],["table","isAddScript"],["table","isModifyScript"],["field","isDropScript"],["field","isAddScript"],["field","isModifyScript"],["index","isAddScript"],["index","isModifyScript"],["renewal","isAddScript"],["view","isAddScript"],["view","isModifyScript"],["udf","isDropScript"],["udf","isAddScript"],["keySpaces","isDropScript"]].reduce((o,[a,u])=>{let{scripts:l,filteredScripts:f}=n(u,o.filteredScripts,a);return{sorted:[...o.sorted,...l],filteredScripts:f}},{sorted:[],filteredScripts:e});return[...s.sorted,...s.filteredScripts].map(o=>o.script)},"sortScript"),xj=c((t,e,r)=>{let n=XR(t,e,r);return n=ZR.lodash.uniqWith(n,ZR.lodash.isEqual),n=Cj(n,r),wj(n).filter(Boolean).join(`

`)},"buildContainerLevelAlterScript"),Tj=c((t,e,r)=>XR(t,e,r).some(n=>n.isActivated&&n.scripts.some(i=>i.isDropScript)),"isDropInStatements");JR.exports={buildContainerLevelAlterScript:xj,isDropInStatements:Tj}});var{retrieveContainerName:_j,retrieveEntityName:bj,retrieveUDA:Ij,retrieveUDF:Aj,retrieveIndexes:Nj,retrieveIsItemActivated:tO,commentDeactivatedStatement:rO,getUserDefinedAggregations:Bj,getUserDefinedFunctions:Rj}=ar(),{getTableStatement:Oj}=Ws(),{sortUdt:ta,getUdtMap:nO,getUdtScripts:iO,prepareDefinitions:e1}=zc(),{getIndexes:Dj}=ca(),{getKeyspaceStatement:sO}=_h(),{getViewScript:oO}=$c(),{getCreateTableScript:Lj}=qS(),{setDependencies:zf}=cr(),{applyToInstance:Pj,testConnection:kj}=yR(),{getScriptOptions:aO}=vR(),{buildContainerLevelAlterScript:cO,isDropInStatements:uO}=eO();module.exports={generateScript(t,e,r,n){try{zf(n);let{udtTypeMap:i,modelDefinitions:s,externalDefinitions:o}=e1(t),a=JSON.parse(t.jsonSchema),u=ta(JSON.parse(t.internalDefinitions));if(t={...t,jsonSchema:a,udtTypeMap:i,modelDefinitions:s,externalDefinitions:o,internalDefinitions:u},t.isUpdateScript)t.scriptOptions=aO(t),r(null,cO(t.jsonSchema,i,t));else{let l=`${sO(t.containerData)}

${Lj(t,!0)}`;r(null,l)}}catch(i){e.log("error",{message:i.message,stack:i.stack},"Cassandra Forward-Engineering Error"),setTimeout(()=>{r({message:i.message,stack:i.stack})},150)}},generateViewScript(t,e,r,n){zf(n);let i=JSON.parse(t.jsonSchema||"{}"),s=JSON.parse(t.jsonSchema[i.viewOn]||"{}"),o=oO({schema:i,entitySchema:s,viewData:t.viewData,entityData:t.entityData,containerData:t.containerData,collectionRefsDefinitionsMap:t.collectionRefsDefinitionsMap,ifNotExist:i.viewIfNotExist});r(null,o)},generateContainerScript(t,e,r,n){try{if(zf(n),t.isUpdateScript){let{udtTypeMap:i,modelDefinitions:s,externalDefinitions:o}=e1(t);t={...t,udtTypeMap:i,modelDefinitions:s,externalDefinitions:o},t.scriptOptions=aO(t);let a=t.entities.map(u=>{let l=JSON.parse(t.jsonSchema[u]);return t.internalDefinitions=ta(JSON.parse(t.internalDefinitions[u])),cO(l,t.udtTypeMap,t)});r(null,a.filter(Boolean).join(`

`))}else{let i=ta(JSON.parse(t.modelDefinitions)),s=JSON.parse(t.externalDefinitions),o=t.containerData,a=[],u=_j(o),l=sO(o),f=tO(o),h=nO([i,s]),p=iO(u,[s,i],h,f),g=Rj(Aj(o)),d=Bj(Ij(o)),y=t.modelData[0].dbVersion;a.push(l,...p),t.entities.forEach(v=>{let m=ta(JSON.parse(t.internalDefinitions[v])),w=JSON.parse(t.jsonSchema[v]),x=t.entityData[v],A=Object.assign({},h,nO([m,w])),O=bj(x),P=tO(x),j=[w,i,m,s],Q=iO(u,[m,w],A,f&&P).map(k=>rO(k,P,f)),se=Oj({tableData:w,tableMetaData:x,keyspaceMetaData:o,dataSources:j,udtTypeMap:A,isKeyspaceActivated:f}),re=Dj(Nj(x,y),j,O,u,P,f,y);a.push(...Q,se,re)}),a=a.concat(t.views.map(v=>{let m=JSON.parse(t.jsonSchema[v]||"{}");return oO({schema:m,viewData:t.viewData[v],entityData:t.entityData[m.viewOn],containerData:t.containerData,collectionRefsDefinitionsMap:t.collectionRefsDefinitionsMap,isKeyspaceActivated:f,ifNotExist:m.viewIfNotExist})})),a.push(g,d),r(null,rO(Fj(a),f))}}catch(i){e.log("error",{message:i.message,stack:i.stack},"Cassandra Forward-Engineering Error"),setTimeout(()=>{r({message:i.message,stack:i.stack})},150)}},applyToInstance(t,e,r,n){e.clear(),e.log("info",t,"connectionInfo",t.hiddenKeys),Pj(t,e,n).then(i=>{r(null,i)}).catch(i=>{r(i)})},testConnection(t,e,r,n){kj(t,n).then(r,r)},isDropInStatements(t,e,r,n){try{zf(n);let i,{udtTypeMap:s,modelDefinitions:o,externalDefinitions:a}=e1(t);if(t.level==="container")t={...t,udtTypeMap:s,modelDefinitions:o,externalDefinitions:a},i=t.entities.map(u=>{let l=JSON.parse(t.jsonSchema[u]);return t.internalDefinitions=ta(JSON.parse(t.internalDefinitions[u])),uO(l,t.udtTypeMap,t)}).some(Boolean);else if(t.level==="entity"){let u=JSON.parse(t.jsonSchema),l=ta(JSON.parse(t.internalDefinitions));t={...t,udtTypeMap:s,modelDefinitions:o,externalDefinitions:a,jsonSchema:u,internalDefinitions:l},i=uO(t.jsonSchema,t.udtTypeMap,t)}r(null,i)}catch(i){r({message:i.message,stack:i.stack})}}};var Fj=c(t=>t.filter(e=>e).join(`

`),"getScript");
/*! Bundled license information:

long/umd/index.js:
  (**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   *)

node-rsa/src/NodeRSA.js:
  (*!
   * RSA library for Node.js
   *
   * Author: rzcoder
   * License MIT
   *)
*/
